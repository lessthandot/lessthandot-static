<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Using CodeDOM to Automate Technical Screening Evaluation</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Using CodeDOM to Automate Technical Screening Evaluation" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="CodeDOM provides dynamic compilation of .Net code and is commonly used in places like template generation or compilation of emitted code. I recently needed a way to evaluate code submissions against a known set of test cases, so this post will walk through building a small program to do take source code as files, compile [&hellip;]" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Using CodeDOM to Automate Technical Screening Evaluation Comments Feed" href="/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Speaking at ITPROceed 2015' href='/index.php/webdev/business-intelligence/speaking-at-itproceed-2015/' />
<link rel='next' title='SQL 2016 Preview has been released!' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2016-preview-has-been-released/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/" />
<link rel='shortlink' href='/?p=3353' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fitprofessionals%2Fusing-codedom-to-automate-technical-screening-evaluation%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fitprofessionals%2Fusing-codedom-to-automate-technical-screening-evaluation%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2016-preview-has-been-released/" rel="next">SQL 2016 Preview has been released!</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/webdev/business-intelligence/speaking-at-itproceed-2015/" rel="prev">Speaking at ITPROceed 2015</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/" class="post-title">Using CodeDOM to Automate Technical Screening Evaluation</a></h1>
					<div class="post-byline">by <a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)" rel="author">Eli Weinstock-Herman (tarwn)</a> on May 27, 2015 in category <a href="/index.php/category/itprofessionals/" rel="category tag">IT Professionals</a>. Article views: 3,919 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&text=RT @LessThanDot Blog - Using CodeDOM to Automate Technical Screening Evaluation by @tarwn" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&title=Using CodeDOM to Automate Technical Screening Evaluation&source=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&title=Using CodeDOM to Automate Technical Screening Evaluation" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&quote=Using CodeDOM to Automate Technical Screening Evaluation" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&title=Using CodeDOM to Automate Technical Screening Evaluation" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>CodeDOM provides dynamic compilation of .Net code and is commonly used in places like template generation or compilation of emitted code. I recently needed a way to evaluate code submissions against a known set of test cases, so this post will walk through building a small program to do take source code as files, compile it, and execute it against a series of known inputs and outputs to evaluate it.</p>
<p>Sample Code: <a href="https://github.com/tarwn/Blog_CodeDom" title="tarwn/Blog_CodeDom on github">tarwn/Blog_CodeDom on github</a></p>
<p>To download and run the code yourself, you will need git and VisualSudion 2013 or greater. Then execute:<br />
<code>git clone git@github.com:tarwn/Blog_CodeDom.git</code></p>
<p>The sample submissions for this post are intended to answer the following tech screening question:</p>
<blockquote><p>Write a function that accepts an integer and outputs a string with: &#8220;Fizz&#8221; if it is divisible by 3, &#8220;Buzz&#8221; if it is divisible by 5, &#8220;FizzBuzz&#8221; if it is divisible by both, or the number if it is divisible by neither.</p></blockquote>
<p>(this is not a real question from our tech screening)</p>
<p>By the end of this post, we will take a random submission like this:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="text"><thead><tr><td colspan="2"  class="head">Text</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1">public static string FizzBuzz(int number){
&nbsp; &nbsp; if(number % 3 == 0 &amp;&amp; number % 5 == 0){
&nbsp; &nbsp; &nbsp; &nbsp; return &quot;FizzBuzz&quot;;
&nbsp; &nbsp; }
&nbsp; &nbsp; else if (number % 3 == 0){
&nbsp; &nbsp; &nbsp; &nbsp; return &quot;Fizz&quot;;
&nbsp; &nbsp; }
&nbsp; &nbsp; else if(number % 5 == 0){
&nbsp; &nbsp; &nbsp; &nbsp; return &quot;Buzz&quot;;
&nbsp; &nbsp; }
&nbsp; &nbsp; else{
&nbsp; &nbsp; &nbsp; &nbsp; return number.ToString();
&nbsp; &nbsp; }
}</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">public static string FizzBuzz(int number){
	if(number % 3 == 0 &amp;&amp; number % 5 == 0){
		return "FizzBuzz";
	}
	else if (number % 3 == 0){
		return "Fizz";
	}
	else if(number % 5 == 0){
		return "Buzz";
	}
	else{
		return number.ToString();
	}
}</pre></div></div>

<p>and automatically produce results like this:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="text"><thead><tr><td colspan="2"  class="head">Text</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1">Evaluated File: SamplePassSubmission.txt
Evaluation Time: 5/9/2015 12:54:41 PM
Final Result: 7/7 tests passed.
&nbsp;
Individual Results:
&nbsp; &nbsp; Pass&nbsp; &nbsp; - Standard number is returned as string
&nbsp; &nbsp; Pass&nbsp; &nbsp; - 3 is returned as 'Fizz'
&nbsp; &nbsp; Pass&nbsp; &nbsp; - 5 is returned as 'Buzz'
&nbsp; &nbsp; Pass&nbsp; &nbsp; - 15 is returned as 'FizzBuzz'
&nbsp; &nbsp; Pass&nbsp; &nbsp; - 9 is returned as 'Fizz'
&nbsp; &nbsp; Pass&nbsp; &nbsp; - 20 is returned as 'Buzz'
&nbsp; &nbsp; Pass&nbsp; &nbsp; - 30 is returned as 'FizzBuzz'
&nbsp;
...</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Evaluated File: SamplePassSubmission.txt
Evaluation Time: 5/9/2015 12:54:41 PM
Final Result: 7/7 tests passed.

Individual Results:
	Pass	- Standard number is returned as string
	Pass	- 3 is returned as 'Fizz'
	Pass	- 5 is returned as 'Buzz'
	Pass	- 15 is returned as 'FizzBuzz'
	Pass	- 9 is returned as 'Fizz'
	Pass	- 20 is returned as 'Buzz'
	Pass	- 30 is returned as 'FizzBuzz'

...</pre></div></div>

<h2>Background</h2>
<p>Lately we been doing a lot of screening and interviewing as we grow the development team at <a href="http://precisionlender.com/about-us/?utm_source=nav&#038;utm_medium=topnav&#038;utm_campaign=website#team">PrecisionLender</a>. Part of our interview process requires candidates to answer a technical screening questionaire with several C# and SQL exercises. Which means that another part of our process is for someone to evaluate those answers. I have a set of unit tests for all of the C# problems, but that doesn&#8217;t solve the part where we have to copy/paste into the tests, modify method names, tweak static/non-static, correct name collisions, etc. </p>
<p>CodeDOM has been on my list to play with for a while and seemed like the perfect answer.</p>
<p>The easy part turns out to be the compilation, which we can do like so:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="de1"><pre class="de1"><span class="co1">// assuming a variable with code in it named &quot;code&quot; and inputs as an object[] named inputParameters</span>
&nbsp;
<span class="co1">// 1</span>
<span class="kw1">var</span> parameters <span class="sy0">=</span> <span class="kw3">new</span> CompilerParameters<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
parameters<span class="sy0">.</span><span class="me1">ReferencedAssemblies</span><span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span><span class="st0">&quot;System.dll&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
parameters<span class="sy0">.</span><span class="me1">ReferencedAssemblies</span><span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span><span class="st0">&quot;System.Core.dll&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
parameters<span class="sy0">.</span><span class="me1">ReferencedAssemblies</span><span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span><span class="st0">&quot;System.Data.dll&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
parameters<span class="sy0">.</span><span class="me1">GenerateInMemory</span> <span class="sy0">=</span> <span class="kw1">true</span><span class="sy0">;</span>
&nbsp;
<span class="co1">// 2</span>
<span class="kw1">var</span> provider <span class="sy0">=</span> <span class="kw3">new</span> CSharpCodeProvider<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">var</span> results <span class="sy0">=</span> provider<span class="sy0">.</span><span class="me1">CompileAssemblyFromSource</span><span class="br0">&#40;</span>parameters, code<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span>results<span class="sy0">.</span><span class="me1">Errors</span><span class="sy0">.</span><span class="me1">HasErrors</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="co1">// do something meaningful + return</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">// 3</span>
<span class="kw1">var</span> assembly <span class="sy0">=</span> results<span class="sy0">.</span><span class="me1">CompiledAssembly</span><span class="sy0">;</span>
<span class="kw1">var</span> type <span class="sy0">=</span> assembly<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="st0">&quot;NamespaceName.ClassName&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">var</span> method <span class="sy0">=</span> type<span class="sy0">.</span><span class="me1">GetMethods</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">;</span>
<span class="kw1">var</span> testObject <span class="sy0">=</span> type<span class="sy0">.</span><span class="me1">GetConstructor</span><span class="br0">&#40;</span><span class="kw3">new</span> Type<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Invoke</span><span class="br0">&#40;</span><span class="kw1">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">var</span> output <span class="sy0">=</span> method<span class="sy0">.</span><span class="me1">Invoke</span><span class="br0">&#40;</span>testObject, inputParameters<span class="br0">&#41;</span><span class="sy0">;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">// assuming a variable with code in it named "code" and inputs as an object[] named inputParameters

// 1
var parameters = new CompilerParameters();
parameters.ReferencedAssemblies.Add("System.dll");
parameters.ReferencedAssemblies.Add("System.Core.dll");
parameters.ReferencedAssemblies.Add("System.Data.dll");
parameters.GenerateInMemory = true;

// 2
var provider = new CSharpCodeProvider();
var results = provider.CompileAssemblyFromSource(parameters, code);
if (results.Errors.HasErrors)
{
	// do something meaningful + return
}

// 3
var assembly = results.CompiledAssembly;
var type = assembly.GetType("NamespaceName.ClassName");
var method = type.GetMethods()[0];
var testObject = type.GetConstructor(new Type[] { }).Invoke(null);
var output = method.Invoke(testObject, inputParameters);</pre></div></div>

<p>In more detail:</p>
<ol>
<li>Define the <a href="https://msdn.microsoft.com/en-us/library/system.codedom.compiler.compilerparameters%28v=vs.110%29.aspx" title="See CompilerParameters on MSDN">compilation parameters</a>, including the referenced assemblies that are needed and that we want to compile the code in memory rather than generating an assembly.</li>
<li>Compile the code and verify it built without errors</li>
<li>Use reflection to get the object and method, instantiate the object, and invoke the method with the test inputs</li>
</ol>
<p>When we ask people to submit code exercise answers, there is no guarantee that it will or won&#8217;t have using statements, a namespace, a class name, or static keywords where I do or don&#8217;t expect them. Even if they are present, there is no guarantee they will have the naming I expect, such as the &#8220;namespaceName&#8221; and &#8220;ClassName&#8221; values I hardcoded above. </p>
<p>Also, ignore the fact that I grab the first method and assume it&#8217;s the one I want. This works often enough that I don&#8217;t mind rearranging a bit in the one or two exceptional cases.</p>
<h2>Normalizing the Code</h2>
<p>To test consistently and automatically, we need to solve the following problems:</p>
<ul>
<li>Remove the &#8220;static&#8221; keyword from the method we intend to execute</li>
<li>Add or rename the class name to an expected value</li>
<li>Add or rename the namespace name to an expected value</li>
<li>Add using statements if they are not present</li>
</ul>
<p>This expanded out into the following test cases (naming pattern: FunctionUnderTest_Scenario_ExpectedResult):<br />
<b><a href="https://github.com/tarwn/Blog_CodeDom/blob/master/EvaluateFizzBuzzTests/EvaluatorTests.cs" title="EvaluateFizzBuzzTests/EvaluatorTests.cs on github">EvaluatorTests.cs</a></b></p>
<ul>
<li>NormalizeCode_MethodWithNoNamespaceOrClass_IsWrappedInBoth</li>
<li>NormalizeCode_StaticClassWithNoNamespace_IsWrappedInNamespace</li>
<li>NormalizeCode_StaticClassWithNoNamespace_ClassIsRenamed</li>
<li>NormalizeCode_ClassWithNoNamespace_IsWrappedInNamespace</li>
<li>NormalizeCode_ClassWithNoNamespace_ClassIsRenamed</li>
<li>NormalizeCode_NamespacedCode_AddsUsingStatements</li>
<li>NormalizeCode_NamespacedCode_RenamesNamespace</li>
<li>NormalizeCode_RunOnCodeLine_ReplacesOriginalClassAndNamespace</li>
<li>NormalizeCode_TwoClasses_OnlyFirstClassIsRenamed</li>
<li>NormalizeCode_StaticMethod_IsConvertedToInstance</li>
<li>NormalizeCode_MultipleStaticMethods_AllAreConvertedToInstance</li>
</ul>
<p>Breaking this down into pieces:<br />
(full function at <a href="https://github.com/tarwn/Blog_CodeDom/blob/master/EvaluateFizzBuzz/Evaluation/Evaluator.cs" title="EvaluateFizzBuzz/Evaluation/Evaluator.cs, Line 34on github">EvaluateFizzBuzz/Evaluation/Evaluator.cs &#8211; NormalizeCode()</a>)</p>
<p>We need to ensure the first method is an instance method rather than static:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="co1">// instance-ize functions</span>
<span class="kw1">var</span> methodnameRegex <span class="sy0">=</span> <span class="kw3">new</span> Regex<span class="br0">&#40;</span><span class="st0">&quot;(public|private) static (?!class)([^{]+)+{&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span>methodnameRegex<span class="sy0">.</span><span class="me1">IsMatch</span><span class="br0">&#40;</span>normalizedSource<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; normalizedSource <span class="sy0">=</span> methodnameRegex<span class="sy0">.</span><span class="me1">Replace</span><span class="br0">&#40;</span>normalizedSource, <span class="st0">&quot;$1 $2<span class="es0">\n</span>{&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">// instance-ize functions
var methodnameRegex = new Regex("(public|private) static (?!class)([^{]+)+{");
if (methodnameRegex.IsMatch(normalizedSource))
{
	normalizedSource = methodnameRegex.Replace(normalizedSource, "$1 $2\n{");
}</pre></div></div>

<p>Add or Normalize the class name to an expected value (IntendedClassName):</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="de1"><pre class="de1"><span class="co1">// normalize class name</span>
<span class="kw1">var</span> classnameRegex <span class="sy0">=</span> <span class="kw3">new</span> Regex<span class="br0">&#40;</span><span class="st0">&quot;(public|private) (static )?class [^{]+{&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span>classnameRegex<span class="sy0">.</span><span class="me1">IsMatch</span><span class="br0">&#40;</span>normalizedSource<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; normalizedSource <span class="sy0">=</span> classnameRegex<span class="sy0">.</span><span class="me1">Replace</span><span class="br0">&#40;</span>normalizedSource, <span class="st0">&quot;public class &quot;</span> <span class="sy0">+</span> IntendedClassName <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\r</span><span class="es0">\n</span>{&quot;</span>, <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="kw1">else</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; normalizedSource <span class="sy0">=</span> <span class="kw4">String</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span><span class="st0">&quot;public class {0}<span class="es0">\r</span><span class="es0">\n</span>{{<span class="es0">\r</span><span class="es0">\n</span>{1}<span class="es0">\r</span><span class="es0">\n</span><span class="es0">\r</span><span class="es0">\n</span>}}&quot;</span>, IntendedClassName, normalizedSource<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">// normalize class name
var classnameRegex = new Regex("(public|private) (static )?class [^{]+{");
if (classnameRegex.IsMatch(normalizedSource))
{
	normalizedSource = classnameRegex.Replace(normalizedSource, "public class " + IntendedClassName + "\r\n{", 1);
}
else
{
	normalizedSource = String.Format("public class {0}\r\n{{\r\n{1}\r\n\r\n}}", IntendedClassName, normalizedSource);
}</pre></div></div>

<p>Add or Normalize the namespace name to an expected value (IntendedNamespace)</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="de1"><pre class="de1"><span class="co1">// normalize namespace</span>
<span class="kw1">var</span> namespaceRegex <span class="sy0">=</span> <span class="kw3">new</span> Regex<span class="br0">&#40;</span><span class="st0">&quot;namespace [^<span class="es0">\\</span>n{ ]+[^{]+{&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">if</span> <span class="br0">&#40;</span>namespaceRegex<span class="sy0">.</span><span class="me1">IsMatch</span><span class="br0">&#40;</span>normalizedSource<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; normalizedSource <span class="sy0">=</span> namespaceRegex<span class="sy0">.</span><span class="me1">Replace</span><span class="br0">&#40;</span>normalizedSource, <span class="st0">&quot;namespace &quot;</span> <span class="sy0">+</span> IntendedNamespace <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\r</span><span class="es0">\n</span>{&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="kw1">else</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; normalizedSource <span class="sy0">=</span> <span class="kw4">String</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span><span class="st0">&quot;{0}<span class="es0">\r</span><span class="es0">\n</span><span class="es0">\n</span>namespace {1}<span class="es0">\r</span><span class="es0">\n</span>{{<span class="es0">\r</span><span class="es0">\n</span>{2}<span class="es0">\r</span><span class="es0">\n</span>}}&quot;</span>, USING_STATEMENTS, IntendedNamespace, normalizedSource<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">// normalize namespace
var namespaceRegex = new Regex("namespace [^\\n{ ]+[^{]+{");
if (namespaceRegex.IsMatch(normalizedSource))
{
	normalizedSource = namespaceRegex.Replace(normalizedSource, "namespace " + IntendedNamespace + "\r\n{");
}
else
{
	normalizedSource = String.Format("{0}\r\n\nnamespace {1}\r\n{{\r\n{2}\r\n}}", USING_STATEMENTS, IntendedNamespace, normalizedSource);
}</pre></div></div>

<p>And then add a standard set of using statements (USING_STATEMENTS constant) if they aren&#8217;t present yet:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="co1">// add using statements if not present</span>
<span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>normalizedSource<span class="sy0">.</span><span class="me1">Contains</span><span class="br0">&#40;</span><span class="st0">&quot;using System&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
normalizedSource <span class="sy0">=</span> USING_STATEMENTS <span class="sy0">+</span> <span class="st0">&quot;<span class="es0">\r</span><span class="es0">\n</span>&quot;</span> <span class="sy0">+</span> normalizedSource<span class="sy0">;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">// add using statements if not present
if (!normalizedSource.Contains("using System"))
{
normalizedSource = USING_STATEMENTS + "\r\n" + normalizedSource;
}</pre></div></div>

<p>This will convert a file like the <a href="https://github.com/tarwn/Blog_CodeDom/blob/master/EvaluateFizzBuzz/SampleFile/SamplePassSubmission.txt" title="EvaluateFizzBuzz/SampleFile/SamplePassSubmission.txt"> sample &#8220;Pass&#8221; submission file</a> like so:</p>
<p>Before:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1"><span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">string</span> FizzBuzz<span class="br0">&#40;</span><span class="kw4">int</span> number<span class="br0">&#41;</span><span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="kw1">if</span><span class="br0">&#40;</span>number <span class="sy0">%</span> <span class="nu0">3</span> <span class="sy0">==</span> <span class="nu0">0</span> <span class="sy0">&amp;&amp;</span> number <span class="sy0">%</span> <span class="nu0">5</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">&quot;FizzBuzz&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>number <span class="sy0">%</span> <span class="nu0">3</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">&quot;Fizz&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw1">else</span> <span class="kw1">if</span><span class="br0">&#40;</span>number <span class="sy0">%</span> <span class="nu0">5</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">&quot;Buzz&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw1">else</span><span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> number<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">public static string FizzBuzz(int number){
	if(number % 3 == 0 &amp;&amp; number % 5 == 0){
		return "FizzBuzz";
	}
	else if (number % 3 == 0){
		return "Fizz";
	}
	else if(number % 5 == 0){
		return "Buzz";
	}
	else{
		return number.ToString();
	}
}</pre></div></div>

<p>After:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="de1"><pre class="de1"><span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Collections.Generic</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Linq</span><span class="sy0">;</span>
&nbsp;
&nbsp;
<span class="kw1">namespace</span> FizzBuzzSample
<span class="br0">&#123;</span>
<span class="kw1">public</span> <span class="kw4">class</span> FizzBuzzClass
<span class="br0">&#123;</span>
&nbsp;
&nbsp;
<span class="kw1">public</span> <span class="kw4">string</span> FizzBuzz<span class="br0">&#40;</span><span class="kw4">int</span> number<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="kw1">if</span><span class="br0">&#40;</span>number <span class="sy0">%</span> <span class="nu0">3</span> <span class="sy0">==</span> <span class="nu0">0</span> <span class="sy0">&amp;&amp;</span> number <span class="sy0">%</span> <span class="nu0">5</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">&quot;FizzBuzz&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw1">else</span> <span class="kw1">if</span> <span class="br0">&#40;</span>number <span class="sy0">%</span> <span class="nu0">3</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">&quot;Fizz&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw1">else</span> <span class="kw1">if</span><span class="br0">&#40;</span>number <span class="sy0">%</span> <span class="nu0">5</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="st0">&quot;Buzz&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw1">else</span><span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> number<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">using System;
using System.Collections.Generic;
using System.Linq;


namespace FizzBuzzSample
{
public class FizzBuzzClass
{


public string FizzBuzz(int number)
{
	if(number % 3 == 0 &amp;&amp; number % 5 == 0){
		return "FizzBuzz";
	}
	else if (number % 3 == 0){
		return "Fizz";
	}
	else if(number % 5 == 0){
		return "Buzz";
	}
	else{
		return number.ToString();
	}
}

}
}</pre></div></div>

<p>So now we have consistent code, next up is evaluating the results.</p>
<h2>Compiling and Evaluating Output</h2>
<p>Earlier in the post I showed example code to compile and run some code. Now that we have normalized code, we know exactly what namespace and class name to expect and can run it through that code and, finally, evaluate the output.</p>
<p>The Evaluator requires not just an IntendedNamespace and IntendedClassname, but also the list of TestDefinitions it will evaluate against:<br />
<b><a href="" title="EvaluateFizzBuzz/Evaluation/TestDefinition.cs on github">EvaluateFizzBuzz/Evaluation/TestDefinition.cs</a></b></p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1">&nbsp;<span class="kw1">public</span> <span class="kw4">class</span> TestDefinition
<span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="sy0">...</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">public</span> TestDefinition<span class="br0">&#40;</span><span class="kw4">string</span> name, <span class="kw4">object</span><span class="br0">&#91;</span><span class="br0">&#93;</span> inputParameters, <span class="kw4">object</span> expectedOutput<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Name <span class="sy0">=</span> name<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InputParameters <span class="sy0">=</span> inputParameters<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DescriptionOfExpectation <span class="sy0">=</span> <span class="kw4">String</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span>expectedOutput<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EvaluateResult <span class="sy0">=</span> <span class="br0">&#40;</span>o<span class="br0">&#41;</span> <span class="sy0">=&gt;</span> <span class="kw3">new</span> LocalEvaluationResult<span class="br0">&#40;</span>expectedOutput<span class="sy0">.</span><span class="me1">Equals</span><span class="br0">&#40;</span>o<span class="br0">&#41;</span>, o <span class="sy0">!=</span> <span class="kw1">null</span> <span class="sy0">?</span> o<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">:</span> <span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp;
&nbsp; &nbsp; <span class="sy0">...</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse"> public class TestDefinition
{
	...

        public TestDefinition(string name, object[] inputParameters, object expectedOutput)
        {
            Name = name;
            InputParameters = inputParameters;
            DescriptionOfExpectation = String.Format(expectedOutput.ToString());
            EvaluateResult = (o) =&gt; new LocalEvaluationResult(expectedOutput.Equals(o), o != null ? o.ToString() : "");
        }

	...
}</pre></div></div>

<p>Here are the TestDefinitions we will evaluate against for the sample problem:<br />
<b><a href="https://github.com/tarwn/Blog_CodeDom/blob/master/EvaluateFizzBuzz/Program.cs" title="EvaluateFizzBuzz/Program.cs on github">EvaluateFizzBuzz/Program.cs</a></b></p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1"><span class="kw3">new</span> List<span class="sy0">&lt;</span>TestDefinition<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="kw3">new</span> TestDefinition<span class="br0">&#40;</span><span class="st0">&quot;Standard number is returned as string&quot;</span>, <span class="kw3">new</span> <span class="kw4">object</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span> <span class="nu0">1</span> <span class="br0">&#125;</span>, <span class="st0">&quot;1&quot;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="kw3">new</span> TestDefinition<span class="br0">&#40;</span><span class="st0">&quot;3 is returned as 'Fizz'&quot;</span>, <span class="kw3">new</span> <span class="kw4">object</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span> <span class="nu0">3</span> <span class="br0">&#125;</span>, <span class="st0">&quot;Fizz&quot;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="kw3">new</span> TestDefinition<span class="br0">&#40;</span><span class="st0">&quot;5 is returned as 'Buzz'&quot;</span>, <span class="kw3">new</span> <span class="kw4">object</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span> <span class="nu0">5</span> <span class="br0">&#125;</span>, <span class="st0">&quot;Buzz&quot;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="kw3">new</span> TestDefinition<span class="br0">&#40;</span><span class="st0">&quot;15 is returned as 'FizzBuzz'&quot;</span>, <span class="kw3">new</span> <span class="kw4">object</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span> <span class="nu0">15</span> <span class="br0">&#125;</span>,<span class="st0">&quot;FizzBuzz&quot;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="kw3">new</span> TestDefinition<span class="br0">&#40;</span><span class="st0">&quot;9 is returned as 'Fizz'&quot;</span>, <span class="kw3">new</span> <span class="kw4">object</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span> <span class="nu0">9</span> <span class="br0">&#125;</span>, <span class="st0">&quot;Fizz&quot;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="kw3">new</span> TestDefinition<span class="br0">&#40;</span><span class="st0">&quot;20 is returned as 'Buzz'&quot;</span>, <span class="kw3">new</span> <span class="kw4">object</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span> <span class="nu0">20</span> <span class="br0">&#125;</span>, <span class="st0">&quot;Buzz&quot;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="kw3">new</span> TestDefinition<span class="br0">&#40;</span><span class="st0">&quot;30 is returned as 'FizzBuzz'&quot;</span>, <span class="kw3">new</span> <span class="kw4">object</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#123;</span> <span class="nu0">30</span> <span class="br0">&#125;</span>, <span class="st0">&quot;FizzBuzz&quot;</span><span class="br0">&#41;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">new List&lt;TestDefinition&gt;(){
	new TestDefinition("Standard number is returned as string", new object[]{ 1 }, "1"),
	new TestDefinition("3 is returned as 'Fizz'", new object[]{ 3 }, "Fizz"),
	new TestDefinition("5 is returned as 'Buzz'", new object[]{ 5 }, "Buzz"),
	new TestDefinition("15 is returned as 'FizzBuzz'", new object[]{ 15 },"FizzBuzz"),
	new TestDefinition("9 is returned as 'Fizz'", new object[]{ 9 }, "Fizz"),
	new TestDefinition("20 is returned as 'Buzz'", new object[]{ 20 }, "Buzz"),
	new TestDefinition("30 is returned as 'FizzBuzz'", new object[]{ 30 }, "FizzBuzz")
}</pre></div></div>

<p>Now we can expand the compilation code above to compile and then invoke and evaluate against each of these TestDefinitions:<br />
<b><a href="https://github.com/tarwn/Blog_CodeDom/blob/master/EvaluateFizzBuzz/Evaluation/Evaluator.cs" title="EvaluateFizzBuzz/Evaluation/Evaluator.cs on github">EvaluateFizzBuzz/Evaluation/Evaluator.cs</a></b></p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="de1"><pre class="de1"><span class="kw1">var</span> parameters <span class="sy0">=</span> <span class="kw3">new</span> CompilerParameters<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">// ... set up parameters ...</span>
&nbsp;
<span class="kw1">var</span> provider <span class="sy0">=</span> <span class="kw3">new</span> CSharpCodeProvider<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">var</span> results <span class="sy0">=</span> provider<span class="sy0">.</span><span class="me1">CompileAssemblyFromSource</span><span class="br0">&#40;</span>parameters, code<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">if</span> <span class="br0">&#40;</span>results<span class="sy0">.</span><span class="me1">Errors</span><span class="sy0">.</span><span class="me1">HasErrors</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="co1">// ... compile list of errors and return</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">var</span> assembly <span class="sy0">=</span> results<span class="sy0">.</span><span class="me1">CompiledAssembly</span><span class="sy0">;</span>
<span class="kw1">var</span> type <span class="sy0">=</span> assembly<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span>IntendedNamespace <span class="sy0">+</span> <span class="st0">&quot;.&quot;</span> <span class="sy0">+</span> IntendedClassName<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">var</span> method <span class="sy0">=</span> type<span class="sy0">.</span><span class="me1">GetMethods</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">var</span> result <span class="sy0">=</span> <span class="kw3">new</span> EvaluationResult<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw1">foreach</span> <span class="br0">&#40;</span><span class="kw1">var</span> test <span class="kw1">in</span> Tests<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="kw1">var</span> testObject <span class="sy0">=</span> type<span class="sy0">.</span><span class="me1">GetConstructor</span><span class="br0">&#40;</span><span class="kw3">new</span> Type<span class="br0">&#91;</span><span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="br0">&#125;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Invoke</span><span class="br0">&#40;</span><span class="kw1">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="kw1">try</span>
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// ...</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">var</span> output <span class="sy0">=</span> method<span class="sy0">.</span><span class="me1">Invoke</span><span class="br0">&#40;</span>testObject, test<span class="sy0">.</span><span class="me1">InputParameters</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">var</span> evalResult <span class="sy0">=</span> test<span class="sy0">.</span><span class="me1">EvaluateResult</span><span class="br0">&#40;</span>output<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>evalResult<span class="sy0">.</span><span class="me1">IsPass</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result<span class="sy0">.</span><span class="me1">Tests</span><span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span><span class="coMULTI">/* ... pass information ... */</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">else</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result<span class="sy0">.</span><span class="me1">Tests</span><span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span><span class="coMULTI">/* ... fail information ... */</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw1">catch</span> <span class="br0">&#40;</span>TargetInvocationException exc<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; result<span class="sy0">.</span><span class="me1">Tests</span><span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span><span class="coMULTI">/* ... error information ... */</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="kw1">finally</span>
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// ...</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
result<span class="sy0">.</span><span class="me1">Summary</span> <span class="sy0">=</span> <span class="kw4">String</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span><span class="st0">&quot;{0}/{1} tests passed.&quot;</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result<span class="sy0">.</span><span class="me1">Tests</span><span class="sy0">.</span><span class="kw1">Where</span><span class="br0">&#40;</span>t <span class="sy0">=&gt;</span> t<span class="sy0">.</span><span class="me1">IsPass</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Count</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result<span class="sy0">.</span><span class="me1">Tests</span><span class="sy0">.</span><span class="me1">Count</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="co1">// ...</span>
&nbsp;
<span class="kw1">return</span> result<span class="sy0">;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">var parameters = new CompilerParameters();
// ... set up parameters ...

var provider = new CSharpCodeProvider();
var results = provider.CompileAssemblyFromSource(parameters, code);

if (results.Errors.HasErrors)
{
	// ... compile list of errors and return
}

var assembly = results.CompiledAssembly;
var type = assembly.GetType(IntendedNamespace + "." + IntendedClassName);
var method = type.GetMethods()[0];

var result = new EvaluationResult();
foreach (var test in Tests)
{
	var testObject = type.GetConstructor(new Type[] { }).Invoke(null);
	try
	{
		// ...

		var output = method.Invoke(testObject, test.InputParameters);
		var evalResult = test.EvaluateResult(output);

		if (evalResult.IsPass)
		{
			result.Tests.Add(/* ... pass information ... */);
		}
		else
		{
			result.Tests.Add(/* ... fail information ... */);
		}
	}
	catch (TargetInvocationException exc)
	{
		result.Tests.Add(/* ... error information ... */);
	}
	finally
	{
	    // ...
	}
}

result.Summary = String.Format("{0}/{1} tests passed.",
			    result.Tests.Where(t =&gt; t.IsPass).Count(),
			    result.Tests.Count);
// ...

return result;</pre></div></div>

<p>And there we have it, we start with one randomly submitted code file and end with the results of automated evaluation.</p>
<h2>But What About&#8230;?</h2>
<p>This is only one small part of our interview process and, before anyone brings it up, we do also evaluate for things the computer can&#8217;t, such as readability of the code. While I have considered some options like incorporating NDepend evaluation, we&#8217;ll likely never be able to completely automate this. That being said, having this portion automated does reduce the amount of manual evaluation we do, so overall we still save quite a bit of effort. </p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/uncategorized/running-nunit-tests-from-your-code/'>Running Nunit tests from your code</a><p>How to run tests in your VB.Net script, and if you ask nicely I'm sure&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/desktopdev/mstech/phone-number-primitive/'>Phone Number Primitive</a><p>I don't know how many times I've put together the same slow regexp to check&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2><img class="bioPic" src="http://www.tiernok.com/images/RedShirt_80.jpg" alt="User bio image"/>My roles have included accidental DBA, lone developer, systems architect, team lead, VP of Engineering, and general troublemaker. On the technical front I work in web development, distributed systems, test automation, and devop-sy areas like delivery pipelines and integration of all the auditable things. <br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/tarwn" title="tarwn at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.linkedin.com/in/eliweinstockherman" title="tarwn at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://tiernok.com/" title="tarwn at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="https://plus.google.com/114520820167873768473" title="tarwn at Google Plus" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_gplus.png" alt="Google Plus" /></a><a href="/index.php/author/tarwn/feed/" title="Blog RSS feed for tarwn" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 3,919 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/tarwn/">Read More Posts by Eli Weinstock-Herman (tarwn)</a>
						</div>
					</div>
					<div>
						<label>Tags:</label> <a href="/index.php/tag/codedom/" rel="tag">CodeDom</a>, <a href="/index.php/tag/reflection/" rel="tag">reflection</a> 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&text=RT @LessThanDot Blog - Using CodeDOM to Automate Technical Screening Evaluation by @tarwn" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&title=Using CodeDOM to Automate Technical Screening Evaluation&source=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&title=Using CodeDOM to Automate Technical Screening Evaluation" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&quote=Using CodeDOM to Automate Technical Screening Evaluation" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/&title=Using CodeDOM to Automate Technical Screening Evaluation" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		No comments posted so far	</h4>
					<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/itprofessionals/using-codedom-to-automate-technical-screening-evaluation/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='3353' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="2a084e55c87b1ebcdaad1f62fdbbac8e"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765901"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
