<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   The Ten Most Asked SQL Server Questions And Their Answers</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   The Ten Most Asked SQL Server Questions And Their Answers" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="If you are active in the SQL Server newsgroups and forums as I am, you will notice that the same questions keep popping up all the time. I picked ten of them which I see daily. Since this became a pretty long blogpost I have linked all the questions bel&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<link rel="canonical" href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/" />	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; The Ten Most Asked SQL Server Questions And Their Answers Comments Feed" href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='An ego will only hurt you: Toughest Challenges' href='/index.php/itprofessionals/ethicsit/an-ego-will-only-hurt-you-toughest-chall/' />
<link rel='next' title='Visual Studio 2005 error &#8211; &#8220;Project type is not supported by this installation&#8221;' href='/index.php/webdev/serverprogramming/aspnet/visual-studio-2005-error-project-type-is/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/" />
<link rel='shortlink' href='/?p=241' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fthe-ten-most-asked-sql-server-questions-1%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fthe-ten-most-asked-sql-server-questions-1%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/webdev/serverprogramming/aspnet/visual-studio-2005-error-project-type-is/" rel="next">Visual Studio 2005 error &#8211; &#8220;Project type is not supported by this installation&#8221;</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/itprofessionals/ethicsit/an-ego-will-only-hurt-you-toughest-chall/" rel="prev">An ego will only hurt you: Toughest Challenges</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/" class="post-title">The Ten Most Asked SQL Server Questions And Their Answers</a></h1>
					<div class="post-byline">by <a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis" rel="author">SQLDenis</a> on December 10, 2008 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a>. Article views: 130,156 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&text=RT @LessThanDot Blog - The Ten Most Asked SQL Server Questions And Their Answers by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&title=The Ten Most Asked SQL Server Questions And Their Answers&source=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&title=The Ten Most Asked SQL Server Questions And Their Answers" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&quote=The Ten Most Asked SQL Server Questions And Their Answers" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&title=The Ten Most Asked SQL Server Questions And Their Answers" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>If you are active in the SQL Server newsgroups and forums as I am, you will notice that the same questions keep popping up all the time. I picked ten of them which I see daily. Since this became a pretty long blogpost I have linked all the questions below to jump to the question itself.</p>
<p>1) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#1">Selecting all the values from a table for a particular date</a><br />
2) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#2">Search all columns in all the tables in a database for a specific value</a><br />
3) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#3">Splitting string values</a><br />
4) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#4">Select all rows from one table that don&#8217;t exist in another table</a><br />
5) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#5">Getting all rows from one table and only the latest from the child table</a><br />
6) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#6">Getting all characters until a specific character</a><br />
7) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#7">Return all rows with NULL values in a column</a><br />
8) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#8">Row values to column (PIVOT)</a><br />
9) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#9">Pad or remove leading zeroes from numbers</a><br />
10) <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1#10">Concatenate Values From Multiple Rows Into One Column</a></p>
<h2 id="1">1 Selecting all the values from a table for a particular date</h2>
<p>This is a very popular question and people sometimes answer that you need to use between. There is a problem with between if you happen to have a value at exactly midnight. Let us take a look, first create this table.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> SomeDates <span class="br0">&#40;</span>DateColumn <span class="kw1">DATETIME</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE SomeDates (DateColumn DATETIME)</pre></div></div>

<p>Insert 2 values</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-02 00:00:00.000'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-01 00:00:00.000'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">INSERT INTO SomeDates VALUES('2008-10-02 00:00:00.000')
INSERT INTO SomeDates VALUES('2008-10-01 00:00:00.000')</pre></div></div>

<p>Return everything between &#8216;2008-10-01&#8217; and &#8216;2008-10-02&#8217;</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span>
<span class="kw1">FROM</span> SomeDates
<span class="kw1">WHERE</span> DateColumn <span class="sy0">BETWEEN</span> <span class="st0">'20081001'</span> <span class="sy0">AND</span> <span class="st0">'20081002'</span>
<span class="kw1">ORDER</span> <span class="kw1">BY</span> DateColumn</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT *
FROM SomeDates
WHERE DateColumn BETWEEN '20081001' AND '20081002'
ORDER BY DateColumn</pre></div></div>

<p>This works without a problem, we get this returned</p>
<p>(results)<br />
2008-10-01 00:00:00.000<br />
2008-10-02 00:00:00.000</p>
<p>Let&#8217;s add some more dates including the time portion</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-02 00:01:00.000'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-02 00:00:59.000'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-02 00:00:01.000'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-01 00:01:00.000'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-01 00:12:00.000'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-01 23:00:00.000'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">INSERT INTO SomeDates VALUES('2008-10-02 00:01:00.000')
INSERT INTO SomeDates VALUES('2008-10-02 00:00:59.000')
INSERT INTO SomeDates VALUES('2008-10-02 00:00:01.000')
INSERT INTO SomeDates VALUES('2008-10-01 00:01:00.000')
INSERT INTO SomeDates VALUES('2008-10-01 00:12:00.000')
INSERT INTO SomeDates VALUES('2008-10-01 23:00:00.000')</pre></div></div>

<p>Return everything between &#8216;2008-10-01&#8217; and &#8216;2008-10-02&#8217;</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span>
<span class="kw1">FROM</span> SomeDates
<span class="kw1">WHERE</span> DateColumn <span class="sy0">BETWEEN</span> <span class="st0">'20081001'</span> <span class="sy0">AND</span> <span class="st0">'20081002'</span>
<span class="kw1">ORDER</span> <span class="kw1">BY</span> DateColumn</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT *
FROM SomeDates
WHERE DateColumn BETWEEN '20081001' AND '20081002'
ORDER BY DateColumn</pre></div></div>

<p>(results)<br />
2008-10-01 00:00:00.000<br />
2008-10-01 00:01:00.000<br />
2008-10-01 00:12:00.000<br />
2008-10-01 23:00:00.000<br />
2008-10-02 00:00:00.000</p>
<p>Here is where it goes wrong; for 2008-10-02 only the midnight value is returned the other ones are ignored</p>
<p>Now if we change 2008-10-02 to 2008-10-03 we get what we want</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span>
<span class="kw1">FROM</span> SomeDates
<span class="kw1">WHERE</span> DateColumn <span class="sy0">BETWEEN</span> <span class="st0">'20081001'</span> <span class="sy0">AND</span> <span class="st0">'20081003'</span>
<span class="kw1">ORDER</span> <span class="kw1">BY</span> DateColumn</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT *
FROM SomeDates
WHERE DateColumn BETWEEN '20081001' AND '20081003'
ORDER BY DateColumn</pre></div></div>

<p>(results)<br />
2008-10-01 00:00:00.000<br />
2008-10-01 00:01:00.000<br />
2008-10-01 00:12:00.000<br />
2008-10-01 23:00:00.000<br />
2008-10-02 00:00:00.000<br />
2008-10-02 00:00:01.000<br />
2008-10-02 00:00:59.000<br />
2008-10-02 00:01:00.000</p>
<p>Now insert a value for 2008-10-03 (midnight)</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">INSERT</span> <span class="kw1">INTO</span> SomeDates <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'2008-10-03 00:00:00.000'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">INSERT INTO SomeDates VALUES('2008-10-03 00:00:00.000')</pre></div></div>

<p>Run the query again</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span>
<span class="kw1">FROM</span> SomeDates
<span class="kw1">WHERE</span> DateColumn <span class="sy0">BETWEEN</span> <span class="st0">'20081001'</span> <span class="sy0">AND</span> <span class="st0">'20081003'</span>
<span class="kw1">ORDER</span> <span class="kw1">BY</span> DateColumn</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT *
FROM SomeDates
WHERE DateColumn BETWEEN '20081001' AND '20081003'
ORDER BY DateColumn</pre></div></div>

<p>(results)<br />
2008-10-01 00:00:00.000<br />
2008-10-01 00:01:00.000<br />
2008-10-01 00:12:00.000<br />
2008-10-01 23:00:00.000<br />
2008-10-02 00:00:00.000<br />
2008-10-02 00:00:01.000<br />
2008-10-02 00:00:59.000<br />
2008-10-02 00:01:00.000<br />
2008-10-03 00:00:00.000</p>
<p>We get back 2008-10-03 00:00:00.000, between will return the date if it is exactly midnight</p>
<p>If you use &gt;= and &lt; then you get exactly what you need </p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span>
<span class="kw1">FROM</span> SomeDates
<span class="kw1">WHERE</span> DateColumn <span class="sy0">&gt;=</span> <span class="st0">'20081001'</span> <span class="sy0">AND</span> DateColumn <span class="sy0">&lt;</span> <span class="st0">'20081003'</span>
<span class="kw1">ORDER</span> <span class="kw1">BY</span> DateColumn</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT *
FROM SomeDates
WHERE DateColumn &gt;= '20081001' AND DateColumn &lt; '20081003'
ORDER BY DateColumn</pre></div></div>

<p>(results)<br />
2008-10-01 00:00:00.000<br />
2008-10-01 00:01:00.000<br />
2008-10-01 00:12:00.000<br />
2008-10-01 23:00:00.000<br />
2008-10-02 00:00:00.000<br />
2008-10-02 00:00:01.000<br />
2008-10-02 00:00:59.000<br />
2008-10-02 00:01:00.000</p>
<p>So be careful when using between because you might get back rows that you did not expect to get back and it might mess up your reporting if you do counts or sums</p>
<p><strong>Bonus: how to strip the time off a date?</strong></p>
<p>To strip the time portion of a datetime, you can do this and still return a datetime</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">Select</span> <span class="sy0">*</span> ,<span class="kw2">DATEADD</span><span class="br0">&#40;</span>dd, <span class="kw2">DATEDIFF</span><span class="br0">&#40;</span>dd, <span class="nu0">0</span>, DateColumn<span class="br0">&#41;</span>, <span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">as</span> stripped
<span class="kw1">from</span> SomeDates </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Select * ,DATEADD(dd, DATEDIFF(dd, 0, DateColumn), 0) as stripped
from SomeDates </pre></div></div>

<p>you can also do a convert to varchar with a style value of 112 and then converting back to datetime</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">Select</span> <span class="sy0">*</span> ,<span class="kw1">convert</span><span class="br0">&#40;</span><span class="kw1">datetime</span>,<span class="kw1">Convert</span><span class="br0">&#40;</span><span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8</span><span class="br0">&#41;</span>,DateColumn,<span class="nu0">112</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">as</span> stripped
<span class="kw1">from</span> SomeDates </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Select * ,convert(datetime,Convert(varchar(8),DateColumn,112)) as stripped
from SomeDates </pre></div></div>

<p>Both methods return this<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;</p>
<pre>DateColumn              stripped
2008-10-02 00:00:00.000	2008-10-02 00:00:00.000
2008-10-01 00:00:00.000	2008-10-01 00:00:00.000
2008-10-02 00:01:00.000	2008-10-02 00:00:00.000
2008-10-02 00:00:59.000	2008-10-02 00:00:00.000
2008-10-02 00:00:01.000	2008-10-02 00:00:00.000
2008-10-01 00:01:00.000	2008-10-01 00:00:00.000
2008-10-01 00:12:00.000	2008-10-01 00:00:00.000
2008-10-01 23:00:00.000	2008-10-01 00:00:00.000
2008-10-03 00:00:00.000	2008-10-03 00:00:00.000</pre>
<h2 id="2">2 Search all columns in all the tables in a database for a specific value</h2>
<p>How can I search all the columns in every table in my database for a specific value?<br />
This question keeps popping up all the time. Here is a variation of this question discussed <a href="http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/190a0d12-840f-4ecb-8d32-b436743fdf4e">MSDN Forum T-SQL</a>. Unfortunately there is no easy way to do this, you have to loop over all the tables in the database and search for the value.<br />
As you can imagine if you have a huge database with a lot of tables this can take a really long time.<br />
There are a couple of checks going on in this proc, if the data is not numeric then we skip all the numeric columns and do not search those columns. This code was created by our own gmmastros and what he did was create 3 different stored procedures, one for dates, numbers and strings. Then he created a 4th stored proc named FindMyData, this proc will only call the appropriate child procs if the datatype is right.<br />
We only list the table name and the column name where the value is stored, we do not return that data!<br />
First create the following 3 stored procedures</p>
<p>Just the date searching proc</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> FindMyData_Date
&nbsp; &nbsp; @DataToFind <span class="kw1">DATETIME</span>
<span class="kw1">AS</span>
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">ON</span>
&nbsp;
<span class="kw1">DECLARE</span> @Temp <span class="kw1">TABLE</span><span class="br0">&#40;</span>RowId <span class="kw1">INT</span> <span class="kw1">IDENTITY</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span>, SchemaName sysname, TableName sysname, ColumnName SysName, DataType <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, DataFound <span class="kw1">BIT</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">DECLARE</span> @<span class="kw2">ISDATE</span> <span class="kw1">BIT</span>
&nbsp;
&nbsp;
&nbsp;
&nbsp; &nbsp; <span class="kw1">INSERT</span> &nbsp;<span class="kw1">INTO</span> @Temp<span class="br0">&#40;</span>TableName,SchemaName, ColumnName, DataType<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> &nbsp;C.<span class="me1">Table_Name</span>,C.<span class="me1">TABLE_SCHEMA</span>, C.<span class="me1">Column_Name</span>, C.<span class="me1">Data_Type</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> &nbsp; &nbsp;Information_Schema.<span class="me1">Columns</span> <span class="kw1">AS</span> C
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">INNER</span> Join Information_Schema.<span class="me1">Tables</span> <span class="kw1">AS</span> T
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ON</span> C.<span class="me1">Table_Name</span> <span class="sy0">=</span> T.<span class="me1">Table_Name</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> C.<span class="me1">TABLE_SCHEMA</span> <span class="sy0">=</span> T.<span class="me1">TABLE_SCHEMA</span>
&nbsp; &nbsp; <span class="kw1">WHERE</span> &nbsp; Table_Type <span class="sy0">=</span> <span class="st0">'Base Table'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; And <span class="br0">&#40;</span>Data_Type <span class="sy0">=</span> <span class="st0">'DateTime'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Or <span class="br0">&#40;</span>Data_Type <span class="sy0">=</span> <span class="st0">'SmallDateTime'</span> And @DataToFind <span class="sy0">&gt;=</span> <span class="st0">'19000101'</span> And @DataToFind <span class="sy0">&lt;</span> <span class="st0">'20790607'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">DECLARE</span> @i <span class="kw1">INT</span>
<span class="kw1">DECLARE</span> @<span class="kw2">MAX</span> <span class="kw1">INT</span>
<span class="kw1">DECLARE</span> @TableName sysname
<span class="kw1">DECLARE</span> @ColumnName sysname
<span class="kw1">DECLARE</span> @SchemaName sysname
<span class="kw1">DECLARE</span> @<span class="kw1">SQL</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @<span class="kw1">PARAMETERS</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @DataExists <span class="kw1">BIT</span>
<span class="kw1">DECLARE</span> @SQLTemplate <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">SELECT</span> &nbsp;@SQLTemplate <span class="sy0">=</span> <span class="st0">'If Exists(Select *</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; From &nbsp; ReplaceTableName</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Where &nbsp;[ReplaceColumnName]</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= '</span><span class="st0">''</span> <span class="sy0">+</span> <span class="kw1">CONVERT</span><span class="br0">&#40;</span><span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">30</span><span class="br0">&#41;</span>, @DataToFind, <span class="nu0">126</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">''</span><span class="st0">'</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set @DataExists = 1</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Else</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set @DataExists = 0'</span>,
&nbsp; &nbsp; &nbsp; &nbsp; @<span class="kw1">PARAMETERS</span> <span class="sy0">=</span> <span class="st0">'@DataExists Bit OUTPUT'</span>,
&nbsp; &nbsp; &nbsp; &nbsp; @i <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">SELECT</span> @i <span class="sy0">=</span> <span class="nu0">1</span>, @<span class="kw2">MAX</span> <span class="sy0">=</span> <span class="kw2">MAX</span><span class="br0">&#40;</span>RowId<span class="br0">&#41;</span>
<span class="kw1">FROM</span> &nbsp; @Temp
&nbsp;
<span class="kw1">WHILE</span> @i <span class="sy0">&lt;=</span> @<span class="kw2">MAX</span>
&nbsp; &nbsp; <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span> &nbsp;@<span class="kw1">SQL</span> <span class="sy0">=</span> <span class="kw2">REPLACE</span><span class="br0">&#40;</span><span class="kw2">REPLACE</span><span class="br0">&#40;</span>@SQLTemplate, <span class="st0">'ReplaceTableName'</span>, <span class="kw2">QUOTENAME</span><span class="br0">&#40;</span>SchemaName<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'.'</span> <span class="sy0">+</span> <span class="kw2">QUOTENAME</span><span class="br0">&#40;</span>TableName<span class="br0">&#41;</span><span class="br0">&#41;</span>, <span class="st0">'ReplaceColumnName'</span>, ColumnName<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">FROM</span> &nbsp; &nbsp;@Temp
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> &nbsp; RowId <span class="sy0">=</span> @i
&nbsp;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">PRINT</span> @<span class="kw1">SQL</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">EXEC</span> <span class="kw3">SP_EXECUTESQL</span> @<span class="kw1">SQL</span>, @<span class="kw1">PARAMETERS</span>, @DataExists <span class="sy0">=</span> @DataExists <span class="kw1">OUTPUT</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">IF</span> @DataExists <span class="sy0">=</span><span class="nu0">1</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UPDATE</span> @Temp <span class="kw1">SET</span> DataFound <span class="sy0">=</span> <span class="nu0">1</span> <span class="kw1">WHERE</span> RowId <span class="sy0">=</span> @i
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @i <span class="sy0">=</span> @i <span class="sy0">+</span> <span class="nu0">1</span>
&nbsp; &nbsp; <span class="kw1">END</span>
&nbsp;
<span class="kw1">SELECT</span> &nbsp;SchemaName,TableName, ColumnName
<span class="kw1">FROM</span> &nbsp; &nbsp;@Temp
<span class="kw1">WHERE</span> &nbsp; DataFound <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
go</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE FindMyData_Date
    @DataToFind DATETIME
AS
SET NOCOUNT ON
 
DECLARE @Temp TABLE(RowId INT IDENTITY(1,1), SchemaName sysname, TableName sysname, ColumnName SysName, DataType VARCHAR(100), DataFound BIT)

DECLARE @ISDATE BIT
 

 
    INSERT  INTO @Temp(TableName,SchemaName, ColumnName, DataType)
    SELECT  C.Table_Name,C.TABLE_SCHEMA, C.Column_Name, C.Data_Type
    FROM    Information_Schema.Columns AS C
            INNER Join Information_Schema.Tables AS T
                ON C.Table_Name = T.Table_Name
		AND C.TABLE_SCHEMA = T.TABLE_SCHEMA
    WHERE   Table_Type = 'Base Table'
            And (Data_Type = 'DateTime'
            Or (Data_Type = 'SmallDateTime' And @DataToFind &gt;= '19000101' And @DataToFind &lt; '20790607'))
 
DECLARE @i INT
DECLARE @MAX INT
DECLARE @TableName sysname
DECLARE @ColumnName sysname
DECLARE @SchemaName sysname
DECLARE @SQL NVARCHAR(4000)
DECLARE @PARAMETERS NVARCHAR(4000)
DECLARE @DataExists BIT
DECLARE @SQLTemplate NVARCHAR(4000)
 
SELECT  @SQLTemplate = 'If Exists(Select *
                                 From   ReplaceTableName
                                 Where  [ReplaceColumnName]
                                              = ''' + CONVERT(VARCHAR(30), @DataToFind, 126) + '''
                                 )
                           Set @DataExists = 1
                       Else
                           Set @DataExists = 0',
        @PARAMETERS = '@DataExists Bit OUTPUT',
        @i = 1
 
SELECT @i = 1, @MAX = MAX(RowId)
FROM   @Temp
 
WHILE @i &lt;= @MAX
    BEGIN
        SELECT  @SQL = REPLACE(REPLACE(@SQLTemplate, 'ReplaceTableName', QUOTENAME(SchemaName) + '.' + QUOTENAME(TableName)), 'ReplaceColumnName', ColumnName)
        FROM    @Temp
        WHERE   RowId = @i
 
 
        PRINT @SQL
        EXEC SP_EXECUTESQL @SQL, @PARAMETERS, @DataExists = @DataExists OUTPUT
 
        IF @DataExists =1
            UPDATE @Temp SET DataFound = 1 WHERE RowId = @i
 
        SET @i = @i + 1
    END
 
SELECT  SchemaName,TableName, ColumnName
FROM    @Temp
WHERE   DataFound = 1

go</pre></div></div>

<p>If you want to test just this proc, try this</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">exec</span> FindMyData_Date <span class="st0">'20070615'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">exec FindMyData_Date '20070615'</pre></div></div>

<p>This is the string proc</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> FindMyData_String
&nbsp; &nbsp; @DataToFind <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; @ExactMatch <span class="kw1">BIT</span> <span class="sy0">=</span> <span class="nu0">0</span>
<span class="kw1">AS</span>
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">ON</span>
&nbsp;
<span class="kw1">DECLARE</span> @Temp <span class="kw1">TABLE</span><span class="br0">&#40;</span>RowId <span class="kw1">INT</span> <span class="kw1">IDENTITY</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span>, SchemaName sysname, TableName sysname, ColumnName SysName, DataType <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, DataFound <span class="kw1">BIT</span><span class="br0">&#41;</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">INSERT</span> &nbsp;<span class="kw1">INTO</span> @Temp<span class="br0">&#40;</span>TableName,SchemaName, ColumnName, DataType<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> &nbsp;C.<span class="me1">Table_Name</span>,C.<span class="me1">TABLE_SCHEMA</span>, C.<span class="me1">Column_Name</span>, C.<span class="me1">Data_Type</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> &nbsp; &nbsp;Information_Schema.<span class="me1">Columns</span> <span class="kw1">AS</span> C
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">INNER</span> Join Information_Schema.<span class="me1">Tables</span> <span class="kw1">AS</span> T
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ON</span> C.<span class="me1">Table_Name</span> <span class="sy0">=</span> T.<span class="me1">Table_Name</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> C.<span class="me1">TABLE_SCHEMA</span> <span class="sy0">=</span> T.<span class="me1">TABLE_SCHEMA</span>
&nbsp; &nbsp; <span class="kw1">WHERE</span> &nbsp; Table_Type <span class="sy0">=</span> <span class="st0">'Base Table'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; And Data_Type In <span class="br0">&#40;</span><span class="st0">'ntext'</span>,<span class="st0">'text'</span>,<span class="st0">'nvarchar'</span>,<span class="st0">'nchar'</span>,<span class="st0">'varchar'</span>,<span class="st0">'char'</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">DECLARE</span> @i <span class="kw1">INT</span>
<span class="kw1">DECLARE</span> @<span class="kw2">MAX</span> <span class="kw1">INT</span>
<span class="kw1">DECLARE</span> @TableName sysname
<span class="kw1">DECLARE</span> @ColumnName sysname
<span class="kw1">DECLARE</span> @SchemaName sysname
<span class="kw1">DECLARE</span> @<span class="kw1">SQL</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @<span class="kw1">PARAMETERS</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @DataExists <span class="kw1">BIT</span>
<span class="kw1">DECLARE</span> @SQLTemplate <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">SELECT</span> &nbsp;@SQLTemplate <span class="sy0">=</span> <span class="kw1">CASE</span> <span class="kw1">WHEN</span> @ExactMatch <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">THEN</span> <span class="st0">'If Exists(Select *</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; From &nbsp; ReplaceTableName</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Where &nbsp;Convert(nVarChar(4000), [ReplaceColumnName])</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= '</span><span class="st0">''</span> <span class="sy0">+</span> @DataToFind <span class="sy0">+</span> <span class="st0">''</span><span class="st0">'</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set @DataExists = 1</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Else</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set @DataExists = 0'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="st0">'If Exists(Select *</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; From &nbsp; ReplaceTableName</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Where &nbsp;Convert(nVarChar(4000), [ReplaceColumnName])</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Like '</span><span class="st0">'%'</span> <span class="sy0">+</span> @DataToFind <span class="sy0">+</span> <span class="st0">'%'</span><span class="st0">'</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set @DataExists = 1</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Else</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set @DataExists = 0'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">END</span>,
&nbsp; &nbsp; &nbsp; &nbsp; @<span class="kw1">PARAMETERS</span> <span class="sy0">=</span> <span class="st0">'@DataExists Bit OUTPUT'</span>,
&nbsp; &nbsp; &nbsp; &nbsp; @i <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">SELECT</span> @i <span class="sy0">=</span> <span class="nu0">1</span>, @<span class="kw2">MAX</span> <span class="sy0">=</span> <span class="kw2">MAX</span><span class="br0">&#40;</span>RowId<span class="br0">&#41;</span>
<span class="kw1">FROM</span> &nbsp; @Temp
&nbsp;
<span class="kw1">WHILE</span> @i <span class="sy0">&lt;=</span> @<span class="kw2">MAX</span>
&nbsp; &nbsp; <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span> &nbsp;@<span class="kw1">SQL</span> <span class="sy0">=</span> <span class="kw2">REPLACE</span><span class="br0">&#40;</span><span class="kw2">REPLACE</span><span class="br0">&#40;</span>@SQLTemplate, <span class="st0">'ReplaceTableName'</span>, <span class="kw2">QUOTENAME</span><span class="br0">&#40;</span>SchemaName<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'.'</span> <span class="sy0">+</span> <span class="kw2">QUOTENAME</span><span class="br0">&#40;</span>TableName<span class="br0">&#41;</span><span class="br0">&#41;</span>, <span class="st0">'ReplaceColumnName'</span>, ColumnName<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">FROM</span> &nbsp; &nbsp;@Temp
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> &nbsp; RowId <span class="sy0">=</span> @i
&nbsp;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">PRINT</span> @<span class="kw1">SQL</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">EXEC</span> <span class="kw3">SP_EXECUTESQL</span> @<span class="kw1">SQL</span>, @<span class="kw1">PARAMETERS</span>, @DataExists <span class="sy0">=</span> @DataExists <span class="kw1">OUTPUT</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">IF</span> @DataExists <span class="sy0">=</span><span class="nu0">1</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UPDATE</span> @Temp <span class="kw1">SET</span> DataFound <span class="sy0">=</span> <span class="nu0">1</span> <span class="kw1">WHERE</span> RowId <span class="sy0">=</span> @i
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @i <span class="sy0">=</span> @i <span class="sy0">+</span> <span class="nu0">1</span>
&nbsp; &nbsp; <span class="kw1">END</span>
&nbsp;
<span class="kw1">SELECT</span> &nbsp;SchemaName,TableName, ColumnName
<span class="kw1">FROM</span> &nbsp; &nbsp;@Temp
<span class="kw1">WHERE</span> &nbsp; DataFound <span class="sy0">=</span> <span class="nu0">1</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE FindMyData_String
    @DataToFind NVARCHAR(4000),
    @ExactMatch BIT = 0
AS
SET NOCOUNT ON
 
DECLARE @Temp TABLE(RowId INT IDENTITY(1,1), SchemaName sysname, TableName sysname, ColumnName SysName, DataType VARCHAR(100), DataFound BIT)
 
    INSERT  INTO @Temp(TableName,SchemaName, ColumnName, DataType)
    SELECT  C.Table_Name,C.TABLE_SCHEMA, C.Column_Name, C.Data_Type
    FROM    Information_Schema.Columns AS C
            INNER Join Information_Schema.Tables AS T
                ON C.Table_Name = T.Table_Name
		AND C.TABLE_SCHEMA = T.TABLE_SCHEMA
    WHERE   Table_Type = 'Base Table'
            And Data_Type In ('ntext','text','nvarchar','nchar','varchar','char')
 
 
DECLARE @i INT
DECLARE @MAX INT
DECLARE @TableName sysname
DECLARE @ColumnName sysname
DECLARE @SchemaName sysname
DECLARE @SQL NVARCHAR(4000)
DECLARE @PARAMETERS NVARCHAR(4000)
DECLARE @DataExists BIT
DECLARE @SQLTemplate NVARCHAR(4000)
 
SELECT  @SQLTemplate = CASE WHEN @ExactMatch = 1
                            THEN 'If Exists(Select *
                                           From   ReplaceTableName
                                           Where  Convert(nVarChar(4000), [ReplaceColumnName])
                                                        = ''' + @DataToFind + '''
                                           )
                                      Set @DataExists = 1
                                  Else
                                      Set @DataExists = 0'
                            ELSE 'If Exists(Select *
                                           From   ReplaceTableName
                                           Where  Convert(nVarChar(4000), [ReplaceColumnName])
                                                        Like ''%' + @DataToFind + '%''
                                           )
                                      Set @DataExists = 1
                                  Else
                                      Set @DataExists = 0'
                            END,
        @PARAMETERS = '@DataExists Bit OUTPUT',
        @i = 1
 
SELECT @i = 1, @MAX = MAX(RowId)
FROM   @Temp
 
WHILE @i &lt;= @MAX
    BEGIN
        SELECT  @SQL = REPLACE(REPLACE(@SQLTemplate, 'ReplaceTableName', QUOTENAME(SchemaName) + '.' + QUOTENAME(TableName)), 'ReplaceColumnName', ColumnName)
        FROM    @Temp
        WHERE   RowId = @i
 
 
        PRINT @SQL
        EXEC SP_EXECUTESQL @SQL, @PARAMETERS, @DataExists = @DataExists OUTPUT
 
        IF @DataExists =1
            UPDATE @Temp SET DataFound = 1 WHERE RowId = @i
 
        SET @i = @i + 1
    END
 
SELECT  SchemaName,TableName, ColumnName
FROM    @Temp
WHERE   DataFound = 1
GO</pre></div></div>

<p>If you want to test just this proc, try this</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">exec</span> FindMyData_string <span class="st0">'google'</span>, <span class="nu0">0</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">exec FindMyData_string 'google', 0</pre></div></div>

<p>Just the number proc</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> FindMyData_Number
&nbsp; &nbsp; @DataToFind <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; @ExactMatch <span class="kw1">BIT</span> <span class="sy0">=</span> <span class="nu0">0</span>
<span class="kw1">AS</span>
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">ON</span>
<span class="kw1">DECLARE</span> @Temp <span class="kw1">TABLE</span><span class="br0">&#40;</span>RowId <span class="kw1">INT</span> <span class="kw1">IDENTITY</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span>, SchemaName sysname, TableName sysname, ColumnName SysName, DataType <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, DataFound <span class="kw1">BIT</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">DECLARE</span> @IsNumber <span class="kw1">BIT</span>
<span class="kw1">DECLARE</span> @<span class="kw2">ISDATE</span> <span class="kw1">BIT</span>
&nbsp;
<span class="kw1">IF</span> <span class="kw2">ISNUMERIC</span><span class="br0">&#40;</span><span class="kw1">CONVERT</span><span class="br0">&#40;</span><span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span>, @DataToFind<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @IsNumber <span class="sy0">=</span> <span class="nu0">1</span>
<span class="kw1">ELSE</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @IsNumber <span class="sy0">=</span> <span class="nu0">0</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">INSERT</span> &nbsp;<span class="kw1">INTO</span> @Temp<span class="br0">&#40;</span>TableName,SchemaName, ColumnName, DataType<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> &nbsp;C.<span class="me1">Table_Name</span>,C.<span class="me1">TABLE_SCHEMA</span>, C.<span class="me1">Column_Name</span>, C.<span class="me1">Data_Type</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> &nbsp; &nbsp;Information_Schema.<span class="me1">Columns</span> <span class="kw1">AS</span> C
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">INNER</span> Join Information_Schema.<span class="me1">Tables</span> <span class="kw1">AS</span> T
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ON</span> C.<span class="me1">Table_Name</span> <span class="sy0">=</span> T.<span class="me1">Table_Name</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> C.<span class="me1">TABLE_SCHEMA</span> <span class="sy0">=</span> T.<span class="me1">TABLE_SCHEMA</span>
&nbsp; &nbsp; <span class="kw1">WHERE</span> &nbsp; Table_Type <span class="sy0">=</span> <span class="st0">'Base Table'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; And Data_Type In <span class="br0">&#40;</span><span class="st0">'float'</span>,<span class="st0">'real'</span>,<span class="st0">'decimal'</span>,<span class="st0">'money'</span>,<span class="st0">'smallmoney'</span>,<span class="st0">'bigint'</span>,<span class="st0">'int'</span>,<span class="st0">'smallint'</span>,<span class="st0">'tinyint'</span>,<span class="st0">'bit'</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">DECLARE</span> @i <span class="kw1">INT</span>
<span class="kw1">DECLARE</span> @<span class="kw2">MAX</span> <span class="kw1">INT</span>
<span class="kw1">DECLARE</span> @TableName sysname
<span class="kw1">DECLARE</span> @ColumnName sysname
<span class="kw1">DECLARE</span> @<span class="kw1">SQL</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @<span class="kw1">PARAMETERS</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @DataExists <span class="kw1">BIT</span>
<span class="kw1">DECLARE</span> @SQLTemplate <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">SELECT</span> &nbsp;@SQLTemplate <span class="sy0">=</span> <span class="kw1">CASE</span> <span class="kw1">WHEN</span> @ExactMatch <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">THEN</span> <span class="st0">'If Exists(Select *</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; From &nbsp; ReplaceTableName</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Where &nbsp;Convert(VarChar(40), [ReplaceColumnName])</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;= '</span><span class="st0">''</span> <span class="sy0">+</span> @DataToFind <span class="sy0">+</span> <span class="st0">''</span><span class="st0">'</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set @DataExists = 1</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Else</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set @DataExists = 0'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="st0">'If Exists(Select *</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; From &nbsp; ReplaceTableName</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Where &nbsp;Convert(VarChar(40), [ReplaceColumnName])</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Like '</span><span class="st0">'%'</span> <span class="sy0">+</span> @DataToFind <span class="sy0">+</span> <span class="st0">'%'</span><span class="st0">'</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set @DataExists = 1</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Else</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Set @DataExists = 0'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">END</span>,
&nbsp; &nbsp; &nbsp; &nbsp; @<span class="kw1">PARAMETERS</span> <span class="sy0">=</span> <span class="st0">'@DataExists Bit OUTPUT'</span>,
&nbsp; &nbsp; &nbsp; &nbsp; @i <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">SELECT</span> @i <span class="sy0">=</span> <span class="nu0">1</span>, @<span class="kw2">MAX</span> <span class="sy0">=</span> <span class="kw2">MAX</span><span class="br0">&#40;</span>RowId<span class="br0">&#41;</span>
<span class="kw1">FROM</span> &nbsp; @Temp
&nbsp;
<span class="kw1">WHILE</span> @i <span class="sy0">&lt;=</span> @<span class="kw2">MAX</span>
&nbsp; &nbsp; <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span> &nbsp;@<span class="kw1">SQL</span> <span class="sy0">=</span> <span class="kw2">REPLACE</span><span class="br0">&#40;</span><span class="kw2">REPLACE</span><span class="br0">&#40;</span>@SQLTemplate, <span class="st0">'ReplaceTableName'</span>, <span class="kw2">QUOTENAME</span><span class="br0">&#40;</span>SchemaName<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'.'</span> <span class="sy0">+</span> <span class="kw2">QUOTENAME</span><span class="br0">&#40;</span>TableName<span class="br0">&#41;</span><span class="br0">&#41;</span>, <span class="st0">'ReplaceColumnName'</span>, ColumnName<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> &nbsp; &nbsp;@Temp
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> &nbsp; RowId <span class="sy0">=</span> @i
&nbsp;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">PRINT</span> @<span class="kw1">SQL</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">EXEC</span> <span class="kw3">SP_EXECUTESQL</span> @<span class="kw1">SQL</span>, @<span class="kw1">PARAMETERS</span>, @DataExists <span class="sy0">=</span> @DataExists <span class="kw1">OUTPUT</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">IF</span> @DataExists <span class="sy0">=</span><span class="nu0">1</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UPDATE</span> @Temp <span class="kw1">SET</span> DataFound <span class="sy0">=</span> <span class="nu0">1</span> <span class="kw1">WHERE</span> RowId <span class="sy0">=</span> @i
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @i <span class="sy0">=</span> @i <span class="sy0">+</span> <span class="nu0">1</span>
&nbsp; &nbsp; <span class="kw1">END</span>
&nbsp;
<span class="kw1">SELECT</span> &nbsp;SchemaName,TableName, ColumnName
<span class="kw1">FROM</span> &nbsp; &nbsp;@Temp
<span class="kw1">WHERE</span> &nbsp; DataFound <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
go</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE FindMyData_Number
    @DataToFind NVARCHAR(4000),
    @ExactMatch BIT = 0
AS
SET NOCOUNT ON
DECLARE @Temp TABLE(RowId INT IDENTITY(1,1), SchemaName sysname, TableName sysname, ColumnName SysName, DataType VARCHAR(100), DataFound BIT)

DECLARE @IsNumber BIT
DECLARE @ISDATE BIT
 
IF ISNUMERIC(CONVERT(VARCHAR(20), @DataToFind)) = 1
    SET @IsNumber = 1
ELSE
    SET @IsNumber = 0
 
    INSERT  INTO @Temp(TableName,SchemaName, ColumnName, DataType)
    SELECT  C.Table_Name,C.TABLE_SCHEMA, C.Column_Name, C.Data_Type
    FROM    Information_Schema.Columns AS C
            INNER Join Information_Schema.Tables AS T
                ON C.Table_Name = T.Table_Name
        AND C.TABLE_SCHEMA = T.TABLE_SCHEMA
    WHERE   Table_Type = 'Base Table'
            And Data_Type In ('float','real','decimal','money','smallmoney','bigint','int','smallint','tinyint','bit')
 
 
DECLARE @i INT
DECLARE @MAX INT
DECLARE @TableName sysname
DECLARE @ColumnName sysname
DECLARE @SQL NVARCHAR(4000)
DECLARE @PARAMETERS NVARCHAR(4000)
DECLARE @DataExists BIT
DECLARE @SQLTemplate NVARCHAR(4000)
 
SELECT  @SQLTemplate = CASE WHEN @ExactMatch = 1
                            THEN 'If Exists(Select *
                                           From   ReplaceTableName
                                           Where  Convert(VarChar(40), [ReplaceColumnName])
                                                        = ''' + @DataToFind + '''
                                           )
                                      Set @DataExists = 1
                                  Else
                                      Set @DataExists = 0'
                            ELSE 'If Exists(Select *
                                           From   ReplaceTableName
                                           Where  Convert(VarChar(40), [ReplaceColumnName])
                                                        Like ''%' + @DataToFind + '%''
                                           )
                                      Set @DataExists = 1
                                  Else
                                      Set @DataExists = 0'
                            END,
        @PARAMETERS = '@DataExists Bit OUTPUT',
        @i = 1
 
SELECT @i = 1, @MAX = MAX(RowId)
FROM   @Temp
 
WHILE @i &lt;= @MAX
    BEGIN
        SELECT  @SQL = REPLACE(REPLACE(@SQLTemplate, 'ReplaceTableName', QUOTENAME(SchemaName) + '.' + QUOTENAME(TableName)), 'ReplaceColumnName', ColumnName)
	FROM    @Temp
        WHERE   RowId = @i
 
 
        PRINT @SQL
        EXEC SP_EXECUTESQL @SQL, @PARAMETERS, @DataExists = @DataExists OUTPUT
 
        IF @DataExists =1
            UPDATE @Temp SET DataFound = 1 WHERE RowId = @i
 
        SET @i = @i + 1
    END
 
SELECT  SchemaName,TableName, ColumnName
FROM    @Temp
WHERE   DataFound = 1
 
go</pre></div></div>

<p>If you want to test just this proc, try this</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">exec</span> FindMyData_Number <span class="st0">'562'</span>, <span class="nu0">1</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">exec FindMyData_Number '562', 1</pre></div></div>

<p>The mother of all procs!</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> FindMyData
&nbsp; &nbsp; @DataToFind <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; @ExactMatch <span class="kw1">BIT</span> <span class="sy0">=</span> <span class="nu0">0</span>
<span class="kw1">AS</span>
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">ON</span>
&nbsp;
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Output<span class="br0">&#40;</span>SchemaName sysname, TableName sysname, ColumnName sysname<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">IF</span> <span class="kw2">ISDATE</span><span class="br0">&#40;</span>@DataToFind<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> #Output <span class="kw1">EXEC</span> FindMyData_Date @DataToFind
&nbsp;
<span class="kw1">IF</span> <span class="kw2">ISNUMERIC</span><span class="br0">&#40;</span>@DataToFind<span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> #Output <span class="kw1">EXEC</span> FindMyData_Number @DataToFind, @Exactmatch
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #Output <span class="kw1">EXEC</span> FindMyData_String @DataToFind, @ExactMatch
&nbsp;
<span class="kw1">SELECT</span> SchemaName,TableName, ColumnName
<span class="kw1">FROM</span> &nbsp; #Output
<span class="kw1">ORDER</span> <span class="kw1">BY</span> SchemaName,TableName, ColumnName
go</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE FindMyData
    @DataToFind NVARCHAR(4000),
    @ExactMatch BIT = 0
AS
SET NOCOUNT ON
 
CREATE TABLE #Output(SchemaName sysname, TableName sysname, ColumnName sysname)
 
IF ISDATE(@DataToFind) = 1
    INSERT INTO #Output EXEC FindMyData_Date @DataToFind
 
IF ISNUMERIC(@DataToFind) = 1
    INSERT INTO #Output EXEC FindMyData_Number @DataToFind, @Exactmatch
 
INSERT INTO #Output EXEC FindMyData_String @DataToFind, @ExactMatch
 
SELECT SchemaName,TableName, ColumnName
FROM   #Output
ORDER BY SchemaName,TableName, ColumnName
go</pre></div></div>

<p>Here are some proc calls to test it out</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">exec</span> FindMyData <span class="st0">'google'</span>, <span class="nu0">0</span>
<span class="kw1">exec</span> FindMyData <span class="nu0">1</span>, <span class="nu0">0</span>
<span class="kw1">exec</span> FindMyData <span class="st0">'20081201'</span>, <span class="nu0">0</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">exec FindMyData 'google', 0
exec FindMyData 1, 0
exec FindMyData '20081201', 0</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">exec</span> FindMyData <span class="st0">'sysobjects'</span>, <span class="nu0">0</span> </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">exec FindMyData 'sysobjects', 0 </pre></div></div>

<h2 id="3">3 Splitting string values</h2>
<p>The fastest way to split a comma delimited string is by using a number table. If you do not have a number table in your database then use this code to create one</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- Create our Pivot table ** do this only once</span>
&nbsp; &nbsp; <span class="kw1">CREATE</span> <span class="kw1">TABLE</span> NumberPivot <span class="br0">&#40;</span>NumberID <span class="kw1">INT</span> <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span><span class="br0">&#41;</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">INSERT</span> <span class="kw1">INTO</span> NumberPivot
&nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">SELECT</span> number <span class="kw1">FROM</span> master..<span class="me1">spt_values</span>
&nbsp; &nbsp; <span class="kw1">where</span> type <span class="sy0">=</span> <span class="st0">'P'</span>
&nbsp; &nbsp;
&nbsp; &nbsp; GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">-- Create our Pivot table ** do this only once
    CREATE TABLE NumberPivot (NumberID INT PRIMARY KEY)
    
       INSERT INTO NumberPivot
       SELECT number FROM master..spt_values
	where type = 'P'
   
    GO</pre></div></div>

<p>Now you can run the following code to return each of the values in the comma delimited string in its own row</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @SplitString <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">1000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> @SplitString <span class="sy0">=</span><span class="st0">'1,4,77,88,4546,234,2,3,54,87,9,6,4,36,6,9,9,6,4,4,68,9,0,5,3,2,'</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="kw2">SUBSTRING</span><span class="br0">&#40;</span><span class="st0">','</span> <span class="sy0">+</span> @SplitString <span class="sy0">+</span> <span class="st0">','</span>, NumberID <span class="sy0">+</span> <span class="nu0">1</span>,
&nbsp; &nbsp; <span class="kw2">CHARINDEX</span><span class="br0">&#40;</span><span class="st0">','</span>, <span class="st0">','</span> <span class="sy0">+</span> @SplitString <span class="sy0">+</span> <span class="st0">','</span>, NumberID <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">-</span> NumberID <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="kw1">AS</span> <span class="kw1">VALUE</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> NumberPivot
&nbsp; &nbsp; <span class="kw1">WHERE</span> NumberID <span class="sy0">&lt;=</span> <span class="kw2">LEN</span><span class="br0">&#40;</span><span class="st0">','</span> <span class="sy0">+</span> @SplitString <span class="sy0">+</span> <span class="st0">','</span><span class="br0">&#41;</span> <span class="sy0">-</span> <span class="nu0">1</span>
&nbsp; &nbsp; <span class="sy0">AND</span> <span class="kw2">SUBSTRING</span><span class="br0">&#40;</span><span class="st0">','</span> <span class="sy0">+</span> @SplitString <span class="sy0">+</span> <span class="st0">','</span>, NumberID, <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">','</span>
&nbsp; &nbsp; GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @SplitString VARCHAR(1000)
    SELECT @SplitString ='1,4,77,88,4546,234,2,3,54,87,9,6,4,36,6,9,9,6,4,4,68,9,0,5,3,2,'
     
    SELECT SUBSTRING(',' + @SplitString + ',', NumberID + 1,
    CHARINDEX(',', ',' + @SplitString + ',', NumberID + 1) - NumberID -1)AS VALUE
    FROM NumberPivot
    WHERE NumberID &lt;= LEN(',' + @SplitString + ',') - 1
    AND SUBSTRING(',' + @SplitString + ',', NumberID, 1) = ','
    GO</pre></div></div>

<p>You can also return distinct values by using DISTINCT </p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @SplitString <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">1000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> @SplitString <span class="sy0">=</span><span class="st0">'1,4,77,88,4546,234,2,3,54,87,9,6,4,36,6,9,9,6,4,4,68,9,0,5,3,2'</span>
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="kw1">DISTINCT</span> <span class="kw2">SUBSTRING</span><span class="br0">&#40;</span><span class="st0">','</span> <span class="sy0">+</span> @SplitString <span class="sy0">+</span> <span class="st0">','</span>, NumberID <span class="sy0">+</span> <span class="nu0">1</span>,
&nbsp; &nbsp; <span class="kw2">CHARINDEX</span><span class="br0">&#40;</span><span class="st0">','</span>, <span class="st0">','</span> <span class="sy0">+</span> @SplitString <span class="sy0">+</span> <span class="st0">','</span>, NumberID <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">-</span> NumberID <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="kw1">AS</span> <span class="kw1">VALUE</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> NumberPivot
&nbsp; &nbsp; <span class="kw1">WHERE</span> NumberID <span class="sy0">&lt;=</span> <span class="kw2">LEN</span><span class="br0">&#40;</span><span class="st0">','</span> <span class="sy0">+</span> @SplitString <span class="sy0">+</span> <span class="st0">','</span><span class="br0">&#41;</span> <span class="sy0">-</span> <span class="nu0">1</span>
&nbsp; &nbsp; <span class="sy0">AND</span> <span class="kw2">SUBSTRING</span><span class="br0">&#40;</span><span class="st0">','</span> <span class="sy0">+</span> @SplitString <span class="sy0">+</span> <span class="st0">','</span>, NumberID, <span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">','</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @SplitString VARCHAR(1000)
    SELECT @SplitString ='1,4,77,88,4546,234,2,3,54,87,9,6,4,36,6,9,9,6,4,4,68,9,0,5,3,2'
     
    SELECT DISTINCT SUBSTRING(',' + @SplitString + ',', NumberID + 1,
    CHARINDEX(',', ',' + @SplitString + ',', NumberID + 1) - NumberID -1)AS VALUE
    FROM NumberPivot
    WHERE NumberID &lt;= LEN(',' + @SplitString + ',') - 1
    AND SUBSTRING(',' + @SplitString + ',', NumberID, 1) = ','</pre></div></div>

<p>You now can dump the result into a table and then you can join one of your real tables with that table which will execute much faster</p>
<h2 id="4">4 Select all rows from one table that don&#8217;t exist in another table</h2>
<p>There are at least 5 ways to return data from one table which is not in another table. Two of these are SQL Server 2005 and greater only</p>
<p>NOT IN<br />
NOT EXISTS<br />
LEFT and RIGHT JOIN<br />
OUTER APPLY (2005+)<br />
EXCEPT (2005+)</p>
<p>First Create these two tables</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> testnulls <span class="br0">&#40;</span>ID <span class="kw1">INT</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> testnulls <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> testnulls <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> testnulls <span class="kw1">VALUES</span> <span class="br0">&#40;</span>null<span class="br0">&#41;</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">CREATE</span> <span class="kw1">TABLE</span> testjoin <span class="br0">&#40;</span>ID <span class="kw1">INT</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> testjoin <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> testjoin <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">3</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE testnulls (ID INT)
    INSERT INTO testnulls VALUES (1)
    INSERT INTO testnulls VALUES (2)
    INSERT INTO testnulls VALUES (null)
 
    CREATE TABLE testjoin (ID INT)
    INSERT INTO testjoin VALUES (1)
    INSERT INTO testjoin VALUES (3)</pre></div></div>

<p><strong>NOT IN</strong></p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> testjoin <span class="kw1">WHERE</span> ID <span class="sy0">NOT</span> <span class="sy0">IN</span><span class="br0">&#40;</span><span class="kw1">SELECT</span> ID <span class="kw1">FROM</span> testnulls<span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM testjoin WHERE ID NOT IN(SELECT ID FROM testnulls)</pre></div></div>

<p>What happened? Nothing gets returned! The reason is because the subquery returns a NULL and you can&#8217;t compare a NULL to anything</p>
<p>Now run this</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> testjoin <span class="kw1">WHERE</span> ID <span class="sy0">NOT</span> <span class="sy0">IN</span><span class="br0">&#40;</span><span class="kw1">SELECT</span> ID <span class="kw1">FROM</span> testnulls <span class="kw1">WHERE</span> ID <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM testjoin WHERE ID NOT IN(SELECT ID FROM testnulls WHERE ID IS NOT NULL)</pre></div></div>

<p>That worked because we eliminated the NULL values in the subquery</p>
<p><strong>NOT EXISTS</strong></p>
<p>NOT EXISTS doesn&#8217;t have the problem that NOT IN has. Run the following code</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> testjoin j
&nbsp; &nbsp; <span class="kw1">WHERE</span> <span class="sy0">NOT</span> <span class="sy0">EXISTS</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> n.<span class="me1">ID</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> testnulls n
&nbsp; &nbsp; <span class="kw1">WHERE</span> n.<span class="me1">ID</span> <span class="sy0">=</span> j.<span class="me1">ID</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM testjoin j
    WHERE NOT EXISTS (SELECT n.ID
    FROM testnulls n
    WHERE n.ID = j.ID)</pre></div></div>

<p>Everything worked as expected</p>
<p><strong>LEFT and RIGHT JOIN</strong></p>
<p>Plain vanilla LEFT and RIGHT JOINS</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> j.<span class="sy0">*</span> <span class="kw1">FROM</span> testjoin j
&nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="sy0">OUTER</span> <span class="sy0">JOIN</span> testnulls n <span class="kw1">ON</span> n.<span class="me1">ID</span> <span class="sy0">=</span> j.<span class="me1">ID</span>
&nbsp; &nbsp; <span class="kw1">WHERE</span> n.<span class="me1">ID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">SELECT</span> j.<span class="sy0">*</span> <span class="kw1">FROM</span> &nbsp;testnulls n
&nbsp; &nbsp; <span class="kw1">RIGHT</span> <span class="sy0">OUTER</span> <span class="sy0">JOIN</span> testjoin j &nbsp;<span class="kw1">ON</span> n.<span class="me1">ID</span> <span class="sy0">=</span> j.<span class="me1">ID</span>
&nbsp; &nbsp; <span class="kw1">WHERE</span> n.<span class="me1">ID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT j.* FROM testjoin j
    LEFT OUTER JOIN testnulls n ON n.ID = j.ID
    WHERE n.ID IS NULL
 
    SELECT j.* FROM  testnulls n
    RIGHT OUTER JOIN testjoin j  ON n.ID = j.ID
    WHERE n.ID IS NULL</pre></div></div>

<p><strong>OUTER APPLY (SQL 2005 +)</strong></p>
<p>OUTER APPLY is something that got added to SQL 2005</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> j.<span class="sy0">*</span> <span class="kw1">FROM</span> testjoin j
&nbsp; &nbsp; <span class="sy0">OUTER</span> APPLY
&nbsp; &nbsp; <span class="br0">&#40;</span><span class="kw1">SELECT</span> id &nbsp;<span class="kw1">FROM</span> testnulls n
&nbsp; &nbsp; <span class="kw1">WHERE</span> n.<span class="me1">ID</span> <span class="sy0">=</span> j.<span class="me1">ID</span><span class="br0">&#41;</span> a
&nbsp; &nbsp; <span class="kw1">WHERE</span> a.<span class="me1">ID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT j.* FROM testjoin j
    OUTER APPLY
    (SELECT id  FROM testnulls n
    WHERE n.ID = j.ID) a
    WHERE a.ID IS NULL</pre></div></div>

<p><strong>EXCEPT(SQL 2005 +)</strong><br />
EXCEPT is something that got added to SQL 2005. It basically returns everything from the top table which is not in the bottom table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> testjoin
&nbsp; &nbsp; <span class="kw1">EXCEPT</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> testnulls</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM testjoin
    EXCEPT
    SELECT * FROM testnulls</pre></div></div>

<p><strong>INTERSECT </strong><br />
INTERSECT returns what ever is in both tables(like a regular join)</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> testjoin
&nbsp; &nbsp; <span class="kw1">INTERSECT</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> testnulls</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM testjoin
    INTERSECT
    SELECT * FROM testnulls</pre></div></div>

<h2 id="5">5 Getting all rows from one table and only the latest from the child table </h2>
<p>First create this table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #MaxVal<span class="br0">&#40;</span>id <span class="kw1">INT</span>,<span class="kw1">VALUE</span> <span class="kw1">INT</span>,SomeDate <span class="kw1">datetime</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> #MaxVal <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span>,<span class="st0">'20010101'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> #MaxVal <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">2</span>,<span class="st0">'20020101'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> #MaxVal <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">3</span>,<span class="st0">'20080101'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> #MaxVal <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">1</span>,<span class="st0">'20010101'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> #MaxVal <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">2</span>,<span class="st0">'20060101'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> #MaxVal <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">3</span>,<span class="st0">'20080101'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> #MaxVal <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">3</span>,<span class="nu0">1</span>,<span class="st0">'20010101'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> #MaxVal <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">3</span>,<span class="nu0">2</span>,<span class="st0">'20080101'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #MaxVal(id INT,VALUE INT,SomeDate datetime)
    INSERT #MaxVal VALUES(1,1,'20010101')
    INSERT #MaxVal VALUES(1,2,'20020101')
    INSERT #MaxVal VALUES(1,3,'20080101')
    INSERT #MaxVal VALUES(2,1,'20010101')
    INSERT #MaxVal VALUES(2,2,'20060101')
    INSERT #MaxVal VALUES(2,3,'20080101')
    INSERT #MaxVal VALUES(3,1,'20010101')
    INSERT #MaxVal VALUES(3,2,'20080101')</pre></div></div>

<p>If you just need the max value from a column you can just do a group by</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> id,<span class="kw2">MAX</span><span class="br0">&#40;</span>SomeDate<span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">VALUE</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> #MaxVal
&nbsp; &nbsp; <span class="kw1">GROUP</span> <span class="kw1">BY</span> id</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT id,MAX(SomeDate) AS VALUE
    FROM #MaxVal
    GROUP BY id</pre></div></div>

<p>If you need the whole row back then the query below is one way of doing this</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> t.<span class="sy0">*</span> <span class="kw1">FROM</span><span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> id,<span class="kw2">MAX</span><span class="br0">&#40;</span>SomeDate<span class="br0">&#41;</span> <span class="kw1">AS</span> MaxValue
&nbsp; &nbsp; <span class="kw1">FROM</span> #MaxVal
&nbsp; &nbsp; <span class="kw1">GROUP</span> <span class="kw1">BY</span> id<span class="br0">&#41;</span> x
&nbsp; &nbsp; <span class="sy0">JOIN</span> #MaxVal t <span class="kw1">ON</span> x.<span class="me1">id</span> <span class="sy0">=</span>t.<span class="me1">id</span>
&nbsp; &nbsp; <span class="sy0">AND</span> x.<span class="me1">MaxValue</span> <span class="sy0">=</span>t.<span class="me1">SomeDate</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT t.* FROM(
    SELECT id,MAX(SomeDate) AS MaxValue
    FROM #MaxVal
    GROUP BY id) x
    JOIN #MaxVal t ON x.id =t.id
    AND x.MaxValue =t.SomeDate</pre></div></div>

<p>We have another blog post on our site which has a lot more detail about doing this, as a matter of fact that blog post describes 5 ways to do it. These 5 ways are:</p>
<p><strong>Key Search</strong><br />
1. Correlated Subquery<br />
2. Derived Table</p>
<p><strong>Number and Filter</strong><br />
3. Windowing Function &#8211; Two Stage<br />
4. Windowing Function &#8211; One Stage</p>
<p><strong>Simulate MS Access</strong><br />
5. Compound Key, aka Packed Values</p>
<p>That post can be found here: <a href="/index.php/DataMgmt/DBProgramming/MSSQLServer/including-an-aggregated-column-s-related">Including an Aggregated Column&#8217;s Related Values</a></p>
<h2 id="6">6 Getting all characters until a specific character (charindex + left)</h2>
<p>There are two built in functions that you can use in SQL Server to return the first position in a column of the character you are looking for. These functions are PATINDEX and CHARINDEX. Let&#8217;s take a look at how PATINDEX  works. First create this table.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #SomeTable2
<span class="br0">&#40;</span>SomeValue <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">49</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable2 <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'one two three'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable2 <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'1 2 3'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable2 <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'abc def ghi'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable2 <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'one two'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable2 <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'one two three four'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable2 <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'one two three four five'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #SomeTable2
(SomeValue VARCHAR(49))
INSERT INTO #SomeTable2 VALUES ('one two three')
INSERT INTO #SomeTable2 VALUES ('1 2 3')
INSERT INTO #SomeTable2 VALUES ('abc def ghi')
INSERT INTO #SomeTable2 VALUES ('one two')
INSERT INTO #SomeTable2 VALUES ('one two three four')
INSERT INTO #SomeTable2 VALUES ('one two three four five')</pre></div></div>

<p>Now we want to return everything up to the first space and also everything after the last space. Here is how we do that</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> <span class="sy0">*</span>,<span class="kw1">left</span><span class="br0">&#40;</span>SomeValue,<span class="kw2">patindex</span><span class="br0">&#40;</span><span class="st0">'% %'</span>,SomeValue<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>,
<span class="kw1">right</span><span class="br0">&#40;</span>SomeValue,<span class="kw2">patindex</span><span class="br0">&#40;</span><span class="st0">'% %'</span>,<span class="br0">&#40;</span><span class="kw2">reverse</span><span class="br0">&#40;</span>SomeValue<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">from</span> #SomeTable2</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select *,left(SomeValue,patindex('% %',SomeValue)-1),
right(SomeValue,patindex('% %',(reverse(SomeValue)))-1)
from #SomeTable2</pre></div></div>

<p>(results)</p>
<table border = "1">
<tr>
<td>	one two three	</td>
<td>	one	</td>
<td>	three	</td>
</tr>
<tr>
<td>	1 2 3	</td>
<td>	1	</td>
<td>	3	</td>
</tr>
<tr>
<td>	abc def ghi	</td>
<td>	abc	</td>
<td>	ghi	</td>
</tr>
<tr>
<td>	one two	</td>
<td>	one	</td>
<td>	two	</td>
</tr>
<tr>
<td>	one two three four	</td>
<td>	one	</td>
<td>	four	</td>
</tr>
<tr>
<td>	one two three four five	</td>
<td>	one	</td>
<td>	five	</td>
</tr>
</table>
<p>As you can see to get the last value you can just use the REVERSE function with the RIGHT function. </p>
<h2 id="7">7 Return all rows with NULL values in a column</h2>
<p>People have a hard time with nulls, the first problem with NULLs is that your WHERE clause is not the same as if you would select a blank or a value </p>
<p>First create this simple table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #SomeTableNull<span class="br0">&#40;</span>SomeValue <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">49</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTableNull <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTableNull <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">''</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTableNull <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'a'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTableNull <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="sy0">NULL</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #SomeTableNull(SomeValue VARCHAR(49))
INSERT INTO #SomeTableNull VALUES ('1')
INSERT INTO #SomeTableNull VALUES ('')
INSERT INTO #SomeTableNull VALUES ('a')
INSERT INTO #SomeTableNull VALUES (NULL)</pre></div></div>

<p>To search a column your WHERE clause uses the  = sign</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> #SomeTableNull <span class="kw1">WHERE</span> SomeValue <span class="sy0">=</span> <span class="st0">''</span>
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> #SomeTableNull <span class="kw1">WHERE</span> SomeValue <span class="sy0">=</span> <span class="st0">'1'</span>
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> #SomeTableNull <span class="kw1">WHERE</span> SomeValue <span class="sy0">=</span> <span class="st0">'a'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM #SomeTableNull WHERE SomeValue = ''
SELECT * FROM #SomeTableNull WHERE SomeValue = '1'
SELECT * FROM #SomeTableNull WHERE SomeValue = 'a'</pre></div></div>

<p>Now let us try that to find a NULL value</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> #SomeTableNull <span class="kw1">WHERE</span> SomeValue <span class="sy0">=</span> <span class="sy0">NULL</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM #SomeTableNull WHERE SomeValue = NULL</pre></div></div>

<p>What just happened? We got nothing back? The reason is that you cannot compare a NULL value according to ANSI standards.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1">Take a look <span class="kw1">at</span> this
<span class="kw1">IF</span> <span class="sy0">NULL</span> <span class="sy0">=</span> <span class="sy0">NULL</span>
<span class="kw1">print</span> <span class="st0">'equal'</span>
<span class="kw1">else</span> 
<span class="kw1">print</span> <span class="st0">'not so equal'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Take a look at this
IF NULL = NULL
print 'equal'
else 
print 'not so equal'</pre></div></div>

<p>The bottom print statement got printed, NULL is unknown and you do not know if two unknows are the same</p>
<p>The correct way to return the NULL value is the following</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> #SomeTableNull <span class="kw1">WHERE</span> SomeValue <span class="kw1">IS</span> <span class="sy0">NULL</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM #SomeTableNull WHERE SomeValue IS NULL</pre></div></div>

<p>Just so that you know this, if you turn off ansi nulls then you can use =</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SET</span> ansi_nulls <span class="kw1">off</span>
&nbsp;
&nbsp;
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> #SomeTableNull <span class="kw1">WHERE</span> SomeValue <span class="sy0">=</span> <span class="sy0">NULL</span>
&nbsp;
<span class="kw1">SET</span> ansi_nulls <span class="kw1">on</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SET ansi_nulls off


SELECT * FROM #SomeTableNull WHERE SomeValue = NULL

SET ansi_nulls on</pre></div></div>

<p>However I do not recommend doing that ever, the default is ON and I would leave it like that</p>
<h2 id="8">8 Row values to column (PIVOT)</h2>
<p>A very frequent request is how to pivot/transpose/crosstab a query. SQL server 2005 introduced PIVOT, this makes life a lot easier compared to the SQL 2000 days. so let&#8217;s see how this works. First create this table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #SomeTable
<span class="br0">&#40;</span>SomeName <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">49</span><span class="br0">&#41;</span>, Quantity <span class="kw1">INT</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #SomeTable
(SomeName VARCHAR(49), Quantity INT)</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="de1"><pre class="de1"><span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Scarface'</span>, <span class="nu0">2</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Scarface'</span>, <span class="nu0">4</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'LOTR'</span>, <span class="nu0">5</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'LOTR'</span>, <span class="nu0">6</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span> <span class="st0">'Jaws'</span>, <span class="nu0">2</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Blade'</span>, <span class="nu0">5</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Saw'</span>, <span class="nu0">6</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span> <span class="st0">'Saw'</span>, <span class="nu0">2</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span> <span class="st0">'Jaws'</span>, <span class="nu0">12</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Blade'</span>, <span class="nu0">5</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Saw'</span>, <span class="nu0">6</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #SomeTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span> <span class="st0">'Saw'</span>, <span class="nu0">2</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">INSERT INTO #SomeTable VALUES ('Scarface', 2)
INSERT INTO #SomeTable VALUES ('Scarface', 4)
INSERT INTO #SomeTable VALUES ('LOTR', 5)
INSERT INTO #SomeTable VALUES ('LOTR', 6)
INSERT INTO #SomeTable VALUES ( 'Jaws', 2)
INSERT INTO #SomeTable VALUES ('Blade', 5)
INSERT INTO #SomeTable VALUES ('Saw', 6)
INSERT INTO #SomeTable VALUES ( 'Saw', 2)
INSERT INTO #SomeTable VALUES ( 'Jaws', 12)
INSERT INTO #SomeTable VALUES ('Blade', 5)
INSERT INTO #SomeTable VALUES ('Saw', 6)
INSERT INTO #SomeTable VALUES ( 'Saw', 2)</pre></div></div>

<p>What we want is too list all the movies in a column and the sum of all quantities for that movie as a value. So in this case we want this output</p>
<table border="1">
<tr>
<td> Scarface </td>
<td> LOTR </td>
<td> Jaws </td>
<td> Saw </td>
<td> Blade
</td>
</tr>
<tr>
<td> 6 </td>
<td> 11 </td>
<td> 14 </td>
<td> 16 </td>
<td> 10
</td>
</tr>
</table>
<p>First let&#8217;s look how we can do this in SQL Server 2000, this BTW will also work in SQL Server 2005/2008</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw2">SUM</span><span class="br0">&#40;</span><span class="kw1">CASE</span> SomeName <span class="kw1">WHEN</span> <span class="st0">'Scarface'</span> <span class="kw1">THEN</span> Quantity <span class="kw1">ELSE</span> <span class="nu0">0</span> <span class="kw1">END</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Scarface,
<span class="kw2">SUM</span><span class="br0">&#40;</span><span class="kw1">CASE</span> SomeName <span class="kw1">WHEN</span> <span class="st0">'LOTR'</span> <span class="kw1">THEN</span> Quantity <span class="kw1">ELSE</span> <span class="nu0">0</span> <span class="kw1">END</span><span class="br0">&#41;</span> <span class="kw1">AS</span> LOTR,
<span class="kw2">SUM</span><span class="br0">&#40;</span><span class="kw1">CASE</span> SomeName <span class="kw1">WHEN</span> <span class="st0">'Jaws'</span> <span class="kw1">THEN</span> Quantity <span class="kw1">ELSE</span> <span class="nu0">0</span> <span class="kw1">END</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Jaws,
<span class="kw2">SUM</span><span class="br0">&#40;</span><span class="kw1">CASE</span> SomeName <span class="kw1">WHEN</span> <span class="st0">'Saw'</span> <span class="kw1">THEN</span> Quantity <span class="kw1">ELSE</span> <span class="nu0">0</span> <span class="kw1">END</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Saw,
<span class="kw2">SUM</span><span class="br0">&#40;</span><span class="kw1">CASE</span> SomeName <span class="kw1">WHEN</span> <span class="st0">'Blade'</span> <span class="kw1">THEN</span> Quantity <span class="kw1">ELSE</span> <span class="nu0">0</span> <span class="kw1">END</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Blade
<span class="kw1">FROM</span> #SomeTable</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT SUM(CASE SomeName WHEN 'Scarface' THEN Quantity ELSE 0 END) AS Scarface,
SUM(CASE SomeName WHEN 'LOTR' THEN Quantity ELSE 0 END) AS LOTR,
SUM(CASE SomeName WHEN 'Jaws' THEN Quantity ELSE 0 END) AS Jaws,
SUM(CASE SomeName WHEN 'Saw' THEN Quantity ELSE 0 END) AS Saw,
SUM(CASE SomeName WHEN 'Blade' THEN Quantity ELSE 0 END) AS Blade
FROM #SomeTable</pre></div></div>

<p>In SQL Server 2005/2008 we can use PIVOT, here is how we can use it</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> Scarface, LOTR, Jaws, Saw,Blade
<span class="kw1">FROM</span>
<span class="br0">&#40;</span><span class="kw1">SELECT</span> SomeName,Quantity
<span class="kw1">FROM</span> #SomeTable<span class="br0">&#41;</span> <span class="kw1">AS</span> pivTemp
PIVOT
<span class="br0">&#40;</span> &nbsp; <span class="kw2">SUM</span><span class="br0">&#40;</span>Quantity<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">FOR</span> SomeName <span class="sy0">IN</span> <span class="br0">&#40;</span>Scarface, LOTR, Jaws, Saw,Blade<span class="br0">&#41;</span>
<span class="br0">&#41;</span> <span class="kw1">AS</span> pivTable</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT Scarface, LOTR, Jaws, Saw,Blade
FROM
(SELECT SomeName,Quantity
FROM #SomeTable) AS pivTemp
PIVOT
(   SUM(Quantity)
    FOR SomeName IN (Scarface, LOTR, Jaws, Saw,Blade)
) AS pivTable</pre></div></div>

<p>That looks a little bit neater than the SQL 2000 version.<br />
If you are interested in Column To Row take a look at <a href="http://wiki.lessthandot.com/index.php/Column_To_Row_%28UNPIVOT%29">Column To Row (UNPIVOT)</a> on our wiki</p>
<h2 id="9">9 Pad or remove leading zeroes from numbers</h2>
<p>To pad a number with leading zeroes you use as many zeroes as you want the output to be, then use concatenation plus the right function to display it<br />
For example if you want to pad a 6 digit column with zeroes you would do something like this<br />
 RIGHT(&#8216;000000&#8217; + CONVERT(VARCHAR(6),ColumnName),6)</p>
<p>Here is some code that will show this, first create this table<br />
USE tempdb<br />
go</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> testpadding<span class="br0">&#40;</span>id <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span>,id2 <span class="kw1">INT</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> testpadding <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'000001'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> testpadding <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'000134'</span>,<span class="nu0">134</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> testpadding <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'002232'</span>,<span class="nu0">2232</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> testpadding <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'000002'</span>,<span class="nu0">2</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE testpadding(id VARCHAR(50),id2 INT)
INSERT testpadding VALUES('000001',1)
INSERT testpadding VALUES('000134',134)
INSERT testpadding VALUES('002232',2232)
INSERT testpadding VALUES('000002',2)</pre></div></div>

<p>Now run </p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">RIGHT</span><span class="br0">&#40;</span><span class="st0">'000000'</span> <span class="sy0">+</span> <span class="kw1">CONVERT</span><span class="br0">&#40;</span><span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">6</span><span class="br0">&#41;</span>,id2<span class="br0">&#41;</span>,<span class="nu0">6</span><span class="br0">&#41;</span>
<span class="kw1">FROM</span> testpadding</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT RIGHT('000000' + CONVERT(VARCHAR(6),id2),6)
FROM testpadding</pre></div></div>

<p>(results)<br />
000001<br />
000134<br />
002232<br />
000002</p>
<p>what about the id columns and stripping the zeroes from that?<br />
No problem do this</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">CONVERT</span><span class="br0">&#40;</span><span class="kw1">INT</span>,id<span class="br0">&#41;</span>
<span class="kw1">FROM</span> testpadding</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT CONVERT(INT,id)
FROM testpadding</pre></div></div>

<p>(results)<br />
1<br />
134<br />
2232<br />
2</p>
<p>Beautiful right? Not so fast, insert this row</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">INSERT</span> testpadding <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'02222222222222222222200002'</span>,<span class="nu0">2</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">INSERT testpadding VALUES('02222222222222222222200002',2)</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">CONVERT</span><span class="br0">&#40;</span><span class="kw1">INT</span>,id<span class="br0">&#41;</span>
<span class="kw1">FROM</span> testpadding</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT CONVERT(INT,id)
FROM testpadding</pre></div></div>

<p>Server: Msg 248, Level 16, State 1, Line 1<br />
The conversion of the varchar value &#8216;02222222222222222222200002&#8217; overflowed an int column.</p>
<p>Okay we can do a bigint instead</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">CONVERT</span><span class="br0">&#40;</span><span class="kw1">bigINT</span>,id<span class="br0">&#41;</span>
<span class="kw1">FROM</span> testpadding</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT CONVERT(bigINT,id)
FROM testpadding</pre></div></div>

<p>Server: Msg 8115, Level 16, State 2, Line 1<br />
Arithmetic overflow error converting expression to data type bigint.</p>
<p>Nope, even that doesn&#8217;t fit, now what?</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> <span class="kw2">replace</span><span class="br0">&#40;</span><span class="kw2">ltrim</span><span class="br0">&#40;</span><span class="kw2">replace</span><span class="br0">&#40;</span>id,<span class="st0">'0'</span>,<span class="st0">' '</span><span class="br0">&#41;</span><span class="br0">&#41;</span>,<span class="st0">' '</span>,<span class="st0">'0'</span><span class="br0">&#41;</span>
<span class="kw1">FROM</span> testpadding</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select replace(ltrim(replace(id,'0',' ')),' ','0')
FROM testpadding</pre></div></div>

<p>(results)<br />
1<br />
134<br />
2232<br />
2<br />
2222222222222222222200002</p>
<p>So how does that work? First you replace all the zeroes with spaces, then you trim it to get rid of the leading spaces, after you replace the space back to zeroes again, the leading zeroes don&#8217;t exists anymore because they were trimmed</p>
<h2 id="10">10 Concatenate Values From Multiple Rows Into One Column</h2>
<p>If you want to concatenate values from multiple rows into one and you want to order it then you have to use FOR XML PATH. The ORDER BY is -not- guaranteed to be processed before the concatenation occurs, if you use that technique. However, it -is- guaranteed if you use FOR XML PATH(&#8221;).</p>
<p>Let&#8217;s take a look. First create these tables</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="de1"><pre class="de1"><span class="kw1">USE</span> TEMPDB
GO
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Authors <span class="br0">&#40;</span>Id <span class="kw1">INT</span>, LastName <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, FirstName <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
GO
<span class="kw1">INSERT</span> Authors <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="st0">'Nielsen'</span>,<span class="st0">'Paul'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> Authors <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">2</span>,<span class="st0">'King'</span>,<span class="st0">'Stephen'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> Authors <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">3</span>,<span class="st0">'Stephenson'</span>,<span class="st0">'Neal'</span><span class="br0">&#41;</span>
GO
&nbsp;
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Books <span class="br0">&#40;</span>ID <span class="kw1">INT</span>,AuthorID <span class="kw1">INT</span>, BookName <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
GO
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span>,<span class="st0">'SQL Server 2005 Bible'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">1</span>,<span class="st0">'SQL Server 2008 Bible'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">3</span>,<span class="nu0">2</span>,<span class="st0">'It'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">4</span>,<span class="nu0">2</span>,<span class="st0">'The Stand'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">5</span>,<span class="nu0">2</span>,<span class="st0">'Thinner'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">6</span>,<span class="nu0">2</span>,<span class="st0">'Salems Lot'</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">7</span>,<span class="nu0">3</span>,<span class="st0">'Snow Crash'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">8</span>,<span class="nu0">3</span>,<span class="st0">'The Diamond Age'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> Books <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">9</span>,<span class="nu0">3</span>,<span class="st0">'Cryptonomicon'</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">USE TEMPDB
GO
CREATE TABLE Authors (Id INT, LastName VARCHAR(100), FirstName VARCHAR(100))
GO
INSERT Authors VALUES(1,'Nielsen','Paul')
INSERT Authors VALUES(2,'King','Stephen')
INSERT Authors VALUES(3,'Stephenson','Neal')
GO
 
CREATE TABLE Books (ID INT,AuthorID INT, BookName VARCHAR(200))
GO
INSERT Books VALUES(1,1,'SQL Server 2005 Bible')
INSERT Books VALUES(2,1,'SQL Server 2008 Bible')
 
INSERT Books VALUES(3,2,'It')
INSERT Books VALUES(4,2,'The Stand')
INSERT Books VALUES(5,2,'Thinner')
INSERT Books VALUES(6,2,'Salems Lot')
 
 
INSERT Books VALUES(7,3,'Snow Crash')
INSERT Books VALUES(8,3,'The Diamond Age')
INSERT Books VALUES(9,3,'Cryptonomicon')
GO</pre></div></div>

<p>This is the old style function, it will run on SQL Server 2000 and up</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">FUNCTION</span> fnGetBooks2 <span class="br0">&#40;</span>@AuthorID <span class="kw1">INT</span><span class="br0">&#41;</span>
<span class="kw1">RETURNS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">DECLARE</span> @BookList <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span> @BookList <span class="sy0">=</span> <span class="st0">''</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span> @BookList <span class="sy0">=</span> @BookList <span class="sy0">+</span> BookName <span class="sy0">+</span><span class="st0">','</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">FROM</span> Books
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> AuthorID <span class="sy0">=</span> @AuthorID
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> BookName <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ORDER</span> <span class="kw1">BY</span> BookName <span class="co1">--yes we can sort</span>
&nbsp;
<span class="kw1">RETURN</span> <span class="kw1">LEFT</span><span class="br0">&#40;</span>@BookList,<span class="br0">&#40;</span><span class="kw2">LEN</span><span class="br0">&#40;</span>@BookList<span class="br0">&#41;</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">END</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE FUNCTION fnGetBooks2 (@AuthorID INT)
RETURNS VARCHAR(8000)
AS
BEGIN
        DECLARE @BookList VARCHAR(8000)
        SELECT @BookList = ''
        SELECT @BookList = @BookList + BookName +','
        FROM Books
        WHERE AuthorID = @AuthorID
        AND BookName IS NOT NULL
        ORDER BY BookName --yes we can sort
 
RETURN LEFT(@BookList,(LEN(@BookList) -1))
END
GO</pre></div></div>

<p>This is the same function using XML Path, so SQL Server 2005 and up</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">FUNCTION</span> fnGetBooks <span class="br0">&#40;</span>@AuthorID <span class="kw1">INT</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">RETURNS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;<span class="kw1">DECLARE</span> @BookList <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
&nbsp;<span class="kw1">SELECT</span> @BookList <span class="sy0">=</span><span class="br0">&#40;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span> &nbsp;BookName <span class="sy0">+</span> <span class="st0">', '</span> <span class="kw1">AS</span> <span class="br0">&#91;</span><span class="kw1">text</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
&nbsp;
&nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> &nbsp; &nbsp;Books
&nbsp;<span class="kw1">WHERE</span> AuthorID <span class="sy0">=</span> @AuthorID
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> BookName <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">ORDER</span> <span class="kw1">BY</span> BookName
&nbsp;
&nbsp; &nbsp; &nbsp;<span class="kw1">FOR</span> XML <span class="kw1">PATH</span><span class="br0">&#40;</span><span class="st0">''</span><span class="br0">&#41;</span> <span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;
<span class="kw1">RETURN</span> <span class="kw1">LEFT</span><span class="br0">&#40;</span>@BookList,<span class="br0">&#40;</span><span class="kw2">LEN</span><span class="br0">&#40;</span>@BookList<span class="br0">&#41;</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">END</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE FUNCTION fnGetBooks (@AuthorID INT)
 
RETURNS VARCHAR(8000)
AS
BEGIN
       
 DECLARE @BookList VARCHAR(8000)
 SELECT @BookList =(
 
        SELECT  BookName + ', ' AS [text()]
 
     FROM    Books
 WHERE AuthorID = @AuthorID
        AND BookName IS NOT NULL
     ORDER BY BookName
 
     FOR XML PATH('') )
       
 
RETURN LEFT(@BookList,(LEN(@BookList) -1))
END
GO</pre></div></div>

<p>Here are the calls to the functions</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span>,dbo.<span class="me1">fnGetBooks</span><span class="br0">&#40;</span>id<span class="br0">&#41;</span> <span class="kw1">AS</span> Books
<span class="kw1">FROM</span> Authors</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT *,dbo.fnGetBooks(id) AS Books
FROM Authors</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span>,dbo.<span class="me1">fnGetBooks2</span><span class="br0">&#40;</span>id<span class="br0">&#41;</span> <span class="kw1">AS</span> Books
<span class="kw1">FROM</span> Authors</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT *,dbo.fnGetBooks2(id) AS Books
FROM Authors</pre></div></div>

<p></p>
<p>(results)</p>
<table border="1">
<tr>
<td> Id </td>
<td> LastName</td>
<td> FirstName </td>
<td> Books
</td>
</tr>
<tr>
<td> 1 </td>
<td> Nielsen </td>
<td> Paul</td>
<td> SQL Server 2005 Bible,SQL Server 2008 Bible
</td>
</tr>
<tr>
<td> 2 </td>
<td> King </td>
<td> Stephen</td>
<td> It,Salems Lot,The Stand,Thinner
</td>
</tr>
<tr>
<td> 3 </td>
<td> Stephenson</td>
<td> Neal</td>
<td> Cryptonomicon,Snow Crash,The Diamond Age
</td>
</tr>
</table>
<p>The results are the same but I have been assured by people in the private SQL Server MVP group that FOR XML PATH will preserve the order while the other function might not</p>
<p>In case you want some more of this stuff we have over 80 hacks, tips and trick on our <a href="http://wiki.lessthandot.com/index.php/SQL_Server_Programming_Hacks_-_100%2B_List">SQL Server Programming Hacks</a> wiki page</p>
<p>*** <strong>Remember, if you have a SQL related question try our <a href="http://forum.lessthandot.com/viewforum.php?f=17">Microsoft SQL Server Programming</a> forum or our <a href="http://forum.lessthandot.com/viewforum.php?f=22">Microsoft SQL Server Admin</a> forum</strong><ins></ins></p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/checking-for-null-values-in-all-columns/'>Checking for NULL values in all columns that allow NULLS in all the tables</a><p>This post is based on a question I answered earlier today, someone wanted to check&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-server-2008-logo/'>SQL Server 2008 Logo</a><p>Here is the new logo for SQL Server 2008. Looks pretty clean, what do you&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2><img class="bioPic" src="http://www.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d.png" alt="User bio image"/>Denis has been working with SQL Server since version 6.5. Although he worked as an ASP/JSP/ColdFusion developer before the dot com bust, he has been working exclusively as a database developer/architect since 2002. In addition to English, Denis is also fluent in Croatian and Dutch, but he can curse in many other languages and dialects (just ask the SQL optimizer) He lives in Princeton, NJ with his wife and three kids.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/denisgobo" title="SQLDenis at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/denis.gobo" title="SQLDenis at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/in/denisgobo" title="SQLDenis at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://denisgobo.blogspot.com/" title="SQLDenis at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="http://www.flickr.com/photos/denisgobo//" title="SQLDenis at Flickr" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_flickr.png" alt="Flickr" /></a><a href="/index.php/author/SQLDenis/feed/" title="Blog RSS feed for SQLDenis" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 130,156 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/SQLDenis/">Read More Posts by SQLDenis</a>
						</div>
					</div>
					<div>
						<label>Tags:</label> <a href="/index.php/tag/answers/" rel="tag">answers</a>, <a href="/index.php/tag/questions/" rel="tag">questions</a>, <a href="/index.php/tag/sql-server-2000/" rel="tag">sql server 2000</a>, <a href="/index.php/tag/sql-server-2005/" rel="tag">sql server 2005</a>, <a href="/index.php/tag/sql-server-2008/" rel="tag">sql server 2008</a> 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&text=RT @LessThanDot Blog - The Ten Most Asked SQL Server Questions And Their Answers by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&title=The Ten Most Asked SQL Server Questions And Their Answers&source=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&title=The Ten Most Asked SQL Server Questions And Their Answers" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&quote=The Ten Most Asked SQL Server Questions And Their Answers" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/&title=The Ten Most Asked SQL Server Questions And Their Answers" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		56 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-chrissie1 even thread-even depth-1" id="comment-511">
				<div id="div-comment-511" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/70e155e88e0ead5e2bdcb3e1c57506b4?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/70e155e88e0ead5e2bdcb3e1c57506b4?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Christiaan Baes (chrissie1)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-511">
			December 10, 2008 at 10:18 am</a>		</div>

		<p>Cool, long but cool.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=511#respond' onclick='return addComment.moveForm( "div-comment-511", "511", "respond", "241" )' aria-label='Reply to Christiaan Baes (chrissie1)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcuse odd alt thread-odd thread-alt depth-1" id="comment-513">
				<div id="div-comment-513" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5e8bfdc77e52098a1ab2ddd1cd2a176f?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5e8bfdc77e52098a1ab2ddd1cd2a176f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Alex Ullrich</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-513">
			December 10, 2008 at 10:44 am</a>		</div>

		<p>Great post man, I don&#8217;t think you made it long enough though!  You could have milked this for ten posts for sure 😉</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=513#respond' onclick='return addComment.moveForm( "div-comment-513", "513", "respond", "241" )' aria-label='Reply to Alex Ullrich'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-514">
				<div id="div-comment-514" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5178fd512aa69c7743fbdfbb3247576e?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5178fd512aa69c7743fbdfbb3247576e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Impal3r</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-514">
			December 10, 2008 at 10:46 am</a>		</div>

		<p>Damn, I just wore out my scroll wheel trying to read the whole thing. If I print it half the Amazon will be gone 🙁</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=514#respond' onclick='return addComment.moveForm( "div-comment-514", "514", "respond", "241" )' aria-label='Reply to Impal3r'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-516">
				<div id="div-comment-516" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/02335a6e50e2fb5af7df12054ef0348a?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/02335a6e50e2fb5af7df12054ef0348a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">sirrocco</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-516">
			December 11, 2008 at 4:47 am</a>		</div>

		<p>Great job man. Congrats.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=516#respond' onclick='return addComment.moveForm( "div-comment-516", "516", "respond", "241" )' aria-label='Reply to sirrocco'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-517">
				<div id="div-comment-517" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/cc36dac13dc85cc5a4e5efddcd99aad7?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/cc36dac13dc85cc5a4e5efddcd99aad7?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Scott Swank</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-517">
			December 11, 2008 at 11:14 am</a>		</div>

		<p>For #5 you can cut your i/o in half by using window functions.</p>
<p>select id, value, SomeDate<br />
  from (<br />
select m.*,<br />
       row_number() over (<br />
         partition by id<br />
         order by SomeDate desc) as rn<br />
  from #MaxVal  m<br />
       ) m2<br />
 where m2.rn = 1;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=517#respond' onclick='return addComment.moveForm( "div-comment-517", "517", "respond", "241" )' aria-label='Reply to Scott Swank'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-519">
				<div id="div-comment-519" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-519">
			December 11, 2008 at 11:27 am</a>		</div>

		<p>Scott,  </p>
<p>True, thanks for the comment, my solution is slower but still 2000 compatible</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=519#respond' onclick='return addComment.moveForm( "div-comment-519", "519", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-522">
				<div id="div-comment-522" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0c2672d183877f7fcd8d46970ef03f1f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0c2672d183877f7fcd8d46970ef03f1f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">sqlsister</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-522">
			December 11, 2008 at 12:23 pm</a>		</div>

		<p>You forgot &#8211; Why is my cursor so slow?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=522#respond' onclick='return addComment.moveForm( "div-comment-522", "522", "respond", "241" )' aria-label='Reply to sqlsister'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-524">
				<div id="div-comment-524" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-524">
			December 11, 2008 at 12:25 pm</a>		</div>

		<p>sqlsister , </p>
<p>I don&#8217;t know what cursors have to do with SQL, I move them on my screen with the mouse  😉</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=524#respond' onclick='return addComment.moveForm( "div-comment-524", "524", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kaht even thread-even depth-1" id="comment-525">
				<div id="div-comment-525" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e8cf1f89d93accfa6f422a6e718ad2f9?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e8cf1f89d93accfa6f422a6e718ad2f9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">kaht</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-525">
			December 11, 2008 at 2:15 pm</a>		</div>

		<p>You forgot the most famous SQL question of all time (that&#8217;s not really a question):</p>
<p>&#8220;NEED TO GO FASTER&#8221;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=525#respond' onclick='return addComment.moveForm( "div-comment-525", "525", "respond", "241" )' aria-label='Reply to kaht'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-526">
				<div id="div-comment-526" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e943a5a6994987d2ffcd41b826a4790a?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e943a5a6994987d2ffcd41b826a4790a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-526">
			December 11, 2008 at 7:31 pm</a>		</div>

		<p>Another way to strip the time out of a date:</p>
<p>SELECT *, CONVERT(datetime,FLOOR(CONVERT(float,DateColumn,0)),0) AS stripped<br />
FROM SomeDates</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=526#respond' onclick='return addComment.moveForm( "div-comment-526", "526", "respond", "241" )' aria-label='Reply to Andy'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-527">
				<div id="div-comment-527" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0af35a813a7ce75bd217aa36a1311e27?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0af35a813a7ce75bd217aa36a1311e27?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://jane.dallaway.com/blog' rel='external nofollow' class='url'>Jane</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-527">
			December 12, 2008 at 4:39 am</a>		</div>

		<p>Re item 1, and specifically getting the date element without the time (prior to SQL Server 2008)</p>
<p>A colleague of mine discovered <br />
SELECT CONVERT(DATETIME,FLOOR(CONVERT(FLOAT,GETDATE())))</p>
<p>which seems to be more efficient than converting to varchar, something I attempted to prove at <a href="http://jane.dallaway.com/tsql-timings">TSQL &#8211; Timings</a>.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=527#respond' onclick='return addComment.moveForm( "div-comment-527", "527", "respond", "241" )' aria-label='Reply to Jane'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-528">
				<div id="div-comment-528" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a11151a7deec3b25f65eba772e2ec4e9?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a11151a7deec3b25f65eba772e2ec4e9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://sainbayar.wordpress.com/' rel='external nofollow' class='url'>Sainbayar G</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-528">
			December 14, 2008 at 11:04 pm</a>		</div>

		<p>first two questions are really creative.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=528#respond' onclick='return addComment.moveForm( "div-comment-528", "528", "respond", "241" )' aria-label='Reply to Sainbayar G'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-480">
				<div id="div-comment-480" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1b5080c29ca207116b97b8f4250a13eb?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1b5080c29ca207116b97b8f4250a13eb?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLSam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-480">
			December 23, 2008 at 4:20 pm</a>		</div>

		<p>Great job, I had been looking for padding info elsewhere and came across a long winded way around it, <br />
I knew there must have been a better way.</p>
<p>Also might be good to mention that when searching for columns that may include nulls, if you want to include<br />
nulls you actually have to specify it.  Took me a while to realise this.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=480#respond' onclick='return addComment.moveForm( "div-comment-480", "480", "respond", "241" )' aria-label='Reply to SQLSam'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-488">
				<div id="div-comment-488" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f87890eb9052320733ce3c8017e63d82?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f87890eb9052320733ce3c8017e63d82?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.dubaihits.com/' rel='external nofollow' class='url'>Rizwan Javed</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-488">
			May 23, 2009 at 1:20 am</a>		</div>

		<p>GREAT JOB !!! <br />
Thank you for sharing such an amazing material, I have learn a lot from this article. </p>
<p>Regards,<br />
Rizwan Javed</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=488#respond' onclick='return addComment.moveForm( "div-comment-488", "488", "respond", "241" )' aria-label='Reply to Rizwan Javed'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-512">
				<div id="div-comment-512" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/30ddc299e41a0913edfcec897bf461e5?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/30ddc299e41a0913edfcec897bf461e5?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">hondageoff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-512">
			June 11, 2009 at 2:16 pm</a>		</div>

		<p>This is what I&#8217;ve been looking for.  Great post!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=512#respond' onclick='return addComment.moveForm( "div-comment-512", "512", "respond", "241" )' aria-label='Reply to hondageoff'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-515">
				<div id="div-comment-515" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-515">
			June 12, 2009 at 6:32 am</a>		</div>

		<p>Can you please list all other variations of a solution to #5 problem &#8211; then I can simply point to this blog.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=515#respond' onclick='return addComment.moveForm( "div-comment-515", "515", "respond", "241" )' aria-label='Reply to Naomi'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-487">
				<div id="div-comment-487" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/b9232fe2c8d655bfd1a36ff65c713afd?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/b9232fe2c8d655bfd1a36ff65c713afd?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://eguanasolutions.com/' rel='external nofollow' class='url'>mamlin</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-487">
			July 10, 2009 at 4:26 pm</a>		</div>

		<p>Great post!  For #2 (string search) you can simplify the code by replacing the CASE statement.  Instead of using CASE to check for @ExactMatch and then repeating most of the code in THEN and ELSE, do a simple IF just before the select.  If @ExactMatch = 1 then set @DataToFind = &#8216;%&#8217;+@DataToFind+&#8217;%&#8217;.  Replace the CASE statement with just the code from inside the THEN clause and change the &#8220;=&#8221; to &#8220;LIKE&#8221;.  If not @ExactMatch then your LIKE compare value won&#8217;t be enclosed in &#8216;%&#8217; and the operation will logically perform as an &#8220;=&#8221;.</p>
<p>Also, I haven&#8217;t put it to the test, yet, but you _may_ get better performance with a version of search that does not repeatedly call a stored procedure but instead keeps the SELECT queries internal.  One such variation that&#8217;s been around since 2002 is here:  <a href="http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm" rel="nofollow">http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm</a></p>
<p>
Again, great post!  You definitely should have milked this for a full series of postings.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=487#respond' onclick='return addComment.moveForm( "div-comment-487", "487", "respond", "241" )' aria-label='Reply to mamlin'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-483">
				<div id="div-comment-483" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/56536c33760bcd75b7c0841f8b279965?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/56536c33760bcd75b7c0841f8b279965?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Andrew</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-483">
			August 6, 2009 at 9:00 am</a>		</div>

		<p>You can also strip the time off a date by:</p>
<p>CAST(CONVERT(CHAR(10),DateColumn,101) AS DATETIME))</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=483#respond' onclick='return addComment.moveForm( "div-comment-483", "483", "respond", "241" )' aria-label='Reply to Andrew'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-492">
				<div id="div-comment-492" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e6f2aab89155ccc6ffa00add56484fce?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e6f2aab89155ccc6ffa00add56484fce?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">lakshmi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-492">
			September 3, 2009 at 10:45 am</a>		</div>

		<p>Thanks for the tips</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=492#respond' onclick='return addComment.moveForm( "div-comment-492", "492", "respond", "241" )' aria-label='Reply to lakshmi'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-482">
				<div id="div-comment-482" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/edd99ce1b8ccf59c270975544f38e895?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/edd99ce1b8ccf59c270975544f38e895?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-482">
			October 27, 2009 at 4:41 pm</a>		</div>

		<p>Great page, very helpful. Just one thing re your comment about cursors&#8230;.</p>
<p>I have a similar situation and have resolved the issue by creating an SP that just has a cursor that goes thru the Author table and concatenates all the books returning an AuthorID and a string of concatenated books.</p>
<p>In my main SP I create a table variable and populate it by calling the above SP. In my main query I JOIN the table variable and SELECT the concatenated books.</p>
<p>This has the overhead of one call to the SP with a cursor, but then removes the call to a function for each row in the main SELECT.</p>
<p>I know cursors are evil but function calls in SELECTS are a performance hit. Any thoughts much appreciated.</p>
<p>Cheers.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=482#respond' onclick='return addComment.moveForm( "div-comment-482", "482", "respond", "241" )' aria-label='Reply to Dave'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-484">
				<div id="div-comment-484" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-484">
			October 28, 2009 at 7:07 am</a>		</div>

		<p>Dave can you post DDL and sample DML and the code that you used&#8230;I would like to see the performance difference between the cursor and the set based operation.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=484#respond' onclick='return addComment.moveForm( "div-comment-484", "484", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-497">
				<div id="div-comment-497" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">BR</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-497">
			December 13, 2009 at 11:20 am</a>		</div>

		<p>This comment is related to &#8220;Search all columns in all the tables in a database for a specific value&#8221; , what happens is that when your query iterates through another schema it fails , giving the below messagwe ,though the table exists in the schema in the database.<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211; <br />
Msg 208, Level 16, State 1, Line 1<br />
Invalid object name &#8216;def&#8217;.<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;<br />
Please can you shed some light on it as it is bit important and urgent for me .<br />
Thanks</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=497#respond' onclick='return addComment.moveForm( "div-comment-497", "497", "respond", "241" )' aria-label='Reply to BR'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-498">
				<div id="div-comment-498" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-498">
			December 13, 2009 at 11:26 am</a>		</div>

		<p>BR add</p>
<p> AND C.TABLE_SCHEMA = T.TABLE_SCHEMA  </p>
<p>to the JOIN, it should look like this if you have multiple schemas</p>
<p>
SELECT  C.Table_Name, C.Column_Name, C.Data_Type<br />
    FROM    Information_Schema.Columns AS C<br />
            INNER Join Information_Schema.Tables AS T<br />
                ON C.Table_Name = T.Table_Name<br />
                AND C.TABLE_SCHEMA = T.TABLE_SCHEMA<br />
    WHERE   Table_Type = &#8216;Base Table&#8217;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=498#respond' onclick='return addComment.moveForm( "div-comment-498", "498", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-499">
				<div id="div-comment-499" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">BR</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-499">
			December 13, 2009 at 11:58 am</a>		</div>

		<p>Thanks for the catch Denis,but still its not working when executing its not able to pick up the tables from various schemas.<br />
Can you just peep in .<br />
Thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=499#respond' onclick='return addComment.moveForm( "div-comment-499", "499", "respond", "241" )' aria-label='Reply to BR'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-500">
				<div id="div-comment-500" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">BR</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-500">
			December 13, 2009 at 12:13 pm</a>		</div>

		<p>I amnot able to understand as to why this is happening . Please can anyone help me out.This is bit urgent and important.<br />
Thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=500#respond' onclick='return addComment.moveForm( "div-comment-500", "500", "respond", "241" )' aria-label='Reply to BR'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt odd alt thread-odd thread-alt depth-1" id="comment-501">
				<div id="div-comment-501" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-501">
			December 14, 2009 at 6:24 am</a>		</div>

		<p>Hi BR,</p>
<p>I took the email addresses out of your last comment to protect them.  Can you bring your question over to the forums in the SQL Programming section @ <a href="http://forum.lessthandot.com/viewforum.php?f=17" rel="nofollow">http://forum.lessthandot.com/viewforum.php?f=17</a></p>
<p>Thanks</p>
<p>onpnt</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=501#respond' onclick='return addComment.moveForm( "div-comment-501", "501", "respond", "241" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-504">
				<div id="div-comment-504" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Roadies99</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-504">
			December 15, 2009 at 12:08 pm</a>		</div>

		<p>Please can anyone helpme out on my issue.<br />
Also have raised it acros the forum too.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=504#respond' onclick='return addComment.moveForm( "div-comment-504", "504", "respond", "241" )' aria-label='Reply to Roadies99'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-505">
				<div id="div-comment-505" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3d1e2e6b4ae95cf987b90538d157477f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Roadies99</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-505">
			December 15, 2009 at 12:37 pm</a>		</div>

		<p>&#8220;Thanks&#8221; to each and everyone involved in helping me out to resolve the issue.<br />
Only one request if someone and update the stored procedure on the site as it has modifications coming after its failure to run on multiple schemas.<br />
Thanks a lot.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=505#respond' onclick='return addComment.moveForm( "div-comment-505", "505", "respond", "241" )' aria-label='Reply to Roadies99'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-507">
				<div id="div-comment-507" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-507">
			December 15, 2009 at 12:37 pm</a>		</div>

		<p>I updated this post to handle schemas in 2005 and up</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=507#respond' onclick='return addComment.moveForm( "div-comment-507", "507", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-479">
				<div id="div-comment-479" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1dd22e51a2ad2b496ccb21b9542feefe?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1dd22e51a2ad2b496ccb21b9542feefe?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Shiv</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-479">
			January 29, 2010 at 6:23 am</a>		</div>

		<p>hi i want the query or script how to search  and replace all the the columns in a table and reaplace??</p>
<p>Any idea i go through some link but they didnt mention clearly how to search and replace for the single table , even i tried it shows some error<br />
 ?</p>
<p>Msg 217, Level 16, State 1, Procedure SearchAndReplace2, Line 63<br />
Maximum stored procedure, function, trigger, or view nesting level exceeded (limit 32).</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=479#respond' onclick='return addComment.moveForm( "div-comment-479", "479", "respond", "241" )' aria-label='Reply to Shiv'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-485">
				<div id="div-comment-485" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f2dda785dc002da652828af00b03f909?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f2dda785dc002da652828af00b03f909?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">bhami</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-485">
			June 30, 2010 at 3:22 am</a>		</div>

		<p>Excellent&#8230;.it hrlped me well while searing for a value in all the columns.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=485#respond' onclick='return addComment.moveForm( "div-comment-485", "485", "respond", "241" )' aria-label='Reply to bhami'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-489">
				<div id="div-comment-489" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-489">
			October 14, 2010 at 7:27 am</a>		</div>

		<p>For the number 3 how do you perform splitting if you need to split a column of comma-delimited values in SQL 2000 where CROSS APPLY is not available?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=489#respond' onclick='return addComment.moveForm( "div-comment-489", "489", "respond", "241" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-490">
				<div id="div-comment-490" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-490">
			October 14, 2010 at 7:36 am</a>		</div>

		<blockquote><p>For the number 3 how do you perform splitting if you need to split a column of comma-delimited values in SQL 2000 where CROSS APPLY is not available?</p></blockquote>
<p>What do you mean, where do you see CROSS APPLY being used here? I have used this code in SQL 2000 since at least 2003 and never had a problem</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=490#respond' onclick='return addComment.moveForm( "div-comment-490", "490", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-491">
				<div id="div-comment-491" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-491">
			October 14, 2010 at 7:41 am</a>		</div>

		<p>I mean, if you have a table with this structure:</p>
<p>Id Items<br />
1  Item1, Item2<br />
2  Item2, Item5, Item7</p>
<p>and you need to change it to</p>
<p>1  Item1<br />
1  Item2</p>
<p>etc.</p>
<p>how would you do this in SQL 2000 ?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=491#respond' onclick='return addComment.moveForm( "div-comment-491", "491", "respond", "241" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-493">
				<div id="div-comment-493" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-493">
			October 14, 2010 at 9:18 am</a>		</div>

		<p>example</p>
<p>
<codeblock lang="" line="1">create table #temp(id int, col varchar(20))<br />
insert #temp values (1,&#8217;1,2&#8242;)<br />
insert #temp values (2,&#8217;3,4&#8242;)<br />
insert #temp values (3,&#8217;4,5,6,7&#8242;)</p>
<p>select * from #temp t<br />
join( SELECT id,SUBSTRING(&#8216;,&#8217; + col + &#8216;,&#8217;, Number + 1,<br />
    CHARINDEX(&#8216;,&#8217;, &#8216;,&#8217; + col + &#8216;,&#8217;, Number + 1) &#8211; Number -1)AS VALUE<br />
    FROM master..spt_values<br />
    cross join #temp <br />
    where type = &#8216;P&#8217;<br />
    and Number &lt;= LEN(&#8216;,&#8217; + col + &#8216;,&#8217;) &#8211; 1<br />
    AND SUBSTRING(&#8216;,&#8217; + col + &#8216;,&#8217;, Number, 1) = &#8216;,&#8217;<br />
    ) x on x.id = t.id<br /></codeblock></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=493#respond' onclick='return addComment.moveForm( "div-comment-493", "493", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-494">
				<div id="div-comment-494" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-494">
			October 14, 2010 at 9:50 am</a>		</div>

		<p>Thanks &#8211; BTW, I don&#8217;t think you need an extra JOIN.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=494#respond' onclick='return addComment.moveForm( "div-comment-494", "494", "respond", "241" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-495">
				<div id="div-comment-495" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-495">
			October 14, 2010 at 9:52 am</a>		</div>

		<p>That is correct, this will also work</p>
<p>SELECT #temp.*,SUBSTRING(&#8216;,&#8217; + col + &#8216;,&#8217;, Number + 1,<br />
    CHARINDEX(&#8216;,&#8217;, &#8216;,&#8217; + col + &#8216;,&#8217;, Number + 1) &#8211; Number -1)AS VALUE<br />
    FROM master..spt_values<br />
    cross join #temp <br />
    where type = &#8216;P&#8217;<br />
    and Number &lt;= LEN(&#8216;,&#8217; + col + &#8216;,&#8217;) &#8211; 1<br />
    AND SUBSTRING(&#8216;,&#8217; + col + &#8216;,&#8217;, Number, 1) = &#8216;,&#8217;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=495#respond' onclick='return addComment.moveForm( "div-comment-495", "495", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-523">
				<div id="div-comment-523" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/99f61c6276daa00f354964d8dea786da?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/99f61c6276daa00f354964d8dea786da?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">JCosler</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-523">
			December 22, 2010 at 10:25 am</a>		</div>

		<p>Thanks for #4 &#8211; EXCEPT.   Very clean solution and easy to quickly reverse to test table to table.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=523#respond' onclick='return addComment.moveForm( "div-comment-523", "523", "respond", "241" )' aria-label='Reply to JCosler'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-emtucifor even thread-even depth-1" id="comment-508">
				<div id="div-comment-508" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-508">
			June 1, 2011 at 11:24 am</a>		</div>

		<p>For Jane, Andy, and others: In my mind, using conversion to float to remove the time from a date is problematic because round-trip conversions (back to datetime) are not reliable. Since using DateDiff is even faster than converting to float, there&#8217;s no reason to use float at all.</p>
<p>Please see <a href="http://stackoverflow.com/questions/2775/whats-the-best-way-to-remove-the-time-portion-of-a-datetime-value-sql-server/3696991#3696991">Best way to remove the time portion of a datetime</a></p>
<p>And for Denis: The method given to remove leading zeroes returns the wrong answer when the value is a single &#8216;0&#8217; and the value should be treated as a number:</p>
<p>SELECT REPLACE(LTRIM(REPLACE(&#8216;0&#8217;, &#8216;0&#8217;, &#8216; &#8216;)), &#8216; &#8216;, &#8216;0&#8217;)<br />
FROM testpadding</p>
<p>I suspect you already know this, though. 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=508#respond' onclick='return addComment.moveForm( "div-comment-508", "508", "respond", "241" )' aria-label='Reply to Erik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-509">
				<div id="div-comment-509" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-509">
			June 1, 2011 at 11:35 am</a>		</div>

		<p>Erik, I guess a case expression would be needed in that case to see if it is only 000&#8230;which is of course not hard to do</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=509#respond' onclick='return addComment.moveForm( "div-comment-509", "509", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-even depth-1" id="comment-510">
				<div id="div-comment-510" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-510">
			June 1, 2011 at 12:00 pm</a>		</div>

		<p>Erik,</p>
<p>For question 9 you may also want to check the alternative solution presented in WiKi article<br />
<a href="http://wiki.lessthandot.com/index.php/Trim_Leading_Zeroes">Trim Leading Zeroes</a></p>
<p>May be Denis can provide a link as well.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=510#respond' onclick='return addComment.moveForm( "div-comment-510", "510", "respond", "241" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-481">
				<div id="div-comment-481" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/374c4f54f7c1c4727969599d5bc83ecb?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/374c4f54f7c1c4727969599d5bc83ecb?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.itguy.gr/' rel='external nofollow' class='url'>Andreas</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-481">
			June 11, 2011 at 6:41 am</a>		</div>

		<p>What an absolutely brilliant piece of work!!!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=481#respond' onclick='return addComment.moveForm( "div-comment-481", "481", "respond", "241" )' aria-label='Reply to Andreas'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-518">
				<div id="div-comment-518" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5571d5e8246fe7a003c1bbcc717d12d6?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5571d5e8246fe7a003c1bbcc717d12d6?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.geekblogger.org/' rel='external nofollow' class='url'>Geek Blogger</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-518">
			July 27, 2011 at 9:12 am</a>		</div>

		<p>@Denis, Great post, i was looking for the item 2 (Search all columns in all the tables in a database for a specific value) but when i tried to execute SP to find String value i got below error.</p>
<p>[The module &#8216;FindMyData_String&#8217; depends on the missing object &#8216;SP_EXECUTESQL&#8217;. The module will still be created; however, it cannot run successfully until the object exists.] </p>
<p>Can you please guide me how to resolve this issue so that i can execute it successfully and find the string without any error.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=518#respond' onclick='return addComment.moveForm( "div-comment-518", "518", "respond", "241" )' aria-label='Reply to Geek Blogger'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-520">
				<div id="div-comment-520" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-520">
			July 27, 2011 at 9:42 am</a>		</div>

		<p>The formatter we use on this site makes all keywords uppercase and will also do it with extended procedures</p>
<p>Can you try lowercase, instead of SP_EXECUTESQL use sp_executesql, maybe your database collation is case sensitive?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=520#respond' onclick='return addComment.moveForm( "div-comment-520", "520", "respond", "241" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-even depth-1" id="comment-521">
				<div id="div-comment-521" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-521">
			July 27, 2011 at 10:17 am</a>		</div>

		<p>Hi Geek Blogger,</p>
<p>Also you may try an alternative solution (although similar idea):</p>
<p><a href="http://beyondrelational.com/blogs/naomi/archive/2010/10/29/how-to-search-a-string-value-in-all-columns-in-the-table-and-in-all-tables-in-the-database.aspx">How to search a string value in all columns in the table</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=521#respond' onclick='return addComment.moveForm( "div-comment-521", "521", "respond", "241" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-486">
				<div id="div-comment-486" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9cf6374a7c73e6726dfba8831b61545a?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9cf6374a7c73e6726dfba8831b61545a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Scott</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-486">
			August 19, 2011 at 2:36 pm</a>		</div>

		<p>Thanks so very much for this post. I am an Oracle PL/SQL developer now working with SQL Server 2008 and this post had exactly what I was looking to do with searching every column in every table (Number 2) and it works perfectly in SQL Server 2008. I love the fact you allow for exact or like matching. And the other questions I am sure I will need to look at later.</p>
<p>Scott</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=486#respond' onclick='return addComment.moveForm( "div-comment-486", "486", "respond", "241" )' aria-label='Reply to Scott'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-496">
				<div id="div-comment-496" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/15c5152f1fc79771277fab85fe5a0dd7?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/15c5152f1fc79771277fab85fe5a0dd7?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Shri</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-496">
			February 2, 2012 at 7:27 pm</a>		</div>

		<p>The procedure for &#8216;Search all columns in all the tables in a database for a specific value&#8217; helped me a lot. Thank you so much</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=496#respond' onclick='return addComment.moveForm( "div-comment-496", "496", "respond", "241" )' aria-label='Reply to Shri'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-503">
				<div id="div-comment-503" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0bfd7ea1f9ae4ba4930494fba1defc89?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0bfd7ea1f9ae4ba4930494fba1defc89?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">matheusfilipe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-503">
			September 11, 2012 at 3:07 pm</a>		</div>

		<p>Man, that tips save my life!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=503#respond' onclick='return addComment.moveForm( "div-comment-503", "503", "respond", "241" )' aria-label='Reply to matheusfilipe'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-502">
				<div id="div-comment-502" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7f2edbdbf195af9449d398db3169e529?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7f2edbdbf195af9449d398db3169e529?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://fullparam.wordpress.com/' rel='external nofollow' class='url'>Reto Egeter</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-502">
			November 27, 2012 at 8:57 am</a>		</div>

		<p>I&#8217;ve revisited the topic of &#8220;Search All Tables&#8221; and added some bells and whistles (Also search XML) &#8211; and it&#8217;s not in a stored procedure format:<br />
<a href="http://fullparam.wordpress.com/2012/09/07/fck-it-i-am-going-to-search-all-tables-all-collumns/" rel="nofollow">http://fullparam.wordpress.com/2012/09/07/fck-it-i-am-going-to-search-all-tables-all-collumns/</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=502#respond' onclick='return addComment.moveForm( "div-comment-502", "502", "respond", "241" )' aria-label='Reply to Reto Egeter'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-506">
				<div id="div-comment-506" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3b34649e23fae13f9cb0d8abc117b154?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3b34649e23fae13f9cb0d8abc117b154?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">pari</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-506">
			November 4, 2013 at 5:02 am</a>		</div>

		<p>How can I create a procedure that will search word by word from a string and return the entire row if a word is found???<br />
How to modify the procedure?<br />
Help Please.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=506#respond' onclick='return addComment.moveForm( "div-comment-506", "506", "respond", "241" )' aria-label='Reply to pari'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback even thread-even depth-1" id="comment-20891">
				<div id="div-comment-20891" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.myoutermonologue.co.uk/blog/for-the-perfectionist-correcting-the-case-of-server-names-in-the-configmgr-2012-console/' rel='external nofollow' class='url'>For The Perfectionist: Correcting the Case of Server Names in the ConfigMgr 2012 Console. - My Outer Monologue - Tech blog and brain dump of Tom Waller</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-20891">
			January 15, 2014 at 4:50 am</a>		</div>

		<p>[&#8230;] running a brief trace in SQL Server, and with the help of this FindMyData_String Stored Procedure, I was able to track the relevant text in the SQL database and adjust [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=20891#respond' onclick='return addComment.moveForm( "div-comment-20891", "20891", "respond", "241" )' aria-label='Reply to For The Perfectionist: Correcting the Case of Server Names in the ConfigMgr 2012 Console. - My Outer Monologue - Tech blog and brain dump of Tom Waller'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-62672">
				<div id="div-comment-62672" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/485070f6d1853bb34be36b545f1fac35?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/485070f6d1853bb34be36b545f1fac35?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Shoeb</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-62672">
			January 23, 2014 at 6:34 am</a>		</div>

		<p>This is the post of a lifetime&#8230;&#8230;&#8230;..Thanks for sharing.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=62672#respond' onclick='return addComment.moveForm( "div-comment-62672", "62672", "respond", "241" )' aria-label='Reply to Shoeb'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1047860">
				<div id="div-comment-1047860" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5e427a42058dbe80a24345482b0de212?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5e427a42058dbe80a24345482b0de212?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">randomPasserBy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-1047860">
			June 4, 2014 at 9:26 pm</a>		</div>

		<p>Appreciated The Scripts Very Much </p>
<p>In the script which searches all text columns in a database for a string &#8230; it would be worth filtering the original database column selections not only for text columns, but for text columns as long or longer than the text searched for &#8230; i.e. no point searching for the word &#8216;blind&#8217; in a column varchar(3)</p>
<p>thanks again</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=1047860#respond' onclick='return addComment.moveForm( "div-comment-1047860", "1047860", "respond", "241" )' aria-label='Reply to randomPasserBy'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1274530">
				<div id="div-comment-1274530" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/01d59a6317c34d328e7f4a2d830d8057?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/01d59a6317c34d328e7f4a2d830d8057?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Sanjeev</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-1274530">
			June 27, 2014 at 12:31 pm</a>		</div>

		<p>Awesome post Dennis, appreciate your effort</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=1274530#respond' onclick='return addComment.moveForm( "div-comment-1274530", "1274530", "respond", "241" )' aria-label='Reply to Sanjeev'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback even thread-even depth-1" id="comment-2852819">
				<div id="div-comment-2852819" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://blog.xperienciaweb.com/?p=237' rel='external nofollow' class='url'>Less Than Dot &#8211; Blog &#8211; The Ten Most Asked SQL Server Questions And Their Answers - XperienciaWeb</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-2852819">
			November 27, 2014 at 1:14 pm</a>		</div>

		<p>[&#8230;] vía Less Than Dot &#8211; Blog &#8211; The Ten Most Asked SQL Server Questions And Their Answers. [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=2852819#respond' onclick='return addComment.moveForm( "div-comment-2852819", "2852819", "respond", "241" )' aria-label='Reply to Less Than Dot &#8211; Blog &#8211; The Ten Most Asked SQL Server Questions And Their Answers - XperienciaWeb'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-5903078">
				<div id="div-comment-5903078" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://exceptionshub.com/mysql-delete-all-rows-containing-string-foo-in-table-bar.html' rel='external nofollow' class='url'>MYSQL: delete all rows containing string &ldquo;foo&rdquo; in table &ldquo;bar&rdquo; - ExceptionsHub</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/#comment-5903078">
			November 23, 2017 at 8:01 am</a>		</div>

		<p>[&#8230;] <a href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions&#038;#&#038;#8230" rel="nofollow">/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions&#038;#&#038;#8230</a>; [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/the-ten-most-asked-sql-server-questions-1/?replytocom=5903078#respond' onclick='return addComment.moveForm( "div-comment-5903078", "5903078", "respond", "241" )' aria-label='Reply to MYSQL: delete all rows containing string &ldquo;foo&rdquo; in table &ldquo;bar&rdquo; - ExceptionsHub'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/DataMgmt/DataDesign/the-ten-most-asked-sql-server-questions--1/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='241' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="149e9677a5989fd342ae44213df68868"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552766981"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
