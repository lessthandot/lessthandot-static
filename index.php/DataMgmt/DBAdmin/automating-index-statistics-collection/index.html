<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Automating Index Statistics Collection</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Automating Index Statistics Collection" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Undeniably, the largest impact a database administrator can have on a database server’s performance is with indexing.  One index can mean the difference between a 30 minute overall time of execution or a few seconds overall time of execution.  At the sa&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<link rel="canonical" href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/" />	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Automating Index Statistics Collection Comments Feed" href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Cheatsheet: Relational Database Management Systems Comparison' href='/index.php/datamgmt/datadesign/a-comparison-of-relational-database/' />
<link rel='next' title='Madison SQL Server User Group' href='/index.php/datamgmt/dbadmin/mssqlserveradmin/madison-sql-server-user-group/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/" />
<link rel='shortlink' href='/?p=1506' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fautomating-index-statistics-collection%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fautomating-index-statistics-collection%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/DataMgmt/DBAdmin/automating-index-statistics-collection/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbadmin/mssqlserveradmin/madison-sql-server-user-group/" rel="next">Madison SQL Server User Group</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/datamgmt/datadesign/a-comparison-of-relational-database/" rel="prev">Cheatsheet: Relational Database Management Systems Comparison</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/" class="post-title">Automating Index Statistics Collection</a></h1>
					<div class="post-byline">by <a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)" rel="author">Ted Krueger (onpnt)</a> on January 25, 2012 in category <a href="/index.php/category/datamgmt/dbadmin/" rel="category tag">Database Administration</a> <a href="/index.php/category/datamgmt/dbprogramming/" rel="category tag">Database Programming</a> <a href="/index.php/category/datamgmt/dbadmin/mssqlserveradmin/" rel="category tag">Microsoft SQL Server Admin</a>. Article views: 9,730 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&text=RT @LessThanDot Blog - Automating Index Statistics Collection by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&title=Automating Index Statistics Collection&source=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&title=Automating Index Statistics Collection" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&quote=Automating Index Statistics Collection" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&title=Automating Index Statistics Collection" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>Undeniably, the largest impact a database administrator can have on a database server’s performance is with indexing.  One index can mean the difference between a 30 minute overall time of execution or a few seconds overall time of execution.  At the same time, indexing can have a negative impact on overall database server performance.  This negative impact can be from too many indexes, overlapping indexes, or indexes that are not defined correctly.</p>
<p>Jason Strate (<a href="http://www.jasonstrate.com/">Blog</a> | <a href="https://twitter.com/#%21/stratesql">Twitter</a>) has written an <a href="http://www.jasonstrate.com/2010/11/return-of-the-index-analysis-report/">index analysis script</a> that can assist in showing statistics for all types of index-related topics including missing indexes, foreign key indexing, alignment of indexes, and overall performance of an index.  To further the value of this script Jason has developed, we can automate the use of the script by utilizing SQL Server Integration Services to execute the script and export the results to a file that can be later analyzed.  This gives us analysis over time, proactive analysis on a database that may change often for query needs and retention of performance impacts from that analysis for later review.</p>
<p><strong>Designing an SSIS Package</strong></p>
<p>The design of the SSIS package that will use Jason’s script involves utilizing dynamic features and methods.  This dynamic nature of the package will allow for the script to be executed on several SQL Server Instances and several databases that are located on each of those instances.</p>
<p><strong>The Design</strong></p>
<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-102.png?mtime=1327420570"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-102.png?mtime=1327420570" width="495" height="320" /></a></div>
</p>
<p>The SSIS package will first use an external file that will have a list of all the servers to collect the index statistics from.   In the first process, the file will be read and a data table used to populate the list into a variable of an object data type.  This method is commonly referred to in SSIS as Shredding Variables.</p>
<p>Once the variable is loaded with the list of servers from the file in a table format, a Foreach Loop Container is utilized to perform the actual shredding task.  For each row in the table contained in the variable, the internal processing will occur.</p>
<p>The internal processing of the Foreach Loop will consist of an Execute T-SQL Task to execute Jason’s script based on the instance the Foreach Loop is focused on (or indexed currently), which will pass the results to another Foreach Loop Container that will process each row returned and insert the row into a flat file destination.</p>
<p><strong>The SSIS Control Flow</strong></p>
<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-103.png?mtime=1327420570"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-103.png?mtime=1327420570" width="624" height="136" /></a></div>
</p>
<p>With this design and method used, there are a few bottlenecks that appear.  Later we will look at these bottlenecks and put another design together that will allow a higher scalable SSIS package and a direct data flow.  The design above has many methods that are valuable and will be shown.</p>
<p><strong>Shredding Variables</strong></p>
<p>With SSIS, configurations can be used to allow a package to become more dynamic with the SQL Server Instance it uses and databases in those instances it connects directly to.  In some cases, multiple instances are needed in a situation where the package should iterate through each instance and perform the same task on each instance.  To do this, flat files are often a stable and easy solution for other database administrators to implement and alter.</p>
<p>The flat file connection used in this package connects to a text file containing a list of SQL Server Instances formatted as follows.</p>
<p>ONPNTRC0</p>
<p>ONPNTRC0_Mirror</p>
<p>ONPNT</p>
<p>In order to utilize this file and the list, the first task in the package is a script task.  This script task opens the file, reads the contents and populates a data table with them.  This data table is then set to a variable that is an object type.  The code in the demonstration to do this is shown below.</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="de1"><pre class="de1"><span class="kw1">try</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="kw4">string</span> Serverlisting<span class="sy0">;</span>
&nbsp; &nbsp; DataTable dt <span class="sy0">=</span> <span class="kw3">new</span> DataTable<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; dt<span class="sy0">.</span><span class="me1">Columns</span><span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span><span class="st0">&quot;Server&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
&nbsp; &nbsp; Serverlisting <span class="sy0">=</span> <span class="br0">&#40;</span>Dts<span class="sy0">.</span><span class="me1">Connections</span><span class="br0">&#91;</span><span class="st0">&quot;ServerList&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">AcquireConnection</span><span class="br0">&#40;</span>Dts<span class="sy0">.</span><span class="me1">Transaction</span><span class="br0">&#41;</span> <span class="kw1">as</span> <span class="kw4">String</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">using</span> <span class="br0">&#40;</span><span class="kw5">System.<span class="me1">IO</span></span><span class="sy0">.</span><span class="me1">StreamReader</span> sr <span class="sy0">=</span> <span class="kw3">new</span> <span class="kw5">System.<span class="me1">IO</span></span><span class="sy0">.</span><span class="me1">StreamReader</span><span class="br0">&#40;</span>Serverlisting<span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">string</span> line<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">while</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>line <span class="sy0">=</span> sr<span class="sy0">.</span><span class="me1">ReadLine</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">!=</span> <span class="kw1">null</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DataRow newRow <span class="sy0">=</span> dt<span class="sy0">.</span><span class="me1">NewRow</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; newRow<span class="br0">&#91;</span><span class="st0">&quot;Server&quot;</span><span class="br0">&#93;</span> <span class="sy0">=</span> line<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dt<span class="sy0">.</span><span class="me1">Rows</span><span class="sy0">.</span><span class="kw1">Add</span><span class="br0">&#40;</span>newRow<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; Dts<span class="sy0">.</span><span class="me1">Variables</span><span class="br0">&#91;</span><span class="st0">&quot;ServerListing&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span> <span class="sy0">=</span> dt<span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="kw1">catch</span> <span class="br0">&#40;</span>Exception ex<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp; &nbsp; MessageBox<span class="sy0">.</span><span class="me1">Show</span><span class="br0">&#40;</span>ex<span class="sy0">.</span><span class="me1">Message</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
Dts<span class="sy0">.</span><span class="me1">TaskResult</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">int</span><span class="br0">&#41;</span>ScriptResults<span class="sy0">.</span><span class="me1">Success</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">try
{
    string Serverlisting;
    DataTable dt = new DataTable();
    dt.Columns.Add("Server");

    Serverlisting = (Dts.Connections["ServerList"].AcquireConnection(Dts.Transaction) as String);

    using (System.IO.StreamReader sr = new System.IO.StreamReader(Serverlisting))
    {
        string line;
        while ((line = sr.ReadLine()) != null)
        {
            DataRow newRow = dt.NewRow();
            newRow["Server"] = line.ToString();
            dt.Rows.Add(newRow);
        }
    }
    Dts.Variables["ServerListing"].Value = dt;
}
catch (Exception ex)
{
    MessageBox.Show(ex.Message.ToString());
}
            
Dts.TaskResult = (int)ScriptResults.Success;
}</pre></div></div>

</p>
<p>To complete the shredding of the variable process, a Foreach Loop Container is used with an enumerator, Foreach ADO Enumerator.  This is the same method of parsing record sets used in past years with scripting languages.   Once the Foreach ADO Enumerator is set, the ADO object source variable option is made available.  Select the variable to be read in this drop down list.  The last major configuration is to set one or more variables that will be populated by the enumeration of each row in the object variable.  In the case of the container that will read the server list, only one column per row is available.  So only one variable mapping is required.</p>
<p> </p>
<p>For a detailed article on shredding variables, read “<a href="http://josef-richberg.squarespace.com/journal/2010/11/12/ssis-using-variables-as-a-source-in-a-data-flow-component.html">Using Variables as a source in a Data Flow Component</a>” by Josef Richberg (<a href="http://josef-richberg.squarespace.com/">Blog</a> | <a href="http://www.twitter.com/sqlrunner">Twitter</a>).</p>
<p> </p>
<p><strong>Data Flow</strong></p>
<p>With the method and designs we have chosen to do this SSIS package, the data flow that will read the data and export to the file, will need to utilize a script component as the source.  The script component as a source in a data flow task allows us to perform several code specific transformations, such aslogic or even data extraction.  Earlier we shredded the secondary object variable into several matching variables.  Those variables are now required to be the source in an output format.  This output format is then passed to the destination.  Before being able to set the variables as output values, the output columns need to be defined.  For each variable, or column that is needed as an output column, the column needs to be defined in the Inputs and Outputs page of the script transformation editor.</p>
<p>Using the Add Column button, add a column into the Output Columns for each matching variable that was created and populated from the Foreach Loop over the object variable.</p>
<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-104.png?mtime=1327420570"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-104.png?mtime=1327420570" width="624" height="485" /></a></div>
</p>
<p>Remember to ensure the length and data types of these columns are accurate.  Lengths that are too small can cause truncation errors and lengths that are too large can cause unwanted performance problems.  In some cases, data types can be explicitly converted at the time of the buffer moving in the data flow, but this value should match to ensure no performance problems or errors on casting the data types occur.  Remember, casting from unicode to non-unicode will always generate an error.  In flat file and many systems or other data sources, Unicode will be the default.</p>
<p> </p>
<p>After the output columns are defined, the next step is to add the variables as write available variables to the script component and then add the code needed to move the variables to the output columns or output buffer.</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre></td><td class="de1"><pre class="de1">IDTSVariables100 <span class="kw1">var</span> <span class="sy0">=</span> <span class="kw1">null</span><span class="sy0">;</span>
&nbsp;
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::buffer_mb&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::duplicate_indexes&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::has_unique&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::index_action&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::index_name&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::indexed_columns&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::is_unique&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::object_name&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::overlapping_indexes&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::pct_in_buffer&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::related_foreign_keys&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::related_foreign_keys_xml&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::row_block_pct&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::row_count&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::size_in_mb&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::table_buffer_mb&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::type_desc&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::user_lookups&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::user_scans&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::user_seeks&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::user_total_pct&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">LockForWrite</span><span class="br0">&#40;</span><span class="st0">&quot;User::included_columns&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
VariableDispenser<span class="sy0">.</span><span class="me1">GetVariables</span><span class="br0">&#40;</span><span class="kw1">out</span> <span class="kw1">var</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
Output0Buffer<span class="sy0">.</span><span class="me1">AddRow</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
Output0Buffer<span class="sy0">.</span><span class="me1">buffermb</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::buffer_mb&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">duplicateindexes</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::duplicate_indexes&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">hasunique</span> <span class="sy0">=</span> <span class="br0">&#40;</span>Int32<span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::has_unique&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">indexaction</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::index_action&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">indexname</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::index_name&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">indexedcolumns</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::indexed_columns&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">isunique</span> <span class="sy0">=</span> <span class="br0">&#40;</span>Int32<span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::is_unique&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">objectname</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::object_name&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">overlappingindexes</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::overlapping_indexes&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">pctinbuffer</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::pct_in_buffer&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">relatedforeignkeys</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::related_foreign_keys&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">relatedforeignkeysxml</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::related_foreign_keys_xml&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">rowblockpct</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::row_block_pct&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">rowcount</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::row_count&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">sizeinmb</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::size_in_mb&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">tablebuffermb</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::table_buffer_mb&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">typedesc</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::type_desc&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">userlookups</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::user_lookups&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">userscans</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::user_scans&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">userseeks</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::user_seeks&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">usertotalpct</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::user_total_pct&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">includedcolumns</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw4">String</span><span class="br0">&#41;</span><span class="kw1">var</span><span class="br0">&#91;</span><span class="st0">&quot;User::included_columns&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">var</span><span class="sy0">.</span><span class="me1">Unlock</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
Output0Buffer<span class="sy0">.</span><span class="me1">SetEndOfRowset</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">IDTSVariables100 var = null;

VariableDispenser.LockForWrite("User::buffer_mb");
VariableDispenser.LockForWrite("User::duplicate_indexes");
VariableDispenser.LockForWrite("User::has_unique");
VariableDispenser.LockForWrite("User::index_action");
VariableDispenser.LockForWrite("User::index_name");
VariableDispenser.LockForWrite("User::indexed_columns");
VariableDispenser.LockForWrite("User::is_unique");
VariableDispenser.LockForWrite("User::object_name");
VariableDispenser.LockForWrite("User::overlapping_indexes");
VariableDispenser.LockForWrite("User::pct_in_buffer");
VariableDispenser.LockForWrite("User::related_foreign_keys");
VariableDispenser.LockForWrite("User::related_foreign_keys_xml");
VariableDispenser.LockForWrite("User::row_block_pct");
VariableDispenser.LockForWrite("User::row_count");
VariableDispenser.LockForWrite("User::size_in_mb");
VariableDispenser.LockForWrite("User::table_buffer_mb");
VariableDispenser.LockForWrite("User::type_desc");
VariableDispenser.LockForWrite("User::user_lookups");
VariableDispenser.LockForWrite("User::user_scans");
VariableDispenser.LockForWrite("User::user_seeks");
VariableDispenser.LockForWrite("User::user_total_pct");
VariableDispenser.LockForWrite("User::included_columns");
VariableDispenser.GetVariables(out var);

Output0Buffer.AddRow();

Output0Buffer.buffermb = (String)var["User::buffer_mb"].Value;
Output0Buffer.duplicateindexes = (String)var["User::duplicate_indexes"].Value;
Output0Buffer.hasunique = (Int32)var["User::has_unique"].Value;
Output0Buffer.indexaction = (String)var["User::index_action"].Value;
Output0Buffer.indexname = (String)var["User::index_name"].Value;
Output0Buffer.indexedcolumns = (String)var["User::indexed_columns"].Value;
Output0Buffer.isunique = (Int32)var["User::is_unique"].Value;
Output0Buffer.objectname = (String)var["User::object_name"].Value;
Output0Buffer.overlappingindexes = (String)var["User::overlapping_indexes"].Value;
Output0Buffer.pctinbuffer = (String)var["User::pct_in_buffer"].Value;
Output0Buffer.relatedforeignkeys = (String)var["User::related_foreign_keys"].Value;
Output0Buffer.relatedforeignkeysxml = (String)var["User::related_foreign_keys_xml"].Value;
Output0Buffer.rowblockpct = (String)var["User::row_block_pct"].Value;
Output0Buffer.rowcount = (String)var["User::row_count"].Value;
Output0Buffer.sizeinmb = (String)var["User::size_in_mb"].Value;
Output0Buffer.tablebuffermb = (String)var["User::table_buffer_mb"].Value;
Output0Buffer.typedesc = (String)var["User::type_desc"].Value;
Output0Buffer.userlookups = (String)var["User::user_lookups"].Value;
Output0Buffer.userscans = (String)var["User::user_scans"].Value;
Output0Buffer.userseeks = (String)var["User::user_seeks"].Value;
Output0Buffer.usertotalpct = (String)var["User::user_total_pct"].Value;
Output0Buffer.includedcolumns = (String)var["User::included_columns"].Value;

var.Unlock();
Output0Buffer.SetEndOfRowset();</pre></div></div>

</p>
<p>The code above locks all the variables and then assigns them accordingly to the output buffer columns.  One completed, the variables are unlocked and the row is sent through.</p>
<p> </p>
<p>At this point, mapping the output columns to the flat file destination columns is all that is needed.</p>
<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-105.png?mtime=1327420570"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-105.png?mtime=1327420570" width="650" height="472" /></a></div>
</p>
<p><strong>Configuration File</strong></p>
<p>Add a configuration file to the package to complete the dynamic and mobile setup of the package.  The configuration file will take the server list and database list file names.  It should also contain a default database, in most cases master, for administrative operations.</p>
<p> </p>
<p>For detailed information on using and setting up configuration files, refer to “<a href="/index.php/DataMgmt/DBAdmin/making-ssis-dynamic-configuration-manage">Making SSIS Dynamic: Configuration Management</a>”</p>
<p> </p>
<p><strong>Execution</strong></p>
<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-106.png?mtime=1327420570"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-106.png?mtime=1327420570" width="624" height="123" /></a></div>
</p>
<p>This package runs well and performed the exact task that was required of it.  The shredding of the object variables completed, the output buffer created for each row and loaded into the file destination.  The files were also created for each task that we wanted based on each SQL Server Instance.</p>
<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-107.png?mtime=1327420777"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-107.png?mtime=1327420777" width="437" height="73" /></a></div>
</p>
<p><strong>Review and Problems with this Design</strong></p>
<p>In review, we’ve talked about how to do several things to make this package possible.</p>
<ol>
<li>Dynamic file lists for reusable package executions on several SQL Server Instances</li>
<li>Shred variables and map them to multiple variables for each column returned by using the Foreach Loop Container and the ADO Enumerator</li>
<li>Script component as sources and populating the output buffer with variables.</li>
</ol>
<p> </p>
<p>Although this design works well on databases with a lower number of indexes and databases used less frequently, the design is inherently poor on performance overall if a large database is a factor.  In the tests I made, the least utilized and smallest database resulted in a relatively quick total execution time.  Using a larger more realistic database, the total execution time suffered drastically from the design.</p>
<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-108.png?mtime=1327420777"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-108.png?mtime=1327420777" width="389" height="235" /></a></div>
</p>
<p>Based on three executions of the package for each instance set in the Server List file.</p>
<p> </p>
<p>We went through this design to show methods that could be used.  We also went through the design to show that even when coming from something that was successfully execute and results validated, the overall achievement and performance factor was poor.  Due to those factors, this package will be redesigned to better use SQL Server and the Data Flow task in SSIS.  In the next article we will build that package from scratch and show each step that is involved.</p>
<p> </p>
<p>Use this design when there is a need.  Several cases require the shredding of variables and utilizing them as a data source.  Be sure that when utilizing either a row-by-row operations or a one row in type situation, to measure your performance on all database sizes.</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection-with/'>Automating Index Statistics Collection with SSIS – The fast one</a><p>Article, Automating Index Statistics Collection, went over a method to automate running a script authored&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/variables-ssis-dynamic-parent-to-child/'>Making SSIS Dynamic: Passing variables between packages</a><p>So far, we showed how to manipulate connections so we can freely move packages from&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Ted Krueger is a SQL Server MVP and Author that has been working in development and database administration and the owner of a successful consulting business, DataMetrics Consulting.  Specialties range from High Availability and Disaster / Recovery setup and testing methods down to custom assembly development for SQL Server Reporting Services.  Ted blogs and is also one of the founders of LessThanDot.com technology community.  Some of the articles focused on are Backup / Recovery, Security, SSIS and working on SQL Server and using all of the SQL Server features available to create stable and scalable database services.  <br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/onpnt" title="onpnt at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=https://www.facebook.com/onpntfirearms" title="onpnt at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/pub/ted-krueger/2/183/b66" title="onpnt at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://www.datametricsconsulting.com/" title="onpnt at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="/index.php/author/onpnt/feed/" title="Blog RSS feed for onpnt" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 9,730 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/onpnt/">Read More Posts by Ted Krueger (onpnt)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&text=RT @LessThanDot Blog - Automating Index Statistics Collection by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&title=Automating Index Statistics Collection&source=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&title=Automating Index Statistics Collection" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&quote=Automating Index Statistics Collection" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/&title=Automating Index Statistics Collection" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		8 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-chrissie1 even thread-even depth-1" id="comment-5086">
				<div id="div-comment-5086" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/70e155e88e0ead5e2bdcb3e1c57506b4?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/70e155e88e0ead5e2bdcb3e1c57506b4?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Christiaan Baes (chrissie1)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/#comment-5086">
			January 25, 2012 at 6:39 am</a>		</div>

		<p>You might need to rethink that first C# example.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/?replytocom=5086#respond' onclick='return addComment.moveForm( "div-comment-5086", "5086", "respond", "1506" )' aria-label='Reply to Christiaan Baes (chrissie1)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-5087">
				<div id="div-comment-5087" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/#comment-5087">
			January 25, 2012 at 6:53 am</a>		</div>

		<p>I&#8217;m very open to better ways to write code I don&#8217;t get to play with often, my friend 🙂 That&#8217;s what I have you for. to show me the better light!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/?replytocom=5087#respond' onclick='return addComment.moveForm( "div-comment-5087", "5087", "respond", "1506" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-5088">
				<div id="div-comment-5088" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2aa31dd163aa21dee21d9bcf9d0c26f1?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2aa31dd163aa21dee21d9bcf9d0c26f1?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Keith Mescha</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/#comment-5088">
			January 25, 2012 at 7:02 am</a>		</div>

		<p>Ted, any reason you used a script task to read in the file of servers versus just a flat file data source control? Wondering if there is some benefit to that approach.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/?replytocom=5088#respond' onclick='return addComment.moveForm( "div-comment-5088", "5088", "respond", "1506" )' aria-label='Reply to Keith Mescha'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-5089">
				<div id="div-comment-5089" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/#comment-5089">
			January 25, 2012 at 7:12 am</a>		</div>

		<p>Hey Keith, error handling is usually the reasoning but I&#8217;m not following how you would do that with a flat file source without in an out of the pipe?  (multiple DFs and ending up still going back to the control flow to still enumerate each one)</p>
<p>Sounds interesting actually.  Off to try it out 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/?replytocom=5089#respond' onclick='return addComment.moveForm( "div-comment-5089", "5089", "respond", "1506" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor even thread-even depth-1" id="comment-5090">
				<div id="div-comment-5090" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/#comment-5090">
			January 25, 2012 at 7:15 am</a>		</div>

		<p>On a side note.  The follow up blog to this one and a MUCH better way to do this will be posted shortly.  It executes in seconds and the bottleneck or highest utilization that shows in that design is the index script itself which won&#8217;t have much tuning available.  This can all be done with an execute sql task and DF (with the same script task to dynamically hit multiple servers and databases).</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/?replytocom=5090#respond' onclick='return addComment.moveForm( "div-comment-5090", "5090", "respond", "1506" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis odd alt thread-odd thread-alt depth-1" id="comment-5091">
				<div id="div-comment-5091" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/#comment-5091">
			January 25, 2012 at 10:08 am</a>		</div>

		<p>I have a way to this in PowerShell as well</p>
<p>
here is what you need to do</p>
<p>save this as IndexAnalysis.ps1</p>
<p>###############################################<br />
Param($InstanceName,$DatabaseName)</p>
<p>Add-PSSnapin SqlServerCmdletSnapin100<br />
Add-PSSnapin SqlServerProviderSnapin100</p>
<p>$FilePath    = &#8220;C:PowerShellOutput&#8221; + $InstanceName+ &#8220;_&#8221; + $DatabaseName + &#8220;_IndexAnalysis2005.csv&#8221;</p>
<p>
Invoke-Sqlcmd -ServerInstance $InstanceName -Database $DatabaseName -Query &#8220;<br />
EXEC sp_IndexAnalysis2005&#8243; |<br />
export-csv  $FilePath   </p>
<p>###############################################</p>
<p>now call it like this, change &#8220;D:SVNPowershell&#8221; to where your path is</p>
<p>powershell.exe &#8220;D:SVNPowershellIndexAnalysis.ps1&#8221; -InstanceName LocalHost -DatabaseName SomeDatabase</p>
<p>
So then the  thing left to do is to loop over the servers and databases that you want. Stick it in a table or file and it should be pretty eay</p>
<p>Maybe I should make it into a blog post?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/?replytocom=5091#respond' onclick='return addComment.moveForm( "div-comment-5091", "5091", "respond", "1506" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor even thread-even depth-1" id="comment-5092">
				<div id="div-comment-5092" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/#comment-5092">
			January 25, 2012 at 11:47 am</a>		</div>

		<p>Absolutely make it into a blog.  I&#8217;d add scheduling it also.  Very nice and thanks!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/?replytocom=5092#respond' onclick='return addComment.moveForm( "div-comment-5092", "5092", "respond", "1506" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5085">
				<div id="div-comment-5085" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3bfaea32e36d760703ffa0627a5ef8e3?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3bfaea32e36d760703ffa0627a5ef8e3?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">bini</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/#comment-5085">
			February 28, 2012 at 1:01 pm</a>		</div>

		<p>Nice, is there any way we can download the whole package and try it out ?!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/automating-index-statistics-collection/?replytocom=5085#respond' onclick='return addComment.moveForm( "div-comment-5085", "5085", "respond", "1506" )' aria-label='Reply to bini'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/DataMgmt/DBAdmin/automating-index-statistics-collection/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1506' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="46ba9f2a6976570b0353203ec4474217"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552767188"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
