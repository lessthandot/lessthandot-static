<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="So you want to spit out some XML from SQL Server into a file, how can you do that? There are a couple of ways, I will show you how you can do it with SSIS. In the SSIS package you need an Execute SQL Task and a Script Task.Let's get startedFirst&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<link rel="canonical" href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/" />	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax Comments Feed" href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='ASP.NET MVC Release Candidate 2 Has Been Released' href='/index.php/webdev/serveradmin/msiis/asp-net-mvc-release-candidate-2-has-been/' />
<link rel='next' title='SQL Friday, The Best SQL Server Links Of The Past Week Episode 14' href='/index.php/datamgmt/datadesign/sql-friday-the-best-sql-server-links-of-14/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/" />
<link rel='shortlink' href='/?p=339' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fcreate-xml-files-out-of-sql-server-with%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fcreate-xml-files-out-of-sql-server-with%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/DataMgmt/DBProgramming/create-xml-files-out-of-sql-server-with-/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/datadesign/sql-friday-the-best-sql-server-links-of-14/" rel="next">SQL Friday, The Best SQL Server Links Of The Past Week Episode 14</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/webdev/serveradmin/msiis/asp-net-mvc-release-candidate-2-has-been/" rel="prev">ASP.NET MVC Release Candidate 2 Has Been Released</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/" class="post-title">Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax</a></h1>
					<div class="post-byline">by <a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis" rel="author">SQLDenis</a> on March 5, 2009 in category <a href="/index.php/category/datamgmt/dbprogramming/" rel="category tag">Database Programming</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 103,125 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&text=RT @LessThanDot Blog - Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&title=Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax&source=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&title=Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&quote=Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&title=Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>So you want to spit out some XML from SQL Server into a file, how can you do that? There are a couple of ways, I will show you how you can do it with SSIS. In the SSIS package you need an Execute SQL Task and a Script Task.</p>
<p>Let&#8217;s get started</p>
<p>First create and populate these two tables in your database</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="de1"><pre class="de1"><span class="kw1">create</span> <span class="kw1">table</span> Artist <span class="br0">&#40;</span>ArtistID <span class="kw1">int</span> <span class="kw1">primary</span> <span class="kw1">key</span> not null,
ArtistName <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">38</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
go
&nbsp;
<span class="kw1">create</span> <span class="kw1">table</span> Album<span class="br0">&#40;</span>AlbumID <span class="kw1">int</span> <span class="kw1">primary</span> <span class="kw1">key</span> not null,
ArtistID <span class="kw1">int</span> not null,
AlbumName <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span> not null,
YearReleased <span class="kw1">smallint</span> not null<span class="br0">&#41;</span>
go
&nbsp;
&nbsp;
<span class="kw1">insert</span> <span class="kw1">into</span> Artist <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="st0">'Pink Floyd'</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> <span class="kw1">into</span> Artist <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">2</span>,<span class="st0">'Incubus'</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> <span class="kw1">into</span> Artist <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">3</span>,<span class="st0">'Prince'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">insert</span> <span class="kw1">into</span> Album <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span>,<span class="st0">'Wish You Were Here'</span>,<span class="nu0">1975</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> <span class="kw1">into</span> Album <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">1</span>,<span class="st0">'The Wall'</span>,<span class="nu0">1979</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
&nbsp;
<span class="kw1">insert</span> <span class="kw1">into</span> Album <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">3</span>,<span class="nu0">3</span>,<span class="st0">'Purple Rain'</span>,<span class="nu0">1984</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> <span class="kw1">into</span> Album <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">4</span>,<span class="nu0">3</span>,<span class="st0">'Lotusflow3r'</span>,<span class="nu0">2009</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> <span class="kw1">into</span> Album <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">5</span>,<span class="nu0">3</span>,<span class="st0">'1999'</span>,<span class="nu0">1982</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">insert</span> <span class="kw1">into</span> Album <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">6</span>,<span class="nu0">2</span>,<span class="st0">'Morning View'</span>,<span class="nu0">2001</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> <span class="kw1">into</span> Album <span class="kw1">values</span><span class="br0">&#40;</span><span class="nu0">7</span>,<span class="nu0">2</span>,<span class="st0">'Light Grenades'</span>,<span class="nu0">2006</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">create table Artist (ArtistID int primary key not null,
ArtistName varchar(38))
go

create table Album(AlbumID int primary key not null,
ArtistID int not null,
AlbumName varchar(100) not null,
YearReleased smallint not null)
go


insert into Artist values(1,'Pink Floyd')
insert into Artist values(2,'Incubus')
insert into Artist values(3,'Prince')

insert into Album values(1,1,'Wish You Were Here',1975)
insert into Album values(2,1,'The Wall',1979)



insert into Album values(3,3,'Purple Rain',1984)
insert into Album values(4,3,'Lotusflow3r',2009)
insert into Album values(5,3,'1999',1982)


insert into Album values(6,2,'Morning View',2001)
insert into Album values(7,2,'Light Grenades',2006)</pre></div></div>

<p>Now create this proc</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1"><span class="kw1">create</span> <span class="kw1">proc</span> prMusicCollectionXML
<span class="kw1">as</span>
<span class="kw1">declare</span> @XmlOutput xml 
<span class="kw1">set</span> @XmlOutput <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">select</span> ArtistName,AlbumName,YearReleased <span class="kw1">from</span> Album
join Artist <span class="kw1">on</span> Album.<span class="me1">ArtistID</span> <span class="sy0">=</span> Artist.<span class="me1">ArtistID</span>
<span class="kw1">FOR</span> XML AUTO, ROOT<span class="br0">&#40;</span><span class="st0">'MusicCollection'</span><span class="br0">&#41;</span>, ELEMENTS<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">select</span> @XmlOutput
go</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">create proc prMusicCollectionXML
as
declare @XmlOutput xml 
set @XmlOutput = (select ArtistName,AlbumName,YearReleased from Album
join Artist on Album.ArtistID = Artist.ArtistID
FOR XML AUTO, ROOT('MusicCollection'), ELEMENTS)

select @XmlOutput
go</pre></div></div>

<p>After executing the proc</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">exec</span> prMusicCollectionXML</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">exec prMusicCollectionXML</pre></div></div>

<p>you will see the following output</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="xml"><thead><tr><td colspan="2"  class="head">XML</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="de1"><pre class="de1">&nbsp;<span class="sc3"><span class="re1">&lt;MusicCollection<span class="re2">&gt;</span></span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;Artist<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;ArtistName<span class="re2">&gt;</span></span></span>Pink Floyd<span class="sc3"><span class="re1">&lt;/ArtistName<span class="re2">&gt;</span></span></span> 
&nbsp;<span class="sc3"><span class="re1">&lt;Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;AlbumName<span class="re2">&gt;</span></span></span>Wish You Were Here<span class="sc3"><span class="re1">&lt;/AlbumName<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;YearReleased<span class="re2">&gt;</span></span></span>1975<span class="sc3"><span class="re1">&lt;/YearReleased<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;/Album<span class="re2">&gt;</span></span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;AlbumName<span class="re2">&gt;</span></span></span>The Wall<span class="sc3"><span class="re1">&lt;/AlbumName<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;YearReleased<span class="re2">&gt;</span></span></span>1979<span class="sc3"><span class="re1">&lt;/YearReleased<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;/Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;/Artist<span class="re2">&gt;</span></span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;Artist<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;ArtistName<span class="re2">&gt;</span></span></span>Prince<span class="sc3"><span class="re1">&lt;/ArtistName<span class="re2">&gt;</span></span></span> 
&nbsp;<span class="sc3"><span class="re1">&lt;Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;AlbumName<span class="re2">&gt;</span></span></span>Purple Rain<span class="sc3"><span class="re1">&lt;/AlbumName<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;YearReleased<span class="re2">&gt;</span></span></span>1984<span class="sc3"><span class="re1">&lt;/YearReleased<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;/Album<span class="re2">&gt;</span></span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;AlbumName<span class="re2">&gt;</span></span></span>Lotusflow3r<span class="sc3"><span class="re1">&lt;/AlbumName<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;YearReleased<span class="re2">&gt;</span></span></span>2009<span class="sc3"><span class="re1">&lt;/YearReleased<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;/Album<span class="re2">&gt;</span></span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;AlbumName<span class="re2">&gt;</span></span></span>1999<span class="sc3"><span class="re1">&lt;/AlbumName<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;YearReleased<span class="re2">&gt;</span></span></span>1982<span class="sc3"><span class="re1">&lt;/YearReleased<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;/Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;/Artist<span class="re2">&gt;</span></span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;Artist<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;ArtistName<span class="re2">&gt;</span></span></span>Incubus<span class="sc3"><span class="re1">&lt;/ArtistName<span class="re2">&gt;</span></span></span> 
&nbsp;<span class="sc3"><span class="re1">&lt;Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;AlbumName<span class="re2">&gt;</span></span></span>Morning View<span class="sc3"><span class="re1">&lt;/AlbumName<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;YearReleased<span class="re2">&gt;</span></span></span>2001<span class="sc3"><span class="re1">&lt;/YearReleased<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;/Album<span class="re2">&gt;</span></span></span>
&nbsp;<span class="sc3"><span class="re1">&lt;Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;AlbumName<span class="re2">&gt;</span></span></span>Light Grenades<span class="sc3"><span class="re1">&lt;/AlbumName<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;YearReleased<span class="re2">&gt;</span></span></span>2006<span class="sc3"><span class="re1">&lt;/YearReleased<span class="re2">&gt;</span></span></span> 
&nbsp; <span class="sc3"><span class="re1">&lt;/Album<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;/Artist<span class="re2">&gt;</span></span></span>
&nbsp; <span class="sc3"><span class="re1">&lt;/MusicCollection<span class="re2">&gt;</span></span></span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse"> &lt;MusicCollection&gt;
 &lt;Artist&gt;
  &lt;ArtistName&gt;Pink Floyd&lt;/ArtistName&gt; 
 &lt;Album&gt;
  &lt;AlbumName&gt;Wish You Were Here&lt;/AlbumName&gt; 
  &lt;YearReleased&gt;1975&lt;/YearReleased&gt; 
  &lt;/Album&gt;
 &lt;Album&gt;
  &lt;AlbumName&gt;The Wall&lt;/AlbumName&gt; 
  &lt;YearReleased&gt;1979&lt;/YearReleased&gt; 
  &lt;/Album&gt;
  &lt;/Artist&gt;
 &lt;Artist&gt;
  &lt;ArtistName&gt;Prince&lt;/ArtistName&gt; 
 &lt;Album&gt;
  &lt;AlbumName&gt;Purple Rain&lt;/AlbumName&gt; 
  &lt;YearReleased&gt;1984&lt;/YearReleased&gt; 
  &lt;/Album&gt;
 &lt;Album&gt;
  &lt;AlbumName&gt;Lotusflow3r&lt;/AlbumName&gt; 
  &lt;YearReleased&gt;2009&lt;/YearReleased&gt; 
  &lt;/Album&gt;
 &lt;Album&gt;
  &lt;AlbumName&gt;1999&lt;/AlbumName&gt; 
  &lt;YearReleased&gt;1982&lt;/YearReleased&gt; 
  &lt;/Album&gt;
  &lt;/Artist&gt;
 &lt;Artist&gt;
  &lt;ArtistName&gt;Incubus&lt;/ArtistName&gt; 
 &lt;Album&gt;
  &lt;AlbumName&gt;Morning View&lt;/AlbumName&gt; 
  &lt;YearReleased&gt;2001&lt;/YearReleased&gt; 
  &lt;/Album&gt;
 &lt;Album&gt;
  &lt;AlbumName&gt;Light Grenades&lt;/AlbumName&gt; 
  &lt;YearReleased&gt;2006&lt;/YearReleased&gt; 
  &lt;/Album&gt;
  &lt;/Artist&gt;
  &lt;/MusicCollection&gt;</pre></div></div>

<p>So far so good, so how do we dump that data into a file?<br />
Create a new SSIS package add an ADO.NET Connection, name it AdventureWorksConnection<br />
Drop an Execute SQL Task onto your control flow and modify the properties so it looks like this</p>
<p><img src="http://i44.tinypic.com/1zcz3hl.jpg" border="0" alt="Execute SQL Task" /></p>
<p>On the add a result set by clicking on the add button, change the variable name to User::XMLOutput if it is not already like that</p>
<p>Note!!! In SSIS 2008 this variable should be already created otherwise it will fail</p>
<p><img src="http://i44.tinypic.com/nyab2x.jpg" border="0" alt="Execute SQL Task Adding A Resultset" /></p>
<p>Now execute the package.<br />
You will be greeted with the following message:<br />
Error: 0xC00291E3 at Execute SQL Task, Execute SQL Task: The result binding name must be set to zero for full result set and XML results.<br />
Task failed: Execute SQL Task<br />
 In order to fix that, change the Result Name property from NewresultName to 0, now run it again and it should execute successfully. </p>
<p>Our next step will be to write this XML to a file.<br />
Add a Script Task to the package,double click the Script Task,click on script and type XMLOutput into the property of ReadWriteVariables. It should look like the image below</p>
<p><img src="http://i43.tinypic.com/2ug2df7.jpg" border="0" alt="SSIS Script Task" /></p>
<p>Click the Design Script button, this will open up a code window, replace all the code you see with this</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="vb"><thead><tr><td colspan="2"  class="head">Visual Basic</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre></td><td class="de1"><pre class="de1"><span class="co1">' Microsoft SQL Server Integration Services Script Task</span>
<span class="co1">' Write scripts using Microsoft Visual Basic</span>
<span class="co1">' The ScriptMain class is the entry point of the Script Task.</span>
&nbsp;
Imports System
Imports System.Data
Imports System.Math
Imports Microsoft.SqlServer.Dts.Runtime
&nbsp;
&nbsp;
<span class="kw2">Public</span> Class ScriptMain
&nbsp;
&nbsp; &nbsp;
&nbsp;
&nbsp; &nbsp; <span class="kw2">Public</span> <span class="kw2">Sub</span> Main()
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'</span>
 &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">' Add your code here</span>
 &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">'</span>
 &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw4">Dim</span> XMLString <span class="kw4">As</span> <span class="kw1">String</span> = <span class="st0">&quot; &quot;</span>
&nbsp;
&nbsp;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; XMLString = Dts.Variables(<span class="st0">&quot;XMLOutput&quot;</span>).Value.ToString.Replace(<span class="st0">&quot;&lt;ROOT&gt;&quot;</span>, <span class="st0">&quot;&quot;</span>).Replace(<span class="st0">&quot;&lt;/ROOT&gt;&quot;</span>, <span class="st0">&quot;&quot;</span>)
&nbsp; &nbsp; &nbsp; &nbsp; XMLString = <span class="st0">&quot;&lt;?xml version=&quot;</span><span class="st0">&quot;1.0&quot;</span><span class="st0">&quot; ?&gt;&quot;</span> + XMLString
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; GenerateXmlFile(<span class="st0">&quot;C:\MusicCollection.xml&quot;</span>, XMLString)
&nbsp;
&nbsp; &nbsp; <span class="kw3">End</span> <span class="kw2">Sub</span>
&nbsp;
&nbsp; &nbsp; <span class="kw2">Public</span> <span class="kw2">Sub</span> GenerateXmlFile(<span class="kw4">ByVal</span> filePath <span class="kw4">As</span> <span class="kw1">String</span>, <span class="kw4">ByVal</span> fileContents <span class="kw4">As</span> <span class="kw1">String</span>)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">Dim</span> objStreamWriter <span class="kw4">As</span> IO.StreamWriter
&nbsp; &nbsp; &nbsp; &nbsp; Try
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objStreamWriter = <span class="kw2">New</span> IO.StreamWriter(filePath)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objStreamWriter.Write(fileContents)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objStreamWriter.<span class="kw3">Close</span>()
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; Catch Excep <span class="kw4">As</span> Exception
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MsgBox(Excep.Message)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">End</span> Try
&nbsp; &nbsp; &nbsp; &nbsp; Dts.TaskResult = Dts.Results.Success
&nbsp; &nbsp; <span class="kw3">End</span> <span class="kw2">Sub</span>
&nbsp;
<span class="kw3">End</span> Class</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">' Microsoft SQL Server Integration Services Script Task
' Write scripts using Microsoft Visual Basic
' The ScriptMain class is the entry point of the Script Task.

Imports System
Imports System.Data
Imports System.Math
Imports Microsoft.SqlServer.Dts.Runtime


Public Class ScriptMain

   

    Public Sub Main()
        '
        ' Add your code here
        '
        Dim XMLString As String = " "



        XMLString = Dts.Variables("XMLOutput").Value.ToString.Replace("&lt;ROOT&gt;", "").Replace("&lt;/ROOT&gt;", "")
        XMLString = "&lt;?xml version=""1.0"" ?&gt;" + XMLString

        GenerateXmlFile("C:\MusicCollection.xml", XMLString)

    End Sub

    Public Sub GenerateXmlFile(ByVal filePath As String, ByVal fileContents As String)

        Dim objStreamWriter As IO.StreamWriter
        Try

            objStreamWriter = New IO.StreamWriter(filePath)

            objStreamWriter.Write(fileContents)

            objStreamWriter.Close()

        Catch Excep As Exception

            MsgBox(Excep.Message)

        End Try
        Dts.TaskResult = Dts.Results.Success
    End Sub

End Class</pre></div></div>

<p><strong>SSIS 2008 requires a code change</strong><br />
Here is what the code should look like if you are running SSIS 2008</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="vb"><thead><tr><td colspan="2"  class="head">Visual Basic</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td><td class="de1"><pre class="de1"><span class="co1">' Microsoft SQL Server Integration Services Script Task</span>
<span class="co1">' Write scripts using Microsoft Visual Basic 2008.</span>
<span class="co1">' The ScriptMain is the entry point class of the script.</span>
&nbsp;
Imports System
Imports System.Data
Imports System.Math
Imports Microsoft.SqlServer.Dts.Runtime
&nbsp;
&lt;System.AddIn.AddIn(<span class="st0">&quot;ScriptMain&quot;</span>, Version:=<span class="st0">&quot;1.0&quot;</span>, Publisher:=<span class="st0">&quot;&quot;</span>, Description:=<span class="st0">&quot;&quot;</span>)&gt; _
&lt;System.CLSCompliantAttribute(<span class="kw5">False</span>)&gt; _
Partial <span class="kw2">Public</span> Class ScriptMain
&nbsp; &nbsp; Inherits Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
&nbsp;
&nbsp; &nbsp; <span class="kw1">Enum</span> ScriptResults
&nbsp; &nbsp; &nbsp; &nbsp; Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success
&nbsp; &nbsp; &nbsp; &nbsp; Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
&nbsp; &nbsp; <span class="kw3">End</span> <span class="kw1">Enum</span>
&nbsp; &nbsp; 
&nbsp;
&nbsp; &nbsp; 
&nbsp;
&nbsp; &nbsp; <span class="kw2">Public</span> <span class="kw2">Sub</span> Main()
&nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'</span>
 &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">' Add your code here</span>
 &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">'</span>
 &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw4">Dim</span> XMLString <span class="kw4">As</span> <span class="kw1">String</span> = <span class="st0">&quot; &quot;</span>
&nbsp;
&nbsp;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; XMLString = Dts.Variables(<span class="st0">&quot;XMLOutput&quot;</span>).Value.ToString.Replace(<span class="st0">&quot;&lt;ROOT&gt;&quot;</span>, <span class="st0">&quot;&quot;</span>).Replace(<span class="st0">&quot;&lt;/ROOT&gt;&quot;</span>, <span class="st0">&quot;&quot;</span>)
&nbsp; &nbsp; &nbsp; &nbsp; XMLString = <span class="st0">&quot;&lt;?xml version=&quot;</span><span class="st0">&quot;1.0&quot;</span><span class="st0">&quot; ?&gt;&quot;</span> + XMLString
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; GenerateXmlFile(<span class="st0">&quot;C:\MusicCollection.xml&quot;</span>, XMLString)
&nbsp;
&nbsp; &nbsp; <span class="kw3">End</span> <span class="kw2">Sub</span>
&nbsp;
&nbsp; &nbsp; <span class="kw2">Public</span> <span class="kw2">Sub</span> GenerateXmlFile(<span class="kw4">ByVal</span> filePath <span class="kw4">As</span> <span class="kw1">String</span>, <span class="kw4">ByVal</span> fileContents <span class="kw4">As</span> <span class="kw1">String</span>)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">Dim</span> objStreamWriter <span class="kw4">As</span> IO.StreamWriter
&nbsp; &nbsp; &nbsp; &nbsp; Try
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objStreamWriter = <span class="kw2">New</span> IO.StreamWriter(filePath)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objStreamWriter.Write(fileContents)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; objStreamWriter.<span class="kw3">Close</span>()
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; Catch Excep <span class="kw4">As</span> Exception
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MsgBox(Excep.Message)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw3">End</span> Try
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; Dts.TaskResult = ScriptResults.Success
&nbsp;
&nbsp;
&nbsp; &nbsp; <span class="kw3">End</span> <span class="kw2">Sub</span>
&nbsp;
<span class="kw3">End</span> Class</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">' Microsoft SQL Server Integration Services Script Task
' Write scripts using Microsoft Visual Basic 2008.
' The ScriptMain is the entry point class of the script.

Imports System
Imports System.Data
Imports System.Math
Imports Microsoft.SqlServer.Dts.Runtime

&lt;System.AddIn.AddIn("ScriptMain", Version:="1.0", Publisher:="", Description:="")&gt; _
&lt;System.CLSCompliantAttribute(False)&gt; _
Partial Public Class ScriptMain
	Inherits Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase

	Enum ScriptResults
		Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success
		Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
	End Enum
	

	

	Public Sub Main()
        '
        ' Add your code here
        '
        Dim XMLString As String = " "



        XMLString = Dts.Variables("XMLOutput").Value.ToString.Replace("&lt;ROOT&gt;", "").Replace("&lt;/ROOT&gt;", "")
        XMLString = "&lt;?xml version=""1.0"" ?&gt;" + XMLString

        GenerateXmlFile("C:\MusicCollection.xml", XMLString)

    End Sub

    Public Sub GenerateXmlFile(ByVal filePath As String, ByVal fileContents As String)

        Dim objStreamWriter As IO.StreamWriter
        Try

            objStreamWriter = New IO.StreamWriter(filePath)

            objStreamWriter.Write(fileContents)

            objStreamWriter.Close()

        Catch Excep As Exception

            MsgBox(Excep.Message)

        End Try

        Dts.TaskResult = ScriptResults.Success


    End Sub

End Class</pre></div></div>

<p>There are a couple of things you need to know, the XML will be generated inside a &lt;ROOT&gt; tag, I am stripping that out on line 23 of the code, on line 24 I am adding &lt;?xml version=&#8221;1.0&#8243; ?&gt; to the file. Line 26 has the location where the file will be written, right now it is C:MusicCollection.xml but you can modify that.</p>
<p>So now we are all done with this. It is time to run this package. Run the package and you should see that file has been created.</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/removing-old-files-with-ssis-sql-server/'>Removing old files with SSIS</a><p>This post will illustrate two methods for removing old files from directories using SSIS. This&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/ssis-configuration-editor/'>SQL Server Integration Services tools to have  Configuration File Editor</a><p>In a previous post, SQL Server Integration Services tools to have  Expression Editor &amp;&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2><img class="bioPic" src="http://www.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d.png" alt="User bio image"/>Denis has been working with SQL Server since version 6.5. Although he worked as an ASP/JSP/ColdFusion developer before the dot com bust, he has been working exclusively as a database developer/architect since 2002. In addition to English, Denis is also fluent in Croatian and Dutch, but he can curse in many other languages and dialects (just ask the SQL optimizer) He lives in Princeton, NJ with his wife and three kids.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/denisgobo" title="SQLDenis at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/denis.gobo" title="SQLDenis at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/in/denisgobo" title="SQLDenis at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://denisgobo.blogspot.com/" title="SQLDenis at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="http://www.flickr.com/photos/denisgobo//" title="SQLDenis at Flickr" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_flickr.png" alt="Flickr" /></a><a href="/index.php/author/SQLDenis/feed/" title="Blog RSS feed for SQLDenis" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 103,125 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/SQLDenis/">Read More Posts by SQLDenis</a>
						</div>
					</div>
					<div>
						<label>Tags:</label> <a href="/index.php/tag/integration-services/" rel="tag">integration services</a>, <a href="/index.php/tag/sql-server-2005/" rel="tag">sql server 2005</a>, <a href="/index.php/tag/sql-server-2008/" rel="tag">sql server 2008</a>, <a href="/index.php/tag/ssis-2/" rel="tag">ssis</a>, <a href="/index.php/tag/xml/" rel="tag">xml</a> 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&text=RT @LessThanDot Blog - Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&title=Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax&source=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&title=Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&quote=Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/&title=Create XML Files Out Of SQL Server With SSIS And FOR XML Syntax" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		62 Comments	</h4>
			<ol class="comments-list">
					<li class="comment even thread-even depth-1" id="comment-1040">
				<div id="div-comment-1040" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a67cdd2db3f3665545d10bd5d2f215da?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a67cdd2db3f3665545d10bd5d2f215da?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">rpf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1040">
			April 22, 2009 at 1:02 am</a>		</div>

		<p>Works like a wonder! Thank you sir!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1040#respond' onclick='return addComment.moveForm( "div-comment-1040", "1040", "respond", "339" )' aria-label='Reply to rpf'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-986">
				<div id="div-comment-986" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/23a500a97fa0a84e8832fadda86fa381?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/23a500a97fa0a84e8832fadda86fa381?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Reuben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-986">
			June 26, 2009 at 9:41 am</a>		</div>

		<p>Nice Job!  Great Post!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=986#respond' onclick='return addComment.moveForm( "div-comment-986", "986", "respond", "339" )' aria-label='Reply to Reuben'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1012">
				<div id="div-comment-1012" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/521c167ea5bbb7a396240a85df025c92?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/521c167ea5bbb7a396240a85df025c92?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">NetGolf</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1012">
			October 12, 2009 at 3:12 pm</a>		</div>

		<p>Great post! However, I got &#8220;out of memory&#8221; error when I tried to create an XML from a table with 3 million rows. Due to security concern, I was not able to use &#8220;bcp&#8221;. What else can I do? Please help! Thanks!!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1012#respond' onclick='return addComment.moveForm( "div-comment-1012", "1012", "respond", "339" )' aria-label='Reply to NetGolf'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-990">
				<div id="div-comment-990" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3672e0459a54119782bc8255f3365e1b?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3672e0459a54119782bc8255f3365e1b?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.acmecontracts.com/' rel='external nofollow' class='url'>Charles Marche</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-990">
			November 27, 2009 at 8:32 am</a>		</div>

		<p>I managed to get this to work on SQL 2005.  But the script has many problems when running on SQL 2008.  Any chance of posting a SQL 2008 version please???</p>
<p>Thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=990#respond' onclick='return addComment.moveForm( "div-comment-990", "990", "respond", "339" )' aria-label='Reply to Charles Marche'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-991">
				<div id="div-comment-991" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-991">
			November 27, 2009 at 8:59 am</a>		</div>

		<p>Charles,</p>
<p>what errors are you getting?  I will run this on sql 2008 later today and will let you know if it works</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=991#respond' onclick='return addComment.moveForm( "div-comment-991", "991", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-996">
				<div id="div-comment-996" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-996">
			November 29, 2009 at 6:32 pm</a>		</div>

		<p>Charles I added the 2008 code changes</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=996#respond' onclick='return addComment.moveForm( "div-comment-996", "996", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-998">
				<div id="div-comment-998" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7cf62788a19ff1ff5d4131ce1406565b?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7cf62788a19ff1ff5d4131ce1406565b?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Charles</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-998">
			November 30, 2009 at 7:02 pm</a>		</div>

		<p>Hi SQLDenis,</p>
<p>Many thanks for the new code!  It seems to execute as long as you keep the entrypoint to Main.</p>
<p>The output file has problems, it only contains 1 line which says xml version=&#8221;1.0&#8243;. Then the rest of the file is blank.</p>
<p>A couple of questions please,<br />
1) In 2008 it doesn&#8217;t create the Result Set entry for User:XMLOutput automatically.  Is it meant to auto-detect this? from an output from the Stored Procedure?</p>
<p>2) As a solution it seems complicated for just outputing an XML file.  I&#8217;d heard great things about SSIS, but it seems extremely complex &#8211; probably rightly so.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=998#respond' onclick='return addComment.moveForm( "div-comment-998", "998", "respond", "339" )' aria-label='Reply to Charles'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1018">
				<div id="div-comment-1018" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/fefa45d7509fcfd95ceb75bde71bd8c2?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/fefa45d7509fcfd95ceb75bde71bd8c2?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">StanleyG</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1018">
			December 13, 2009 at 8:26 pm</a>		</div>

		<p>Thanks for sharing.  This was helpful.  What determines the encoding (e.g. UTF-8, UTF-16) of the final output file using this process? Can one specify what they want the encoding to be?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1018#respond' onclick='return addComment.moveForm( "div-comment-1018", "1018", "respond", "339" )' aria-label='Reply to StanleyG'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt even thread-even depth-1" id="comment-1020">
				<div id="div-comment-1020" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1020">
			December 14, 2009 at 6:20 am</a>		</div>

		<p>You&#8217;ll need to set it in the script task using Encoding <br />
<a href="http://msdn.microsoft.com/en-us/library/ms143456.aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/ms143456.aspx</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1020#respond' onclick='return addComment.moveForm( "div-comment-1020", "1020", "respond", "339" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1029">
				<div id="div-comment-1029" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/fefa45d7509fcfd95ceb75bde71bd8c2?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/fefa45d7509fcfd95ceb75bde71bd8c2?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">StanleyG</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1029">
			December 15, 2009 at 12:43 am</a>		</div>

		<p>Thanks for the response, onpnt.  I will review.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1029#respond' onclick='return addComment.moveForm( "div-comment-1029", "1029", "respond", "339" )' aria-label='Reply to StanleyG'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1021">
				<div id="div-comment-1021" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/6041051980308c52bb81843900a4f5cd?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/6041051980308c52bb81843900a4f5cd?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Tony</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1021">
			January 13, 2010 at 11:19 am</a>		</div>

		<p>Found this article after much searching on Google. It is sad that there isn&#8217;t a native component for writing out a file within SSIS, but at least the solution is a very simple script. Thanks for this!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1021#respond' onclick='return addComment.moveForm( "div-comment-1021", "1021", "respond", "339" )' aria-label='Reply to Tony'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1032">
				<div id="div-comment-1032" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/75fc77cc76b5cad2bca8c8f13ae8372e?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/75fc77cc76b5cad2bca8c8f13ae8372e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Greca</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1032">
			January 18, 2010 at 1:23 am</a>		</div>

		<p>This article was very useful for me, especially the trick on line 23 . Thank you very much</p>
<p>Greca</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1032#respond' onclick='return addComment.moveForm( "div-comment-1032", "1032", "respond", "339" )' aria-label='Reply to Greca'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1022">
				<div id="div-comment-1022" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/6f8db50af56277bd2e83b57e56cee015?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/6f8db50af56277bd2e83b57e56cee015?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Slick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1022">
			April 28, 2010 at 12:38 pm</a>		</div>

		<p>How can I date stamp the file name?</p>
<p>musiccollection_04212010.xml or similar?</p>
<p>thanks,<br />
s</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1022#respond' onclick='return addComment.moveForm( "div-comment-1022", "1022", "respond", "339" )' aria-label='Reply to Slick'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1023">
				<div id="div-comment-1023" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1023">
			April 28, 2010 at 12:58 pm</a>		</div>

		<p>Slick,</p>
<p>Like this</p>
<p>
Dim FileName As String<br />
FileName = &#8220;musiccollection_&#8221; &amp; Today.ToString(&#8220;MMddyyyy&#8221;) &amp; &#8220;.xml&#8221;</p>
<p>
and then instead of this</p>
<p> GenerateXmlFile(&#8220;C:\MusicCollection.xml&#8221;, XMLString)</p>
<p>do this</p>
<p> GenerateXmlFile(FileName , XMLString)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1023#respond' onclick='return addComment.moveForm( "div-comment-1023", "1023", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1026">
				<div id="div-comment-1026" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/6f8db50af56277bd2e83b57e56cee015?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/6f8db50af56277bd2e83b57e56cee015?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Slick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1026">
			April 28, 2010 at 1:35 pm</a>		</div>

		<p>Thanks for your reply. </p>
<p>Sorry I&#8217;m weak with programming languages. </p>
<p>Thank you so much again.</p>
<p>S</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1026#respond' onclick='return addComment.moveForm( "div-comment-1026", "1026", "respond", "339" )' aria-label='Reply to Slick'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-992">
				<div id="div-comment-992" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/899cc383a8a09874282baa120abe3ac8?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/899cc383a8a09874282baa120abe3ac8?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Gerry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-992">
			May 21, 2010 at 2:55 pm</a>		</div>

		<p>Wow. thanks this is great. </p>
<p>How do I now call these packages I have created to run on a schedule? <br />
So that the XML populates in a folder everyday or every hour?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=992#respond' onclick='return addComment.moveForm( "div-comment-992", "992", "respond", "339" )' aria-label='Reply to Gerry'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-993">
				<div id="div-comment-993" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-993">
			May 22, 2010 at 4:29 am</a>		</div>

		<p>Gerry, you can create a SQL Agent job and schedule that or start the job from a procedure/SQL with sp_start_job</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=993#respond' onclick='return addComment.moveForm( "div-comment-993", "993", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1031">
				<div id="div-comment-1031" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3b4bf295b3e6f4f340ebf58e136dc3ae?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3b4bf295b3e6f4f340ebf58e136dc3ae?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Sainis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1031">
			June 9, 2010 at 9:14 pm</a>		</div>

		<p>Hey,Can anyone please help me on how can I do the same task using OLEDB Connection instead of ADO.Net.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1031#respond' onclick='return addComment.moveForm( "div-comment-1031", "1031", "respond", "339" )' aria-label='Reply to Sainis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1024">
				<div id="div-comment-1024" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a02502f1a0c6ab3e16bc666ab2ebc27f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a02502f1a0c6ab3e16bc666ab2ebc27f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">CVN</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1024">
			July 8, 2010 at 9:04 am</a>		</div>

		<p>Hey,</p>
<p>This works great. Thanks a lot.</p>
<p>Can somebody tell me how to add a namespace?</p>
<p>Example:<br />
ns0:MusicCollection xmlns:ns0=&#8221;http://ABC.Data.AX.v01&#8243;</p>
<p>Thanks in advance,<br />
CVN</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1024#respond' onclick='return addComment.moveForm( "div-comment-1024", "1024", "respond", "339" )' aria-label='Reply to CVN'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-988">
				<div id="div-comment-988" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9a84b594ffa76ad5fd21584cc6a721dc?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9a84b594ffa76ad5fd21584cc6a721dc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">BravehearT1326</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-988">
			September 17, 2010 at 2:14 am</a>		</div>

		<p>Hi &#8211; seems to be just what I&#8217;m looing for but cant get it to work!!!</p>
<p>In your posting you say &#8220;Drop an Execute SQL Task onto your control flow and modify the properties so it looks like this&#8221; but there is no picture or instructions on the values to add etc.</p>
<p>and when I create a script task for SQL 2005 and paste in your code all I get is the ?XML Version row written to the file not the results from the stored proc.</p>
<p>Can you advise what I&#8217;m mising?<br />
Thanks in advance</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=988#respond' onclick='return addComment.moveForm( "div-comment-988", "988", "respond", "339" )' aria-label='Reply to BravehearT1326'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-989">
				<div id="div-comment-989" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9a84b594ffa76ad5fd21584cc6a721dc?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9a84b594ffa76ad5fd21584cc6a721dc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">BravehearT1326</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-989">
			September 17, 2010 at 3:16 am</a>		</div>

		<p>Got it working after spending some time fiddling around with the results sets options etc.</p>
<p>Thanks this has saved a whole lot of hassle.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=989#respond' onclick='return addComment.moveForm( "div-comment-989", "989", "respond", "339" )' aria-label='Reply to BravehearT1326'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1036">
				<div id="div-comment-1036" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f14bfbf8994a8dcf458be2b81cb596a5?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f14bfbf8994a8dcf458be2b81cb596a5?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">John</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1036">
			April 11, 2011 at 2:55 am</a>		</div>

		<p>Very useful article, thanks!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1036#respond' onclick='return addComment.moveForm( "div-comment-1036", "1036", "respond", "339" )' aria-label='Reply to John'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-994">
				<div id="div-comment-994" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/6ed8732c9bf720009e016ef8ca0f91d9?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/6ed8732c9bf720009e016ef8ca0f91d9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jason</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-994">
			May 4, 2011 at 9:49 am</a>		</div>

		<p>Great article!</p>
<p>I&#8217;m so close, but I&#8217;m having an issue where the file created only shows this:<br />
&#8216;xml version=&#8221;1.0&#8243; ?>System.Xml.XmlDocument&#8217;</p>
<p>I verified the query in my procedure and when run from SQL 2008, it produces results.</p>
<p>How can I show the data in the destination .xml file?</p>
<p>Thanks!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=994#respond' onclick='return addComment.moveForm( "div-comment-994", "994", "respond", "339" )' aria-label='Reply to Jason'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1025">
				<div id="div-comment-1025" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/6f8db50af56277bd2e83b57e56cee015?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/6f8db50af56277bd2e83b57e56cee015?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Slick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1025">
			May 25, 2011 at 2:25 pm</a>		</div>

		<p>Hi, I had a question.</p>
<p>Where does the &#8220;Artist&#8221; and &#8220;Album&#8221; element come from? In your SP select there is only ArtistName and AlbumName which are children.</p>
<p>I&#8217;m sure it doesnt just randomly/magically appear under those parents. So I was wondering if you could please tell me how that shows up in the XML file.</p>
<p>Thank you,<br />
S</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1025#respond' onclick='return addComment.moveForm( "div-comment-1025", "1025", "respond", "339" )' aria-label='Reply to Slick'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1027">
				<div id="div-comment-1027" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/6f8db50af56277bd2e83b57e56cee015?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/6f8db50af56277bd2e83b57e56cee015?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Slick</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1027">
			May 25, 2011 at 2:27 pm</a>		</div>

		<p>Oh!! The parent elements are the table names! DOH!!!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1027#respond' onclick='return addComment.moveForm( "div-comment-1027", "1027", "respond", "339" )' aria-label='Reply to Slick'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1028">
				<div id="div-comment-1028" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1028">
			May 25, 2011 at 2:28 pm</a>		</div>

		<p>Artist and Album come from the table names itself</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1028#respond' onclick='return addComment.moveForm( "div-comment-1028", "1028", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1001">
				<div id="div-comment-1001" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1c62f2683decfc70db3174af2cc92eba?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1c62f2683decfc70db3174af2cc92eba?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">anki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1001">
			July 5, 2011 at 2:09 pm</a>		</div>

		<p>i was able to create xml file using your method.it works great.but in my xml file i have the expandable button being display like if i click on &#8216;+&#8217; sign it displays all the nodes under it,if i again click on it it hides the nodes.I dont want this functinality in the result.How can i avoid this?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1001#respond' onclick='return addComment.moveForm( "div-comment-1001", "1001", "respond", "339" )' aria-label='Reply to anki'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1003">
				<div id="div-comment-1003" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1003">
			July 5, 2011 at 2:48 pm</a>		</div>

		<p>Open the XML file in a parser or notepad/editplus/notepad++ instead of Internet Explorer</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1003#respond' onclick='return addComment.moveForm( "div-comment-1003", "1003", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1004">
				<div id="div-comment-1004" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1c62f2683decfc70db3174af2cc92eba?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1c62f2683decfc70db3174af2cc92eba?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">anki</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1004">
			July 7, 2011 at 3:09 pm</a>		</div>

		<p>thanks for your reply Dennis.<br />
I am trying to add timestamp to the xmlfile name ,i am using the below syntax in vb.net <br />
C:usersresult_&#8221; &amp; Today.ToString(&#8220;ccyymmdd&#8221;) &amp; &#8220;.xml&#8221;<br />
 but the resultant filename is result_cc110007 which is not the right one.Can you please tell me if i am going in the right way?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1004#respond' onclick='return addComment.moveForm( "div-comment-1004", "1004", "respond", "339" )' aria-label='Reply to anki'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1006">
				<div id="div-comment-1006" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1006">
			July 7, 2011 at 5:23 pm</a>		</div>

		<p>mm has to be upper case  MM<br />
try yyyyMMdd</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1006#respond' onclick='return addComment.moveForm( "div-comment-1006", "1006", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1008">
				<div id="div-comment-1008" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/d6d4c3a8797587ee704d1643141ae123?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/d6d4c3a8797587ee704d1643141ae123?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">sqldeveloper</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1008">
			July 12, 2011 at 11:02 am</a>		</div>

		<p>Dennis,<br />
i am trying to add namespace to the header of the xml file.I want to add this as the default namespace in the header but with no prefixes for the child nodes.I want this namespace to be a part of the header file it should be seen only there but not anywhere in the xmlfile.Below is the example:<br />
root xmlns=&#8221;http://www.w3.org/&#8221;<br />
  tr<br />
    tdApples/td<br />
    td>Bananas/td<br />
  /tr<br />
/root<br />
i edited the example because it was not allowing be to post using the symbols.<br />
I tried doing this using sql server but it didnot work for me ,is there any code in vb.net so that i can add it in the script task before the xml file is generated.I am using same vb.net code that is given in your bolg to generate the xml file.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1008#respond' onclick='return addComment.moveForm( "div-comment-1008", "1008", "respond", "339" )' aria-label='Reply to sqldeveloper'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1019">
				<div id="div-comment-1019" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a0135bd916cdaaa416f43e43f8e754a?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a0135bd916cdaaa416f43e43f8e754a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Porter</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1019">
			July 14, 2011 at 12:53 pm</a>		</div>

		<p>I am running SQL 2k8 R2, and having the same problem as others with only the header appearing in the output file</p>
<p>Running the code in the SQL task does return rows from a table column of type xml</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1019#respond' onclick='return addComment.moveForm( "div-comment-1019", "1019", "respond", "339" )' aria-label='Reply to Porter'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-995">
				<div id="div-comment-995" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/76673eb7f99205bf39de3358b5074aa4?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/76673eb7f99205bf39de3358b5074aa4?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">MMeyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-995">
			August 17, 2011 at 1:32 am</a>		</div>

		<p>For adding Namespaces you can use an RegEx Replace before you Output the File:</p>
<p>XMLString = System.Text.RegularExpressions.Regex.Replace<br />
with 3 Arguments (String1, String2, String3)<br />
String1 = XMLString (the same String-Variable that stands before =)<br />
String2 = SearchString = your tag to Add Namespace into <br />
String3 = the ReplaceString must consist of Tag(Space)xmlns=&#8221;Namespace&#8221;</p>
<p>Remember to use The greater and lesser symbols around the Tag (could&#8217;nt post an Exact Example here, because it wouldn&#8217;t let me use the symbols).<br />
The Regex.Replace Method Replaces ALL Matches for String2 with String3 so be carefull, but if you only add a NameSpace xmlns to your root Tag then there shouldn&#8217;t be a Problem.</p>
<p>Example for the 3 Arguments with # instead of greater or lesser symbols<br />
(XMLString, &#8220;#ROOT#&#8221;, &#8220;#ROOT xmlns=&#8221;&#8221;Namespace&#8221;&#8221;#&#8221;)<br />
Remember to Escape your &#8221; with another &#8221; or three if you add a Variable between:<br />
(XMLString, &#8220;#ROOT#&#8221;, &#8220;#ROOT xmlns=&#8221;&#8221;&#8221; + Variable + &#8220;&#8221;&#8221;#&#8221;)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=995#respond' onclick='return addComment.moveForm( "div-comment-995", "995", "respond", "339" )' aria-label='Reply to MMeyer'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1014">
				<div id="div-comment-1014" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/65155239d0ac5b47a20baed0d9ef69aa?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/65155239d0ac5b47a20baed0d9ef69aa?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Vasu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1014">
			September 9, 2011 at 12:32 am</a>		</div>

		<p>Gr8 post. But when i try to design the script, i get the error like &#8220;namespace does not directly contain members such as fields or methods&#8221;. I tried every possible way but failed. I am using SSIS 2008. please help me.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1014#respond' onclick='return addComment.moveForm( "div-comment-1014", "1014", "respond", "339" )' aria-label='Reply to Vasu'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1015">
				<div id="div-comment-1015" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/65155239d0ac5b47a20baed0d9ef69aa?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/65155239d0ac5b47a20baed0d9ef69aa?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Vasu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1015">
			September 9, 2011 at 5:12 am</a>		</div>

		<p>Hi Again. After Running the package, only header is appearing in the output xml. And I think most of us are getting the same output.. Please respond.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1015#respond' onclick='return addComment.moveForm( "div-comment-1015", "1015", "respond", "339" )' aria-label='Reply to Vasu'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1016">
				<div id="div-comment-1016" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1016">
			September 9, 2011 at 7:59 am</a>		</div>

		<p>If your file only contains the header it means that the XML variable is empty</p>
<p>after this line</p>
<p>XMLString = Dts.Variables(&#8220;XMLOutput&#8221;).Value.ToString.Replace(&#8220;&lt;root&gt;&#8221;, &#8220;&#8221;).Replace(&#8220;&lt;/root&gt;&#8221;, &#8220;&#8221;)</p>
<p>can you do a messagebox.show</p>
<p>MessageBox.Show(Dts.Variables(&#8220;XMLOutput&#8221;).Value.ToString)</p>
<p>now if the variable is blank you know what the problem is and you have to figure out why the variable wasn&#8217;t populated</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1016#respond' onclick='return addComment.moveForm( "div-comment-1016", "1016", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1017">
				<div id="div-comment-1017" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f9fa8f5871f4c997580ddb3832b2bb6a?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f9fa8f5871f4c997580ddb3832b2bb6a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">gary</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1017">
			September 9, 2011 at 8:53 am</a>		</div>

		<p>Your post has greatly saved me time.  I am very grateful. On implementing this, I realized that somehow, my local machine is not configured the same as yours because I needed to change the SQLSourceType to Variable and set the IsQueryStoredProcedure to False. Otherwise, I get the error &#8220;Object reference not set to an instance of an object&#8221;. Aside from this issue, I got it working spitting out XML files when combined with For Each Loop Container.  May your tribe increase!!!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1017#respond' onclick='return addComment.moveForm( "div-comment-1017", "1017", "respond", "339" )' aria-label='Reply to gary'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1033">
				<div id="div-comment-1033" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/b1bc6d183450ab885e2f324099eb7893?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/b1bc6d183450ab885e2f324099eb7893?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Andrea</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1033">
			September 14, 2011 at 4:25 am</a>		</div>

		<p>Thank you! It works. I developed the package with VS2008 today.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1033#respond' onclick='return addComment.moveForm( "div-comment-1033", "1033", "respond", "339" )' aria-label='Reply to Andrea'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-999">
				<div id="div-comment-999" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/242f53314aeb45dd157095ba4dfcac05?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/242f53314aeb45dd157095ba4dfcac05?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">CY</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-999">
			October 12, 2011 at 5:41 am</a>		</div>

		<p>Hi , I have this error below :</p>
<p>[Execute SQL Task] Error: Executing the query &#8220;prMusicCollectionXML&#8221; failed with the following error: &#8220;Exception of type &#8216;System.Exception&#8217; was thrown.&#8221;. Possible failure reasons: Problems with the query, &#8220;ResultSet&#8221; property not set correctly, parameters not set correctly, or connection not established correctly.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=999#respond' onclick='return addComment.moveForm( "div-comment-999", "999", "respond", "339" )' aria-label='Reply to CY'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1005">
				<div id="div-comment-1005" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/acc88d568e894e5cf72b63d09957a15b?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/acc88d568e894e5cf72b63d09957a15b?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://amal.net/' rel='external nofollow' class='url'>Amal</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1005">
			October 18, 2011 at 1:06 pm</a>		</div>

		<p>I&#8217;ve been tinkering with XML on SQL 2008 R2 for a few hours now and I&#8217;m still not quite sure what I&#8217;m doing. I have a value storage table with 3 fields;</p>
<p>    GUID, Name, Value</p>
<p>The GUID field is a uniqueidentifier data type, and refers to an event record in another table, so there could be multiple records in the value storage table for each GUID that each specify a name/value pair. For example;</p>
<p>B8B6487C-66E0-42B6-B667-92F79A45E544 Pressure 3812.3<br />
B8B6487C-66E0-42B6-B667-92F79A45E544 Temperature 24.2</p>
<p>What I&#8217;m trying to do is create a simple query that will output formatted XML in the following format;</p>
<p>&lt;output%gt;<br />
  &lt;GUID%gt;B8B6487C-66E0-42B6-B667-92F79A45E544&lt;/GUID%gt;<br />
  &lt;Pressure%gt;3812.3&lt;/Pressure%gt;<br />
  &lt;Temperature%gt;24.2&lt;/Temperature%gt;<br />
&lt;/output%gt;</p>
<p>But all I seem to be able to get is something like;</p>
<p>&lt;output%gt;<br />
  &lt;GUID%gt;B8B6487C-66E0-42B6-B667-92F79A45E544&lt;/GUID%gt;<br />
  &lt;Name%gt;Pressure&lt;/Name%gt;<br />
  &lt;Value%gt;3812.3&lt;/Value%gt;<br />
&lt;/output%gt;<br />
&lt;output%gt;<br />
  &lt;GUID%gt;B8B6487C-66E0-42B6-B667-92F79A45E544&lt;/GUID%gt;<br />
  &lt;Name%gt;Temperature&lt;/Name%gt;<br />
  &lt;Value%gt;24.2&lt;/Value%gt;<br />
&lt;/output%gt;</p>
<p>&#8230; which is not what I want. Have any ideas? Thanks in advance!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1005#respond' onclick='return addComment.moveForm( "div-comment-1005", "1005", "respond", "339" )' aria-label='Reply to Amal'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1002">
				<div id="div-comment-1002" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e87bcb84f5199dc0155313058c6eaf9c?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e87bcb84f5199dc0155313058c6eaf9c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Dustin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1002">
			March 30, 2012 at 2:25 pm</a>		</div>

		<p>Thank you so much for this code you have saved me hours of development time.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1002#respond' onclick='return addComment.moveForm( "div-comment-1002", "1002", "respond", "339" )' aria-label='Reply to Dustin'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1007">
				<div id="div-comment-1007" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c81fe85e83784ada661c90a262b78325?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c81fe85e83784ada661c90a262b78325?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Shane</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1007">
			April 5, 2012 at 12:06 pm</a>		</div>

		<p>Thanks alot with a few modifications it worked. <br />
Modifications:</p>
<p>Note!!! In SSIS 2008 this variable should be already created otherwise it will fail<br />
&#8211; I changed it USER::Variable (String &amp; placed XMLOutput in value)<br />
&#8211; then with Script Task (selected USER::Variable chkbox &amp; changed &#8216;XMLString = Dts.Variables(&#8220;XMLOutput&#8221;)&#8217; to (&#8220;Variable&#8221;)<br />
Thanks</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1007#respond' onclick='return addComment.moveForm( "div-comment-1007", "1007", "respond", "339" )' aria-label='Reply to Shane'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-987">
				<div id="div-comment-987" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a4c7f516a0af796f4a3e6d58cedbdc43?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a4c7f516a0af796f4a3e6d58cedbdc43?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Joe</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-987">
			June 20, 2012 at 9:23 am</a>		</div>

		<p>After many hours of fighting this, I finally got it to create a file!!!!!!!!!!   </p>
<p>Thanks for the post!!!</p>
<p>Joe</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=987#respond' onclick='return addComment.moveForm( "div-comment-987", "987", "respond", "339" )' aria-label='Reply to Joe'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1030">
				<div id="div-comment-1030" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e9c2989154c83c48465a643a858f66d0?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e9c2989154c83c48465a643a858f66d0?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">jayanthcavin@yahoo.com</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1030">
			June 27, 2012 at 9:10 am</a>		</div>

		<p>After a lot of internet browsing and learning I found your explanation to be the beast in accomplishing the task. Appreciated.<br />
Last one question when I open the stored XML file my elements are not formatted but when I open the same file using IE everything looks formatted.<br />
How can be able to see the same formatted output when I viewing through my XML editor as well.<br />
Thanks in advance.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1030#respond' onclick='return addComment.moveForm( "div-comment-1030", "1030", "respond", "339" )' aria-label='Reply to jayanthcavin@yahoo.com'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-997">
				<div id="div-comment-997" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a6d5cbcdfe115f687840c22c1e4c181f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a6d5cbcdfe115f687840c22c1e4c181f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Kishor Kumar</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-997">
			August 1, 2012 at 7:42 am</a>		</div>

		<p>Thanks Sir gr8 job</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=997#respond' onclick='return addComment.moveForm( "div-comment-997", "997", "respond", "339" )' aria-label='Reply to Kishor Kumar'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1000">
				<div id="div-comment-1000" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e9c2989154c83c48465a643a858f66d0?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e9c2989154c83c48465a643a858f66d0?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jayanth</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1000">
			August 9, 2012 at 9:50 am</a>		</div>

		<p>If you want to add NameSpaces to the RootNode then you can do it in the following way.Just replace # with Greaterthan and Lesserthan symbols. </p>
<p>Dim XMLString1 As String<br />
        Dim NameSpaces1 As String<br />
        Dim NameSpaces2 As String<br />
        Dim NameSpaces3 As String<br />
        NameSpaces1 = &#8220;https://uidataexchange.org/schemas&#8221;<br />
        NameSpaces2 = &#8220;http://www.w3.org/2001/XMLSchema-instance&#8221;<br />
        NameSpaces3 = &#8220;https://uidataexchange.org/schemas combined.xsd &#8220;</p>
<p>        XMLString1 = System.Text.RegularExpressions.Regex.Replace(XMLString, &#8220;#StateSeperationRequestCollection#&#8221;, &#8220;#StateSeperationRequestCollection xmlns=&#8221;&#8221;&#8221; + NameSpaces1 + &#8220;&#8221;&#8221; xmlns:xsi=&#8221;&#8221;&#8221; + NameSpaces2 + &#8220;&#8221;&#8221; xsi:schemaLocation=&#8221;&#8221;&#8221; + NameSpaces3 + &#8220;&#8221;&#8221; #&#8221;)<br />
        GenerateXmlFile(FileName, XMLString1)</p>
<p>Just a working copy.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1000#respond' onclick='return addComment.moveForm( "div-comment-1000", "1000", "respond", "339" )' aria-label='Reply to Jayanth'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1009">
				<div id="div-comment-1009" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/cff0e40432cc05d19e8d75793efc7675?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/cff0e40432cc05d19e8d75793efc7675?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1009">
			November 21, 2012 at 11:16 am</a>		</div>

		<p>I also can&#8217;t get the xml file to read anything but:xml version=&#8221;1.0&#8243; ?>System.Object</p>
<p>Why would this be&#8230;so close&#8230;help!!! Thank you.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1009#respond' onclick='return addComment.moveForm( "div-comment-1009", "1009", "respond", "339" )' aria-label='Reply to Steve'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1010">
				<div id="div-comment-1010" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1010">
			November 21, 2012 at 11:19 am</a>		</div>

		<p>Steve,</p>
<p>If your file only contains the header it means that the XML variable is empty</p>
<p>after this line</p>
<p>XMLString = Dts.Variables(&#8220;XMLOutput&#8221;).Value.ToString.Replace(&#8220;&#8220;, &#8220;&#8221;).Replace(&#8220;&#8220;, &#8220;&#8221;)</p>
<p>can you do a messagebox.show</p>
<p>MessageBox.Show(Dts.Variables(&#8220;XMLOutput&#8221;).Value.ToString)</p>
<p>now if the variable is blank you know what the problem is and you have to figure out why the variable wasn&#8217;t populated</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1010#respond' onclick='return addComment.moveForm( "div-comment-1010", "1010", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1034">
				<div id="div-comment-1034" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/07a48b0c7853172e41f3536a2e303a53?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/07a48b0c7853172e41f3536a2e303a53?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">mim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1034">
			December 3, 2012 at 4:10 am</a>		</div>

		<p>how to write the syntax if i have few tables and i want <br />
they all to be the same level, for example i have album table and also pictures table and i do not want pictures to be under album, any one has an idea?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1034#respond' onclick='return addComment.moveForm( "div-comment-1034", "1034", "respond", "339" )' aria-label='Reply to mim'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1038">
				<div id="div-comment-1038" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1038">
			December 5, 2012 at 8:07 am</a>		</div>

		<p>Min, take a look at <a href="/index.php/DataMgmt/DataDesign/use-for-xml-auto-type-elements-to-get-xm">Use FOR XML AUTO,TYPE, ELEMENTS to get XML in the format you really want with SQL Server FOR XML Syntax</a> to see how you can do it</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1038#respond' onclick='return addComment.moveForm( "div-comment-1038", "1038", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1037">
				<div id="div-comment-1037" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9b7ec0d8b0b2a6fccdb1f0bc81e15ae5?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9b7ec0d8b0b2a6fccdb1f0bc81e15ae5?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">jampa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1037">
			April 29, 2013 at 11:28 am</a>		</div>

		<p>thanks Dennis, we are implementing XML targets now . you&#8217;ll see me on your blog quite often. </p>
<p>Thank you !!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1037#respond' onclick='return addComment.moveForm( "div-comment-1037", "1037", "respond", "339" )' aria-label='Reply to jampa'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-985">
				<div id="div-comment-985" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5c19010fe6ae8221c24ae6f1dd8bca5e?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5c19010fe6ae8221c24ae6f1dd8bca5e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">nadeem</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-985">
			May 9, 2013 at 11:58 am</a>		</div>

		<p>Hi, thankyou for the wonderful post, however can you please provide me the C# code instead of VBCode. I appreciate your help.<br />
Thanks</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=985#respond' onclick='return addComment.moveForm( "div-comment-985", "985", "respond", "339" )' aria-label='Reply to nadeem'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1013">
				<div id="div-comment-1013" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/371b48e69ba97fca2571b671421bddd7?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/371b48e69ba97fca2571b671421bddd7?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">wyscavern</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1013">
			June 17, 2013 at 6:28 pm</a>		</div>

		<p>Hello,<br />
I am new to the blog&#8230;and SSIS. I have tried all of the above. And I now get a file that says System._ComObject. Before I was getting one that said had the begining tags I needed (opening and closing roots). But no information. Each time I would change one thing I would get a million errors&#8230;so. Now I don&#8217;t know what works and what does not. So the actual XML file I need I have a SQL script for&#8230;and the XML file comes out perfect for my needs. But I don&#8217;t know how to save it and then be able to move it to a share drive, so that the information contained insided can be uploaded to another application&#8230;which REQUIRES XML Explicit format. <br />
Can you help? <br />
Nicole Wyscaver</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1013#respond' onclick='return addComment.moveForm( "div-comment-1013", "1013", "respond", "339" )' aria-label='Reply to wyscavern'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1035">
				<div id="div-comment-1035" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a5fe1cd4461d95a136154051128965e3?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a5fe1cd4461d95a136154051128965e3?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Heather</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1035">
			July 9, 2013 at 3:38 pm</a>		</div>

		<p>This article just worked wonders for me! I&#8217;m very new at my job and this explained everything step-by-step from start to finish! Thank you so much!!!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1035#respond' onclick='return addComment.moveForm( "div-comment-1035", "1035", "respond", "339" )' aria-label='Reply to Heather'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1039">
				<div id="div-comment-1039" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3af618948ade9faa63d75794b745bb6b?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3af618948ade9faa63d75794b745bb6b?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Alisha</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1039">
			July 18, 2013 at 9:42 am</a>		</div>

		<p>I have sql to generate multiple xml from single query, one xml file per record. My task is to save them all automatically. can someone please help?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1039#respond' onclick='return addComment.moveForm( "div-comment-1039", "1039", "respond", "339" )' aria-label='Reply to Alisha'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1011">
				<div id="div-comment-1011" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2da1cc711d6498a331c6816cc0a24f16?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2da1cc711d6498a331c6816cc0a24f16?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Abdul</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1011">
			October 11, 2013 at 8:58 am</a>		</div>

		<p>It works like charm.<br />
Thanks a lot</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1011#respond' onclick='return addComment.moveForm( "div-comment-1011", "1011", "respond", "339" )' aria-label='Reply to Abdul'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-380427">
				<div id="div-comment-380427" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/120179fd92f9adc397d715f426a34e9c?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/120179fd92f9adc397d715f426a34e9c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Geetesh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-380427">
			March 17, 2014 at 5:33 pm</a>		</div>

		<p>Hi, Is there a way I can get the XML output in the below format (all elements in newline):</p>
<p>    File.txt</p>
<p>    196<br />
    0<br />
    ALIS Balancing XML message</p>
<p> Right now everything appears in the single line format with the above approach:</p>
<p>File.txt4720ALIS Balancing XML message</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=380427#respond' onclick='return addComment.moveForm( "div-comment-380427", "380427", "respond", "339" )' aria-label='Reply to Geetesh'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1815838">
				<div id="div-comment-1815838" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3277496df9ad27632cebaa5221dd18d2?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3277496df9ad27632cebaa5221dd18d2?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='/index.php/DataMgmt/DBProgramming/create-xml-files-out-of-sql-server-with/' rel='external nofollow' class='url'>Sweta</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1815838">
			September 11, 2014 at 8:43 am</a>		</div>

		<p>Can you explain this line :<br />
XMLString = Dts.Variables(&#8220;XMLOutput&#8221;).Value.ToString.Replace(&#8220;&#8221;, &#8220;&#8221;).Replace(&#8220;&#8221;, &#8220;&#8221;)<br />
will , gets addes since the result set is XML and so we need to remove it?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1815838#respond' onclick='return addComment.moveForm( "div-comment-1815838", "1815838", "respond", "339" )' aria-label='Reply to Sweta'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-1816251">
				<div id="div-comment-1816251" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-1816251">
			September 11, 2014 at 9:57 am</a>		</div>

		<p>ROOT tag gets injected by FOR XML, we don&#8217;t really want that to be in the generated file</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=1816251#respond' onclick='return addComment.moveForm( "div-comment-1816251", "1816251", "respond", "339" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2114795">
				<div id="div-comment-2114795" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/417a0bfcdbe731787d6c4b7f0bff981c?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/417a0bfcdbe731787d6c4b7f0bff981c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Vinay Gambhir</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-2114795">
			October 13, 2014 at 2:28 pm</a>		</div>

		<p>Hi ..</p>
<p>I have got a typical problem.<br />
I connect to DB2 from sql server management studi and execute a stored procedure:<br />
EXEC (&#8216;CALL ENROLLMENT(&#8221;20140601&#8221;,&#8221;20140901&#8221;)&#8217;)At db2serverName</p>
<p>This statement returns two result sets with the following columns:<br />
Recordset 1: Hdr, UserRn, MemberRn, MemberIdentifier, MemberDOB<br />
Recordset 2: Hdr, MemberRn, MemberIdentifier, PlanId, StartDt, EndDt, Rate, Amount</p>
<p>1st recordset is basically the header and 2nd recordset is the detail</p>
<p>I have to create two xml files using the above stored procedure. I am not sure how to handle two recordsets being returned from the above stored proc</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=2114795#respond' onclick='return addComment.moveForm( "div-comment-2114795", "2114795", "respond", "339" )' aria-label='Reply to Vinay Gambhir'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-4024279">
				<div id="div-comment-4024279" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e7eecdcfd3033459ef51b28091405872?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e7eecdcfd3033459ef51b28091405872?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">KDes</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-4024279">
			March 24, 2015 at 9:31 am</a>		</div>

		<p>Any idea what VB code should be used in SSIS 2012? I can&#8217;t get it working, the code builds with errors&#8230;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=4024279#respond' onclick='return addComment.moveForm( "div-comment-4024279", "4024279", "respond", "339" )' aria-label='Reply to KDes'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5060293">
				<div id="div-comment-5060293" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/af55f17728593947c2d26612d1d3348f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/af55f17728593947c2d26612d1d3348f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Dorsun</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/#comment-5060293">
			May 25, 2016 at 7:19 am</a>		</div>

		<p>When I open the xml file that is saved to the folder in notepad, it does not have the xml structure. All the contents are written without any line breaks Makes it hard for reading.<br />
How Can I have the file in the xml structured format?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/create-xml-files-out-of-sql-server-with/?replytocom=5060293#respond' onclick='return addComment.moveForm( "div-comment-5060293", "5060293", "respond", "339" )' aria-label='Reply to Dorsun'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/DataMgmt/DBProgramming/create-xml-files-out-of-sql-server-with-/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='339' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="37f0e884fbad9667e38940169d0a3c95"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552767045"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
