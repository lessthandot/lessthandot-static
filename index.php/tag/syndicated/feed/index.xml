<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>syndicated &#8211; LessthanDot</title>
	<atom:link href="/index.php/tag/syndicated/feed/" rel="self" type="application/rss+xml" />
	<link>/</link>
	<description>A Technical Community for IT Professionals</description>
	<lastBuildDate>Sat, 09 Mar 2019 12:50:36 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.6.1</generator>
	<item>
		<title>Overview of Published Articles &#8211; 2015Q2</title>
		<link>/index.php/webdev/business-intelligence/overview-of-published-articles-2015q2/</link>
		<comments>/index.php/webdev/business-intelligence/overview-of-published-articles-2015q2/#respond</comments>
		<pubDate>Thu, 09 Jul 2015 12:31:10 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Business Intelligence]]></category>
		<category><![CDATA[articles]]></category>
		<category><![CDATA[mds]]></category>
		<category><![CDATA[power bi]]></category>
		<category><![CDATA[power query]]></category>
		<category><![CDATA[sql server]]></category>
		<category><![CDATA[syndicated]]></category>

		<guid isPermaLink="false">/?p=3479</guid>
		<description><![CDATA[Here is an overview of the articles I published in the second¬†quarter of 2015. INTENSE SCHOOL Book Review: Query Tuning &#38; Optimization by Benjamin Nevarez MSSQLTIPS I&#8217;ve been busy writing tips! Purging Entity Members in SQL Server Master Data Services Using the Transaction History in SQL Server Master Data Services Introduction to Power Query for [&#8230;]]]></description>
				<content:encoded><![CDATA[<p style="color: #2f2f2f">Here is an overview of the articles I published in the second¬†quarter of 2015.</p>
<p style="color: #2f2f2f"><strong>INTENSE SCHOOL</strong></p>
<ul style="color: #2f2f2f">
<li><a href="http://resources.intenseschool.com/book-review-query-tuning-optimization-by-benjamin-nevarez/">Book Review: Query Tuning &amp; Optimization by Benjamin Nevarez</a></li>
</ul>
<p><strong style="color: #2f2f2f">MSSQLTIPS</strong></p>
<p>I&#8217;ve been busy writing tips!</p>
<ul style="color: #2f2f2f">
<li><a href="https://www.mssqltips.com/sqlservertip/3646/purging-entity-members-in-sql-server-master-data-services/">Purging Entity Members in SQL Server Master Data Services</a></li>
<li><a href="https://www.mssqltips.com/sqlservertip/3645/using-the-transaction-history-in-sql-server-master-data-services/">Using the Transaction History in SQL Server Master Data Services</a></li>
<li><a href="https://www.mssqltips.com/sqlservertip/3588/introduction-to-power-query-for-excel/">Introduction to Power Query for Excel</a></li>
<li><a href="https://www.mssqltips.com/sqlservertip/3625/extracting-a-sharepoint-list-with-power-query/">Extracting a SharePoint List with Power Query</a></li>
<li><a href="https://www.mssqltips.com/sqlservertip/3635/query-folding-in-power-query-to-improve-performance-/">Query Folding in Power Query to Improve Performance</a></li>
<li><a href="https://www.mssqltips.com/sqlservertip/3667/sql-server-2016-features-in-ctp2/">SQL Server 2016 Features in CTP2</a></li>
</ul>
<p>More tips about SQL Server 2016 are in the pipeline!</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/webdev/business-intelligence/overview-of-published-articles-2015q2/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>How to drop a Temporal Table</title>
		<link>/index.php/uncategorized/how-to-drop-a-temporal-table/</link>
		<comments>/index.php/uncategorized/how-to-drop-a-temporal-table/#comments</comments>
		<pubDate>Fri, 03 Jul 2015 07:39:59 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[business intelligence]]></category>
		<category><![CDATA[sql 2016]]></category>
		<category><![CDATA[sql server]]></category>
		<category><![CDATA[syndicated]]></category>
		<category><![CDATA[temporal table]]></category>

		<guid isPermaLink="false">/?p=3465</guid>
		<description><![CDATA[No no, I didn&#8217;t say temporary, but temporal! SQL Server 2016 introduces a great new feature called Temporal Tables. Or in other words, system-versioned tables. We&#8217;ll see what catches on. In a gist, such a table keeps track of the history of its rows by the use of some audit columns (start and end date) [&#8230;]]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify">No no, I didn&#8217;t say <em>temporary</em>, but <strong>temporal</strong>! SQL Server 2016 introduces a great new feature called <strong>Temporal Tables</strong>. Or in other words, system-versioned tables. We&#8217;ll see what catches on. In a gist, such a table keeps track of the history of its rows by the use of some audit columns (start and end date) and a history table. Sounds a bit like the love child of Change Data Capture and a Type 2 dimension.</p>
<p style="text-align: justify">Anyway, I was testing this feature a bit (more specifically if they supported computed columns as promised in CTP 2.1) and I created a temporal table with the following query:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> dbo.<span class="me1">TestTemporal</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#40;</span>ID <span class="kw1">int</span> <span class="kw1">primary</span> <span class="kw1">key</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,A <span class="kw1">int</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,B <span class="kw1">int</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,C <span class="kw1">AS</span> A <span class="sy0">*</span> B
&nbsp; &nbsp; &nbsp; &nbsp; ,SysStartTime datetime2 GENERATED ALWAYS <span class="kw1">AS</span> <span class="kw1">ROW</span> <span class="kw1">START</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,SysEndTime datetime2 GENERATED ALWAYS <span class="kw1">AS</span> <span class="kw1">ROW</span> <span class="kw1">END</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,PERIOD <span class="kw1">FOR</span> SYSTEM_TIME <span class="br0">&#40;</span>SysStartTime,SysEndTime<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">WITH</span><span class="br0">&#40;</span>SYSTEM_VERSION<span class="sy0">IN</span>G <span class="sy0">=</span> <span class="kw1">ON</span><span class="br0">&#41;</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE dbo.TestTemporal
		(ID int primary key
		,A int
		,B int
		,C AS A * B
		,SysStartTime datetime2 GENERATED ALWAYS AS ROW START NOT NULL
		,SysEndTime datetime2 GENERATED ALWAYS AS ROW END NOT NULL
		,PERIOD FOR SYSTEM_TIME (SysStartTime,SysEndTime)) WITH(SYSTEM_VERSIONING = ON);</pre></div></div>

<p style="text-align: justify">This code only works in CTP2.1, not in earlier versions of SQL 2016 because of the computed column specification.<br />
Anyway, of course I forgot to set my database so this table was created in the master database. I wanted to drop it, but I was greeted with this lovely message:</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2015/07/errormessage.png"><img class="alignnone size-full wp-image-3466" src="/wp-content/uploads/2015/07/errormessage.png" alt="errormessage" width="716" height="151" srcset="/wp-content/uploads/2015/07/errormessage.png 716w, /wp-content/uploads/2015/07/errormessage-300x63.png 300w" sizes="(max-width: 716px) 100vw, 716px" /></a></p>
<p style="text-align: justify">Even the <em>Delete</em> action was missing from the table&#8217;s context menu.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2015/07/nodelete.png"><img class="alignnone size-full wp-image-3467" src="/wp-content/uploads/2015/07/nodelete.png" alt="nodelete" width="312" height="364" srcset="/wp-content/uploads/2015/07/nodelete.png 312w, /wp-content/uploads/2015/07/nodelete-257x300.png 257w" sizes="(max-width: 312px) 100vw, 312px" /></a></p>
<p style="text-align: justify">A quick look on the MSDN page¬†<a href="https://msdn.microsoft.com/en-us/library/dn935015.aspx">Temporal Tables</a>¬†teaches us that dropping a system-versioned table is a¬†<em>disallowed Alter Schema operation</em>. No luck there. The answer came, as usual, through Twitter:</p>
<blockquote class="twitter-tweet" lang="en">
<p dir="ltr" lang="en"><a href="https://twitter.com/Ko_Ver">@Ko_Ver</a> did you try to remove temporal setting before dropping it?</p>
<p>‚Äî Janos Berke (@JanosBerke) <a href="https://twitter.com/JanosBerke/status/615491933146861568">June 29, 2015</a></p></blockquote>
<p style="text-align: justify">Turning the system-versioning off and dropping the table is the answer to our question (and to about any schema operation you want to do on a system-versioned table). If we execute such an ALTER TABLE script, we get the following:</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2015/07/after_alter.png"><img class="alignnone size-full wp-image-3468" src="/wp-content/uploads/2015/07/after_alter.png" alt="after_alter" width="830" height="99" srcset="/wp-content/uploads/2015/07/after_alter.png 830w, /wp-content/uploads/2015/07/after_alter-300x35.png 300w" sizes="(max-width: 830px) 100vw, 830px" /></a></p>
<p style="text-align: justify">The temporal table is reduced to a normal table, which means it can be dropped as a normal table. But the history table is kept as well. This means you can always re-enable system-versioning if you want to.<br />
The name of the history table is dbo.MSSQL_TemporalHistoryFor_xxx, where xxx is the object id of the main table. Something to keep in mind if you want to automate scripts. Or just specify a friendly name when enabling system-versioning.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/uncategorized/how-to-drop-a-temporal-table/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		</item>
		<item>
		<title>Doing a Full Outer Join in Power Query</title>
		<link>/index.php/webdev/business-intelligence/doing-a-full-outer-join-in-power-query/</link>
		<comments>/index.php/webdev/business-intelligence/doing-a-full-outer-join-in-power-query/#comments</comments>
		<pubDate>Thu, 02 Jul 2015 11:55:34 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Business Intelligence]]></category>
		<category><![CDATA[join]]></category>
		<category><![CDATA[power bi]]></category>
		<category><![CDATA[power query]]></category>
		<category><![CDATA[syndicated]]></category>

		<guid isPermaLink="false">/?p=3450</guid>
		<description><![CDATA[A while back a give a session at the element61 Microsoft Business Analytics Day, a free event where the capabilities of ¬†the Microsoft BI platform is demonstrated alongside client testimonials. I gave a session called &#8220;Drilling across Analysis Services cubes using Power Query&#8221;, which talked about how you can use Power Query to do a [&#8230;]]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify">A while back a give a session at the <a href="http://www.element61.be/">element61 </a>Microsoft Business Analytics Day, a free event where the capabilities of ¬†the Microsoft BI platform is demonstrated alongside client testimonials. I gave a session called &#8220;Drilling across Analysis Services cubes using Power Query&#8221;, which talked about how you can use Power Query to do a <em>drill across</em> analysis over multiple SSAS cubes. Drilling across combines facts from multiple fact tables through their conformed dimensions, something that is not possible if your data is split up against multiple cubes. I even wrote an article about it: <a href="http://www.element61.be/e/resourc-detail.asp?ResourceId=876">Drilling across Analysis Services cubes using Power Query</a>.</p>
<p style="text-align: justify">Basically the solution is to create a query for each fact table and then combine them using the Merge transformation in Power Query, which basically is a Left or Inner Join. At the end of the session, I got the question if it&#8217;s possible to do a Full Outer Join instead, to which my initial response was &#8220;Ehrmmm&#8230;&#8221;. It&#8217;s not possible through the user interface, so I gave the advice to create a query that contains the cross join of the dimensions you want to use, then left join all the fact tables against that query and at the end filter out any rows where all the facts are empty. This advice still stands for people who do not want to write a single line of code in Power Query. However, when reading Chris Webbs <a href="http://www.amazon.com/Power-Query-BI-Excel/dp/1430266910/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1435817503&amp;sr=1-1">excellent book about Power Query</a>¬†and more specifically the chapter about M, I realized there is a more elegant solution out there.</p>
<p style="text-align: justify">In this blog post, I&#8217;ll use the following data as a source:</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2015/07/MergeSource.jpg"><img class="alignnone size-full wp-image-3455" src="/wp-content/uploads/2015/07/MergeSource.jpg" alt="MergeSource" width="478" height="135" srcset="/wp-content/uploads/2015/07/MergeSource.jpg 478w, /wp-content/uploads/2015/07/MergeSource-300x84.jpg 300w" sizes="(max-width: 478px) 100vw, 478px" /></a></p>
<p style="text-align: justify">You start out just as usual, by creating two queries on top of the these¬†tables and then merging them together in the user interface.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2015/07/MergeGUI.jpg"><img class="alignnone wp-image-3456" src="/wp-content/uploads/2015/07/MergeGUI-e1435818852971.jpg" alt="MergeGUI" width="800" height="670" srcset="/wp-content/uploads/2015/07/MergeGUI-e1435818852971.jpg 871w, /wp-content/uploads/2015/07/MergeGUI-e1435818852971-300x251.jpg 300w" sizes="(max-width: 800px) 100vw, 800px" /></a></p>
<p style="text-align: justify">After clicking OK, you get the following result:</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2015/07/MergeResult.jpg"><img class="alignnone wp-image-3457 size-full" src="/wp-content/uploads/2015/07/MergeResult-e1435818919233.jpg" alt="MergeResult" width="757" height="175" srcset="/wp-content/uploads/2015/07/MergeResult-e1435818919233.jpg 757w, /wp-content/uploads/2015/07/MergeResult-e1435818919233-300x69.jpg 300w" sizes="(max-width: 757px) 100vw, 757px" /></a></p>
<p style="text-align: justify">The import part here is the M formula in the formula bar. There is actually room for a final, optional parameter: <strong>JoinKind</strong>. If we simply add JoinKind.FullOuter, we get our desired result.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2015/07/MergeResult_FullOuter.jpg"><img class="alignnone size-full wp-image-3458" src="/wp-content/uploads/2015/07/MergeResult_FullOuter.jpg" alt="MergeResult_FullOuter" width="902" height="187" srcset="/wp-content/uploads/2015/07/MergeResult_FullOuter.jpg 902w, /wp-content/uploads/2015/07/MergeResult_FullOuter-300x62.jpg 300w" sizes="(max-width: 902px) 100vw, 902px" /></a></p>
<p style="text-align: justify">Of course, we still have to expand the NewColumn column to retrieve the Category and the Value from the right input.</p>
<p style="text-align: justify">¬†<a href="/wp-content/uploads/2015/07/MergeResult_Expand.jpg"><img class="alignnone size-full wp-image-3459" src="/wp-content/uploads/2015/07/MergeResult_Expand.jpg" alt="MergeResult_Expand" width="1050" height="188" srcset="/wp-content/uploads/2015/07/MergeResult_Expand.jpg 1050w, /wp-content/uploads/2015/07/MergeResult_Expand-300x53.jpg 300w, /wp-content/uploads/2015/07/MergeResult_Expand-1024x183.jpg 1024w" sizes="(max-width: 1050px) 100vw, 1050px" /></a></p>
<p style="text-align: justify">And finally we have to do some cosmetics to get a decent presentable result:</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2015/07/MergeFinalResult.jpg"><img class="alignnone size-full wp-image-3460" src="/wp-content/uploads/2015/07/MergeFinalResult.jpg" alt="MergeFinalResult" width="354" height="141" srcset="/wp-content/uploads/2015/07/MergeFinalResult.jpg 354w, /wp-content/uploads/2015/07/MergeFinalResult-300x119.jpg 300w" sizes="(max-width: 354px) 100vw, 354px" /></a></p>
<p style="text-align: justify">I added¬†the following transformations:</p>
<ul style="text-align: justify">
<li>Renaming columns</li>
<li>Adding a custom column taking the left category, unless it is null, then the right category is taken</li>
<li>Removing the old category columns</li>
<li>Moving columns around</li>
</ul>
<p style="text-align: justify"><strong>Conclusion</strong></p>
<p style="text-align: justify">Doing a Full Outer Join in Power Query is really straight forward and you don&#8217;t have to be an M guru to adapt the code.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/webdev/business-intelligence/doing-a-full-outer-join-in-power-query/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>SQL Server 2016 CTP 2.1 has been released</title>
		<link>/index.php/datamgmt/dbprogramming/mssqlserver/sql-server-2016-ctp-2-1-has-been-released/</link>
		<comments>/index.php/datamgmt/dbprogramming/mssqlserver/sql-server-2016-ctp-2-1-has-been-released/#respond</comments>
		<pubDate>Mon, 29 Jun 2015 12:59:52 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[sql 2016]]></category>
		<category><![CDATA[sql server]]></category>
		<category><![CDATA[syndicated]]></category>

		<guid isPermaLink="false">/?p=3432</guid>
		<description><![CDATA[Microsoft is all about rapid release cycles nowadays. We already experienced this with Power BI, where monthly new features and improvements have been added. Now SQL Server appears to get the same treatment: SQL Server 2016 CTP 2.1 has just been released.¬†There is nothing groundbreaking in this release &#8211; which can be considered as an [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Microsoft is all about rapid release cycles nowadays. We already experienced this with Power BI, where monthly new features and improvements have been added.<br />
Now SQL Server appears to get the same treatment: <a href="http://blogs.technet.com/b/dataplatforminsider/archive/2015/06/24/sql-server-2016-community-technology-preview-2-1-is-available.aspx">SQL Server 2016 CTP 2.1 has just been released</a>.¬†There is nothing groundbreaking in this release &#8211; which can be considered as an upgrade of CTP2 &#8211; but there are some additional functionalities and improvements in the database engine.</p>
<p>If you have already installed CTP2, you can just upgrade it to CTP2.1 following the usual upgrade procedure. Just spin-up the SQL Server set-up, go to Installation and choose <i>Upgrade from a previous version of SQL Server</i>. Hit Next a few times, choose which instance and which features you want to upgrade and you&#8217;re all done.</p>
<p>Before:</p>
<p><a href="/wp-content/uploads/2015/06/version_1.png"><img class="alignnone size-full wp-image-3433" src="/wp-content/uploads/2015/06/version_1.png" alt="version_1" width="350" height="141" srcset="/wp-content/uploads/2015/06/version_1.png 350w, /wp-content/uploads/2015/06/version_1-300x120.png 300w" sizes="(max-width: 350px) 100vw, 350px" /></a></p>
<p>After:</p>
<p><a href="/wp-content/uploads/2015/06/version_2.png"><img class="alignnone size-full wp-image-3434" src="/wp-content/uploads/2015/06/version_2.png" alt="version_2" width="317" height="145" srcset="/wp-content/uploads/2015/06/version_2.png 317w, /wp-content/uploads/2015/06/version_2-300x137.png 300w" sizes="(max-width: 317px) 100vw, 317px" /></a></p>
<p>One of the new features for example is the ability to use¬†computed columns in¬†a temporal table. Exciting! (OK, I&#8217;m just using this as an example that I actually upgraded my system)</p>
<p><a href="/wp-content/uploads/2015/06/temporal_before.png"><img class="alignnone size-full wp-image-3437" src="/wp-content/uploads/2015/06/temporal_before.png" alt="temporal_before" width="973" height="317" srcset="/wp-content/uploads/2015/06/temporal_before.png 973w, /wp-content/uploads/2015/06/temporal_before-300x97.png 300w" sizes="(max-width: 973px) 100vw, 973px" /></a></p>
<p>After the upgrade:</p>
<p><a href="/wp-content/uploads/2015/06/temporal_after-e1435582654552.png"><img class="alignnone size-full wp-image-3441" src="/wp-content/uploads/2015/06/temporal_after-e1435582654552.png" alt="temporal_after" width="640" height="231" srcset="/wp-content/uploads/2015/06/temporal_after-e1435582654552.png 640w, /wp-content/uploads/2015/06/temporal_after-e1435582654552-300x108.png 300w" sizes="(max-width: 640px) 100vw, 640px" /></a></p>
<p>&nbsp;</p>
<p>Anyway, I hope we can see more incremental releases of SQL 2016 soon and dare I say with more exciting Business Intelligence features.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/mssqlserver/sql-server-2016-ctp-2-1-has-been-released/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Demystifying Power BI &#8211; slidedeck</title>
		<link>/index.php/uncategorized/demystifying-power-bi-slidedeck/</link>
		<comments>/index.php/uncategorized/demystifying-power-bi-slidedeck/#respond</comments>
		<pubDate>Tue, 16 Jun 2015 10:15:31 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[excel]]></category>
		<category><![CDATA[itproceed]]></category>
		<category><![CDATA[power bi]]></category>
		<category><![CDATA[sql server]]></category>
		<category><![CDATA[syndicated]]></category>

		<guid isPermaLink="false">/?p=3418</guid>
		<description><![CDATA[ITPROceed has come to an end and what a great event it was. Kudos to the organizers and all the other speakers! My session went pretty well, at least from my point of view, although I had to rush my demos a bit since there was only a 50 minute time slot. I prepared for [&#8230;]]]></description>
				<content:encoded><![CDATA[<p><a href="/index.php/webdev/business-intelligence/speaking-at-itproceed-2015/">ITPROceed </a>has come to an end and what a great event it was. Kudos to the organizers and all the other speakers!</p>
<p>My session went pretty well, at least from my point of view, although I had to rush my demos a bit since there was only a 50 minute time slot. I prepared for 1 hour of course <img src="https://s.w.org/images/core/emoji/2/72x72/1f642.png" alt="üôÇ" class="wp-smiley" style="height: 1em; max-height: 1em;" /><br />
I saw some pretty interesting stuff about Azure SQL DB and I really liked the session about Azure Stream Analytics. And I won a Bose headphone, so that&#8217;s nice as well <img src="https://s.w.org/images/core/emoji/2/72x72/1f600.png" alt="üòÄ" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Congrats <a href="https://twitter.com/Ko_Ver">@Ko_Ver</a> for winning the <a href="https://twitter.com/Derdack">@Derdack</a> customized Noise Cancelling <a href="https://twitter.com/Bose">@Bose</a> headphones! <a href="https://twitter.com/ITPROceed">@ITPROceed</a> <a href="https://twitter.com/EnterpriseAlert">@EnterpriseAlert</a> <a href="http://t.co/vPy7i8Lk2j">pic.twitter.com/vPy7i8Lk2j</a></p>
<p>&mdash; Stefanie Gerken (@StefanieGerken) <a href="https://twitter.com/StefanieGerken/status/608989760363884545">June 11, 2015</a></p></blockquote>
<p>Anyway, you can find the slidedeck here on <a href="http://www.slideshare.net/KoenVerbeeck/demystifying-power-bi">SlideShare</a>.<br />
You can download them and use them for your own use, but with proper attribution.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/uncategorized/demystifying-power-bi-slidedeck/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>SQL 2016 Preview has been released!</title>
		<link>/index.php/datamgmt/dbprogramming/mssqlserver/sql-2016-preview-has-been-released/</link>
		<comments>/index.php/datamgmt/dbprogramming/mssqlserver/sql-2016-preview-has-been-released/#comments</comments>
		<pubDate>Thu, 28 May 2015 10:54:51 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[ctp2]]></category>
		<category><![CDATA[sql server]]></category>
		<category><![CDATA[sql2016]]></category>
		<category><![CDATA[ssis]]></category>
		<category><![CDATA[ssrs]]></category>
		<category><![CDATA[syndicated]]></category>

		<guid isPermaLink="false">/?p=3394</guid>
		<description><![CDATA[For those who haven&#8217;t noticed already: SQL Server 2016 CTP2 (or Preview as some call it) has just been released! This means it is play time! üôÇ You can either download a copy if you&#8217;re old school like me, or you can spin up a VM in Azure like all the cool kids. SQL Server [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>For those who haven&#8217;t noticed already:</p>
<p>SQL Server 2016 CTP2 (or Preview as some call it) has just been released!<br />
This means it is play time! <img src="https://s.w.org/images/core/emoji/2/72x72/1f642.png" alt="üôÇ" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<p>You can either download a copy if you&#8217;re old school like me, or you can spin up a VM in Azure like all the cool kids.</p>
<p><a href="http://blogs.technet.com/b/dataplatforminsider/archive/2015/05/27/sql-server-2016-first-public-preview-now-available.aspx">SQL Server 2016 first public preview now available!</a></p>
<p>Some of my favorite features (although some are not yet in the preview):</p>
<ul>
<li>SSIS incremental deployment model (aka deploy only 1 package to the SSIS catalog). Although I understand the reason of the SSIS team to first allow only deployments of full projects, there are a lot of customers that want this functionality.</li>
<li>Power Query in all the things! (more specifically: in SSIS and SSRS)</li>
<li>R integration in SSRS (this should allow you to do amazing things with SSRS)</li>
<li>SSRS revamp (still have to see it though, but I&#8217;m already excited!)</li>
<li><a href="https://msdn.microsoft.com/en-us/library/dn935015(v=sql.130).aspx">Temporal tables¬†</a></li>
<li><a href="http://www.brentozar.com/archive/2015/05/announcing-live-query-execution-plans/">Live query plans</a> (seems pretty awesome)</li>
<li>DAX enhancements (many 2 many, median, percentiles, and so on)</li>
</ul>
<p>Here&#8217;s a good overview of what you can expect in SQL Server 2016:</p>
<p><a href="http://sqlblog.com/blogs/jorg_klein/archive/2015/05/22/bi-on-your-terms-with-sql-server-2016.aspx">BI on your terms with SQL Server 2016</a></p>
<p>Be careful, if you install Polybase, you apparently need the Oracle JRE. Boooo.</p>
<p><a href="/wp-content/uploads/2015/05/polybase_jre.jpg"><img class="alignnone size-full wp-image-3395" src="/wp-content/uploads/2015/05/polybase_jre.jpg" alt="polybase_jre" width="594" height="285" srcset="/wp-content/uploads/2015/05/polybase_jre.jpg 594w, /wp-content/uploads/2015/05/polybase_jre-300x143.jpg 300w" sizes="(max-width: 594px) 100vw, 594px" /></a></p>
<p>Anyway, a lot of goodness and I am very excited about this release.</p>
<p>&nbsp;</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/mssqlserver/sql-2016-preview-has-been-released/feed/</wfw:commentRss>
		<slash:comments>6</slash:comments>
		</item>
		<item>
		<title>Overview of the data visualization books by Stephen Few</title>
		<link>/index.php/webdev/business-intelligence/overview-stephen-few/</link>
		<comments>/index.php/webdev/business-intelligence/overview-stephen-few/#comments</comments>
		<pubDate>Tue, 07 Apr 2015 12:04:16 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Business Intelligence]]></category>
		<category><![CDATA[dashboard]]></category>
		<category><![CDATA[data visualization]]></category>
		<category><![CDATA[dataviz]]></category>
		<category><![CDATA[stephen few]]></category>
		<category><![CDATA[syndicated]]></category>

		<guid isPermaLink="false">/?p=3337</guid>
		<description><![CDATA[I recently finished the book Now You See It: Simple Visualization Techniques for Quantitative Analysis by Stephen Few of Perceptual Edge. Stephen Few is a data visualization guru and his books about designed visualizations has changed my career in BI and how I develop reports and dashboards. Few currently has three books published (with a [&#8230;]]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify">I recently finished the book <a href="http://www.amazon.com/Now-You-See-Visualization-Quantitative/dp/0970601980/ref=la_B001H6IQ5M_1_3?s=books&amp;ie=UTF8&amp;qid=1428393017&amp;sr=1-3">Now You See It: Simple Visualization Techniques for Quantitative Analysis</a> by Stephen Few of <a href="http://www.perceptualedge.com/">Perceptual Edge</a>. Stephen Few is a data visualization guru and his books about designed visualizations has changed my career in BI and how I develop reports and dashboards. Few currently has three books published (with <a href="http://www.perceptualedge.com/blog/?p=1749">a fourth on its way</a>):</p>
<ul style="text-align: justify">
<li><a href="http://www.amazon.com/Show-Me-Numbers-Designing-Enlighten/dp/0970601972/ref=la_B001H6IQ5M_1_2?s=books&amp;ie=UTF8&amp;qid=1428393017&amp;sr=1-2">Show Me the Numbers: Designing Tables and Graphs to Enlighten</a>, which has already 2 editions.</li>
<li><a href="http://www.amazon.com/Information-Dashboard-Design-At---Glance/dp/1938377001/ref=la_B001H6IQ5M_1_1?s=books&amp;ie=UTF8&amp;qid=1428393017&amp;sr=1-1">Information Dashboard Design</a>, which also has 2 published editions.</li>
<li><a href="http://www.amazon.com/Now-You-See-Visualization-Quantitative/dp/0970601980/ref=la_B001H6IQ5M_1_3?s=books&amp;ie=UTF8&amp;qid=1428393017&amp;sr=1-3">Now You See It: Simple Visualization Techniques for Quantitative Analysis</a></li>
</ul>
<p style="text-align: justify">I‚Äôm a huge fan of Few‚Äôs work and this blog post is meant as an introduction to his different titles, so people know what to expect when they read one of his books. I‚Äôll review each of them in the order that I‚Äôve read them (which actually has no specific meaning).</p>
<h1 style="text-align: justify">Information Dashboard Design</h1>
<p style="text-align: justify"><a href="http://amzn.to/1SnBSj9"><img class="alignnone" style="float: left;margin: 0px 10px 0px 10px" src="/wp-content/uploads/2015/04/dashboard-150x150.jpg" alt="dashboard" width="150" height="150" /></a>This book really opened my eyes regarding data visualization best practices. I read the first edition, of which you can find my review <a href="/index.php/itprofessionals/book-review/data-visualization-book-review/">here</a>. I ordered the second edition the day it came out; the book is that good.</p>
<p style="text-align: justify">As the title says, this book explains how to design dashboards efficiently. It introduces you to the principles of visual perception and how you can use those to make better dashboards. It also gives plenty examples of bad and good dashboard design.</p>
<p style="text-align: justify">Even though its focus is on dashboards, a lot of the design principles are true for regular reports and visualizations as well. I could apply them immediately at my job when creating SSRS reports.</p>
<h1 style="text-align: justify">Show me the Numbers</h1>
<p style="text-align: justify"><a href="http://amzn.to/1Oejusx"><img class="alignnone" style="float: left;margin: 0px 10px 0px 10px" src="/wp-content/uploads/2015/04/showmethenumbers-150x150.jpg" alt="showmethenumbers" width="150" height="150" /></a>After reading <em>Information Dashboard Design</em>, I thought: ‚ÄúGreat, now I know how to design dashboards and charts, but what about tables?‚Äù This book is the answer to that question. It gives a full overview on how to design data visualizations, be it tables or graphs. There are even some exercises in the book.</p>
<p style="text-align: justify">This makes the book more complete than <em>Information Dashboard Design</em>. There is in fact quite some considerable overlap between the two books. If you want to buy only one book about data visualization, I recommend this one. If you are interested in dashboards only and how multiple graphs can interact on one page, then get the other book.</p>
<p style="text-align: justify">There are also some interesting appendices to this book, such as adjusting for inflation and how to create some chart types in Excel.</p>
<h1 style="text-align: justify">Now you see it</h1>
<p style="text-align: justify"><a href="http://amzn.to/1OejBUY"><img class="alignnone" style="float: left;margin: 0px 10px 0px 10px" src="/wp-content/uploads/2015/04/nowyouseeit-150x150.jpg" alt="nowyouseeit" width="150" height="150" /></a>The final book is a bit more different. While the other two books focus more on how to create data visualizations, this book goes into more detail on what you should do with those visualizations and why purpose they can serve.</p>
<p style="text-align: justify">This book is meant for people using visualizations for analytic purposes. It describes what characteristics analysts should have, what kind of analytical interaction and navigation there is and how analytical software should support it. Very interesting to read, because even 6 years after this book has been published, not a single software product supports all of those features.</p>
<p style="text-align: justify">It also describes analytical techniques such as using reference lines, reducing overplotting and using trellises. The book then talks about patterns and then details all the different types of relationships: time-series, ranking, deviation, distribution, correlation and multivariate analysis. Most of the time examples were made using Excel, Tableau or Spotfire.</p>
<p style="text-align: justify">All in all a very interesting book to read. I definitely recommend it for people who have to analyze data as part of their job.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/webdev/business-intelligence/overview-stephen-few/feed/</wfw:commentRss>
		<slash:comments>5</slash:comments>
		</item>
		<item>
		<title>The shaky bug in SSIS</title>
		<link>/index.php/datamgmt/ssis/the-shaky-bug-in-ssis/</link>
		<comments>/index.php/datamgmt/ssis/the-shaky-bug-in-ssis/#respond</comments>
		<pubDate>Tue, 24 Mar 2015 11:52:20 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[SSIS]]></category>
		<category><![CDATA[bug]]></category>
		<category><![CDATA[jitter]]></category>
		<category><![CDATA[shake]]></category>
		<category><![CDATA[ssis]]></category>
		<category><![CDATA[syndicated]]></category>

		<guid isPermaLink="false">/?p=3312</guid>
		<description><![CDATA[You may or may not have noticed it after installing SQL Server 2012: the designer interface in Visual Studio 2010/2012 has had a make-over. Nothing too drastic, but at least the undo button works. However, sometimes when you drag or move tasks/components on the canvas, they start to shake. A lot. And very annoyingly as [&#8230;]]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify">You may or may not have noticed it after installing SQL Server 2012: the designer interface in Visual Studio 2010/2012 has had a make-over. Nothing too drastic, but at least the undo button works. However, sometimes when you drag or move tasks/components on the canvas, they start to shake. A lot. And very annoyingly as well. (Quite impossible to take a screenshot of that, so sorry). This behaviour emerged after applying CU6. There are Connect items logged about this issue:</p>
<ul>
<li><a href="https://connect.microsoft.com/SQLServer/feedback/details/790470/when-dragging-ssis-objects-on-canvas-the-objects-shake-jiggle-jitter">When dragging SSIS objects on canvas the objects shake/jiggle/jitter</a></li>
<li><a href="https://connect.microsoft.com/SQLServer/feedback/details/776664/ssis-2012-control-flow-moving-objects-is-unusable">SSIS 2012 Control Flow moving objects is unusable</a></li>
</ul>
<p style="text-align: justify">Luckily Microsoft patched this bug in CU7. You can download the hotfix <a href="https://support.microsoft.com/en-us/kb/2883424/en-us?wa=wsignin1.0">here</a>. If your environment is up-to-date with the latest patches, most likely you won&#8217;t experience this bug.</p>
<p style="text-align: justify">I patched the Visual Studio 2010 environment at the client and the issue went away. But at home I use Visual Studio 2012 and the issue was still there, even after applying the fix. Fortunately, Twitter was there with the answer:</p>
<blockquote class="twitter-tweet" lang="en"><p><a href="https://twitter.com/Ko_Ver">@Ko_Ver</a> Ok, because the CU that fixes that only updates the DLL&#8217;s for VS2010, you need to manually overwrite the assemblies in VS2012 folder</p>
<p>‚Äî Jan Van humbeek (@janvanhumbeek) <a href="https://twitter.com/janvanhumbeek/status/517569881672544256">October 2, 2014</a></p></blockquote>
<p>If you go back to the <a href="https://connect.microsoft.com/SQLServer/feedback/details/790470/when-dragging-ssis-objects-on-canvas-the-objects-shake-jiggle-jitter">first Connect item</a>, these steps are described in the work arounds and they work like a charm.</p>
<p>The issue has also been <a href="https://connect.microsoft.com/SQLServer/feedback/details/1013088/ssis-2014-control-flow-moving-objects-is-unusable">reported for SSIS 2014</a>, and while the item has been closed as fixed, there&#8217;s no explanation on how it is fixed. Maybe in an upcoming CU for SQL Server 2014? It&#8217;s possible the same work around works for SSIS 2014, but I haven&#8217;t tried it (I don&#8217;t have the bug in Visual Studio 2013) so if you do try it, it&#8217;s at your own risk.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/ssis/the-shaky-bug-in-ssis/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>Solving a slow running query issue with UNION</title>
		<link>/index.php/datamgmt/dbprogramming/mssqlserver/solving-a-slow-running-query-issue-with-union/</link>
		<comments>/index.php/datamgmt/dbprogramming/mssqlserver/solving-a-slow-running-query-issue-with-union/#comments</comments>
		<pubDate>Wed, 25 Feb 2015 11:38:03 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[performance]]></category>
		<category><![CDATA[sql]]></category>
		<category><![CDATA[sql server]]></category>
		<category><![CDATA[syndicated]]></category>
		<category><![CDATA[t-sql]]></category>

		<guid isPermaLink="false">/?p=3253</guid>
		<description><![CDATA[That&#8217;s right! I will solve a performance issue by adding a UNION into the query. Interested? Read on! I recently encountered a curious issue with a query. The query itself wasn‚Äôt exactly rocket science: it read data from a few tables and calculated the start and the end dates of a contract in the SELECT [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>That&#8217;s right! I will solve a performance issue by adding a UNION into the query. Interested? Read on!</p>
<p>I recently encountered a curious issue with a query. The query itself wasn‚Äôt exactly rocket science: it read data from a few tables and calculated the start and the end dates of a contract in the SELECT statement. In an outer query there‚Äôs a range join with a date dimension to explode the data over the different months. Let me explain that last part. Suppose we have a contract with ID 5 that is valid between January 2015 and March 2015. The range join with the date dimension would thus return 3 rows:</p>
<p><a href="/wp-content/uploads/2015/02/Exploding.png"><img class="alignnone size-full wp-image-3257" src="/wp-content/uploads/2015/02/Exploding.png" alt="Exploding" width="187" height="97" /></a></p>
<p>The query looked something like this:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="de1"><pre class="de1"><span class="kw1">WITH</span> CTE_Contracts <span class="kw1">AS</span>
<span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c.<span class="me1">ContractID</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,ContractFrom &nbsp; <span class="sy0">=</span> IIF<span class="br0">&#40;</span> ... <span class="me1">some</span> <span class="kw1">date</span> logic<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,ContractTo &nbsp; &nbsp; <span class="sy0">=</span> IIF<span class="br0">&#40;</span> ... <span class="me1">some</span> <span class="kw1">date</span> logic<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> contracts&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c
&nbsp; &nbsp; <span class="sy0">JOIN</span> contractsdetail&nbsp; &nbsp; cd <span class="kw1">ON</span> c.<span class="me1">ContractID</span> <span class="sy0">=</span> cd.<span class="me1">ContractID</span>
<span class="br0">&#41;</span>
<span class="kw1">SELECT</span>
&nbsp; &nbsp; &nbsp;ContractID
&nbsp; &nbsp; ,ContractMonth <span class="sy0">=</span> d.<span class="br0">&#91;</span><span class="kw1">Month</span><span class="br0">&#93;</span>
<span class="kw1">FROM</span> CTE_Contracts&nbsp; c
<span class="sy0">JOIN</span> dateDim&nbsp; &nbsp; &nbsp; &nbsp; d <span class="kw1">ON</span>&nbsp; &nbsp; d.<span class="br0">&#91;</span><span class="kw1">Date</span><span class="br0">&#93;</span>&nbsp; &nbsp; <span class="sy0">BETWEEN</span> c.<span class="me1">ContractFrom</span> <span class="sy0">AND</span> c.<span class="me1">ContractTo</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> d.<span class="br0">&#91;</span><span class="kw1">Day</span><span class="br0">&#93;</span> &nbsp; &nbsp; <span class="sy0">=</span> <span class="nu0">1</span>; <span class="co1">-- only get the first of the month </span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">WITH CTE_Contracts AS
(
	SELECT
		 c.ContractID
		,ContractFrom	= IIF( ... some date logic)
		,ContractTo		= IIF( ... some date logic)
	FROM contracts			c
	JOIN contractsdetail	cd ON c.ContractID = cd.ContractID
)
SELECT
	 ContractID
	,ContractMonth = d.[Month]
FROM CTE_Contracts	c
JOIN dateDim		d ON	d.[Date]	BETWEEN c.ContractFrom AND c.ContractTo
						AND	d.[Day]		= 1; -- only get the first of the month </pre></div></div>

<p>The query is a bit more complex, but you get the idea. On the test server, the query took 1 minute and 24 seconds to return about 90,000 rows. That‚Äôs a tad slow if you ask me. I didn‚Äôt see anything wrong with the query (and indexes wouldn‚Äôt help), so I just blamed it on the server and on the standard edition of SQL Server. That was until I came across a very similar query. That query did about the same thing, but it also fetched data from another table and appended it to the first result set with a UNION. Something like this:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="de1"><pre class="de1"><span class="kw1">WITH</span> CTE_Contracts <span class="kw1">AS</span>
<span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c.<span class="me1">ContractID</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,ContractFrom &nbsp; <span class="sy0">=</span> IIF<span class="br0">&#40;</span> ... <span class="me1">some</span> <span class="kw1">date</span> logic<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,ContractTo &nbsp; &nbsp; <span class="sy0">=</span> IIF<span class="br0">&#40;</span> ... <span class="me1">some</span> <span class="kw1">date</span> logic<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> contracts&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c
&nbsp; &nbsp; <span class="sy0">JOIN</span> contractsdetail&nbsp; &nbsp; cd <span class="kw1">ON</span> c.<span class="me1">ContractID</span> <span class="sy0">=</span> cd.<span class="me1">ContractID</span>
&nbsp; &nbsp; <span class="kw1">UNION</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c.<span class="me1">ContractID</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,ContractFrom &nbsp; <span class="sy0">=</span> IIF<span class="br0">&#40;</span> ... <span class="me1">some</span> <span class="kw1">date</span> logic<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,ContractTo &nbsp; &nbsp; <span class="sy0">=</span> IIF<span class="br0">&#40;</span> ... <span class="me1">some</span> <span class="kw1">date</span> logic<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> contractsextra &nbsp; &nbsp; c
&nbsp; &nbsp; <span class="sy0">JOIN</span> contractsdetail&nbsp; &nbsp; cd <span class="kw1">ON</span> c.<span class="me1">ContractID</span> <span class="sy0">=</span> cd.<span class="me1">ContractID</span>
<span class="br0">&#41;</span>
<span class="kw1">SELECT</span>
&nbsp; &nbsp; &nbsp;ContractID
&nbsp; &nbsp; ,ContractMonth <span class="sy0">=</span> d.<span class="br0">&#91;</span><span class="kw1">Month</span><span class="br0">&#93;</span>
<span class="kw1">FROM</span> CTE_Contracts&nbsp; c
<span class="sy0">JOIN</span> dateDim&nbsp; &nbsp; &nbsp; &nbsp; d <span class="kw1">ON</span>&nbsp; &nbsp; d.<span class="br0">&#91;</span><span class="kw1">Date</span><span class="br0">&#93;</span>&nbsp; &nbsp; <span class="sy0">BETWEEN</span> c.<span class="me1">ContractFrom</span> <span class="sy0">AND</span> c.<span class="me1">ContractTo</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> d.<span class="br0">&#91;</span><span class="kw1">Day</span><span class="br0">&#93;</span> &nbsp; &nbsp; <span class="sy0">=</span> <span class="nu0">1</span>; <span class="co1">-- only get the first of the month</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">WITH CTE_Contracts AS
(
	SELECT
		 c.ContractID
		,ContractFrom	= IIF( ... some date logic)
		,ContractTo		= IIF( ... some date logic)
	FROM contracts			c
	JOIN contractsdetail	cd ON c.ContractID = cd.ContractID
	UNION
	SELECT
		 c.ContractID
		,ContractFrom	= IIF( ... some date logic)
		,ContractTo		= IIF( ... some date logic)
	FROM contractsextra		c
	JOIN contractsdetail	cd ON c.ContractID = cd.ContractID
)
SELECT
	 ContractID
	,ContractMonth = d.[Month]
FROM CTE_Contracts	c
JOIN dateDim		d ON	d.[Date]	BETWEEN c.ContractFrom AND c.ContractTo
						AND	d.[Day]		= 1; -- only get the first of the month</pre></div></div>

<p>Now this query returned about 120,000 rows in 6 seconds. What? More rows in less time? How‚Äôs that possible? Time to take a look at the execution plans. The execution plan of the second query:</p>
<p><a href="/wp-content/uploads/2015/02/executionplan_1.png"><img class="alignnone size-full wp-image-3258" src="/wp-content/uploads/2015/02/executionplan_1.png" alt="executionplan_1" width="852" height="511" srcset="/wp-content/uploads/2015/02/executionplan_1.png 852w, /wp-content/uploads/2015/02/executionplan_1-300x179.png 300w" sizes="(max-width: 852px) 100vw, 852px" /></a></p>
<p>You can clearly see the two paths of the union being merged with the hash match after which the results are joined to the date dimension using the nested loops.</p>
<p>The execution plan of the first query is a bit different:</p>
<p><a href="/wp-content/uploads/2015/02/executionplan_2.png"><img class="alignnone size-full wp-image-3255" src="/wp-content/uploads/2015/02/executionplan_2.png" alt="executionplan_2" width="1013" height="340" srcset="/wp-content/uploads/2015/02/executionplan_2.png 1013w, /wp-content/uploads/2015/02/executionplan_2-300x100.png 300w" sizes="(max-width: 1013px) 100vw, 1013px" /></a></p>
<p>The nested loops now gives a warning that there is no join predicate. This results in about 5 million rows, which are filtered later on with the Filter operator to the desired 90,000 rows. A bit of unnecessary overhead it seems. So the execution plan of the first query is a bit silly, since it calculates the date columns for the inner select after the join (in the Compute Scalar operator between the Filter and the Nested Loops). In the second query, these columns are calculated before the join and so the Nested Loops can use them as join predicates.</p>
<p>The question is why does SQL Server change behavior? Well, the second query has a UNION operator in the inner query. This means that SQL Server has to compare the two result sets which each other, so the date columns have to be calculated directly in the inner query. Knowing this, we can easily optimize the first query by adding a ‚Äúdummy UNION‚Äù:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1"><span class="kw1">WITH</span> CTE_Contracts <span class="kw1">AS</span>
<span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;c.<span class="me1">ContractID</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,ContractFrom &nbsp; <span class="sy0">=</span> IIF<span class="br0">&#40;</span> ... <span class="me1">some</span> <span class="kw1">date</span> logic<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; ,ContractTo &nbsp; &nbsp; <span class="sy0">=</span> IIF<span class="br0">&#40;</span> ... <span class="me1">some</span> <span class="kw1">date</span> logic<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">FROM</span> contracts&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c
&nbsp; &nbsp; <span class="sy0">JOIN</span> contractsdetail&nbsp; &nbsp; cd <span class="kw1">ON</span> c.<span class="me1">ContractID</span> <span class="sy0">=</span> cd.<span class="me1">ContractID</span>
&nbsp; &nbsp; <span class="kw1">UNION</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="sy0">NULL</span>, <span class="sy0">NULL</span>, <span class="sy0">NULL</span>, <span class="sy0">NULL</span> <span class="co1">-- just to enforce performance</span>
<span class="br0">&#41;</span>
<span class="kw1">SELECT</span>
&nbsp; &nbsp; &nbsp;ContractID
&nbsp; &nbsp; ,ContractMonth <span class="sy0">=</span> d.<span class="br0">&#91;</span><span class="kw1">Month</span><span class="br0">&#93;</span>
<span class="kw1">FROM</span> CTE_Contracts&nbsp; c
<span class="sy0">JOIN</span> dateDim&nbsp; &nbsp; &nbsp; &nbsp; d <span class="kw1">ON</span>&nbsp; &nbsp; d.<span class="br0">&#91;</span><span class="kw1">Date</span><span class="br0">&#93;</span>&nbsp; &nbsp; <span class="sy0">BETWEEN</span> c.<span class="me1">ContractFrom</span> <span class="sy0">AND</span> c.<span class="me1">ContractTo</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> d.<span class="br0">&#91;</span><span class="kw1">Day</span><span class="br0">&#93;</span> &nbsp; &nbsp; <span class="sy0">=</span> <span class="nu0">1</span>; <span class="co1">-- only get the first of the month </span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">WITH CTE_Contracts AS
(
	SELECT
		 c.ContractID
		,ContractFrom	= IIF( ... some date logic)
		,ContractTo		= IIF( ... some date logic)
	FROM contracts			c
	JOIN contractsdetail	cd ON c.ContractID = cd.ContractID
	UNION
	SELECT NULL, NULL, NULL, NULL -- just to enforce performance
)
SELECT
	 ContractID
	,ContractMonth = d.[Month]
FROM CTE_Contracts	c
JOIN dateDim		d ON	d.[Date]	BETWEEN c.ContractFrom AND c.ContractTo
						AND	d.[Day]		= 1; -- only get the first of the month </pre></div></div>

<p>This extra row with all NULL values will be filtered out by the INNER JOIN with the date dimension. Now the query runs in 3 seconds!</p>
<p><a href="/wp-content/uploads/2015/02/executionplan_3.png"><img class="alignnone size-full wp-image-3256" src="/wp-content/uploads/2015/02/executionplan_3.png" alt="executionplan_3" width="769" height="168" srcset="/wp-content/uploads/2015/02/executionplan_3.png 769w, /wp-content/uploads/2015/02/executionplan_3-300x65.png 300w" sizes="(max-width: 769px) 100vw, 769px" /></a></p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/mssqlserver/solving-a-slow-running-query-issue-with-union/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
		</item>
		<item>
		<title>T-SQL Tuesday #63: How do you manage security</title>
		<link>/index.php/datamgmt/ssis/t-sql-tuesday-63-how-do-you-manage-security/</link>
		<comments>/index.php/datamgmt/ssis/t-sql-tuesday-63-how-do-you-manage-security/#comments</comments>
		<pubDate>Tue, 10 Feb 2015 08:11:04 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[SSIS]]></category>
		<category><![CDATA[security]]></category>
		<category><![CDATA[ssis]]></category>
		<category><![CDATA[syndicated]]></category>
		<category><![CDATA[t-sql tuesday]]></category>

		<guid isPermaLink="false">/?p=3165</guid>
		<description><![CDATA[This month‚Äôs T-SQL Tuesday is hosted by Kenneth Fisher (blog &#124; twitter) and its subject is about security. Security is one of those subjects that most DBAs have to deal with regardless of specialty. So as something we all have to work with at some point or another what are some tips you‚Äôd like to [&#8230;]]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify"><a href="http://sqlstudies.com/2015/02/03/tsql-tuesday-63-how-do-you-manage-security/"><img style="float: left;margin: 0px 10px 0px 10px" src="/wp-content/uploads/2014/01/TSQL2sday.png" alt="TSQL2sday" width="133" height="134" /></a>This month‚Äôs T-SQL Tuesday is hosted by Kenneth Fisher (<a href="http://sqlstudies.com/">blog </a>| <a href="https://twitter.com/sqlstudent144">twitter</a>) and its subject is about security.</p>
<p style="text-align: justify"><em>Security is one of those subjects that most DBAs have to deal with regardless of specialty. So as something we all have to work with at some point or another what are some tips you‚Äôd like to share? What‚Äôs the best security design? You‚Äôve picked up a legacy system and the security is awful, how do you fix it? Any great tools out there you‚Äôd like to share? Hate it or love it I‚Äôm betting we all have something to say.</em></p>
<p style="text-align: justify">Now, I‚Äôm not exactly a DBA but even ETL developers have to deal with security from time to time. In this blog post, I‚Äôd like to talk about the built-in security of the SSIS packages. You see, SSIS packages can store sensitive data inside them, such as the passwords for the connection managers for example. In order to protect that information, SSIS uses <a href="https://msdn.microsoft.com/en-us/library/ms141747.aspx">protection levels</a> which is a package-level property. These are the available protection levels:</p>
<ul style="text-align: justify">
<li><strong>DontSaveSensitive</strong>, which is my personal favorite as it forces you to use either configurations or parameters.</li>
<li><strong>EncryptSensitiveWithPassword</strong>. Other people can still open the package if they don&#8217;t have the password, ¬†but the passwords in the connection managers are lost and need to be re-entered..</li>
<li><strong>EncryptAllWithPassword</strong>, for the paranoia people.</li>
<li><strong>EncryptSensitiveWithUserKey</strong>, which is the default. And as usual, they choose the absolute worst choice as the default. This setting basically means only you can access the sensitive data. Real peachy when you are in a team with multiple developers. Other developers can still open the package (then ignore a few warnings) but they have to re-enter all the passwords in the connection managers.</li>
<li><strong>EncryptAllWithUserKey</strong>, when you are really possessive over your packages.</li>
<li><strong>ServerStorage</strong>. When you deploy a package to the server, you trust SQL Server in protecting the sensitive data. This is default when you deploy packages to the SSIS catalog with the project deployment model.</li>
</ul>
<p style="text-align: justify">Protection levels were really important before SSIS 2012, as they specified how sensitive data was protected. However, the default of EncryptSensitiveWithUserKey is a really crappy one. If you schedule a package with this protection level using SQL Server Agent, the package can still run if there is no actual sensitive data in the package, but a lot of unnecessary warnings are generated. It&#8217;s best to avoid this protection level at all costs.</p>
<p style="text-align: justify">Protecting the package with a password is a good option. However, when deploying the package with the package deployment model (or every version of SSIS before 2012), you had to enter the password when you were scheduling the package with Agent. This means though that the password is stored in MSDB, so it isn&#8217;t that secure. My advice is to use DontSaveSensitive and store sensitive information inside a SQL Server configuration table.</p>
<p style="text-align: justify">With the project deployment model however, configurations are gone. They are replaced with parameters and environments. Since parameters are configured inside the package or project, this means the sensitive data is stored inside the package again. In this case it makes sense to protect the package with a password if needed. There is no issue on the server side, since the protection level is automatically converted to ServerStorage during deployment. Keep in mind that all the packages and the project itself need to have the same protection level, otherwise you get an error when the .ispac file is built.</p>
<p style="text-align: justify">Conclusion:</p>
<ul style="text-align: justify">
<li>when using earlier version of SSIS or when using the package deployment: the DontSaveSensitive protection level in combination with a configuration table is the most secure option.</li>
<li>when using the project deployment model: use parameters and environments to replace the configurations. Protect the package with a password if you want to secure those parameters.</li>
</ul>
<p style="text-align: justify">Note:<br />
when using Windows Authentication for all sources and destinations, there is almost nothing to be secured in a package. Obviously, this is even more secure.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/ssis/t-sql-tuesday-63-how-do-you-manage-security/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
	</channel>
</rss>
