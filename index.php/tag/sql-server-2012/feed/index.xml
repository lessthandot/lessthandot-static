<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>sql server 2012 &#8211; LessthanDot</title>
	<atom:link href="/index.php/tag/sql-server-2012/feed/" rel="self" type="application/rss+xml" />
	<link>/</link>
	<description>A Technical Community for IT Professionals</description>
	<lastBuildDate>Sat, 09 Mar 2019 12:50:36 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.6.1</generator>
	<item>
		<title>Master Data Services (Second Edition) – Review</title>
		<link>/index.php/datamgmt/master-data-services-second-edition-review/</link>
		<comments>/index.php/datamgmt/master-data-services-second-edition-review/#comments</comments>
		<pubDate>Fri, 31 Jan 2014 13:45:14 +0000</pubDate>
		<dc:creator><![CDATA[Koen Verbeeck]]></dc:creator>
				<category><![CDATA[Book Review]]></category>
		<category><![CDATA[Data Management]]></category>
		<category><![CDATA[Master Data Services (MDS)]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[master data management]]></category>
		<category><![CDATA[master data services]]></category>
		<category><![CDATA[mds]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[syndicated]]></category>

		<guid isPermaLink="false">/?p=2329</guid>
		<description><![CDATA[For the preparation of my upcoming talk about SQL Server 2012 Master Data Services on the Microsoft Business Analytics Day (hosted by my company element61), I read the book Master Data Services 2nd edition by Tyler Graham. I had almost no prior experience with MDS up to this point (I very quickly glanced over it [&#8230;]]]></description>
				<content:encoded><![CDATA[<p style="text-align: justify">For the preparation of my upcoming talk about SQL Server 2012 Master Data Services on the <a href="http://www.element61.be/e/newsevt-detail.asp?ResourceId=721">Microsoft Business Analytics Day</a> (hosted by my company <a href="http://www.element61.be/">element61</a>), I read the book <a href="http://amzn.to/1Oeichj">Master Data Services 2<sup>nd</sup> edition</a> by Tyler Graham.</p>
<p style="text-align: justify">I had almost no prior experience with MDS up to this point (I very quickly glanced over it in preparation for the 70-463 exam and I guess I didn’t answer a lot of questions about MDS correctly), so I needed a book that could introduce me to the concepts of MDS and how I can effectively manage master data using this tool.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/01/MDS_book2_banner.png"><img class="alignleft  wp-image-2331" src="/wp-content/uploads/2014/01/MDS_book2_banner.png" alt="MDS_book2_banner" width="207" height="228" /></a></p>
<p style="text-align: justify">Tyler Graham was part of the development team of SQL Server Master Data Services right from the start, so if anyone is qualified about writing a book about MDS it’s probably him. You can notice his profound knowledge throughout the book, as he frequently delves deeper in the MDS web service (I didn’t even know there was one) and references hidden stored procedures and views to make MDS do your bidding. The book accomplishes its goal: I know have a good working knowledge of the tool and if I have to use it in a project tomorrow, I know where to start.</p>
<p style="text-align: justify">The book starts with an introduction to manager master data in general, which is very welcome for someone new to the field, just like me. The book then thoroughly explains how to install and configure MDS. In the next chapter, the business use case used throughout the book is introduces and in the following chapter you learn about creating models.</p>
<p style="text-align: justify">Chapter 5 explains how you can import data into MDS, using the various staging tables. I would have put this chapter later in the book, because the examples show you how to populate objects you have never even heard of and you don’t exactly know what they represent or how you can use them. A bit confusing. The author talks how you can automate the import process using stored procedures – very useful when you plan on using SSIS to load MDS – and he says he will explain them in the next section. However, the next section is about web services and he never mentions the stored procedures again. A missed opportunity…</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/01/WhereAreTheStoredProcedures.png"><img class="alignleft size-medium wp-image-2332" src="/wp-content/uploads/2014/01/WhereAreTheStoredProcedures-300x237.png" alt="WhereAreTheStoredProcedures" width="300" height="237" srcset="/wp-content/uploads/2014/01/WhereAreTheStoredProcedures-300x237.png 300w, /wp-content/uploads/2014/01/WhereAreTheStoredProcedures.png 724w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p style="text-align: justify">The next chapters explain how to create hierarchies, collections, business rules and so on. The whole time the same business case is used for the examples: a clothing company managing financial and product data with MDS. The examples are real-life and they help you to understand how to work with the product.</p>
<p style="text-align: justify">Then there’s a whole chapter on using Excel as the front-end for MDS. This is great, as this really opens up MDS for the business user, which gives MDS an advantage over its competitors. However, the book uses a sample workbook you can supposedly download from <a href="http://www.mdsuser.com/">mdsuser.com</a>. But the Excel is nowhere to be found in this site. The book also mentions another site you can download samples from, but that site doesn’t even exist anymore.</p>
<p style="text-align: justify">At that point we’re at chapter 11, which is a long chapter on how to implement security. The author goes into great detail to explain how it works in MDS. This chapter is certainly useful as a reference when you are implementing permissions in MDS. Chapter 12 shortly explains how to create subscription views so that you can extract data from the system (which is basically the point of a master data implementation, otherwise it wouldn’t be a much use). The next chapter is all about web services, so I gladly skipped that one. The last chapter talks about advanced modelling, but is just a few pages with a few tips and a few reminders of what not to do with MDS. Very interesting though was the authors take on MDS and slowly changing dimensions.</p>
<p style="text-align: justify">All in all this was a very decent book that showed me how to work with Master Data Services and how to get the most out of it. The author always explains the differences between the previous version and also warns you about what will not work (well) in MDS and how you can possibly circumvent it by fiddling around in the database.</p>
<p style="text-align: justify">The biggest downside – for me personally – is something that is probably out of control of the author: the format of the eBook. The book was purchased on ebooks.com in PDF format, but the PDF look like some poorly converted eBook format (epub or mobi or something like that). There were no page numbers, no headings or footers and every page just went to the next one, leading to awkward section endings. There were also no margins, which makes it difficult to decently print a page. The book is supposed to be 416 pages long, but the PDF has only 337 pages. Quite a difference. Maybe ebooks.com throw the section about stored procedures away with their lousy conversion. Bad ebooks.com.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/01/WorstFormatEver.png"><img class="alignleft size-medium wp-image-2333" src="/wp-content/uploads/2014/01/WorstFormatEver-300x124.png" alt="WorstFormatEver" width="300" height="124" srcset="/wp-content/uploads/2014/01/WorstFormatEver-300x124.png 300w, /wp-content/uploads/2014/01/WorstFormatEver.png 755w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p style="text-align: justify">This might be normal for an actual eBook for reading on a Kindle or a tablet (I have no idea, I own neither of both), but when I buy a PDF I expect it to look like the actual book. Again, this has nothing to do with the efforts of the author: he wrote an excellent book on Master Data Services. The samples are OK with this book, but a few more effort could be put into them. All in all I recommend this book to everyone who wants to learn more about SQL Server 2012 Master Data Services. Just don’t buy it from ebooks.com.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/master-data-services-second-edition-review/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>Nice Collection Of Free SQL Server, Visual Studio, Azure ebooks</title>
		<link>/index.php/datamgmt/datadesign/nice-collection-of-free-sql/</link>
		<comments>/index.php/datamgmt/datadesign/nice-collection-of-free-sql/#respond</comments>
		<pubDate>Wed, 19 Jun 2013 12:17:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Business Intelligence]]></category>
		<category><![CDATA[Data Modelling and Design]]></category>
		<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Excel Reporting]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[SSAS]]></category>
		<category><![CDATA[SSIS]]></category>
		<category><![CDATA[SSRS]]></category>
		<category><![CDATA[ebook]]></category>
		<category><![CDATA[sql server]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/06/nice-collection-of-free-sql/</guid>
		<description><![CDATA[Eric Ligman has posted a nice collection of ebooks available in pdf, epub and mobi formats. The books cover Office, Office 365, SharePoint, SQL Server, System Center, Visual Studio, Web Development, Windows, Windows Azure, and Windows Server

Here is&#8230;]]></description>
				<content:encoded><![CDATA[<p>Eric Ligman has posted a nice collection of ebooks available in pdf, epub and mobi formats. The books cover Office, Office 365, SharePoint, SQL Server, System Center, Visual Studio, Web Development, Windows, Windows Azure, and Windows Server</p>
<p>Here is what is available for SQL Server</p>
<p>5 Tips for a Smooth SSIS Upgrade to SQL Server 2012<br />
A Hitchiker&#8217;s Guide to Microsoft StreamInsight Queries<br />
Data Mining Extensions (DMX) Reference<br />
Data Quality Services<br />
High Availability Solutions<br />
Master Data Services<br />
Monitor and Tune for Performance<br />
Multidimensional Expressions (MDX) Reference<br />
SQL Server Distributed Replay<br />
Transact-SQL Data Definition Language (DDL) Reference<br />
XQuery Language Reference<br />
Extracting and Loading SharePoint Data in SQL Server Integration Services<br />
Integration Services: Extending Packages with Scripting<br />
Multidimensional Model Programming<br />
Optimized Bulk Loading of Data into Oracle<br />
Planning Disaster Recovery for Microsoft SQL Server Reporting Services in SharePoint Integrated Mode<br />
SQL Server 2012 Tutorials: Reporting Services<br />
SQL Server 2012 Tutorials: Writing Transact-SQL Statements<br />
SQL Server Community FAQs Manual </p>
<p>You can get all the links from here: http://blogs.msdn.com/b/mssmallbiz/archive/2013/06/18/huge-collection-of-free-microsoft-ebooks-for-you-including-office-office-365-sharepoint-sql-server-system-center-visual-studio-web-development-windows-windows-azure-and-windows-server.aspx?Redirected=true</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/datadesign/nice-collection-of-free-sql/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>SQL Puzzle.. How many uppercase and lowercase characters in a column</title>
		<link>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-uppercase/</link>
		<comments>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-uppercase/#comments</comments>
		<pubDate>Wed, 12 Jun 2013 12:47:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[puzzle]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[teaser]]></category>

		<guid isPermaLink="false">/index.php/2013/06/sql-puzzle-how-many-uppercase/</guid>
		<description><![CDATA[In this week's puzzle we are going to try to figure out how many uppercase, how many lowercase characters are in a column, we are also interested in how many are neither uppercase or lowercase


Here is the table and the data

CREATE TABLE Puzzle&#8230;]]></description>
				<content:encoded><![CDATA[<p>In this week&#8217;s puzzle we are going to try to figure out how many uppercase, how many lowercase characters are in a column, we are also interested in how many are neither uppercase or lowercase</p>
<p>Here is the table and the data</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Puzzle
&nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span>Col1 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> Puzzle <span class="br0">&#40;</span>Col1<span class="br0">&#41;</span>
<span class="kw1">SELECT</span> <span class="st0">'ABCD01234Z'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'AAAAAAAAAA'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'aaaaaaaaaZ'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'a&amp;a&amp;a&amp;a&amp;aA'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'1234Tt7890'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE Puzzle
     (Col1 varchar(10));
 
INSERT INTO Puzzle (Col1)
SELECT 'ABCD01234Z'
UNION ALL
SELECT 'AAAAAAAAAA'
UNION ALL
SELECT 'aaaaaaaaaZ'
UNION ALL
SELECT 'a&amp;a&amp;a&amp;a&amp;aA'
UNION ALL
SELECT '1234Tt7890'</pre></div></div>

<p>This is the expected output</p>
<pre>Col1		UpperCase	LowerCase	Neither
ABCD01234Z	5		0		5
AAAAAAAAAA	10		0		0
aaaaaaaaaZ	1		9		0
a&amp;a&amp;a&amp;a&amp;aA	1		5		4
1234Tt7890	1		1		8</pre>
<p>For bonus points, you can add 3 more columns to the output, one column will hold only uppercase characters, one column will hold only lowercase characters, one column will hold only characters that are neither uppercase  or lowercase</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-uppercase/feed/</wfw:commentRss>
		<slash:comments>5</slash:comments>
		</item>
		<item>
		<title>Changing a column that is already populated into a column that uses a sequence</title>
		<link>/index.php/datamgmt/dbprogramming/changing-a-column-that-is/</link>
		<comments>/index.php/datamgmt/dbprogramming/changing-a-column-that-is/#comments</comments>
		<pubDate>Wed, 05 Jun 2013 19:38:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[how to]]></category>
		<category><![CDATA[sequence]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/06/changing-a-column-that-is/</guid>
		<description><![CDATA[Just got a question on my A first look at sequences in SQL Server Denali post.

The question is the following: How can you add a new column to existing table (already populated) and make it a sequence column?

Let's take a look. First create this ve&#8230;]]></description>
				<content:encoded><![CDATA[<p>Just got a question on my <a href="/index.php/DataMgmt/DataDesign/a-first-look-at-sequences-in-sql-server">A first look at sequences in SQL Server Denali</a> post.</p>
<p>The question is the following: <em>How can you add a new column to existing table (already populated) and make it a sequence column?</em></p>
<p>Let&#8217;s take a look. First create this very simple table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> bla <span class="br0">&#40;</span>id <span class="kw1">INT</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> BLA <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> BLA <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> BLA <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">3</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> BLA <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">4</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> BLA <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="nu0">5</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE bla (id INT)
INSERT BLA VALUES(1)
INSERT BLA VALUES(2)
INSERT BLA VALUES(3)
INSERT BLA VALUES(4)
INSERT BLA VALUES(5)</pre></div></div>

<p>What you want to do is have the sequence start at 6, here is how to do that.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">SEQUENCE</span> GlobalCounter
&nbsp; &nbsp; <span class="kw1">AS</span> <span class="kw1">INT</span>
&nbsp; &nbsp; M<span class="sy0">IN</span>VALUE <span class="nu0">1</span>
&nbsp; &nbsp; <span class="kw1">NO</span> MAXVALUE
&nbsp; &nbsp; <span class="kw1">START</span> <span class="kw1">WITH</span> <span class="nu0">6</span>;
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE SEQUENCE GlobalCounter
    AS INT
    MINVALUE 1
    NO MAXVALUE
    START WITH 6;
GO</pre></div></div>

<p>Use START WITH to indicate that the sequence should start at 6</p>
<p>The next step is to add a default to the column, this default would use the sequence</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">TABLE</span> bla
<span class="kw1">ADD</span> <span class="kw1">CONSTRAINT</span> id_default_sequence
<span class="kw1">DEFAULT</span> <span class="kw1">NEXT</span> <span class="kw1">VALUE</span> <span class="kw1">FOR</span> GlobalCounter <span class="kw1">FOR</span> ID;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER TABLE bla
ADD CONSTRAINT id_default_sequence
DEFAULT NEXT VALUE FOR GlobalCounter FOR ID;</pre></div></div>

<p>Now if we do an insert, followed by a select</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">INSERT</span> bla <span class="kw1">DEFAULT</span> <span class="kw1">VALUES</span>
&nbsp;
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> Bla</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">INSERT bla DEFAULT VALUES

SELECT * FROM Bla</pre></div></div>

<p>Here are the results</p>
<p>id<br />
1<br />
2<br />
3<br />
4<br />
5<br />
6</p>
<p>As you can see the value 6 was inserted</p>
<p>There you have it, a simple way to change a column to a sequence column</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/changing-a-column-that-is/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>SQL Puzzle.. Sorting results without using ORDER BY</title>
		<link>/index.php/datamgmt/dbprogramming/mssqlserver/sql-puzzle-sorting-results-without/</link>
		<comments>/index.php/datamgmt/dbprogramming/mssqlserver/sql-puzzle-sorting-results-without/#comments</comments>
		<pubDate>Wed, 05 Jun 2013 19:25:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[puzzle]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[teaser]]></category>

		<guid isPermaLink="false">/index.php/2013/06/sql-puzzle-sorting-results-without/</guid>
		<description><![CDATA[Time for this week's puzzle/teaser. I want to return the results in ascending order but without using ORDER BY

If you run this code

CREATE TABLE Puzzle
     (Col1 varchar(20) NOT NULL PRIMARY KEY CLUSTERED,
      Col2 varchar(20) NOT NULL UNIQUE&#8230;]]></description>
				<content:encoded><![CDATA[<p>Time for this week&#8217;s puzzle/teaser. I want to return the results in ascending order but without using ORDER BY</p>
<p>If you run this code</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Puzzle
&nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span>Col1 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span> <span class="kw1">CLUSTERED</span>,
&nbsp; &nbsp; &nbsp; Col2 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> <span class="kw1">UNIQUE</span> <span class="kw1">NONCLUSTERED</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> Puzzle <span class="br0">&#40;</span>Col1, Col2<span class="br0">&#41;</span>
<span class="kw1">SELECT</span> <span class="st0">'Z'</span>, <span class="st0">'AA'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'A'</span>, <span class="st0">'BB'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'B'</span>, <span class="st0">'CC'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'C'</span>, <span class="st0">'DD'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'M'</span>, <span class="st0">'EE'</span>;
&nbsp;
<span class="kw1">SELECT</span> Col1 <span class="kw1">FROM</span> Puzzle;
<span class="kw1">DROP</span> <span class="kw1">TABLE</span> Puzzle;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE Puzzle
     (Col1 varchar(20) NOT NULL PRIMARY KEY CLUSTERED,
      Col2 varchar(20) NOT NULL UNIQUE NONCLUSTERED);

INSERT INTO Puzzle (Col1, Col2)
SELECT 'Z', 'AA'
UNION ALL
SELECT 'A', 'BB'
UNION ALL
SELECT 'B', 'CC'
UNION ALL
SELECT 'C', 'DD'
UNION ALL
SELECT 'M', 'EE';

SELECT Col1 FROM Puzzle;
DROP TABLE Puzzle;</pre></div></div>

<p>you get these results</p>
<p>Col1<br />
Z<br />
A<br />
B<br />
C<br />
M</p>
<p>What I want to see is the following</p>
<p>Col1<br />
A<br />
B<br />
C<br />
M<br />
Z</p>
<p>Without using ORDER BY, how would you make the SELECT query return Col1 in ascending order?  You can&#8217;t make changes to the table, all that you are allowed to modify is this part</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> Col1 <span class="kw1">FROM</span> Puzzle;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT Col1 FROM Puzzle;</pre></div></div>

<p><strong>Warning</strong><br />
Do not use these suggestion in production code, the only real way to guarantee order of a result set is by using ORDER BY</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/mssqlserver/sql-puzzle-sorting-results-without/feed/</wfw:commentRss>
		<slash:comments>26</slash:comments>
		</item>
		<item>
		<title>SQL Puzzle&#8230;how many even numbers are there in a row</title>
		<link>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-even/</link>
		<comments>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-even/#comments</comments>
		<pubDate>Wed, 29 May 2013 07:29:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[puzzle]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[teaser]]></category>

		<guid isPermaLink="false">/index.php/2013/05/sql-puzzle-how-many-even/</guid>
		<description><![CDATA[In last week's puzzle SQL Puzzle: RIGHT without using the RIGHT function we looked at how to do a RIGHT function without using the RIGHT function. Today we are going to find out how many columns are even in a row. 

Before starting I want you to be aw&#8230;]]></description>
				<content:encoded><![CDATA[<p>In last week&#8217;s puzzle SQL Puzzle: <a href="/index.php/DataMgmt/DBProgramming/sql-puzzle-right-without-using">RIGHT without using the RIGHT function</a> we looked at how to do a RIGHT function without using the RIGHT function. Today we are going to find out how many columns are even in a row. </p>
<p>Before starting I want you to be aware that 0 is an even number  From wikipedia: <a href="http://en.wikipedia.org/wiki/Parity_of_zero">Parity of zero</a></p>
<blockquote><p>Zero is an even number. In other words, its parity—the quality of an integer being even or odd—is even. Zero fits the definition of &#8220;even number&#8221;: it is an integer multiple of 2, namely 0 × 2. As a result, zero shares all the properties that characterize even numbers: 0 is divisible by 2, 0 is surrounded on both sides by odd numbers, 0 is the sum of an integer (0) with itself, and a set of 0 objects can be split into two equal sets.</p>
<p>Zero also fits into the patterns formed by other even numbers. The parity rules of arithmetic, such as even &#8722; even = even, require 0 to be even. Zero is the additive identity element of the group of even integers, and it is the starting case from which other even natural numbers are recursively defined. Applications of this recursion from graph theory to computational geometry rely on zero being even. Not only is 0 divisible by 2, it is divisible by every integer. In the binary numeral system used by computers, it is especially relevant that 0 is divisible by every power of 2; in this sense, 0 is the &#8220;most even&#8221; number of all.</p></blockquote>
<p>Here is the table that you will use for your solution</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Puzzle<span class="br0">&#40;</span>Col1 <span class="kw1">int</span>, Col2 <span class="kw1">int</span>, Col3 <span class="kw1">int</span>, Col4 <span class="kw1">int</span>, Col5 <span class="kw1">int</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">4</span>,<span class="nu0">5</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">0</span>,<span class="nu0">1</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">4</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">2</span>,<span class="nu0">2</span>,<span class="nu0">2</span>,<span class="nu0">2</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span>,<span class="nu0">1</span>,<span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">3</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">2</span>,<span class="nu0">3</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">2</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #Puzzle(Col1 int, Col2 int, Col3 int, Col4 int, Col5 int)

INSERT  #Puzzle VALUES (1,2,3,4,5)
INSERT  #Puzzle VALUES (0,1,2,3,4)
INSERT  #Puzzle VALUES (2,2,2,2,2)
INSERT  #Puzzle VALUES (1,1,1,1,1)
INSERT  #Puzzle VALUES (3,2,3,2,3)
INSERT  #Puzzle VALUES (2,3,2,3,2)</pre></div></div>

<p>And here is the expected output</p>
<pre>Col1	Col2	Col3	Col4	Col5	Even
1	2	3	4	5	2
0	1	2	3	4	3
2	2	2	2	2	5
1	1	1	1	1	0
3	2	3	2	3	2
2	3	2	3	2	3</pre>
<p>That should be pretty easy right?</p>
<p>How about a solution that doesn&#8217;t use a CASE statement, you think you can do it (I can think of 2 ways without using a CASE statement)</p>
<p>Post your solutions as a comment</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-even/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
		</item>
		<item>
		<title>SQL Puzzle:  RIGHT without using the RIGHT function</title>
		<link>/index.php/datamgmt/dbprogramming/sql-puzzle-right-without-using/</link>
		<comments>/index.php/datamgmt/dbprogramming/sql-puzzle-right-without-using/#comments</comments>
		<pubDate>Wed, 22 May 2013 07:44:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[puzzle]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[teaser]]></category>

		<guid isPermaLink="false">/index.php/2013/05/sql-puzzle-right-without-using/</guid>
		<description><![CDATA[I haven't done a puzzle for a long time so I figured let's do a simple one. Return the right 6 characters of the column but without using the RIGHT function.


Here is what the table looks like
CREATE TABLE #Puzzle(SomeCol CHAR(7))

INSERT  #Puzzl&#8230;]]></description>
				<content:encoded><![CDATA[<p>I haven&#8217;t done a puzzle for a long time so I figured let&#8217;s do a simple one. Return the right 6 characters of the column but without using the RIGHT function.</p>
<p>Here is what the table looks like</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Puzzle<span class="br0">&#40;</span>SomeCol <span class="kw1">CHAR</span><span class="br0">&#40;</span><span class="nu0">7</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'AAAAAAA'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">' BBBBBB'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'CCCCCC'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">' DDDDD '</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="sy0">NULL</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">' &nbsp; &nbsp; &nbsp; '</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #Puzzle(SomeCol CHAR(7))

INSERT  #Puzzle VALUES ('AAAAAAA')
INSERT  #Puzzle VALUES (' BBBBBB')
INSERT  #Puzzle VALUES ('CCCCCC')
INSERT  #Puzzle VALUES (' DDDDD ')
INSERT  #Puzzle VALUES (NULL)
INSERT  #Puzzle VALUES ('       ')</pre></div></div>

<p>As you can see some rows start with spaces and some end with spaces, one row has the NULL value<br />
The output should be a Z followed by the right 6 characters from the column + the length of the column (not the length of the 6 characters that you are returning)</p>
<p>Here is what the output should look like</p>
<pre>ZAAAAAA7
ZBBBBBB7
ZCCCCC 7
ZDDDDD 7
Z0
Z      7</pre>
<p>As you can see spaces should remain and when the value is NULL then there should be a blank. The length for the row with the NULL value should be 0, you cannot hardcode 7 for the length, you have to calculate it.</p>
<p>Post your solution(s) in the comment section, remember no RIGHT function. Let&#8217;s see how many different ways you can come up with to do this</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/sql-puzzle-right-without-using/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
		</item>
		<item>
		<title>SQL Server Database owner ~~UNKNOWN~~</title>
		<link>/index.php/datamgmt/dbadmin/sql-server-database-owner-unknown/</link>
		<comments>/index.php/datamgmt/dbadmin/sql-server-database-owner-unknown/#comments</comments>
		<pubDate>Tue, 14 May 2013 10:02:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Administration]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[security]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/05/sql-server-database-owner-unknown/</guid>
		<description><![CDATA[Today I was checking an older server and decided to run sp_helpdb. On a bunch of databases I noticed that the owner was ~~UNKNOWN~~. The only reason I noticed this was when I tried to look at a specific database which is mirrored. I was greeted with thi&#8230;]]></description>
				<content:encoded><![CDATA[<p>Today I was checking an older server and decided to run sp_helpdb. On a bunch of databases I noticed that the owner was ~~UNKNOWN~~. The only reason I noticed this was when I tried to look at a specific database which is mirrored. I was greeted with this dialog box</p>
<blockquote><p>Cannot show requested dialog.</p>
<p>Additional information:<br />
  Cannot show requested dialog.(SqlMgmt)<br />
    Property Owner is not available for Database'[Your Database Name]&#8217;. This property may not exist for this<br />
    object, or may not be retrievable due to insufficient access rights. (Microsoft.SqlServer.Smo)</p></blockquote>
<p>What does this mean, was the server hacked and someone changed the owner? No, what this means is that the owner of the database was a windows account which no longer exists, the person probably left and the account was removed.</p>
<p>All you have to do is change the owner to a valid login</p>
<p>If you want it to be sa or a sql login, this example is for sa, change sa to something else if you want a different sql login</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">AUTHORIZATION</span> <span class="kw1">ON</span> <span class="kw1">DATABASE</span>::<span class="br0">&#91;</span>YourDatabase<span class="br0">&#93;</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>sa<span class="br0">&#93;</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER AUTHORIZATION ON DATABASE::[YourDatabase] TO [sa];</pre></div></div>

<p>If you want it to be a windows login, you can do the following</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">AUTHORIZATION</span> <span class="kw1">ON</span> <span class="kw1">DATABASE</span>::<span class="br0">&#91;</span>YourDatabase<span class="br0">&#93;</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>DomainLogin<span class="br0">&#93;</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER AUTHORIZATION ON DATABASE::[YourDatabase] TO [DomainLogin];</pre></div></div>

<p>If you run sp_helpdb now, you will see that the owner has been changed</p>
<p>If you are old school, you can also use sp_changedbowner to make the change</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">USE</span> YourDatabase
GO
&nbsp;
<span class="kw1">EXEC</span> <span class="kw3">sp_changedbowner</span> <span class="st0">'sa'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">USE YourDatabase
GO

EXEC sp_changedbowner 'sa'</pre></div></div>

]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbadmin/sql-server-database-owner-unknown/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Fixing a SQL Server could not spawn FRunCM thread error</title>
		<link>/index.php/datamgmt/dbadmin/mssqlserveradmin/fixing-a-sql-server-could/</link>
		<comments>/index.php/datamgmt/dbadmin/mssqlserveradmin/fixing-a-sql-server-could/#comments</comments>
		<pubDate>Tue, 30 Apr 2013 12:28:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[encryption]]></category>
		<category><![CDATA[error]]></category>
		<category><![CDATA[fix]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/04/fixing-a-sql-server-could/</guid>
		<description><![CDATA[I had to change the account that some SQL Server boxes were using to run the SQL Server services. After I changed the account on one machine from DomainNameUser to DomainNameNewUser SQL Server wouldn't start up

In the error log I saw the following&#8230;]]></description>
				<content:encoded><![CDATA[<p>I had to change the domain account on some SQL Server boxes that we have. After I changed the account on one machine from DomainNameUser to DomainNameNewUser SQL Server wouldn&#8217;t start up</p>
<p>In the error log I saw the following messages</p>
<blockquote><p>Server      Error: 17190, Severity: 16, State: 1.<br />
2013-04-30 12:42:06.11 Server      Initializing the FallBack certificate failed with error code: 1, state: 1, error number: -2146893802.<br />
2013-04-30 12:42:06.11 Server      Unable to initialize SSL encryption because a valid certificate could not be found, and it is not possible to create a self-signed certificate.<br />
2013-04-30 12:42:06.11 Server      Error: 17182, Severity: 16, State: 1.<br />
2013-04-30 12:42:06.11 Server      TDSSNIClient initialization failed with error 0x80092004, status code 0x80. Reason: Unable to initialize SSL support. Cannot find object or property.</p>
<p>2013-04-30 12:42:06.11 Server      Error: 17182, Severity: 16, State: 1.<br />
2013-04-30 12:42:06.11 Server      TDSSNIClient initialization failed with error 0x80092004, status code 0x1. Reason: Initialization failed with an infrastructure error. Check for previous errors. Cannot find object or property.</p>
<p>2013-04-30 12:42:06.11 Server      Error: 17826, Severity: 18, State: 3.<br />
2013-04-30 12:42:06.11 Server      Could not start the network library because of an internal error in the network library. To determine the cause, review the errors immediately preceding this one in the error log.<br />
2013-04-30 12:42:06.11 Server      Error: 17120, Severity: 16, State: 1.<br />
2013-04-30 12:42:06.11 Server      SQL Server could not spawn FRunCM thread. Check the SQL Server error log and the Windows event logs for information about possible related problems.</p></blockquote>
<p>We are not using encryption, VIA is disabled as well. After trying all kinds of different things I notice that when logging on with this profile on the box there was an error. Something about that the profile couldn&#8217;t be created and a temporary profile would be used instead</p>
<p>In the end I had to wipe out the user profile from the box</p>
<p>You do that by following these steps</p>
<p>Right click on computer, select Properties<br />
Click on Advanced System Settings<br />
Select the  Advanced Tab<br />
On the user profiles section click on Settings</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/UserProfile.PNG?mtime=1367323923"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/UserProfile.PNG?mtime=1367323923" width="399" height="451" /></a></div>
<p>Select the profile and hit Delete</p>
<p>If you try to log in as that user, the profile will be recreated.</p>
<p>Now when I tried to start SQL Server again, the errors were not there and SQL Server started up without a problem</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbadmin/mssqlserveradmin/fixing-a-sql-server-could/feed/</wfw:commentRss>
		<slash:comments>6</slash:comments>
		</item>
		<item>
		<title>Where to find the xtype info for SQL Server in a table</title>
		<link>/index.php/datamgmt/dbprogramming/where-to-find-the-xtype/</link>
		<comments>/index.php/datamgmt/dbprogramming/where-to-find-the-xtype/#comments</comments>
		<pubDate>Fri, 26 Apr 2013 14:48:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[howto]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[table]]></category>
		<category><![CDATA[tip]]></category>

		<guid isPermaLink="false">/index.php/2013/04/where-to-find-the-xtype/</guid>
		<description><![CDATA[If you look at the sys.sysobjects view, you will see an xtype column listed

Object type. Can be one of the following object types:
AF = Aggregate function (CLR)
C = CHECK constraint
D = Default or DEFAULT constraint
F = FOREIGN KEY constraint
L&#8230;]]></description>
				<content:encoded><![CDATA[<p>If you look at the sys.sysobjects view, you will see a xtype column listed</p>
<p>Object type. Can be one of the following object types:<br />
AF = Aggregate function (CLR)<br />
C = CHECK constraint<br />
D = Default or DEFAULT constraint<br />
F = FOREIGN KEY constraint<br />
L = Log<br />
FN = Scalar function<br />
FS = Assembly (CLR) scalar-function<br />
FT = Assembly (CLR) table-valued function<br />
IF = In-lined table-function<br />
IT = Internal table<br />
P = Stored procedure<br />
PC = Assembly (CLR) stored-procedure<br />
PK = PRIMARY KEY constraint (type is K)<br />
RF = Replication filter stored procedure<br />
S = System table<br />
SN = Synonym<br />
SQ = Service queue<br />
TA = Assembly (CLR) DML trigger<br />
TF = Table function<br />
TR = SQL DML Trigger<br />
TT = Table type<br />
U = User table<br />
UQ = UNIQUE constraint (type is K)<br />
V = View<br />
X = Extended stored procedure</p>
<p>However there is no table in SQL Server that holds this info&#8230;.or is there?</p>
<p>I answered <a href="http://stackoverflow.com/questions/16243857/is-there-a-table-that-holds-the-listing-of-xtype-descriptions">this question</a> today and decided to share here as well</p>
<p>Here is how you can find that info, you can use my favorite table spt_values</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> name
<span class="kw1">FROM</span> master..<span class="me1">spt_values</span>
<span class="kw1">WHERE</span> type <span class="sy0">=</span> <span class="st0">'O9T'</span>
<span class="sy0">AND</span> number &nbsp;<span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">1</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT name
FROM master..spt_values
WHERE type = 'O9T'
AND number  = -1</pre></div></div>

<p>This is the output</p>
<p>AF: aggregate function<br />
AP: application<br />
C : check cns<br />
D : default (maybe cns)<br />
EN: event notification<br />
F : foreign key cns<br />
FN: scalar function<br />
FS: assembly scalar function<br />
FT: assembly table function<br />
IF: inline function<br />
IS: inline scalar function<br />
IT: internal table<br />
L : log<br />
P : stored procedure<br />
PC : assembly stored procedure<br />
PK: primary key cns<br />
R : rule<br />
RF: replication filter proc<br />
S : system table<br />
SN: synonym<br />
SQ: queue<br />
TA: assembly trigger<br />
TF: table function<br />
TR: trigger<br />
U : user table<br />
UQ: unique key cns<br />
V : view<br />
X : extended stored proc</p>
<p>Now if you want to split it into two columns, you can use the LEFT and RIGHT functions together with the PATINDEX function</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">LEFT</span><span class="br0">&#40;</span>name,<span class="kw2">PATINDEX</span><span class="br0">&#40;</span><span class="st0">'%:%'</span>,name<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">AS</span> xtype,
<span class="kw1">RIGHT</span><span class="br0">&#40;</span>name, <span class="br0">&#40;</span><span class="kw2">LEN</span><span class="br0">&#40;</span>name<span class="br0">&#41;</span> <span class="sy0">-</span> <span class="kw2">PATINDEX</span><span class="br0">&#40;</span><span class="st0">'%:%'</span>,name<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Description
<span class="kw1">FROM</span> master..<span class="me1">spt_values</span>
<span class="kw1">WHERE</span> type <span class="sy0">=</span> <span class="st0">'O9T'</span>
<span class="sy0">AND</span> number &nbsp;<span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">1</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT LEFT(name,PATINDEX('%:%',name)-1) AS xtype,
RIGHT(name, (LEN(name) - PATINDEX('%:%',name))) AS Description
FROM master..spt_values
WHERE type = 'O9T'
AND number  = -1</pre></div></div>

<p>Here is the result</p>
<pre>xtype	Description
AF	 aggregate function
AP	 application
C 	 check cns
D 	 default (maybe cns)
EN	 event notification
F 	 foreign key cns
FN	 scalar function
FS	 assembly scalar function
FT	 assembly table function
IF	 inline function
IS	 inline scalar function
IT	 internal table
L 	 log
P 	 stored procedure
PC 	 assembly stored procedure
PK	 primary key cns
R 	 rule
RF	 replication filter proc
S 	 system table
SN	 synonym
SQ	 queue
TA	 assembly trigger
TF	 table function
TR	 trigger
U 	 user table
UQ	 unique key cns
V 	 view
X 	 extended stored proc</pre>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/where-to-find-the-xtype/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
		</item>
	</channel>
</rss>
