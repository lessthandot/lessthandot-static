<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>truncation &#8211; LessthanDot</title>
	<atom:link href="/index.php/tag/truncation/feed/" rel="self" type="application/rss+xml" />
	<link>/</link>
	<description>A Technical Community for IT Professionals</description>
	<lastBuildDate>Sat, 09 Mar 2019 12:50:36 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.6.1</generator>
	<item>
		<title>How to find what column caused the String or binary data would be truncated message</title>
		<link>/index.php/datamgmt/datadesign/how-to-find-what-column/</link>
		<comments>/index.php/datamgmt/datadesign/how-to-find-what-column/#comments</comments>
		<pubDate>Wed, 27 Jul 2011 15:39:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Data Modelling and Design]]></category>
		<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[errors]]></category>
		<category><![CDATA[importing]]></category>
		<category><![CDATA[truncation]]></category>

		<guid isPermaLink="false">/index.php/2011/07/how-to-find-what-column/</guid>
		<description><![CDATA[How to find what column caused the String or binary data would be truncated message. Sometimes you get data from Excel or another system and you need to import that data into your tables. Some people will use an import wizard and all the columns will be nvarchar(255) in the import table]]></description>
				<content:encoded><![CDATA[<p>Sometimes you get data from Excel or another system and you need to import that data into your tables. Some people will use an import wizard and all the columns will be nvarchar(255) in the import table</p>
<p>Here is an example of a table created by the import/export wizard based on an Excel file</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>Sheet1$<span class="br0">&#93;</span> <span class="br0">&#40;</span>
<span class="br0">&#91;</span>emailaddress<span class="br0">&#93;</span> <span class="kw1">nvarchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>,
<span class="br0">&#91;</span><span class="kw1">Value</span><span class="br0">&#93;</span> <span class="kw1">nvarchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>,
<span class="br0">&#91;</span>CategoryName<span class="br0">&#93;</span> <span class="kw1">nvarchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>,
<span class="br0">&#91;</span>CategoryDescription<span class="br0">&#93;</span> <span class="kw1">nvarchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>,
<span class="br0">&#91;</span>CategoryID<span class="br0">&#93;</span> <span class="kw1">float</span>,
<span class="br0">&#91;</span>UserAdditionalInfoTextValue<span class="br0">&#93;</span> <span class="kw1">nvarchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>,
<span class="br0">&#91;</span>F9<span class="br0">&#93;</span> <span class="kw1">nvarchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>
<span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE [dbo].[Sheet1$] (
[emailaddress] nvarchar(255),
[Value] nvarchar(255),
[CategoryName] nvarchar(255),
[CategoryDescription] nvarchar(255),
[CategoryID] float,
[UserAdditionalInfoTextValue] nvarchar(255),
[F9] nvarchar(255)
)</pre></div></div>

<p>Sometimes the data that you are importing won&#8217;t fit into your column and you get the helpful  <strong>String or binary data would be truncated</strong> message.<br />
Of course it doesn&#8217;t tell you which column it is, now you need to figure out which column and compare the tables</p>
<p>I will show you what I mean, first create these two tables</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="de1"><pre class="de1"><span class="kw1">use</span> tempdb
go
&nbsp;
<span class="kw1">create</span> <span class="kw1">table</span> TestTrunc<span class="br0">&#40;</span>
&nbsp; &nbsp; Col1 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; Col2 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">15</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; Col3 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; Col4 <span class="kw1">nchar</span><span class="br0">&#40;</span><span class="nu0">3</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; Col5 <span class="kw1">nvarchar</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; Go
&nbsp; &nbsp; 
&nbsp; &nbsp; 
&nbsp; &nbsp; <span class="kw1">create</span> <span class="kw1">table</span> temp<span class="br0">&#40;</span>
&nbsp; &nbsp; Col1 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; Col2 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; Col3 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; Col4 <span class="kw1">nchar</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; Col5 <span class="kw1">nvarchar</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span><span class="br0">&#41;</span>&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">use tempdb
go

create table TestTrunc(
	Col1 varchar(10),
	Col2 varchar(15),
	Col3 varchar(20),
	Col4 nchar(3),
	Col5 nvarchar(10))
	Go
	
	
	create table temp(
	Col1 varchar(50),
	Col2 varchar(50),
	Col3 varchar(50),
	Col4 nchar(10),
	Col5 nvarchar(50))		
	GO</pre></div></div>

<p>Now let&#8217;s insert some data into the temp table	</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">insert</span> &nbsp;temp
<span class="kw1">select</span> <span class="st0">'1234567890'</span>,<span class="st0">'12345678901234567890'</span>,<span class="st0">'bla'</span>,<span class="st0">'1234'</span>,<span class="st0">'123456789011111'</span> &nbsp; 
<span class="kw1">union</span> all
<span class="kw1">select</span> <span class="st0">'1234567890111'</span>,<span class="st0">'1233'</span>,<span class="st0">'bla111'</span>,<span class="st0">'1234'</span>,<span class="st0">'123456111'</span> &nbsp; </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">insert 	temp
select '1234567890','12345678901234567890','bla','1234','123456789011111'	
union all
select '1234567890111','1233','bla111','1234','123456111'	</pre></div></div>

<p>If we now try to insert the data from the temp table into the TestTrunc table it will blow up</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">insert</span> TestTrunc
<span class="kw1">select</span> <span class="sy0">*</span> <span class="kw1">from</span> temp</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">insert TestTrunc
select * from temp</pre></div></div>

<p><em>Msg 8152, Level 16, State 14, Line 1<br />
String or binary data would be truncated.<br />
The statement has been terminated.</em></p>
<p>Yes, very nice&#8230;.could you indicate which column it actually has a problem with?</p>
<p>Now the purpose of this post is to create code that you then can modify for your own needs and can use it to compare any two tables.</p>
<p>First thing we need to know is what the columns are in the table that are (n)chars or (n)varchar</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> column_name
<span class="kw1">from</span> information_schema.<span class="me1">columns</span>
<span class="kw1">where</span> table_name <span class="sy0">=</span> <span class="st0">'temp'</span>
and data_type in<span class="br0">&#40;</span><span class="st0">'varchar'</span>,<span class="st0">'char'</span>,<span class="st0">'nvarchar'</span>,<span class="st0">'nchar'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select column_name
from information_schema.columns
where table_name = 'temp'
and data_type in('varchar','char','nvarchar','nchar')</pre></div></div>

<p>
column_name<br />
&#8212;&#8212;&#8212;&#8212;&#8211;<br />
Col1<br />
Col2<br />
Col3<br />
Col4<br />
Col5</p>
<p>That was easy, now we want to know the max length of the data in each column</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="kw1">declare</span> @<span class="kw1">sql</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="st0">'select &nbsp;0 as _col0 ,'</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span> &nbsp; <span class="st0">'max(len( '</span> <span class="sy0">+</span> column_name<span class="sy0">+</span> <span class="st0">')) AS '</span> <span class="sy0">+</span> column_name <span class="sy0">+</span> <span class="st0">','</span> 
<span class="kw1">from</span> information_schema.<span class="me1">columns</span>
<span class="kw1">where</span> table_name <span class="sy0">=</span> <span class="st0">'temp'</span>
and data_type in<span class="br0">&#40;</span><span class="st0">'varchar'</span>,<span class="st0">'char'</span>,<span class="st0">'nvarchar'</span>,<span class="st0">'nchar'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="kw1">left</span><span class="br0">&#40;</span>@<span class="kw1">sql</span>,<span class="kw2">len</span><span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span><span class="st0">' into MaxLengths from temp'</span>
&nbsp;
<span class="co1">--select @sql -debugging so simple, a caveman can do it</span>
&nbsp;
<span class="kw1">exec</span> <span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">declare @sql varchar(8000)
select @sql = 'select  0 as _col0 ,'
select @sql +=   'max(len( ' + column_name+ ')) AS ' + column_name + ',' 
from information_schema.columns
where table_name = 'temp'
and data_type in('varchar','char','nvarchar','nchar')

select @sql = left(@sql,len(@sql) -1)
select @sql +=' into MaxLengths from temp'

--select @sql -debugging so simple, a caveman can do it

exec (@sql)</pre></div></div>

<p>That code basically creates and runs the following </p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> &nbsp;<span class="nu0">0</span> <span class="kw1">as</span> _col0 ,
&nbsp; &nbsp; <span class="kw2">max</span><span class="br0">&#40;</span><span class="kw2">len</span><span class="br0">&#40;</span> Col1<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Col1,
&nbsp; &nbsp; <span class="kw2">max</span><span class="br0">&#40;</span><span class="kw2">len</span><span class="br0">&#40;</span> Col2<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Col2,
&nbsp; &nbsp; <span class="kw2">max</span><span class="br0">&#40;</span><span class="kw2">len</span><span class="br0">&#40;</span> Col3<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Col3,
&nbsp; &nbsp; <span class="kw2">max</span><span class="br0">&#40;</span><span class="kw2">len</span><span class="br0">&#40;</span> Col4<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Col4,
&nbsp; &nbsp; <span class="kw2">max</span><span class="br0">&#40;</span><span class="kw2">len</span><span class="br0">&#40;</span> Col5<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Col5 
<span class="kw1">into</span> MaxLengths 
<span class="kw1">from</span> temp</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select  0 as _col0 ,
	max(len( Col1)) AS Col1,
	max(len( Col2)) AS Col2,
	max(len( Col3)) AS Col3,
	max(len( Col4)) AS Col4,
	max(len( Col5)) AS Col5 
into MaxLengths 
from temp</pre></div></div>

<p>If we now look in the MaxLengths table we will see the following</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> <span class="sy0">*</span> <span class="kw1">from</span> MaxLengths</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select * from MaxLengths</pre></div></div>

<p></p>
<pre>_col0	Col1	Col2	Col3	Col4	Col5
---------------------------------------------------
0	13	20	6	4	15</pre>
<p>Next to figure out is what the max length of the column itself is in the table that we want to insert into<br />
Run the following query</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> character_maximum_length,column_name
<span class="kw1">from</span> information_schema.<span class="me1">columns</span>
<span class="kw1">where</span> table_name <span class="sy0">=</span> <span class="st0">'TestTrunc'</span>
and data_type in<span class="br0">&#40;</span><span class="st0">'varchar'</span>,<span class="st0">'char'</span>,<span class="st0">'nvarchar'</span>,<span class="st0">'nchar'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select character_maximum_length,column_name
from information_schema.columns
where table_name = 'TestTrunc'
and data_type in('varchar','char','nvarchar','nchar')</pre></div></div>

<p>Here is the result<br />
</p>
<pre>character_maximum_length	column_name
--------------------------------------------
10				Col1
15				Col2
20				Col3
3				Col4
10				Col5</pre>
<p>We will again do this dynamically and insert the values into another table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="kw1">declare</span> @<span class="kw1">sql</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="st0">'select 0 as _col0, '</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span> &nbsp; <span class="st0">''</span> <span class="sy0">+</span> <span class="kw1">convert</span><span class="br0">&#40;</span><span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span>,character_maximum_length<span class="br0">&#41;</span><span class="sy0">+</span> <span class="st0">' AS '</span> <span class="sy0">+</span> column_name <span class="sy0">+</span> <span class="st0">','</span> 
<span class="kw1">from</span> information_schema.<span class="me1">columns</span>
<span class="kw1">where</span> table_name <span class="sy0">=</span> <span class="st0">'TestTrunc'</span>
and data_type in<span class="br0">&#40;</span><span class="st0">'varchar'</span>,<span class="st0">'char'</span>,<span class="st0">'nvarchar'</span>,<span class="st0">'nchar'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="kw1">left</span><span class="br0">&#40;</span>@<span class="kw1">sql</span>,<span class="kw2">len</span><span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span><span class="st0">' into TempTrunc '</span>
&nbsp;
<span class="co1">--select @sql -debugging so simple, a caveman can do it</span>
&nbsp;
<span class="kw1">exec</span> <span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">declare @sql varchar(8000)
select @sql = 'select 0 as _col0, '
select @sql +=   '' + convert(varchar(20),character_maximum_length)+ ' AS ' + column_name + ',' 
from information_schema.columns
where table_name = 'TestTrunc'
and data_type in('varchar','char','nvarchar','nchar')

select @sql = left(@sql,len(@sql) -1)
select @sql +=' into TempTrunc '

--select @sql -debugging so simple, a caveman can do it

exec (@sql)</pre></div></div>

<p>Now we can see what we have in the two tables</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> <span class="st0">'TempTrunc'</span> <span class="kw1">as</span> TableNAme,<span class="sy0">*</span> <span class="kw1">from</span> TempTrunc
<span class="kw1">union</span> all
<span class="kw1">select</span> <span class="st0">'MaxLengths'</span> <span class="kw1">as</span> TableNAme,<span class="sy0">*</span> <span class="kw1">from</span> MaxLengths</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select 'TempTrunc' as TableNAme,* from TempTrunc
union all
select 'MaxLengths' as TableNAme,* from MaxLengths</pre></div></div>

<p></p>
<pre>TableNAme	_col0	Col1	Col2	Col3	Col4	Col5
-------------------------------------------------------------
TempTrunc	0	10	15	20	3	10
MaxLengths	0	13	20	6	4	15</pre>
<p>As you can see, all columns except for Col3 will cause the truncation problem<br />
Of course we want to do something like this, it will tell us which columns have truncation problems</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> &nbsp;<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col1</span> <span class="sy0">&gt;</span> tt.<span class="me1">col1</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> <span class="kw1">end</span> <span class="kw1">as</span> Col1,
&nbsp;<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col2</span> <span class="sy0">&gt;</span> tt.<span class="me1">col2</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> <span class="kw1">end</span> <span class="kw1">as</span> Col2,
&nbsp;<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col3</span> <span class="sy0">&gt;</span> tt.<span class="me1">col3</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> &nbsp;<span class="kw1">end</span> <span class="kw1">as</span> Col3,
&nbsp;<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col4</span> <span class="sy0">&gt;</span> tt.<span class="me1">col4</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> &nbsp;<span class="kw1">else</span> <span class="st0">'no truncation'</span> <span class="kw1">end</span> <span class="kw1">as</span> Col4,
&nbsp;<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col5</span> <span class="sy0">&gt;</span> tt.<span class="me1">col5</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> &nbsp;<span class="kw1">end</span> <span class="kw1">as</span> Col5
&nbsp; &nbsp;<span class="kw1">from</span> MaxLengths t
join TempTrunc tt <span class="kw1">on</span> t._col0 <span class="sy0">=</span> tt._col0</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select  case when  t.col1 &gt; tt.col1 then 'truncation' else 'no truncation' end as Col1,
 case when  t.col2 &gt; tt.col2 then 'truncation' else 'no truncation' end as Col2,
 case when  t.col3 &gt; tt.col3 then 'truncation' else 'no truncation'  end as Col3,
 case when  t.col4 &gt; tt.col4 then 'truncation'  else 'no truncation' end as Col4,
 case when  t.col5 &gt; tt.col5 then 'truncation' else 'no truncation'  end as Col5
   from MaxLengths t
join TempTrunc tt on t._col0 = tt._col0</pre></div></div>

<p></p>
<pre>Col1		Col2		Col3			Col4		Col5
------------------------------------------------------------------------------------
truncation	truncation	no truncation	     truncation	     truncation</pre>
<p>And again, we will use a dynamic approach, we don&#8217;t know the real column names</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="de1"><pre class="de1"><span class="kw1">declare</span> @<span class="kw1">sql</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="st0">'select &nbsp;'</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span> &nbsp; <span class="st0">''</span> <span class="sy0">+</span> <span class="st0">'case when &nbsp;t.'</span> <span class="sy0">+</span> column_name <span class="sy0">+</span> <span class="st0">' &gt; tt.'</span> <span class="sy0">+</span> column_name
<span class="sy0">+</span> <span class="st0">' then '</span><span class="st0">'truncation'</span><span class="st0">' else '</span><span class="st0">'no truncation'</span><span class="st0">' end as '</span><span class="sy0">+</span> column_name
<span class="sy0">+</span> <span class="st0">','</span> 
<span class="kw1">from</span> information_schema.<span class="me1">columns</span>
<span class="kw1">where</span> table_name <span class="sy0">=</span> <span class="st0">'MaxLengths'</span>
and column_name <span class="sy0">&lt;&gt;</span> <span class="st0">'_col0'</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="kw1">left</span><span class="br0">&#40;</span>@<span class="kw1">sql</span>,<span class="kw2">len</span><span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span><span class="st0">' &nbsp;from MaxLengths t</span>
<span class="st0">join TempTrunc tt on t._col0 = tt._col0 '</span>
&nbsp;
<span class="co1">--select @sql -debugging so simple, a caveman can do it</span>
&nbsp;
<span class="kw1">exec</span> <span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">declare @sql varchar(8000)
select @sql = 'select  '
select @sql +=   '' + 'case when  t.' + column_name + ' &gt; tt.' + column_name
+ ' then ''truncation'' else ''no truncation'' end as '+ column_name
+ ',' 
from information_schema.columns
where table_name = 'MaxLengths'
and column_name &lt;&gt; '_col0'
select @sql = left(@sql,len(@sql) -1)
select @sql +='  from MaxLengths t
join TempTrunc tt on t._col0 = tt._col0 '

--select @sql -debugging so simple, a caveman can do it

exec (@sql)</pre></div></div>

<p></p>
<pre>Col1		Col2		Col3			Col4		Col5
------------------------------------------------------------------------------------
truncation	truncation	no truncation	      truncation    truncation</pre>
<p>That is all there is to it, you can of course customize it by passing in the table names and make this part of your toolkit to quickly see where the problem is</p>
<h2>Making it truly dynamic</h2>
<p>Here is what it would look like with dynamic table names</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre></td><td class="de1"><pre class="de1"><span class="kw1">declare</span> @ImportTable <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>
<span class="kw1">declare</span> @DestinationTable <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @ImportTable <span class="sy0">=</span> <span class="st0">'temp'</span>
<span class="kw1">select</span> @DestinationTable <span class="sy0">=</span> <span class="st0">'TestTrunc'</span>
&nbsp;
<span class="kw1">declare</span> @ImportTableCompare <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>
<span class="kw1">declare</span> @DestinationTableCompare <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @ImportTableCompare <span class="sy0">=</span> <span class="st0">'MaxLengths'</span>
<span class="kw1">select</span> @DestinationTableCompare <span class="sy0">=</span> <span class="st0">'TempTrunc'</span>
&nbsp;
&nbsp;
<span class="kw1">declare</span> @<span class="kw1">sql</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> &nbsp;<span class="sy0">=</span> <span class="st0">''</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="st0">'select &nbsp;0 as _col0 ,'</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span> &nbsp; <span class="st0">'max(len( '</span> <span class="sy0">+</span> column_name<span class="sy0">+</span> <span class="st0">')) AS '</span> <span class="sy0">+</span> column_name <span class="sy0">+</span> <span class="st0">','</span> 
<span class="kw1">from</span> information_schema.<span class="me1">columns</span>
<span class="kw1">where</span> table_name <span class="sy0">=</span> @ImportTable
and data_type in<span class="br0">&#40;</span><span class="st0">'varchar'</span>,<span class="st0">'char'</span>,<span class="st0">'nvarchar'</span>,<span class="st0">'nchar'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="kw1">left</span><span class="br0">&#40;</span>@<span class="kw1">sql</span>,<span class="kw2">len</span><span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span><span class="st0">' into '</span> <span class="sy0">+</span> @ImportTableCompare <span class="sy0">+</span> <span class="st0">' from '</span> <span class="sy0">+</span> @ImportTable
&nbsp;
<span class="co1">--select @sql -debugging so simple, a caveman can do it</span>
&nbsp;
<span class="kw1">exec</span> <span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
&nbsp;
<span class="kw1">select</span> @<span class="kw1">sql</span> &nbsp;<span class="sy0">=</span> <span class="st0">''</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="st0">'select 0 as _col0, '</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span> &nbsp; <span class="st0">''</span> <span class="sy0">+</span> <span class="kw1">convert</span><span class="br0">&#40;</span><span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span>,character_maximum_length<span class="br0">&#41;</span><span class="sy0">+</span> <span class="st0">' AS '</span> <span class="sy0">+</span> column_name <span class="sy0">+</span> <span class="st0">','</span> 
<span class="kw1">from</span> information_schema.<span class="me1">columns</span>
<span class="kw1">where</span> table_name <span class="sy0">=</span> @DestinationTable
and data_type in<span class="br0">&#40;</span><span class="st0">'varchar'</span>,<span class="st0">'char'</span>,<span class="st0">'nvarchar'</span>,<span class="st0">'nchar'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="kw1">left</span><span class="br0">&#40;</span>@<span class="kw1">sql</span>,<span class="kw2">len</span><span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span><span class="st0">' into '</span> <span class="sy0">+</span> @DestinationTableCompare
&nbsp;
<span class="co1">--select @sql -debugging so simple, a caveman can do it</span>
&nbsp;
<span class="kw1">exec</span> <span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">select</span> @<span class="kw1">sql</span> &nbsp;<span class="sy0">=</span> <span class="st0">''</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="st0">'select &nbsp;'</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span> &nbsp; <span class="st0">''</span> <span class="sy0">+</span> <span class="st0">'case when &nbsp;t.'</span> <span class="sy0">+</span> column_name <span class="sy0">+</span> <span class="st0">' &gt; tt.'</span> <span class="sy0">+</span> column_name
<span class="sy0">+</span> <span class="st0">' then '</span><span class="st0">'truncation'</span><span class="st0">' else '</span><span class="st0">'no truncation'</span><span class="st0">' end as '</span><span class="sy0">+</span> column_name
<span class="sy0">+</span> <span class="st0">','</span> 
<span class="kw1">from</span> information_schema.<span class="me1">columns</span>
<span class="kw1">where</span> table_name <span class="sy0">=</span> @ImportTableCompare
and column_name <span class="sy0">&lt;&gt;</span> <span class="st0">'_col0'</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">=</span> <span class="kw1">left</span><span class="br0">&#40;</span>@<span class="kw1">sql</span>,<span class="kw2">len</span><span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">select</span> @<span class="kw1">sql</span> <span class="sy0">+=</span><span class="st0">' &nbsp;from '</span> <span class="sy0">+</span> @ImportTableCompare <span class="sy0">+</span> <span class="st0">' t</span>
<span class="st0">join '</span> <span class="sy0">+</span> @DestinationTableCompare <span class="sy0">+</span> <span class="st0">' tt on t._col0 = tt._col0 '</span>
&nbsp;
<span class="co1">--select @sql -debugging so simple, a caveman can do it</span>
&nbsp;
<span class="kw1">exec</span> <span class="br0">&#40;</span>@<span class="kw1">sql</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">exec</span> <span class="br0">&#40;</span><span class="st0">'drop table '</span> <span class="sy0">+</span> @ImportTableCompare<span class="sy0">+</span> <span class="st0">','</span> <span class="sy0">+</span> @DestinationTableCompare <span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">declare @ImportTable varchar(100)
declare @DestinationTable varchar(100)
select @ImportTable = 'temp'
select @DestinationTable = 'TestTrunc'

declare @ImportTableCompare varchar(100)
declare @DestinationTableCompare varchar(100)
select @ImportTableCompare = 'MaxLengths'
select @DestinationTableCompare = 'TempTrunc'


declare @sql varchar(8000)
select @sql  = ''
select @sql = 'select  0 as _col0 ,'
select @sql +=   'max(len( ' + column_name+ ')) AS ' + column_name + ',' 
from information_schema.columns
where table_name = @ImportTable
and data_type in('varchar','char','nvarchar','nchar')

select @sql = left(@sql,len(@sql) -1)
select @sql +=' into ' + @ImportTableCompare + ' from ' + @ImportTable

--select @sql -debugging so simple, a caveman can do it

exec (@sql)



select @sql  = ''
select @sql = 'select 0 as _col0, '
select @sql +=   '' + convert(varchar(20),character_maximum_length)+ ' AS ' + column_name + ',' 
from information_schema.columns
where table_name = @DestinationTable
and data_type in('varchar','char','nvarchar','nchar')

select @sql = left(@sql,len(@sql) -1)
select @sql +=' into ' + @DestinationTableCompare

--select @sql -debugging so simple, a caveman can do it

exec (@sql)


select @sql  = ''
select @sql = 'select  '
select @sql +=   '' + 'case when  t.' + column_name + ' &gt; tt.' + column_name
+ ' then ''truncation'' else ''no truncation'' end as '+ column_name
+ ',' 
from information_schema.columns
where table_name = @ImportTableCompare
and column_name &lt;&gt; '_col0'
select @sql = left(@sql,len(@sql) -1)
select @sql +='  from ' + @ImportTableCompare + ' t
join ' + @DestinationTableCompare + ' tt on t._col0 = tt._col0 '

--select @sql -debugging so simple, a caveman can do it

exec (@sql)


exec ('drop table ' + @ImportTableCompare+ ',' + @DestinationTableCompare )</pre></div></div>

<p></p>
<h3>To Do list</h3>
<p>Here are some things for you to add&#8230;&#8230;.</p>
<p>Now if you have worked with SQL Server for a while now, you might notice that what I did was not really what you would call defensive programming.<br />
Can you tell what I forgot?</p>
<p><strong>1)</strong> if the column name has spaces or other weird characters I am not taking care of that. To take care of that use the QUOTENAME function or put brackets around column_name</p>
<p><strong>2)</strong> I also didn&#8217;t look at the schema the table is in, you can use the TABLE_SCHEMA column for that, and the same applies as for columns, use QUOTENAME to take care of schemas that have an invalid name.</p>
<p><strong>3)</strong> LEN trims spaces, be aware of that otherwise you might still get truncation if inserting into a char column.</p>
<p>example</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1"><span class="kw1">create</span> <span class="kw1">table</span> TestTrim<span class="br0">&#40;</span>SomeData <span class="kw1">char</span><span class="br0">&#40;</span><span class="nu0">3</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
go
&nbsp;
<span class="kw1">declare</span> @d <span class="kw1">char</span><span class="br0">&#40;</span><span class="nu0">5</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">'12 &nbsp;'</span>
<span class="kw1">select</span> <span class="kw2">len</span><span class="br0">&#40;</span>@d<span class="br0">&#41;</span> <span class="kw1">as</span> <span class="kw2">len</span> ,datalength<span class="br0">&#40;</span>@d<span class="br0">&#41;</span> <span class="kw1">as</span> datalength
&nbsp;
<span class="co1">--len &nbsp; datalength</span>
<span class="co1">--2 &nbsp; &nbsp; 5</span>
&nbsp;
&nbsp;
<span class="kw1">insert</span> TestTrim
<span class="kw1">values</span> <span class="br0">&#40;</span>@d<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">select</span> <span class="sy0">*</span>,<span class="kw2">len</span><span class="br0">&#40;</span>SomeData<span class="br0">&#41;</span> <span class="kw1">as</span> <span class="kw2">len</span>,datalength<span class="br0">&#40;</span>SomeData<span class="br0">&#41;</span> &nbsp;<span class="kw1">as</span> datalength
<span class="kw1">from</span> TestTrim
<span class="co1">--SomeData&nbsp; len &nbsp; &nbsp; datalength</span>
<span class="co1">--12 &nbsp; &nbsp;&nbsp; &nbsp; 2 &nbsp; &nbsp; &nbsp; 3</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">create table TestTrim(SomeData char(3))
go

declare @d char(5) = '12  '
select len(@d) as len ,datalength(@d) as datalength

--len	datalength
--2		5


insert TestTrim
values (@d)

select *,len(SomeData) as len,datalength(SomeData)  as datalength
from TestTrim
--SomeData	len		datalength
--12 		2		3</pre></div></div>

<p><strong>4)</strong> The columns that have varchar(max) values<br />
Create this table<br />
create table TestTrim(SomeData varchar(max))<br />
go</p>
<p>Now run this and observe character_maximum_length<br />
select * from information_schema.columns<br />
where table_name = &#8216;TestTrim&#8217;</p>
<p>As you can see the character_maximum_length is  -1 for (max) columns, you need to take that into account</p>
<p><strong>5)</strong> If your database uses a case sensitive collation then you need to take that into account with column and table names</p>
<p>That is it for this post, hopefully the code helps you to find out where the truncation occurs and if you do the 5 modifications like I suggested it should be pretty bullet proof</p>
<p>Bonus, use IIF instead of CASE.<br />
If you are using SQL Server Denali CTP3 or up, you can use IIF instead of CASE. See <a href="/index.php/DataMgmt/DBProgramming/MSSQLServer/a-quick-look-at-the">A Quick look at the new IIF function in Denali CTP3 for more information about IIF</a></p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> &nbsp;
<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col1</span> <span class="sy0">&gt;</span> tt.<span class="me1">col1</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> <span class="kw1">end</span> <span class="kw1">as</span> Col1,
<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col2</span> <span class="sy0">&gt;</span> tt.<span class="me1">col2</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> <span class="kw1">end</span> <span class="kw1">as</span> Col2,
<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col3</span> <span class="sy0">&gt;</span> tt.<span class="me1">col3</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> &nbsp;<span class="kw1">end</span> <span class="kw1">as</span> Col3,
<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col4</span> <span class="sy0">&gt;</span> tt.<span class="me1">col4</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> <span class="kw1">end</span> <span class="kw1">as</span> Col4,
<span class="kw1">case</span> <span class="kw1">when</span> &nbsp;t.<span class="me1">col5</span> <span class="sy0">&gt;</span> tt.<span class="me1">col5</span> <span class="kw1">then</span> <span class="st0">'truncation'</span> <span class="kw1">else</span> <span class="st0">'no truncation'</span> &nbsp;<span class="kw1">end</span> <span class="kw1">as</span> Col5
<span class="kw1">from</span> MaxLengths t
join TempTrunc tt <span class="kw1">on</span> t._col0 <span class="sy0">=</span> tt._col0</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select  
case when  t.col1 &gt; tt.col1 then 'truncation' else 'no truncation' end as Col1,
case when  t.col2 &gt; tt.col2 then 'truncation' else 'no truncation' end as Col2,
case when  t.col3 &gt; tt.col3 then 'truncation' else 'no truncation'  end as Col3,
case when  t.col4 &gt; tt.col4 then 'truncation' else 'no truncation' end as Col4,
case when  t.col5 &gt; tt.col5 then 'truncation' else 'no truncation'  end as Col5
from MaxLengths t
join TempTrunc tt on t._col0 = tt._col0</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> &nbsp;
IIF<span class="br0">&#40;</span>t.<span class="me1">col1</span> <span class="sy0">&gt;</span> tt.<span class="me1">col1</span>,<span class="st0">'truncation'</span>,<span class="st0">'no truncation'</span><span class="br0">&#41;</span> <span class="kw1">as</span> Col1,
IIF<span class="br0">&#40;</span>t.<span class="me1">col2</span> <span class="sy0">&gt;</span> tt.<span class="me1">col2</span>,<span class="st0">'truncation'</span>,<span class="st0">'no truncation'</span><span class="br0">&#41;</span> <span class="kw1">as</span> Col2,
IIF<span class="br0">&#40;</span>t.<span class="me1">col3</span> <span class="sy0">&gt;</span> tt.<span class="me1">col3</span>,<span class="st0">'truncation'</span>,<span class="st0">'no truncation'</span><span class="br0">&#41;</span> <span class="kw1">as</span> Col3,
IIF<span class="br0">&#40;</span>t.<span class="me1">col4</span> <span class="sy0">&gt;</span> tt.<span class="me1">col4</span>,<span class="st0">'truncation'</span>,<span class="st0">'no truncation'</span><span class="br0">&#41;</span> <span class="kw1">as</span> Col4,
IIF<span class="br0">&#40;</span>t.<span class="me1">col5</span> <span class="sy0">&gt;</span> tt.<span class="me1">col5</span>,<span class="st0">'truncation'</span>,<span class="st0">'no truncation'</span><span class="br0">&#41;</span> <span class="kw1">as</span> Col5
<span class="kw1">from</span> MaxLengths t
join TempTrunc tt <span class="kw1">on</span> t._col0 <span class="sy0">=</span> tt._col0</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select  
IIF(t.col1 &gt; tt.col1,'truncation','no truncation') as Col1,
IIF(t.col2 &gt; tt.col2,'truncation','no truncation') as Col2,
IIF(t.col3 &gt; tt.col3,'truncation','no truncation') as Col3,
IIF(t.col4 &gt; tt.col4,'truncation','no truncation') as Col4,
IIF(t.col5 &gt; tt.col5,'truncation','no truncation') as Col5
from MaxLengths t
join TempTrunc tt on t._col0 = tt._col0</pre></div></div>

]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/datadesign/how-to-find-what-column/feed/</wfw:commentRss>
		<slash:comments>13</slash:comments>
		</item>
	</channel>
</rss>
