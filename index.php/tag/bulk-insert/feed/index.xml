<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>bulk insert &#8211; LessthanDot</title>
	<atom:link href="/index.php/tag/bulk-insert/feed/" rel="self" type="application/rss+xml" />
	<link>/</link>
	<description>A Technical Community for IT Professionals</description>
	<lastBuildDate>Sat, 09 Mar 2019 12:50:36 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.6.1</generator>
	<item>
		<title>BULK INSERT data where the row terminator is a linefeed in SQL Server</title>
		<link>/index.php/datamgmt/dbadmin/mssqlserveradmin/bulk-insert-data-where-the/</link>
		<comments>/index.php/datamgmt/dbadmin/mssqlserveradmin/bulk-insert-data-where-the/#comments</comments>
		<pubDate>Thu, 14 Feb 2013 13:38:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Business Intelligence]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[bcp]]></category>
		<category><![CDATA[bulk insert]]></category>
		<category><![CDATA[files]]></category>
		<category><![CDATA[import]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/02/bulk-insert-data-where-the/</guid>
		<description><![CDATA[I like to use BULK INSERT or bcp as much as possible, this is especially true if all I need to do is dump the file into a table. For more complex things I will go the SSIS route. Files are generated by all kinds of systems these days, these can be Windo&#8230;]]></description>
				<content:encoded><![CDATA[<p>I like to use BULK INSERT or bcp as much as possible, this is especially true if all I need to do is dump the file into a table. For more complex things I will go the SSIS route. Files are generated by all kinds of systems these days, these can be Windows, *nix, Mac, Amiga and other systems. </p>
<p>Make sure to use something other than notepad when dealing with these files and you want to look at them. Notepad++ or Editplus have more functionality and are many times faster than notepad. The nice thing about either of these is that you can see control characters.</p>
<p>See how you can see the linefeeds here? Can&#8217;t do that in notepad</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/LineFeedFile.PNG?mtime=1360855487"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/LineFeedFile.PNG?mtime=1360855487" width="421" height="223" /></a></div>
<p>So let&#8217;s say you get a file where the row terminator is a linefeed, how would you specify that as a row terminator in BULK INSERT?</p>
<p>You can try newline</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">BULK</span> <span class="kw1">INSERT</span> SomeTable
&nbsp; &nbsp;<span class="kw1">FROM</span> <span class="st0">'D:JunkdrawImportMe.txt'</span>
&nbsp; &nbsp;<span class="kw1">WITH</span> <span class="br0">&#40;</span>FIELDTERM<span class="sy0">IN</span>AT<span class="sy0">OR</span> <span class="sy0">=</span> <span class="st0">'t'</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FIRSTROW <span class="sy0">=</span><span class="nu0">2</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ROWTERM<span class="sy0">IN</span>AT<span class="sy0">OR</span> <span class="sy0">=</span> <span class="st0">'n'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">BULK INSERT SomeTable
   FROM 'D:JunkdrawImportMe.txt'
   WITH (FIELDTERMINATOR = 't',
         FIRSTROW =2,
         ROWTERMINATOR = 'n')</pre></div></div>

<p>Nope, that doesn&#8217;t work, you get 0 rows inserted</p>
<p>You can try carriage return</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">BULK</span> <span class="kw1">INSERT</span> SomeTable
&nbsp; &nbsp;<span class="kw1">FROM</span> <span class="st0">'D:JunkdrawImportMe.txt'</span>
&nbsp; &nbsp;<span class="kw1">WITH</span> <span class="br0">&#40;</span>FIELDTERM<span class="sy0">IN</span>AT<span class="sy0">OR</span> <span class="sy0">=</span> <span class="st0">'t'</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FIRSTROW <span class="sy0">=</span><span class="nu0">2</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ROWTERM<span class="sy0">IN</span>AT<span class="sy0">OR</span> <span class="sy0">=</span> <span class="st0">'r'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">BULK INSERT SomeTable
   FROM 'D:JunkdrawImportMe.txt'
   WITH (FIELDTERMINATOR = 't',
         FIRSTROW =2,
         ROWTERMINATOR = 'r')</pre></div></div>

<p>Nope, that doesn&#8217;t work either, you get 0 rows inserted</p>
<p>What about l for linefeed?</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">BULK</span> <span class="kw1">INSERT</span> SomeTable
&nbsp; &nbsp;<span class="kw1">FROM</span> <span class="st0">'D:JunkdrawImportMe.txt'</span>
&nbsp; &nbsp;<span class="kw1">WITH</span> <span class="br0">&#40;</span>FIELDTERM<span class="sy0">IN</span>AT<span class="sy0">OR</span> <span class="sy0">=</span> <span class="st0">'t'</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FIRSTROW <span class="sy0">=</span><span class="nu0">2</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ROWTERM<span class="sy0">IN</span>AT<span class="sy0">OR</span> <span class="sy0">=</span> <span class="st0">'l'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">BULK INSERT SomeTable
   FROM 'D:JunkdrawImportMe.txt'
   WITH (FIELDTERMINATOR = 't',
         FIRSTROW =2,
         ROWTERMINATOR = 'l')</pre></div></div>

<p>You get an error</p>
<p>Msg 4864, Level 16, State 1, Line 1<br />
Bulk load data conversion error (type mismatch or invalid character for the specified codepage) for row 2, column 1 (SomeDate).</p>
<p>What about if you try a CHAR(10) which is a linefeed</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">BULK</span> <span class="kw1">INSERT</span> SomeTable
&nbsp; &nbsp;<span class="kw1">FROM</span> <span class="st0">'D:JunkdrawImportMe.txt'</span>
&nbsp; &nbsp;<span class="kw1">WITH</span> <span class="br0">&#40;</span>FIELDTERM<span class="sy0">IN</span>AT<span class="sy0">OR</span> <span class="sy0">=</span> <span class="st0">'t'</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FIRSTROW <span class="sy0">=</span><span class="nu0">2</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ROWTERM<span class="sy0">IN</span>AT<span class="sy0">OR</span> <span class="sy0">=</span> <span class="kw1">CHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span> <span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">BULK INSERT SomeTable
   FROM 'D:JunkdrawImportMe.txt'
   WITH (FIELDTERMINATOR = 't',
         FIRSTROW =2,
         ROWTERMINATOR = CHAR(10) )</pre></div></div>

<p>You get this error<br />
Msg 102, Level 15, State 1, Line 5<br />
Incorrect syntax near &#8216;CHAR&#8217;.</p>
<p>Mmm, what if you embed it from within Dynamic SQL</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @cmd <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">1000</span><span class="br0">&#41;</span>
<span class="kw1">SET</span> @cmd <span class="sy0">=</span> <span class="st0">'BULK INSERT SomeTable</span>
<span class="st0">FROM '</span><span class="st0">'D:JunkdrawImportMe.txt'</span><span class="st0">'</span>
<span class="st0">WITH ( &nbsp; &nbsp; &nbsp;FIELDTERMINATOR = '</span><span class="st0">'t'</span><span class="st0">',</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FIRSTROW =2,</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ROWTERMINATOR = '</span><span class="st0">''</span><span class="sy0">+</span><span class="kw1">CHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="sy0">+</span><span class="st0">''</span><span class="st0">')'</span>
<span class="kw1">EXEC</span><span class="br0">&#40;</span>@cmd<span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @cmd varchar(1000)
SET @cmd = 'BULK INSERT SomeTable
FROM ''D:JunkdrawImportMe.txt''
WITH (      FIELDTERMINATOR = ''t'',
            FIRSTROW =2,
            ROWTERMINATOR = '''+CHAR(10)+''')'
EXEC(@cmd)</pre></div></div>

<p>Bingo, that works.  Keep this in mind next time you get a file with a linefeed and you are struggling importing that file</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbadmin/mssqlserveradmin/bulk-insert-data-where-the/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
		</item>
	</channel>
</rss>
