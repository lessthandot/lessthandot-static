<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>sql server 2008 &#8211; LessthanDot</title>
	<atom:link href="/index.php/tag/sql-server-2008/feed/" rel="self" type="application/rss+xml" />
	<link>/</link>
	<description>A Technical Community for IT Professionals</description>
	<lastBuildDate>Sat, 09 Mar 2019 12:50:36 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.6.1</generator>
	<item>
		<title>SQL Puzzle.. How many uppercase and lowercase characters in a column</title>
		<link>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-uppercase/</link>
		<comments>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-uppercase/#comments</comments>
		<pubDate>Wed, 12 Jun 2013 12:47:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[puzzle]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[teaser]]></category>

		<guid isPermaLink="false">/index.php/2013/06/sql-puzzle-how-many-uppercase/</guid>
		<description><![CDATA[In this week's puzzle we are going to try to figure out how many uppercase, how many lowercase characters are in a column, we are also interested in how many are neither uppercase or lowercase


Here is the table and the data

CREATE TABLE Puzzle&#8230;]]></description>
				<content:encoded><![CDATA[<p>In this week&#8217;s puzzle we are going to try to figure out how many uppercase, how many lowercase characters are in a column, we are also interested in how many are neither uppercase or lowercase</p>
<p>Here is the table and the data</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Puzzle
&nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span>Col1 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> Puzzle <span class="br0">&#40;</span>Col1<span class="br0">&#41;</span>
<span class="kw1">SELECT</span> <span class="st0">'ABCD01234Z'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'AAAAAAAAAA'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'aaaaaaaaaZ'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'a&amp;a&amp;a&amp;a&amp;aA'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'1234Tt7890'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE Puzzle
     (Col1 varchar(10));
 
INSERT INTO Puzzle (Col1)
SELECT 'ABCD01234Z'
UNION ALL
SELECT 'AAAAAAAAAA'
UNION ALL
SELECT 'aaaaaaaaaZ'
UNION ALL
SELECT 'a&amp;a&amp;a&amp;a&amp;aA'
UNION ALL
SELECT '1234Tt7890'</pre></div></div>

<p>This is the expected output</p>
<pre>Col1		UpperCase	LowerCase	Neither
ABCD01234Z	5		0		5
AAAAAAAAAA	10		0		0
aaaaaaaaaZ	1		9		0
a&amp;a&amp;a&amp;a&amp;aA	1		5		4
1234Tt7890	1		1		8</pre>
<p>For bonus points, you can add 3 more columns to the output, one column will hold only uppercase characters, one column will hold only lowercase characters, one column will hold only characters that are neither uppercase  or lowercase</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-uppercase/feed/</wfw:commentRss>
		<slash:comments>5</slash:comments>
		</item>
		<item>
		<title>SQL Puzzle.. Sorting results without using ORDER BY</title>
		<link>/index.php/datamgmt/dbprogramming/mssqlserver/sql-puzzle-sorting-results-without/</link>
		<comments>/index.php/datamgmt/dbprogramming/mssqlserver/sql-puzzle-sorting-results-without/#comments</comments>
		<pubDate>Wed, 05 Jun 2013 19:25:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[puzzle]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[teaser]]></category>

		<guid isPermaLink="false">/index.php/2013/06/sql-puzzle-sorting-results-without/</guid>
		<description><![CDATA[Time for this week's puzzle/teaser. I want to return the results in ascending order but without using ORDER BY

If you run this code

CREATE TABLE Puzzle
     (Col1 varchar(20) NOT NULL PRIMARY KEY CLUSTERED,
      Col2 varchar(20) NOT NULL UNIQUE&#8230;]]></description>
				<content:encoded><![CDATA[<p>Time for this week&#8217;s puzzle/teaser. I want to return the results in ascending order but without using ORDER BY</p>
<p>If you run this code</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Puzzle
&nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span>Col1 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span> <span class="kw1">CLUSTERED</span>,
&nbsp; &nbsp; &nbsp; Col2 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> <span class="kw1">UNIQUE</span> <span class="kw1">NONCLUSTERED</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> Puzzle <span class="br0">&#40;</span>Col1, Col2<span class="br0">&#41;</span>
<span class="kw1">SELECT</span> <span class="st0">'Z'</span>, <span class="st0">'AA'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'A'</span>, <span class="st0">'BB'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'B'</span>, <span class="st0">'CC'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'C'</span>, <span class="st0">'DD'</span>
<span class="kw1">UNION</span> <span class="sy0">ALL</span>
<span class="kw1">SELECT</span> <span class="st0">'M'</span>, <span class="st0">'EE'</span>;
&nbsp;
<span class="kw1">SELECT</span> Col1 <span class="kw1">FROM</span> Puzzle;
<span class="kw1">DROP</span> <span class="kw1">TABLE</span> Puzzle;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE Puzzle
     (Col1 varchar(20) NOT NULL PRIMARY KEY CLUSTERED,
      Col2 varchar(20) NOT NULL UNIQUE NONCLUSTERED);

INSERT INTO Puzzle (Col1, Col2)
SELECT 'Z', 'AA'
UNION ALL
SELECT 'A', 'BB'
UNION ALL
SELECT 'B', 'CC'
UNION ALL
SELECT 'C', 'DD'
UNION ALL
SELECT 'M', 'EE';

SELECT Col1 FROM Puzzle;
DROP TABLE Puzzle;</pre></div></div>

<p>you get these results</p>
<p>Col1<br />
Z<br />
A<br />
B<br />
C<br />
M</p>
<p>What I want to see is the following</p>
<p>Col1<br />
A<br />
B<br />
C<br />
M<br />
Z</p>
<p>Without using ORDER BY, how would you make the SELECT query return Col1 in ascending order?  You can&#8217;t make changes to the table, all that you are allowed to modify is this part</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> Col1 <span class="kw1">FROM</span> Puzzle;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT Col1 FROM Puzzle;</pre></div></div>

<p><strong>Warning</strong><br />
Do not use these suggestion in production code, the only real way to guarantee order of a result set is by using ORDER BY</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/mssqlserver/sql-puzzle-sorting-results-without/feed/</wfw:commentRss>
		<slash:comments>26</slash:comments>
		</item>
		<item>
		<title>SQL Puzzle&#8230;how many even numbers are there in a row</title>
		<link>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-even/</link>
		<comments>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-even/#comments</comments>
		<pubDate>Wed, 29 May 2013 07:29:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[puzzle]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[teaser]]></category>

		<guid isPermaLink="false">/index.php/2013/05/sql-puzzle-how-many-even/</guid>
		<description><![CDATA[In last week's puzzle SQL Puzzle: RIGHT without using the RIGHT function we looked at how to do a RIGHT function without using the RIGHT function. Today we are going to find out how many columns are even in a row. 

Before starting I want you to be aw&#8230;]]></description>
				<content:encoded><![CDATA[<p>In last week&#8217;s puzzle SQL Puzzle: <a href="/index.php/DataMgmt/DBProgramming/sql-puzzle-right-without-using">RIGHT without using the RIGHT function</a> we looked at how to do a RIGHT function without using the RIGHT function. Today we are going to find out how many columns are even in a row. </p>
<p>Before starting I want you to be aware that 0 is an even number  From wikipedia: <a href="http://en.wikipedia.org/wiki/Parity_of_zero">Parity of zero</a></p>
<blockquote><p>Zero is an even number. In other words, its parityâ€”the quality of an integer being even or oddâ€”is even. Zero fits the definition of &#8220;even number&#8221;: it is an integer multiple of 2, namely 0 Ã— 2. As a result, zero shares all the properties that characterize even numbers: 0 is divisible by 2, 0 is surrounded on both sides by odd numbers, 0 is the sum of an integer (0) with itself, and a set of 0 objects can be split into two equal sets.</p>
<p>Zero also fits into the patterns formed by other even numbers. The parity rules of arithmetic, such as even &#8722; even = even, require 0 to be even. Zero is the additive identity element of the group of even integers, and it is the starting case from which other even natural numbers are recursively defined. Applications of this recursion from graph theory to computational geometry rely on zero being even. Not only is 0 divisible by 2, it is divisible by every integer. In the binary numeral system used by computers, it is especially relevant that 0 is divisible by every power of 2; in this sense, 0 is the &#8220;most even&#8221; number of all.</p></blockquote>
<p>Here is the table that you will use for your solution</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Puzzle<span class="br0">&#40;</span>Col1 <span class="kw1">int</span>, Col2 <span class="kw1">int</span>, Col3 <span class="kw1">int</span>, Col4 <span class="kw1">int</span>, Col5 <span class="kw1">int</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">4</span>,<span class="nu0">5</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">0</span>,<span class="nu0">1</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">4</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">2</span>,<span class="nu0">2</span>,<span class="nu0">2</span>,<span class="nu0">2</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span>,<span class="nu0">1</span>,<span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">3</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">2</span>,<span class="nu0">3</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">2</span>,<span class="nu0">3</span>,<span class="nu0">2</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #Puzzle(Col1 int, Col2 int, Col3 int, Col4 int, Col5 int)

INSERT  #Puzzle VALUES (1,2,3,4,5)
INSERT  #Puzzle VALUES (0,1,2,3,4)
INSERT  #Puzzle VALUES (2,2,2,2,2)
INSERT  #Puzzle VALUES (1,1,1,1,1)
INSERT  #Puzzle VALUES (3,2,3,2,3)
INSERT  #Puzzle VALUES (2,3,2,3,2)</pre></div></div>

<p>And here is the expected output</p>
<pre>Col1	Col2	Col3	Col4	Col5	Even
1	2	3	4	5	2
0	1	2	3	4	3
2	2	2	2	2	5
1	1	1	1	1	0
3	2	3	2	3	2
2	3	2	3	2	3</pre>
<p>That should be pretty easy right?</p>
<p>How about a solution that doesn&#8217;t use a CASE statement, you think you can do it (I can think of 2 ways without using a CASE statement)</p>
<p>Post your solutions as a comment</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/sql-puzzle-how-many-even/feed/</wfw:commentRss>
		<slash:comments>11</slash:comments>
		</item>
		<item>
		<title>SQL Puzzle:  RIGHT without using the RIGHT function</title>
		<link>/index.php/datamgmt/dbprogramming/sql-puzzle-right-without-using/</link>
		<comments>/index.php/datamgmt/dbprogramming/sql-puzzle-right-without-using/#comments</comments>
		<pubDate>Wed, 22 May 2013 07:44:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[puzzle]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[teaser]]></category>

		<guid isPermaLink="false">/index.php/2013/05/sql-puzzle-right-without-using/</guid>
		<description><![CDATA[I haven't done a puzzle for a long time so I figured let's do a simple one. Return the right 6 characters of the column but without using the RIGHT function.


Here is what the table looks like
CREATE TABLE #Puzzle(SomeCol CHAR(7))

INSERT  #Puzzl&#8230;]]></description>
				<content:encoded><![CDATA[<p>I haven&#8217;t done a puzzle for a long time so I figured let&#8217;s do a simple one. Return the right 6 characters of the column but without using the RIGHT function.</p>
<p>Here is what the table looks like</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Puzzle<span class="br0">&#40;</span>SomeCol <span class="kw1">CHAR</span><span class="br0">&#40;</span><span class="nu0">7</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'AAAAAAA'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">' BBBBBB'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'CCCCCC'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">' DDDDD '</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="sy0">NULL</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> &nbsp;#Puzzle <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">' &nbsp; &nbsp; &nbsp; '</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #Puzzle(SomeCol CHAR(7))

INSERT  #Puzzle VALUES ('AAAAAAA')
INSERT  #Puzzle VALUES (' BBBBBB')
INSERT  #Puzzle VALUES ('CCCCCC')
INSERT  #Puzzle VALUES (' DDDDD ')
INSERT  #Puzzle VALUES (NULL)
INSERT  #Puzzle VALUES ('       ')</pre></div></div>

<p>As you can see some rows start with spaces and some end with spaces, one row has the NULL value<br />
The output should be a Z followed by the right 6 characters from the column + the length of the column (not the length of the 6 characters that you are returning)</p>
<p>Here is what the output should look like</p>
<pre>ZAAAAAA7
ZBBBBBB7
ZCCCCC 7
ZDDDDD 7
Z0
Z      7</pre>
<p>As you can see spaces should remain and when the value is NULL then there should be a blank. The length for the row with the NULL value should be 0, you cannot hardcode 7 for the length, you have to calculate it.</p>
<p>Post your solution(s) in the comment section, remember no RIGHT function. Let&#8217;s see how many different ways you can come up with to do this</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/sql-puzzle-right-without-using/feed/</wfw:commentRss>
		<slash:comments>9</slash:comments>
		</item>
		<item>
		<title>SQL Server Database owner ~~UNKNOWN~~</title>
		<link>/index.php/datamgmt/dbadmin/sql-server-database-owner-unknown/</link>
		<comments>/index.php/datamgmt/dbadmin/sql-server-database-owner-unknown/#comments</comments>
		<pubDate>Tue, 14 May 2013 10:02:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Administration]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[security]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/05/sql-server-database-owner-unknown/</guid>
		<description><![CDATA[Today I was checking an older server and decided to run sp_helpdb. On a bunch of databases I noticed that the owner was ~~UNKNOWN~~. The only reason I noticed this was when I tried to look at a specific database which is mirrored. I was greeted with thi&#8230;]]></description>
				<content:encoded><![CDATA[<p>Today I was checking an older server and decided to run sp_helpdb. On a bunch of databases I noticed that the owner was ~~UNKNOWN~~. The only reason I noticed this was when I tried to look at a specific database which is mirrored. I was greeted with this dialog box</p>
<blockquote><p>Cannot show requested dialog.</p>
<p>Additional information:<br />
  Cannot show requested dialog.(SqlMgmt)<br />
    Property Owner is not available for Database'[Your Database Name]&#8217;. This property may not exist for this<br />
    object, or may not be retrievable due to insufficient access rights. (Microsoft.SqlServer.Smo)</p></blockquote>
<p>What does this mean, was the server hacked and someone changed the owner? No, what this means is that the owner of the database was a windows account which no longer exists, the person probably left and the account was removed.</p>
<p>All you have to do is change the owner to a valid login</p>
<p>If you want it to be sa or a sql login, this example is for sa, change sa to something else if you want a different sql login</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">AUTHORIZATION</span> <span class="kw1">ON</span> <span class="kw1">DATABASE</span>::<span class="br0">&#91;</span>YourDatabase<span class="br0">&#93;</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>sa<span class="br0">&#93;</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER AUTHORIZATION ON DATABASE::[YourDatabase] TO [sa];</pre></div></div>

<p>If you want it to be a windows login, you can do the following</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">AUTHORIZATION</span> <span class="kw1">ON</span> <span class="kw1">DATABASE</span>::<span class="br0">&#91;</span>YourDatabase<span class="br0">&#93;</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>DomainLogin<span class="br0">&#93;</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER AUTHORIZATION ON DATABASE::[YourDatabase] TO [DomainLogin];</pre></div></div>

<p>If you run sp_helpdb now, you will see that the owner has been changed</p>
<p>If you are old school, you can also use sp_changedbowner to make the change</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">USE</span> YourDatabase
GO
&nbsp;
<span class="kw1">EXEC</span> <span class="kw3">sp_changedbowner</span> <span class="st0">'sa'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">USE YourDatabase
GO

EXEC sp_changedbowner 'sa'</pre></div></div>

]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbadmin/sql-server-database-owner-unknown/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Fixing a SQL Server could not spawn FRunCM thread error</title>
		<link>/index.php/datamgmt/dbadmin/mssqlserveradmin/fixing-a-sql-server-could/</link>
		<comments>/index.php/datamgmt/dbadmin/mssqlserveradmin/fixing-a-sql-server-could/#comments</comments>
		<pubDate>Tue, 30 Apr 2013 12:28:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[encryption]]></category>
		<category><![CDATA[error]]></category>
		<category><![CDATA[fix]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/04/fixing-a-sql-server-could/</guid>
		<description><![CDATA[I had to change the account that some SQL Server boxes were using to run the SQL Server services. After I changed the account on one machine from DomainNameUser to DomainNameNewUser SQL Server wouldn't start up

In the error log I saw the following&#8230;]]></description>
				<content:encoded><![CDATA[<p>I had to change the domain account on some SQL Server boxes that we have. After I changed the account on one machine from DomainNameUser to DomainNameNewUser SQL Server wouldn&#8217;t start up</p>
<p>In the error log I saw the following messages</p>
<blockquote><p>Server      Error: 17190, Severity: 16, State: 1.<br />
2013-04-30 12:42:06.11 Server      Initializing the FallBack certificate failed with error code: 1, state: 1, error number: -2146893802.<br />
2013-04-30 12:42:06.11 Server      Unable to initialize SSL encryption because a valid certificate could not be found, and it is not possible to create a self-signed certificate.<br />
2013-04-30 12:42:06.11 Server      Error: 17182, Severity: 16, State: 1.<br />
2013-04-30 12:42:06.11 Server      TDSSNIClient initialization failed with error 0x80092004, status code 0x80. Reason: Unable to initialize SSL support. Cannot find object or property.</p>
<p>2013-04-30 12:42:06.11 Server      Error: 17182, Severity: 16, State: 1.<br />
2013-04-30 12:42:06.11 Server      TDSSNIClient initialization failed with error 0x80092004, status code 0x1. Reason: Initialization failed with an infrastructure error. Check for previous errors. Cannot find object or property.</p>
<p>2013-04-30 12:42:06.11 Server      Error: 17826, Severity: 18, State: 3.<br />
2013-04-30 12:42:06.11 Server      Could not start the network library because of an internal error in the network library. To determine the cause, review the errors immediately preceding this one in the error log.<br />
2013-04-30 12:42:06.11 Server      Error: 17120, Severity: 16, State: 1.<br />
2013-04-30 12:42:06.11 Server      SQL Server could not spawn FRunCM thread. Check the SQL Server error log and the Windows event logs for information about possible related problems.</p></blockquote>
<p>We are not using encryption, VIA is disabled as well. After trying all kinds of different things I notice that when logging on with this profile on the box there was an error. Something about that the profile couldn&#8217;t be created and a temporary profile would be used instead</p>
<p>In the end I had to wipe out the user profile from the box</p>
<p>You do that by following these steps</p>
<p>Right click on computer, select Properties<br />
Click on Advanced System Settings<br />
Select the  Advanced Tab<br />
On the user profiles section click on Settings</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/UserProfile.PNG?mtime=1367323923"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/UserProfile.PNG?mtime=1367323923" width="399" height="451" /></a></div>
<p>Select the profile and hit Delete</p>
<p>If you try to log in as that user, the profile will be recreated.</p>
<p>Now when I tried to start SQL Server again, the errors were not there and SQL Server started up without a problem</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbadmin/mssqlserveradmin/fixing-a-sql-server-could/feed/</wfw:commentRss>
		<slash:comments>6</slash:comments>
		</item>
		<item>
		<title>Where to find the xtype info for SQL Server in a table</title>
		<link>/index.php/datamgmt/dbprogramming/where-to-find-the-xtype/</link>
		<comments>/index.php/datamgmt/dbprogramming/where-to-find-the-xtype/#comments</comments>
		<pubDate>Fri, 26 Apr 2013 14:48:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[howto]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[table]]></category>
		<category><![CDATA[tip]]></category>

		<guid isPermaLink="false">/index.php/2013/04/where-to-find-the-xtype/</guid>
		<description><![CDATA[If you look at the sys.sysobjects view, you will see an xtype column listed

Object type. Can be one of the following object types:
AF = Aggregate function (CLR)
C = CHECK constraint
D = Default or DEFAULT constraint
F = FOREIGN KEY constraint
L&#8230;]]></description>
				<content:encoded><![CDATA[<p>If you look at the sys.sysobjects view, you will see a xtype column listed</p>
<p>Object type. Can be one of the following object types:<br />
AF = Aggregate function (CLR)<br />
C = CHECK constraint<br />
D = Default or DEFAULT constraint<br />
F = FOREIGN KEY constraint<br />
L = Log<br />
FN = Scalar function<br />
FS = Assembly (CLR) scalar-function<br />
FT = Assembly (CLR) table-valued function<br />
IF = In-lined table-function<br />
IT = Internal table<br />
P = Stored procedure<br />
PC = Assembly (CLR) stored-procedure<br />
PK = PRIMARY KEY constraint (type is K)<br />
RF = Replication filter stored procedure<br />
S = System table<br />
SN = Synonym<br />
SQ = Service queue<br />
TA = Assembly (CLR) DML trigger<br />
TF = Table function<br />
TR = SQL DML Trigger<br />
TT = Table type<br />
U = User table<br />
UQ = UNIQUE constraint (type is K)<br />
V = View<br />
X = Extended stored procedure</p>
<p>However there is no table in SQL Server that holds this info&#8230;.or is there?</p>
<p>I answered <a href="http://stackoverflow.com/questions/16243857/is-there-a-table-that-holds-the-listing-of-xtype-descriptions">this question</a> today and decided to share here as well</p>
<p>Here is how you can find that info, you can use my favorite table spt_values</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> name
<span class="kw1">FROM</span> master..<span class="me1">spt_values</span>
<span class="kw1">WHERE</span> type <span class="sy0">=</span> <span class="st0">'O9T'</span>
<span class="sy0">AND</span> number &nbsp;<span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">1</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT name
FROM master..spt_values
WHERE type = 'O9T'
AND number  = -1</pre></div></div>

<p>This is the output</p>
<p>AF: aggregate function<br />
AP: application<br />
C : check cns<br />
D : default (maybe cns)<br />
EN: event notification<br />
F : foreign key cns<br />
FN: scalar function<br />
FS: assembly scalar function<br />
FT: assembly table function<br />
IF: inline function<br />
IS: inline scalar function<br />
IT: internal table<br />
L : log<br />
P : stored procedure<br />
PC : assembly stored procedure<br />
PK: primary key cns<br />
R : rule<br />
RF: replication filter proc<br />
S : system table<br />
SN: synonym<br />
SQ: queue<br />
TA: assembly trigger<br />
TF: table function<br />
TR: trigger<br />
U : user table<br />
UQ: unique key cns<br />
V : view<br />
X : extended stored proc</p>
<p>Now if you want to split it into two columns, you can use the LEFT and RIGHT functions together with the PATINDEX function</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">LEFT</span><span class="br0">&#40;</span>name,<span class="kw2">PATINDEX</span><span class="br0">&#40;</span><span class="st0">'%:%'</span>,name<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">AS</span> xtype,
<span class="kw1">RIGHT</span><span class="br0">&#40;</span>name, <span class="br0">&#40;</span><span class="kw2">LEN</span><span class="br0">&#40;</span>name<span class="br0">&#41;</span> <span class="sy0">-</span> <span class="kw2">PATINDEX</span><span class="br0">&#40;</span><span class="st0">'%:%'</span>,name<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> Description
<span class="kw1">FROM</span> master..<span class="me1">spt_values</span>
<span class="kw1">WHERE</span> type <span class="sy0">=</span> <span class="st0">'O9T'</span>
<span class="sy0">AND</span> number &nbsp;<span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">1</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT LEFT(name,PATINDEX('%:%',name)-1) AS xtype,
RIGHT(name, (LEN(name) - PATINDEX('%:%',name))) AS Description
FROM master..spt_values
WHERE type = 'O9T'
AND number  = -1</pre></div></div>

<p>Here is the result</p>
<pre>xtype	Description
AF	 aggregate function
AP	 application
C 	 check cns
D 	 default (maybe cns)
EN	 event notification
F 	 foreign key cns
FN	 scalar function
FS	 assembly scalar function
FT	 assembly table function
IF	 inline function
IS	 inline scalar function
IT	 internal table
L 	 log
P 	 stored procedure
PC 	 assembly stored procedure
PK	 primary key cns
R 	 rule
RF	 replication filter proc
S 	 system table
SN	 synonym
SQ	 queue
TA	 assembly trigger
TF	 table function
TR	 trigger
U 	 user table
UQ	 unique key cns
V 	 view
X 	 extended stored proc</pre>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/where-to-find-the-xtype/feed/</wfw:commentRss>
		<slash:comments>3</slash:comments>
		</item>
		<item>
		<title>Using a Dedicated Administrator Connection via SSMS</title>
		<link>/index.php/datamgmt/dbprogramming/using-a-dedicated-administrator-connection/</link>
		<comments>/index.php/datamgmt/dbprogramming/using-a-dedicated-administrator-connection/#comments</comments>
		<pubDate>Sun, 07 Apr 2013 13:55:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[dac]]></category>
		<category><![CDATA[how to]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/04/using-a-dedicated-administrator-connection/</guid>
		<description><![CDATA[If you need to use a Dedicated Administrator Connection (DAC) via SSMS, you can't just use the Connect Object Explorer, if you try you will get the following error

Dedicated administrator connections are not supported via SSMS as it establishes multi&#8230;]]></description>
				<content:encoded><![CDATA[<p>If you need to use a Dedicated Administrator Connection (DAC) via SSMS, you can&#8217;t just use the Connect Object Explorer, if you try you will get the following error</p>
<p>Dedicated administrator connections are not supported via SSMS as it establishes multiple connections by design. (Microsoft.SqlServer.Management.SqlStudio.Explorer)</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/Dac.PNG?mtime=1365341742"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/Dac.PNG?mtime=1365341742" width="619" height="174" /></a></div>
<p>So what do you do? You can connect from within SSMS, you need to click on the  <code>Database Engine Query</code> icon</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/Dac2.PNG?mtime=1365342094"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/Dac2.PNG?mtime=1365342094" width="416" height="87" /></a></div>
<p>Prefix the servername with Admin: Instead of <strong>(local)</strong>, you would do <strong>Admin:(local)</strong></p>
<p>
Another way to connect is by using sqlcmd with the command-line option A<br />
Here is an example with a username and password</p>
<p>sqlcmd -S ServerName -U sa -P Password â€“A</p>
<p>You can also use a trusted connection</p>
<p>sqlcmd -S (local) -E -A</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/dac3.PNG?mtime=1365343123"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/dac3.PNG?mtime=1365343123" width="671" height="142" /></a></div>
<p>If you want to know more about DAC, check out <a href="http://msdn.microsoft.com/en-us/library/ms189595(v=sql.110).aspx">Using a Dedicated Administrator Connection</a></p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/using-a-dedicated-administrator-connection/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Messing with your friendly DBA on April Fools&#8217; Day</title>
		<link>/index.php/datamgmt/dbadmin/mssqlserveradmin/messing-with-your-friendly-dba/</link>
		<comments>/index.php/datamgmt/dbadmin/mssqlserveradmin/messing-with-your-friendly-dba/#comments</comments>
		<pubDate>Fri, 29 Mar 2013 10:27:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[prank]]></category>
		<category><![CDATA[sql server 2000]]></category>
		<category><![CDATA[sql server 2005]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>

		<guid isPermaLink="false">/index.php/2013/03/messing-with-your-friendly-dba/</guid>
		<description><![CDATA[April Fools' Day is a day when people play practical jokes and hoaxes on each other. Why not trying to play some practical jokes on your friendly DBA :-)

The first thing we are going to do is to spoof the host and program name. This is easy to do. Click on Connect, choose Database Engine, you will see the following box]]></description>
				<content:encoded><![CDATA[<p>April Fools&#8217; Day is a day when people play practical jokes and hoaxes on each other. Why not trying to play some practical jokes on your friendly DBA  <img src="https://s.w.org/images/core/emoji/2/72x72/1f642.png" alt="ðŸ™‚" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<p>The first thing we are going to do is to spoof the host and program name. This is easy to do. Click on Connect, choose Database Engine, you will see the following box</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/AprilFools1.PNG?mtime=1364551429"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/AprilFools1.PNG?mtime=1364551429" width="411" height="301" /></a></div>
<p>Click on options >></p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/AprilFools2.PNG?mtime=1364551448"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/AprilFools2.PNG?mtime=1364551448" width="420" height="485" /></a></div>
<p>Click on the Additional Connection Parameters tab and paste in the following</p>
<p>Application Name=TOAD;Workstation ID=LarryEllison-PC</p>
<p>Now you can verify that what you have entered is returned from SQL Server</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw2">host_name</span>,program_name 
<span class="kw1">FROM</span> &nbsp;sys.<span class="me1">dm_exec_sessions</span>
<span class="kw1">WHERE</span> session_id <span class="sy0">=</span> <span class="kw2">@@spid</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT host_name,program_name 
FROM  sys.dm_exec_sessions
WHERE session_id = @@spid</pre></div></div>

<p></p>
<pre>host_name	    program_name
LarryEllison-PC	    TOAD</pre>
<p>If the DBA monitors the connection he might notice&#8230;..if not, time for plan B</p>
<h2>Kick it up a notch&#8230;.or two</h2>
<p>Time to become real evil  <img src="https://s.w.org/images/core/emoji/2/72x72/1f642.png" alt="ðŸ™‚" class="wp-smiley" style="height: 1em; max-height: 1em;" /><br />
Find out what the biggest table is in your company. Create a database with the same name on your local instance and also create the same table. Now it is time to create a panic.<br />
Open another connect dialog box, add the real server in the Server Name box, for example I entered PDWSQLServer2015</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/AprilFools3.PNG?mtime=1364551852"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/AprilFools3.PNG?mtime=1364551852" width="413" height="306" /></a></div>
<p>Click on options >>, click on the Additional Connection Parameters tab and paste in the following <em><strong>Data Source=localhost</strong></em></p>
<p>Just to verify, run the following query</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw2">@@SERVERNAME</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT @@SERVERNAME</pre></div></div>

<p>That returns you the local servername. Look what you see everywhere else (highlighted in yellow)</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/AprilFools4.PNG?mtime=1364552737"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/SQL2013/AprilFools4.PNG?mtime=1364552737" width="713" height="440" /></a></div>
<p>I see PDWSQLServer2015 everywhere else.<br />
Now run your query which returns 0 rows</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> HugeTable</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM HugeTable</pre></div></div>

<p>Call your DBA to stop by and then ask him if he deleted all 3 billion rows from this table? Look at his face..let him run <code>sp_spaceused 'HugeTable'</code>. Once the panic sets in tell him he has be pranked&#8230;&#8230;.</p>
<p>Of course there is a chance that all your permissions will be taken away&#8230;..</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbadmin/mssqlserveradmin/messing-with-your-friendly-dba/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Wrap inserts in a transaction for faster performance</title>
		<link>/index.php/datamgmt/dbprogramming/wrap-inserts-in-a-transaction/</link>
		<comments>/index.php/datamgmt/dbprogramming/wrap-inserts-in-a-transaction/#comments</comments>
		<pubDate>Wed, 13 Mar 2013 13:54:00 +0000</pubDate>
		<dc:creator><![CDATA[SQLDenis]]></dc:creator>
				<category><![CDATA[Business Intelligence]]></category>
		<category><![CDATA[Database Programming]]></category>
		<category><![CDATA[Microsoft SQL Server]]></category>
		<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[performance]]></category>
		<category><![CDATA[sql server 2008]]></category>
		<category><![CDATA[sql server 2012]]></category>
		<category><![CDATA[testing]]></category>
		<category><![CDATA[transactions]]></category>

		<guid isPermaLink="false">/index.php/2013/03/wrap-inserts-in-a-transaction/</guid>
		<description><![CDATA[Sometimes you have to insert a bunch of data and you can't use BCP or another bulk load method. When you do single row inserts, SQL Server wraps these inserts inside an implicit transaction. Did you know that if you use an explicit transaction that the&#8230;]]></description>
				<content:encoded><![CDATA[<p>Sometimes you have to insert a bunch of data and you can&#8217;t use BCP or another bulk load method. When you do single row inserts, SQL Server wraps these inserts inside an implicit transaction. Did you know that if you use an explicit transaction that the inserts will be much faster? I touched upon this earlier in this post <a href="/index.php/DataMgmt/DBProgramming/mongodb-vs-sql-server-insert-comparison">MongoDB vs. SQL Server &#8211; INSERT comparison part deux</a> but since someone asked about this today, I decided to take another look with different run sizes as well</p>
<p>Let&#8217;s take a look. first create the following table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Sometest<span class="br0">&#40;</span>id <span class="kw1">INT</span> <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span>, SomeCol <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span>, SomeDate <span class="kw1">DATETIME</span>,SomeCol2 <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span>, SomeDate2 <span class="kw1">DATETIME</span>,
SomeCol3 <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span>, SomeDate3 <span class="kw1">DATETIME</span>,SomeCol4 <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span>, SomeDate4 <span class="kw1">DATETIME</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE Sometest(id INT PRIMARY KEY, SomeCol VARCHAR(200), SomeDate DATETIME,SomeCol2 VARCHAR(200), SomeDate2 DATETIME,
SomeCol3 VARCHAR(200), SomeDate3 DATETIME,SomeCol4 VARCHAR(200), SomeDate4 DATETIME)
GO</pre></div></div>

<p>Now run the following code</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1"><span class="kw1">TRUNCATE</span> <span class="kw1">TABLE</span> Sometest
<span class="kw1">DECLARE</span> @<span class="kw1">start</span> <span class="kw1">DATETIME</span> <span class="sy0">=</span> <span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">ON</span>
<span class="co1">--BEGIN TRAN</span>
<span class="kw1">DECLARE</span> @id <span class="kw1">INT</span> <span class="sy0">=</span><span class="nu0">0</span>
<span class="kw1">WHILE</span> @id <span class="sy0">&lt;</span> <span class="nu0">50000</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> Sometest
&nbsp; &nbsp; <span class="kw1">SELECT</span> @id ,<span class="st0">'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla111111'</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="st0">'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla2222'</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="st0">'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla3333'</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="st0">'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla4444'</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="kw1">SET</span> @id<span class="sy0">+=</span><span class="nu0">1</span>
<span class="kw1">END</span>
<span class="co1">--COMMIT</span>
<span class="kw1">SELECT</span> <span class="kw2">DATEDIFF</span><span class="br0">&#40;</span>ms,@<span class="kw1">start</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">SELECT</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> Sometest</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">TRUNCATE TABLE Sometest
DECLARE @start DATETIME = GETDATE()
SET NOCOUNT ON
--BEGIN TRAN
DECLARE @id INT =0
WHILE @id &lt; 50000
BEGIN
	INSERT Sometest
	SELECT @id ,'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla111111',GETDATE(),
	'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla2222',GETDATE(),
	'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla3333',GETDATE(),
	'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla4444',GETDATE()
SET @id+=1
END
--COMMIT
SELECT DATEDIFF(ms,@start,GETDATE())
SELECT COUNT(*) FROM Sometest</pre></div></div>

<p>That takes 1153 milliseconds on my machine</p>
<p>Run the same code but now uncomment the transaction</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1"><span class="kw1">TRUNCATE</span> <span class="kw1">TABLE</span> Sometest
<span class="kw1">DECLARE</span> @<span class="kw1">start</span> <span class="kw1">DATETIME</span> <span class="sy0">=</span> <span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">ON</span>
<span class="kw1">BEGIN</span> <span class="kw1">TRAN</span>
<span class="kw1">DECLARE</span> @id <span class="kw1">INT</span> <span class="sy0">=</span><span class="nu0">0</span>
<span class="kw1">WHILE</span> @id <span class="sy0">&lt;</span> <span class="nu0">50000</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> Sometest
&nbsp; &nbsp; <span class="kw1">SELECT</span> @id ,<span class="st0">'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla111111'</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="st0">'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla2222'</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="st0">'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla3333'</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; <span class="st0">'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla4444'</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="kw1">SET</span> @id<span class="sy0">+=</span><span class="nu0">1</span>
<span class="kw1">END</span>
<span class="kw1">COMMIT</span>
<span class="kw1">SELECT</span> <span class="kw2">DATEDIFF</span><span class="br0">&#40;</span>ms,@<span class="kw1">start</span>,<span class="kw2">GETDATE</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">SELECT</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> Sometest</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">TRUNCATE TABLE Sometest
DECLARE @start DATETIME = GETDATE()
SET NOCOUNT ON
BEGIN TRAN
DECLARE @id INT =0
WHILE @id &lt; 50000
BEGIN
	INSERT Sometest
	SELECT @id ,'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla111111',GETDATE(),
	'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla2222',GETDATE(),
	'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla3333',GETDATE(),
	'BlaBlaBlaBlaBlaBlaBlaBlaBlaBla4444',GETDATE()
SET @id+=1
END
COMMIT
SELECT DATEDIFF(ms,@start,GETDATE())
SELECT COUNT(*) FROM Sometest</pre></div></div>

<p>That is almost twice as fast (or almost half as slow), it takes 673 milliseconds</p>
<p>Here is what the numbers look like on my machine for different insert sizes</p>
<pre>Inserts	no tran	explicit transaction
100000  18030   10800
50000	 9363	 5516
5000	 1130	  760
5000	 190	  103
1000	  40       23</pre>
<p>As you can see, when you have an explicit transaction it is much faster than when you don&#8217;t specify a transaction</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/wrap-inserts-in-a-transaction/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
	</channel>
</rss>
