<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -    Availability Groups Setup and Configuration from A to Z</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -    Availability Groups Setup and Configuration from A to Z" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Availability Groups were introduced in SQL Server 2012 and have quickly become the forefront of high availability for the SQL Server Database Engine Services.  In prior versions of SQL Server, true high availability was not a complete solution packaged with the native installation and feature set.  While mirroring was introduced in SQL Server 2005 and [&hellip;]" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Availability Groups Setup and Configuration from A to Z Comments Feed" href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Automated Deployment to Azure Hosted Services' href='/index.php/enterprisedev/cloud/azure/automated-deployment-to-azure-hosted-services/' />
<link rel='next' title='ITPROceed &#8211; Slide Deck and demo materials' href='/index.php/datamgmt/ssrs/itproceed-slide-deck-and-demo-materials/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/" />
<link rel='shortlink' href='/?p=2434' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Farchitect%2Favailability-groups-setup-and-configuration-from-a-to-z%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Farchitect%2Favailability-groups-setup-and-configuration-from-a-to-z%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/ssrs/itproceed-slide-deck-and-demo-materials/" rel="next">ITPROceed &#8211; Slide Deck and demo materials</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/enterprisedev/cloud/azure/automated-deployment-to-azure-hosted-services/" rel="prev">Automated Deployment to Azure Hosted Services</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/" class="post-title">Availability Groups Setup and Configuration from A to Z</a></h1>
					<div class="post-byline">by <a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)" rel="author">Ted Krueger (onpnt)</a> on June 3, 2014 in category <a href="/index.php/category/architect/" rel="category tag">Architecture, Design and Strategy</a> <a href="/index.php/category/datamgmt/dbadmin/" rel="category tag">Database Administration</a> <a href="/index.php/category/architect/enterprisearchitecture/" rel="category tag">Enterprise Architecture</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a> <a href="/index.php/category/datamgmt/dbadmin/mssqlserveradmin/" rel="category tag">Microsoft SQL Server Admin</a>. Article views: 18,983 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&text=RT @LessThanDot Blog - Availability Groups Setup and Configuration from A to Z by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&title=Availability Groups Setup and Configuration from A to Z&source=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&title=Availability Groups Setup and Configuration from A to Z" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&quote=Availability Groups Setup and Configuration from A to Z" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&title=Availability Groups Setup and Configuration from A to Z" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>Availability Groups were introduced in SQL Server 2012 and have quickly become the forefront of high availability for the SQL Server Database Engine Services.  In prior versions of SQL Server, true high availability was not a complete solution packaged with the native installation and feature set.  While mirroring was introduced in SQL Server 2005 and provided a much-needed advance towards achieving highly available data services, mirroring still required much customization to effectively provide a true high availability solution.</p>
<p>It’s important to define high availability as it pertains to database level services – database high availability requires the means of retaining data services to users, applications and services within a defined allowable interruption of data services.  This equates simply as, are data services available to <i>any</i> connection within a given tolerance.  The <i>nines </i>has always been the flavor of measuring availability in the way of uptime.  “<i>My database server achieved four nines availability last year!” </i> This achievement is essentially stating the database services were not available for an estimated .01% of the total operating hours in a year or, 52 minutes.  Remember, this achievement is based on service level agreements that can have vast variations.  While even Full Clustered Instances of SQL Server implement a level of high availability, there is still the single point of failure that is of highest importance to the data services – the database.  Points of failure and focusing on where they may occur, begins allowing a visual representation of how availability achievements can be achieved.</p>
<p>Points of Failure</p>
<ul>
<ul>
<li>Hardware</li>
<li>Operating System</li>
<li>Data Corruption</li>
<li>Data Loss</li>
<li>Network</li>
</ul>
</ul>
<p>These five possible points of failure are specific to almost all data services.  As discussed, Full Clustered Instances is a protection against hardware and operating system failures, mirroring is protection against data loss and corruption events, and geo-clustering can be utilized to prevent network failure events.  However, even combining all of these technologies or features, the concept of data connectivity is still of concern as customization is needed if a single point of connection is not available to an application or user.</p>
<p>As stated already, pre-SQL Server 2012, even a four nines achievement was difficult.  This was due to the customization that was needed to maintain a mirror failover event.  Given that SQL Server is mirroring from instance name to instance name, and there is no single entry point for applications, some manual or programmatic intervention would be needed to handle the fact that a data server name could change.  While connection strings built in certain frameworks could allow for a failover partner attribute, not all connectivity types and providers supported them.  This forced coding changes, monitoring needs and much effort to manage a complete, seamless failover of one designated primary database server.</p>
<p>Availability Groups in SQL Server 2012 combats these issues directly by joining clustering and mirroring technologies and associating them into a group that coexist and all rely on each other in order to maintain availability.  The concept of applying a cluster design and including single instances acting on their own, begins to remove failure points in all areas of availability.</p>
<p>With Availability Groups and Windows Server Failover Clustering, we can look at the same failure points differently, asking how they allow for availability to be retained at any point of failure.</p>
<ul>
<ul>
<li>Hardware
<ul>
<li>Prevention be implementing the same level of protection in FCI but with WSFC</li>
</ul>
</li>
<li>Operating System
<ul>
<li>Prevention be implementing the same level of protection in FCI but with WSFC</li>
</ul>
</li>
<li>Data Corruption
<ul>
<li>Prevention with mirrored databases between each instance in the group</li>
</ul>
</li>
<li>Data Loss
<ul>
<li>Prevention with mirrored databases standing on unique disk subsystems</li>
</ul>
</li>
<li>Network
<ul>
<li>Allowance of multi-subnet clustering for added protection of network loss</li>
</ul>
</li>
</ul>
</ul>
<p>The following step-by-step illustration has been composed for a general setup and configuration need of Availability Groups in SQL Server 2012.  This is essential to becoming familiar with Availability Groups and determining how they fit into specific high availability needs and how data services are being used.  The specific setup and configuration for the Availability Group, SQLAG located on the network, has been utilized to document the needed setup and configurations.  Use this document for setup and configuration of new Availability Groups or the model in place on the network for the Availability Group SQLAG.</p>
<p>Availability Groups are being utilized for three primary objectives:</p>
<ol>
<ol>
<li>Achieve High Availability</li>
<li>Offload read-only queries (or requests)</li>
<li>Achieve a Disaster and Recovery solution</li>
</ol>
</ol>
<p>In order to meet all three objectives, a 4-Node Availability Group has been designed, based on a node and share majority solution.</p>
<p><a href="/wp-content/uploads/2014/06/ag1.png"><img class="aligncenter wp-image-2688 size-full" src="/wp-content/uploads/2014/06/ag1.png" alt="ag1" width="624" height="267" srcset="/wp-content/uploads/2014/06/ag1.png 624w, /wp-content/uploads/2014/06/ag1-300x128.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>In the Availability Group solution pictured above, the following scenarios Availability Group can be achieved:</p>
<ol>
<ol>
<ol>
<li>Loss of primary database or physical hardware
<ul>
<li>Automatic failover to synchronous node 2</li>
</ul>
</li>
<li>Loss of primary database or physical hardware and loss of secondary automatic synchronous node 2
<ul>
<li>Manual failover to node 3 secondary or node 4 secondary</li>
</ul>
</li>
<li>Loss of primary database or physical hardware
<ul>
<li>Manual failover to node 3 secondary or node 4 secondary</li>
</ul>
</li>
<li>Loss of primary database or physical hardware and loss of file share
<ul>
<li>Automatic failover to synchronous node 2</li>
<li>Manual failover to any other node provided 3 nodes maintain connectivity</li>
</ul>
</li>
</ol>
</ol>
</ol>
<p>Note: Failover scenarios are extended to any node and cluster services maintained provided file share resources are online.  This failure scenario will maintain the cluster and listener resources of up to 2 nodes.  File share loss lowers a maximum node failure loss of one node.  If file share loss occurs and 2 nodes are lost, the cluster cannot be maintained.</p>
<p>&nbsp;</p>
<h1>Windows Server Failover Clustering and Availability Group Information</h1>
<p>Setup of the Availability Groups in the structure covers one or more databases.  The naming conventions utilized are listed below along with each setting that has been configured in this setup per node.</p>
<h2>Windows Server Failover Cluster (WSFC)</h2>
<h3 style="padding-left: 30px">Lab Server Build &#8211; Ensure to search for new hotfixes</h3>
<ul>
<ul>
<li>Windows Server 2008 R2 Enterprise Service Pack 1
<ul>
<li>Physical Memory – 4.00 GB</li>
<li>64-bit Operating System</li>
<li>Processor – Intel Xeon X5660 @ 2.80Ghx
<ul>
<li>1 CPU allocation (Logical count = 1)</li>
</ul>
</li>
</ul>
</li>
<li>Hotfix patches applied
<ul>
<li>KB2494036
<ul>
<li>A hotfix is available to let you configure a cluster node that does not have quorum votes in Windows Server 2008 and in Windows Server 2008 R2</li>
</ul>
</li>
<li>KB2687741
<ul>
<li>A hotfix that improves the performance of the &#8220;AlwaysOn Availability Group&#8221; feature in SQL Server 2012 is available for Windows Server 2008 R2</li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
<h3 style="padding-left: 30px">Server names</h3>
<ul style="padding-left: 30px">
<ul>
<li>NODE1</li>
<li>NODE2</li>
<li>NODE3</li>
<li>NODE4</li>
</ul>
</ul>
<h3 style="padding-left: 30px">Cluster Name</h3>
<ul>
<ul>
<li>SQLCLSTR</li>
</ul>
</ul>
<h3 style="padding-left: 30px">Quorum configuration for WSFC</h3>
<ul>
<ul>
<li>Node Majority File Share</li>
</ul>
</ul>
<h3 style="padding-left: 30px">Network Configuration</h3>
<ul>
<ul>
<li>Cluster Network 1<b></b></li>
<li>Cluster Access IP – 10.2.4.71
<ul>
<li>Subnet 10.2.4.0/24
<ul>
<li>NODE1
<ul>
<li>10.2.4.31</li>
</ul>
</li>
<li>NODE2
<ul>
<li>10.2.4.34</li>
</ul>
</li>
<li>NODE3
<ul>
<li>10.2.4.50</li>
</ul>
</li>
<li>NODE4
<ul>
<li>10.2.4.55</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
<h2>SQL Server Availability Groups</h2>
<h3 style="padding-left: 30px">SQL Server Instances</h3>
<ul>
<ul>
<li>Microsoft SQL Server Enterprise (64-bit)</li>
<li>Build 11.0.2100.0</li>
<li>Named Instances</li>
</ul>
</ul>
<ul>
<ul>
<ul>
<li>NODE1\SHAREPOINT2013</li>
<li>NODE2\SHAREPOINT2013</li>
<li>NODE3\SHAREPOINT2013</li>
<li>NODE4\SHAREPOINT2013</li>
</ul>
</ul>
</ul>
<p>&nbsp;</p>
<h2>Availability Group (AG)</h2>
<ul>
<ul>
<li>AG Name
<ul style="padding-left: 60px">
<li>SQLAG</li>
<li>Timeout configuration for all replicas – 10 seconds</li>
<li>Endpoint port utilized – 5022</li>
</ul>
</li>
<li>AG Listener Name
<ul style="padding-left: 60px">
<li>SQLAGLISTENER</li>
<li>10.2.4.72</li>
</ul>
</li>
<li>AG Replicas
<ul>
<li>NODE1
<ul style="padding-left: 60px">
<li>Primary</li>
<li>Synchronous Role</li>
<li>Automatic Failover</li>
</ul>
</li>
<li>NODE2
<ul style="padding-left: 60px">
<li>Secondary</li>
<li>Synchronous Role</li>
<li>Automatic Failover</li>
</ul>
</li>
<li>NODE3
<ul style="padding-left: 60px">
<li>Secondary</li>
<li>Synchronous Role</li>
<li>Read Only</li>
<li>Read-intent only</li>
<li>Manual Failover</li>
</ul>
</li>
<li>NODE4
<ul style="padding-left: 60px">
<li>Secondary</li>
<li>Asynchronous Role</li>
<li>Manual Failover</li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
<h1>WSFC Setup and Configuration</h1>
<h2>Cluster Setup</h2>
<p>Four servers are acting as nodes in the Windows Server Failover Cluster (WSFC).  The servers are all located on the subnet 10.2.4.x.  Each server has the failover clustering full feature installation.</p>
<p>Configuring the WSFC cluster first requires each server to have the Failover Clustering feature installed.  To perform this installation, follow these steps.</p>
<p>Connect to each server or open Server Manager for remote access to each server. In Server Manager, go to the Features node and click the Add Features link.</p>
<p><a href="/wp-content/uploads/2014/06/ag2.png"><img class="size-full wp-image-2689 aligncenter" src="/wp-content/uploads/2014/06/ag2.png" alt="ag2" width="624" height="156" srcset="/wp-content/uploads/2014/06/ag2.png 624w, /wp-content/uploads/2014/06/ag2-300x75.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p style="text-align: center">In the Select Features wizard, check “Failover Clustering” and click Install.</p>
<p><a href="/wp-content/uploads/2014/06/ag3.png"><img class="size-full wp-image-2690 aligncenter" src="/wp-content/uploads/2014/06/ag3.png" alt="ag3" width="519" height="377" srcset="/wp-content/uploads/2014/06/ag3.png 519w, /wp-content/uploads/2014/06/ag3-300x217.png 300w" sizes="(max-width: 519px) 100vw, 519px" /></a></p>
<p style="text-align: center">Once the installation is completed, a restart of the server is not required but highly recommended.</p>
<p style="text-align: center">Perform these steps for every server that will be enlisted in the WSFC.</p>
<h2>Configure the Cluster</h2>
<p>The following steps are used to configure the cluster containing the four logical servers that have the failover clustering features installed.</p>
<p>On a local computer with Failover Manager installed, or one of the servers that will be in the cluster, click Start&#8211;&gt;Administrative Tools&#8211;&gt;Failover Cluster Manager.</p>
<p>(The Failover Cluster Manager can also be opened by using the MMC snap-in.)</p>
<p><a href="/wp-content/uploads/2014/06/ag4.png"><img class="alignnone size-full wp-image-2691" src="/wp-content/uploads/2014/06/ag4.png" alt="ag4" width="402" height="459" srcset="/wp-content/uploads/2014/06/ag4.png 402w, /wp-content/uploads/2014/06/ag4-262x300.png 262w" sizes="(max-width: 402px) 100vw, 402px" /></a></p>
<p><a href="/wp-content/uploads/2014/06/ag5.png"><img class="alignnone size-full wp-image-2692" src="/wp-content/uploads/2014/06/ag5.png" alt="ag5" width="326" height="263" srcset="/wp-content/uploads/2014/06/ag5.png 326w, /wp-content/uploads/2014/06/ag5-300x242.png 300w" sizes="(max-width: 326px) 100vw, 326px" /></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>(If the welcome screen is shown, click Next.)</p>
<p>Enter in each server’s name that will be part of the cluster.  Click Add after typing in the server name or utilize the Browse button to search the domain for registered server names.</p>
<p><a href="/wp-content/uploads/2014/06/ag6.png"><img class="size-full wp-image-2693 aligncenter" src="/wp-content/uploads/2014/06/ag6.png" alt="ag6" width="624" height="374" srcset="/wp-content/uploads/2014/06/ag6.png 624w, /wp-content/uploads/2014/06/ag6-300x179.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Click Next to review the Validation Warning options.</p>
<p>In the Validation Warning screen, if validation tests have not been executed yut, select Yes and click Next to run the validation tests.  This will review the servers for all configurations and options, as they pertain to the server being set up correctly for participation in a cluster.</p>
<p><a href="/wp-content/uploads/2014/06/ag7.png"><img class="size-full wp-image-2694 aligncenter" src="/wp-content/uploads/2014/06/ag7.png" alt="ag7" width="624" height="360" srcset="/wp-content/uploads/2014/06/ag7.png 624w, /wp-content/uploads/2014/06/ag7-300x173.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Select No to bypass the validation warning review</p>
<p>In the Access Point for Administering the Cluster, enter the name of the cluster and the network information needed.  If multiple subnets will be utilized, add both in this screen.</p>
<p><a href="/wp-content/uploads/2014/06/ag8.png"><img class="size-full wp-image-2695 aligncenter" src="/wp-content/uploads/2014/06/ag8.png" alt="ag8" width="581" height="331" srcset="/wp-content/uploads/2014/06/ag8.png 581w, /wp-content/uploads/2014/06/ag8-300x170.png 300w" sizes="(max-width: 581px) 100vw, 581px" /></a></p>
<p>Click Next and confirm the settings are accurate. If any changes are required, click Back to make adjustments.</p>
<p>Click Next to create the cluster.</p>
<p><a href="/wp-content/uploads/2014/06/ag9.png"><img class="size-full wp-image-2696 aligncenter" src="/wp-content/uploads/2014/06/ag9.png" alt="ag9" width="582" height="315" srcset="/wp-content/uploads/2014/06/ag9.png 582w, /wp-content/uploads/2014/06/ag9-300x162.png 300w" sizes="(max-width: 582px) 100vw, 582px" /></a></p>
<p>Once completed, click Finish.</p>
<h2>Configuring the Quorum</h2>
<p>&nbsp;</p>
<p>To configure the quorum settings for the new cluster, right click the cluster name in Cluster Manager. Scroll to More Actions and select Configure Cluster Quorum Settings.  Click Next to the Before You Begin screen if it is shown.</p>
<p><a href="/wp-content/uploads/2014/06/ag10.png"><img class="alignnone size-full wp-image-2697" src="/wp-content/uploads/2014/06/ag10.png" alt="ag10" width="624" height="332" srcset="/wp-content/uploads/2014/06/ag10.png 624w, /wp-content/uploads/2014/06/ag10-300x159.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>In the Select Quorum Configuration screen, chose which type of quorum should be utilized.  If a disk or file share resource has not been added, the only selection available will be Node Majority.  Note: to create a share resource, the share must be located outside of the servers in the cluster.  For this configuration, we want a file share as a fifth node to retain a healthy quorum in the event of node losses.</p>
<p><a href="/wp-content/uploads/2014/06/ag11.png"><img class="alignnone size-full wp-image-2698" src="/wp-content/uploads/2014/06/ag11.png" alt="ag11" width="491" height="337" srcset="/wp-content/uploads/2014/06/ag11.png 491w, /wp-content/uploads/2014/06/ag11-300x205.png 300w" sizes="(max-width: 491px) 100vw, 491px" /></a></p>
<p>Select Node and File Share Majority (for clusters with special configurations)</p>
<p><a href="/wp-content/uploads/2014/06/ag12.png"><img class="alignnone size-full wp-image-2699" src="/wp-content/uploads/2014/06/ag12.png" alt="ag12" width="493" height="341" srcset="/wp-content/uploads/2014/06/ag12.png 493w, /wp-content/uploads/2014/06/ag12-300x207.png 300w" sizes="(max-width: 493px) 100vw, 493px" /></a></p>
<p>Click Next to confirm settings and click Next again to configure the settings.</p>
<p><a href="/wp-content/uploads/2014/06/ag13.png"><img class="alignnone size-full wp-image-2700" src="/wp-content/uploads/2014/06/ag13.png" alt="ag13" width="289" height="200" /></a>      <a href="/wp-content/uploads/2014/06/ag14.png"><img class="alignnone size-full wp-image-2701" src="/wp-content/uploads/2014/06/ag14.png" alt="ag14" width="287" height="200" /></a></p>
<h1>SQL Server 2012 Availability Group Setup and Configuration</h1>
<h2>Configure the SQL Server Availability Group</h2>
<p>In order to configure an Availability Group, the following steps are required in this sequence.</p>
<p>Each server that will take part as a replica must be in a WSFC.</p>
<ol>
<ol>
<li>A network name should be created to act as the listener (the name by which applications and users will connect to SQL Server and the databases in the Availability Group).  A listener can be created from the wizard if the listener is not created beforehand.</li>
<li>Security should be set up for the administrator that will be executing the AG setup.  This account must be in the sysadmin server role on all SQL Server instances that are acting as replicas and have access to read the domain Active Directory services.  If a listener is not prepared before creating the AG, the account is required to be a domain admin.</li>
<li>Each server that will act as a replica must have AlwaysOn features enabled in SQL Server.</li>
<li> The database(s) that will be in the Availability Group should be restored or created on the replica that will act as the primary.  These database(s) should be in RECOVERY mode and set to a recovery model of Full.</li>
<li>Each database on the primary requires a full backup to be executed.</li>
<li>A share should be created to retain the full backup of the primary replica’s database(s).  This share can be located on any of the replica servers or an external share resource.</li>
</ol>
</ol>
<p>Once the above security and required resources are available, continue with the steps below to create the AG.</p>
<p>Remote into each server that will act as a replica in the Availability Group and configure SQL Server for AlwaysOn features to be enabled. (Warning: This setting requires SQL Server to be restarted.)</p>
<p>Open SQL Server Configuration Manager.</p>
<p>Select SQL Server Services in the tree view.  Right click the SQL Server instance to be configured and select Properties.</p>
<p><a href="/wp-content/uploads/2014/06/ag15.png"><img class="alignnone size-full wp-image-2702" src="/wp-content/uploads/2014/06/ag15.png" alt="ag15" width="527" height="272" srcset="/wp-content/uploads/2014/06/ag15.png 527w, /wp-content/uploads/2014/06/ag15-300x154.png 300w" sizes="(max-width: 527px) 100vw, 527px" /></a></p>
<p>In the SQL Server Properties window, select the AlwaysOn High Availability tab. Check Enable AlwaysOn Availability Groups.  The Windows failover cluster name should default to the cluster that the server is part of.  If this does not auto-populate, the server is not in a WSFC and is required to be added before this step is performed.</p>
<p><a href="/wp-content/uploads/2014/06/ag16.png"><img class="alignnone size-full wp-image-2703" src="/wp-content/uploads/2014/06/ag16.png" alt="ag16" width="413" height="483" srcset="/wp-content/uploads/2014/06/ag16.png 413w, /wp-content/uploads/2014/06/ag16-256x300.png 256w" sizes="(max-width: 413px) 100vw, 413px" /></a></p>
<p>Click OK and restart the SQL Server services.</p>
<p>(Perform the above steps for each SQL Server that will be in the Availability Group.)</p>
<p>Connect to SQL Server via SQL Server Management Studio (SSMS) on the server that will act as the primary replica in the Availability Group.  Restore or create the database(s) that are required to be in the Availability Group.  Perform a full back up on each database.  (Note: ensure each database is in Full Recovery Model)</p>
<p>Expand the AlwaysOn High Availability node.  Right click the Availability Groups node and select New Availability Group Wizard</p>
<p><a href="/wp-content/uploads/2014/06/ag17.png"><img class="alignnone size-full wp-image-2704" src="/wp-content/uploads/2014/06/ag17.png" alt="ag17" width="378" height="296" srcset="/wp-content/uploads/2014/06/ag17.png 378w, /wp-content/uploads/2014/06/ag17-300x234.png 300w" sizes="(max-width: 378px) 100vw, 378px" /></a></p>
<p>Click Next if shown the Introduction window.</p>
<p><a href="/wp-content/uploads/2014/06/ag18.png"><img class="alignnone size-full wp-image-2705" src="/wp-content/uploads/2014/06/ag18.png" alt="ag18" width="346" height="321" srcset="/wp-content/uploads/2014/06/ag18.png 346w, /wp-content/uploads/2014/06/ag18-300x278.png 300w" sizes="(max-width: 346px) 100vw, 346px" /></a></p>
<p>Enter the name chosen for the Availability Groups and click Next.</p>
<p><a href="/wp-content/uploads/2014/06/ag19.png"><img class="alignnone size-full wp-image-2706" src="/wp-content/uploads/2014/06/ag19.png" alt="ag19" width="624" height="287" srcset="/wp-content/uploads/2014/06/ag19.png 624w, /wp-content/uploads/2014/06/ag19-300x137.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Ensure each database that will take part in the Availability Group passes validations.  If a database does not pass the validation process that is required to be added to an Availability Group, the list to the right of each database will show what is required.  For example: if a full backup was not performed, the link will read, “Full backup is required”.</p>
<p><a href="/wp-content/uploads/2014/06/ag20.png"><img class="alignnone size-full wp-image-2707" src="/wp-content/uploads/2014/06/ag20.png" alt="ag20" width="624" height="92" srcset="/wp-content/uploads/2014/06/ag20.png 624w, /wp-content/uploads/2014/06/ag20-300x44.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>After performing the required prerequisites, click Refresh to re-validate the databases.  Once the validation process states, “Meets prerequisites”, check each database that is required and click Next.</p>
<p><a href="/wp-content/uploads/2014/06/ag21.png"><img class="alignnone size-full wp-image-2708" src="/wp-content/uploads/2014/06/ag21.png" alt="ag21" width="567" height="361" srcset="/wp-content/uploads/2014/06/ag21.png 567w, /wp-content/uploads/2014/06/ag21-300x191.png 300w" sizes="(max-width: 567px) 100vw, 567px" /></a></p>
<p>In the Specify Replicas screen, click the Add Replica…button to add the replicas that will be part of the Availability Group.</p>
<p>Make the configuration changes as shown below</p>
<ol>
<ol>
<li>Primary 01 – check Automatic failover, Synchronous Commit</li>
<li>Secondary 02 – check Automatic failover, Synchronous Commit</li>
<li>Secondary 03 – check synchronous Commit and select Readable Secondary option “Read-intent only”</li>
<li>Secondary 04 – Leave all options as default</li>
</ol>
</ol>
<p><a href="/wp-content/uploads/2014/06/ag22.png"><img class="alignnone size-full wp-image-2709" src="/wp-content/uploads/2014/06/ag22.png" alt="ag22" width="624" height="179" srcset="/wp-content/uploads/2014/06/ag22.png 624w, /wp-content/uploads/2014/06/ag22-300x86.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Click the Endpoints tab to ensure all settings are populated</p>
<p><a href="/wp-content/uploads/2014/06/ag23.png"><img class="alignnone size-full wp-image-2710" src="/wp-content/uploads/2014/06/ag23.png" alt="ag23" width="624" height="155" srcset="/wp-content/uploads/2014/06/ag23.png 624w, /wp-content/uploads/2014/06/ag23-300x74.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>If changes are required due to network needs or port configurations, make them in this window.  For example: if port 5022 is used for other communications, adjust to port 5023 or another free port.</p>
<p>Click the Backup preferences tab.</p>
<p>Check Secondary only option for backup preferences and check the checkbox for Replica NODE3.</p>
<p><a href="/wp-content/uploads/2014/06/ag24.png"><img class="alignnone size-full wp-image-2711" src="/wp-content/uploads/2014/06/ag24.png" alt="ag24" width="624" height="361" srcset="/wp-content/uploads/2014/06/ag24.png 624w, /wp-content/uploads/2014/06/ag24-300x173.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Click the Listener tab.  If the listener was created prior to configuring the Availability Group, leave “Do not create an Availability Group listener now”.  If a listen should be created, check the “Create an Availability Group listener” and enter the required information.  Note: domain admin privileges are required to create the domain name if choosing to create the listener at this time.</p>
<p><a href="/wp-content/uploads/2014/06/ag25.png"><img class="alignnone size-full wp-image-2712" src="/wp-content/uploads/2014/06/ag25.png" alt="ag25" width="624" height="283" srcset="/wp-content/uploads/2014/06/ag25.png 624w, /wp-content/uploads/2014/06/ag25-300x136.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Click Next to save the replica settings.</p>
<p>In the Select Initial Data Synchronization window, enter a location for the full backup and log backup to be stored to initialize the other replicas in the Availability Group.  This location can be a drive or share on any of the replicas or an external share.  In the example below, replica 04 is used with the admin share to the T Drive.</p>
<p><a href="/wp-content/uploads/2014/06/ag26.png"><img class="alignnone size-full wp-image-2713" src="/wp-content/uploads/2014/06/ag26.png" alt="ag26" width="624" height="203" srcset="/wp-content/uploads/2014/06/ag26.png 624w, /wp-content/uploads/2014/06/ag26-300x97.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Click Next to run the validation process from the settings saved so far.  The only warning should be if the listener was chosen not to be created at the time of the setup.</p>
<p><a href="/wp-content/uploads/2014/06/ag27.png"><img class="alignnone size-full wp-image-2714" src="/wp-content/uploads/2014/06/ag27.png" alt="ag27" width="624" height="404" srcset="/wp-content/uploads/2014/06/ag27.png 624w, /wp-content/uploads/2014/06/ag27-300x194.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>If a warning or error has been found, click the link to review the message and act accordingly.</p>
<p>Click Next to review the choices that will be executed upon clicking Finish to create the Availability Group and initialize the replicas.</p>
<p><a href="/wp-content/uploads/2014/06/ag28.png"><img class="alignnone size-full wp-image-2715" src="/wp-content/uploads/2014/06/ag28.png" alt="ag28" width="624" height="405" srcset="/wp-content/uploads/2014/06/ag28.png 624w, /wp-content/uploads/2014/06/ag28-300x194.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Note: it is recommended to click the Script button at this time and save the script generated by the wizard to a secure location for future recovery.</p>
<p><a href="/wp-content/uploads/2014/06/ag29.png"><img class="alignnone size-full wp-image-2716" src="/wp-content/uploads/2014/06/ag29.png" alt="ag29" width="392" height="103" srcset="/wp-content/uploads/2014/06/ag29.png 392w, /wp-content/uploads/2014/06/ag29-300x78.png 300w" sizes="(max-width: 392px) 100vw, 392px" /></a></p>
<p>Once Finish is clicked, the Availability Group and all replicas will be initialized and created.  This process can take some time depending on the size of each database in the Availability Group.</p>
<p>The process will execute in this order</p>
<ol>
<ol>
<li>Endpoints will be configured/created</li>
<li>Extended Events for monitoring an AG will be created</li>
<li>The Availability Group will be created</li>
<li>The Availability Group will be brought online</li>
<li>Secondary replicas will be added to the Availability Group</li>
<li>The WSFC quorum will be validated for votes of each replica server</li>
<li>A full backup of the database in the Availability Group will be taken</li>
<li>Steps repeated in this order for each replica</li>
</ol>
</ol>
<ul>
<ul>
<ul>
<li>A backup will be restored to the secondary replica</li>
<li>The tail-end log backup will be taken from the primary</li>
<li>The tail-end log backup will be restored to the secondary replica</li>
<li>Database will be joined to the Availability Group</li>
</ul>
</ul>
</ul>
<p><a href="/wp-content/uploads/2014/06/ag30.png"><img class="alignnone size-full wp-image-2717" src="/wp-content/uploads/2014/06/ag30.png" alt="ag30" width="624" height="269" srcset="/wp-content/uploads/2014/06/ag30.png 624w, /wp-content/uploads/2014/06/ag30-300x129.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Given the even number of node votes in this wizard driven setup, we will need to configure the voting weight of the nodes at a later point.  With the even number the warning is shown as “Validating WSFC quorum vote configuration”.</p>
<h2>Configure the Listener</h2>
<p>If the listener was not created in the initial wizard setup, perform these steps to assign the listener to the Availability Group.</p>
<ol>
<ol>
<ol>
<li>Open SSMS 2012</li>
<li>Execute the statement below to assign the listener name and IP to the Availability Group</li>
</ol>
</ol>
</ol>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1"><span class="kw1">USE</span> <span class="br0">&#91;</span>master<span class="br0">&#93;</span>
GO
<span class="kw1">ALTER</span> AVAILABILITY <span class="kw1">GROUP</span> <span class="br0">&#91;</span>SQLAG<span class="br0">&#93;</span>
<span class="kw1">ADD</span> LISTENER N<span class="st0">'SQLAGLISTENER'</span> <span class="br0">&#40;</span>
<span class="kw1">WITH</span> IP
<span class="br0">&#40;</span><span class="br0">&#40;</span>N<span class="st0">'10.2.4.72'</span>, N<span class="st0">'255.255.255.0'</span><span class="br0">&#41;</span>
<span class="br0">&#41;</span>
, P<span class="sy0">OR</span>T<span class="sy0">=</span><span class="nu0">1433</span><span class="br0">&#41;</span>;
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">USE [master]
GO
ALTER AVAILABILITY GROUP [SQLAG]
ADD LISTENER N'SQLAGLISTENER' (
WITH IP
((N'10.2.4.72', N'255.255.255.0')
)
, PORT=1433);
GO</pre></div></div>

<p>Note: Assign the IP as needed in this step.  This is the IP that will translate for any connection being made to the Availability Group containing all databases.</p>
<h2>Configure Read Routing for Read-Intent Connections</h2>
<p>Multiple replicas can be configured for read-intent only connections.  This configuration is used to route connections that specify in the connection string the “read-intent” setting.  For example: the following connection string is set for read-intent and will be routed to a read-only secondary replica.</p>
<div>
<p>Server=SQLAGLISTENER;Database=_Cache;IntegratedSecurity=SSPI;<b>ApplicationIntent=ReadOnly</b></p>
</div>
<p>&nbsp;</p>
<p>To configure a replica for read-intent only connections, a primary and secondary role must be set.  Each replica in an Availability Group has both a primary and secondary role.  By default, the primary role for all replicas is All Connections.  This allows for every secondary or primary to be utilized in the event of a disaster as a primary connection with full read/write capabilities.  For read-only with read-intent configurations, there are two or more replicas that are configured for the role of primary with all connections and then a secondary role as a read routing for read-intent purposes.</p>
<p><a href="/wp-content/uploads/2014/06/ag31.png"><img class="size-full wp-image-2718 aligncenter" src="/wp-content/uploads/2014/06/ag31.png" alt="ag31" width="440" height="671" srcset="/wp-content/uploads/2014/06/ag31.png 440w, /wp-content/uploads/2014/06/ag31-196x300.png 196w" sizes="(max-width: 440px) 100vw, 440px" /></a></p>
<p>In the following configuration, the diagram illustrates the 2-node read routing configuration.</p>
<p>Note: Each replica requires the secondary role to be configured in a read-intent configuration.  In this configuration, the primary replica has a secondary role of read-intent.  In the case of the automatic failover to the secondary node, read-intent connections would be routed back to the secondary node.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> AVAILABILITY <span class="kw1">GROUP</span> SQLAG
<span class="kw1">MODIFY</span> REPLICA <span class="kw1">ON</span>
N<span class="st0">'NODE1\SHAREPOINT2013'</span> <span class="kw1">WITH</span>
<span class="br0">&#40;</span>SECONDARY_ROLE <span class="br0">&#40;</span><span class="sy0">ALL</span>OW_CONNECTIONS <span class="sy0">=</span> READ_ONLY<span class="br0">&#41;</span><span class="br0">&#41;</span>;
<span class="kw1">ALTER</span> AVAILABILITY <span class="kw1">GROUP</span> SQLAG
<span class="kw1">MODIFY</span> REPLICA <span class="kw1">ON</span>
N<span class="st0">'NODE1\SHAREPOINT2013'</span> <span class="kw1">WITH</span>
<span class="br0">&#40;</span>SECONDARY_ROLE <span class="br0">&#40;</span>READ_ONLY_ROUT<span class="sy0">IN</span>G_URL <span class="sy0">=</span> N<span class="st0">'TCP://NODE1.ONPNT.TedsDomain.com:1433'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;<span class="sy0">&lt;/</span>code<span class="sy0">&gt;</span>
&nbsp;
<span class="kw1">ALTER</span> AVAILABILITY <span class="kw1">GROUP</span> SQLAG
<span class="kw1">MODIFY</span> REPLICA <span class="kw1">ON</span>
N<span class="st0">'NODE3\SHAREPOINT2013'</span> <span class="kw1">WITH</span>
<span class="br0">&#40;</span>SECONDARY_ROLE <span class="br0">&#40;</span><span class="sy0">ALL</span>OW_CONNECTIONS <span class="sy0">=</span> READ_ONLY<span class="br0">&#41;</span><span class="br0">&#41;</span>;
<span class="kw1">ALTER</span> AVAILABILITY <span class="kw1">GROUP</span> SQLAG
<span class="kw1">MODIFY</span> REPLICA <span class="kw1">ON</span>
N<span class="st0">'NODE3\SHAREPOINT2013'</span> <span class="kw1">WITH</span>
<span class="br0">&#40;</span>SECONDARY_ROLE <span class="br0">&#40;</span>READ_ONLY_ROUT<span class="sy0">IN</span>G_URL <span class="sy0">=</span> N<span class="st0">'TCP://NODE3.ONPNT.TedsDomain.com:1433'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">ALTER</span> AVAILABILITY <span class="kw1">GROUP</span> SQLAG
<span class="kw1">MODIFY</span> REPLICA <span class="kw1">ON</span>
N<span class="st0">'NODE1\SHAREPOINT2013'</span> <span class="kw1">WITH</span>
<span class="br0">&#40;</span>PRIMARY_ROLE <span class="br0">&#40;</span>READ_ONLY_ROUT<span class="sy0">IN</span>G_LIST<span class="sy0">=</span><span class="br0">&#40;</span><span class="st0">'NODE3\SHAREPOINT2013'</span>,<span class="st0">'NODE1\SHAREPOINT2013'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw1">ALTER</span> AVAILABILITY <span class="kw1">GROUP</span> SQLAG
<span class="kw1">MODIFY</span> REPLICA <span class="kw1">ON</span>
N<span class="st0">'NODE3\SHAREPOINT2013'</span> <span class="kw1">WITH</span>
<span class="br0">&#40;</span>PRIMARY_ROLE <span class="br0">&#40;</span>READ_ONLY_ROUT<span class="sy0">IN</span>G_LIST<span class="sy0">=</span><span class="br0">&#40;</span><span class="st0">'NODE1\SHAREPOINT2013'</span>,<span class="st0">'NODE3\SHAREPOINT2013'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER AVAILABILITY GROUP SQLAG
MODIFY REPLICA ON
N'NODE1\SHAREPOINT2013' WITH
(SECONDARY_ROLE (ALLOW_CONNECTIONS = READ_ONLY));
ALTER AVAILABILITY GROUP SQLAG
MODIFY REPLICA ON
N'NODE1\SHAREPOINT2013' WITH
(SECONDARY_ROLE (READ_ONLY_ROUTING_URL = N'TCP://NODE1.ONPNT.TedsDomain.com:1433'));&lt;/code&gt;

ALTER AVAILABILITY GROUP SQLAG
MODIFY REPLICA ON
N'NODE3\SHAREPOINT2013' WITH
(SECONDARY_ROLE (ALLOW_CONNECTIONS = READ_ONLY));
ALTER AVAILABILITY GROUP SQLAG
MODIFY REPLICA ON
N'NODE3\SHAREPOINT2013' WITH
(SECONDARY_ROLE (READ_ONLY_ROUTING_URL = N'TCP://NODE3.ONPNT.TedsDomain.com:1433'));

ALTER AVAILABILITY GROUP SQLAG
MODIFY REPLICA ON
N'NODE1\SHAREPOINT2013' WITH
(PRIMARY_ROLE (READ_ONLY_ROUTING_LIST=('NODE3\SHAREPOINT2013','NODE1\SHAREPOINT2013')));

ALTER AVAILABILITY GROUP SQLAG
MODIFY REPLICA ON
N'NODE3\SHAREPOINT2013' WITH
(PRIMARY_ROLE (READ_ONLY_ROUTING_LIST=('NODE1\SHAREPOINT2013','NODE3\SHAREPOINT2013')));
GO</pre></div></div>

<p>&nbsp;</p>
<h2>Connecting to SQL Server and the Availability Group</h2>
<p>Every Availability Group utilizes the listener for connectivity between an external source and the actual database(s) enrolled in the Availability Group.  It is possible, for administrative purposes only, to connect directly to each replica’s SQL Server instance directly.  These direct connections should be performed for instance level configurations such as MAXDOP, memory and so on.  Configuring or making changes to the Availability Group should also be performed on the primary replica by directly connecting to it.  For example: the primary in the configuration is NODE1 and this would be the instance to connect to for configuration of the Availability Group.</p>
<p>For database level changes such as security, connect to the database through the listener name.</p>
<p>For application or service connections, no other changes are needed beyond the normal connection strings utilized for connecting directly to either a named instanced, default instance or clustered instances of SQL Server.  However, if a read-intent connection is desired, the ApplicationIntent=ReadOnly, attribute is required in the connection string for read routing to take place. <b></b></p>
<p>&nbsp;</p>
<h2>Modifying the Availability Group</h2>
<h4>Add a database to an existing Availability Group</h4>
<p>To add or remove a database from a pre-existing Availability Group, connect to the SQL Server instance acting as the primary replica via SSMS.</p>
<p>Expand the AlwaysOn High Availability node and expand the Availability Group that you wish change.</p>
<p><a href="/wp-content/uploads/2014/06/ag32.png"><img class="alignnone size-full wp-image-2719" src="/wp-content/uploads/2014/06/ag32.png" alt="ag32" width="361" height="307" srcset="/wp-content/uploads/2014/06/ag32.png 361w, /wp-content/uploads/2014/06/ag32-300x255.png 300w" sizes="(max-width: 361px) 100vw, 361px" /></a></p>
<p>Right click Availability Databases and click Add Database.</p>
<p><a href="/wp-content/uploads/2014/06/ag33.png"><img class="alignnone size-full wp-image-2720" src="/wp-content/uploads/2014/06/ag33.png" alt="ag33" width="370" height="360" srcset="/wp-content/uploads/2014/06/ag33.png 370w, /wp-content/uploads/2014/06/ag33-300x291.png 300w" sizes="(max-width: 370px) 100vw, 370px" /></a></p>
<p>The Add Database to Availability Group wizard will be shown.  This wizard is the same as the initial Availability Group setup.  Each database must follow the same requirements of being in full recovery model and having a full backup taken.</p>
<p>Follow the screens and fill in each required piece of information that is specific to the database(s) you wish to add to the Availability Group</p>
<p><a href="/wp-content/uploads/2014/06/ag34.png"><img class="alignnone size-full wp-image-2721" src="/wp-content/uploads/2014/06/ag34.png" alt="ag34" width="624" height="275" srcset="/wp-content/uploads/2014/06/ag34.png 624w, /wp-content/uploads/2014/06/ag34-300x132.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>When the wizard has completed, the database will have a full backup taken and restored to all replicas, and a tail-end log backup will be taken, before it is added to the Availability Group.  During this time the other databases and the Availability Group will be available to all connections.  There are no requirements beyond these steps to add a database to the Availability Group.</p>
<p>To remove a database, right click the database in the listing and select Remove Database from Availability Group.  Note: this will remove the database from the Availability Group only.  This will not delete the physical database located on all replicas.  The primary database will persist allowing direct connections and all replica databases will be in a NORECOVERY state (restoring…).</p>
<p><a href="/wp-content/uploads/2014/06/ag35.png"><img class="alignnone size-full wp-image-2676" src="/wp-content/uploads/2014/06/ag35.png" alt="ag35" width="506" height="311" srcset="/wp-content/uploads/2014/06/ag35.png 506w, /wp-content/uploads/2014/06/ag35-300x184.png 300w" sizes="(max-width: 506px) 100vw, 506px" /></a></p>
<h3>Modifying Availability Group Settings</h3>
<p>All modifications to the Availability Group should be performed on the primary replica.   To modify settings for a specific Availability Group, connect to the primary replica via SSMS 2012, expand the AlwaysOn High Availability list and expand the Availability Groups node.</p>
<p>Right click the Availability Group requiring modifications and click Properties.</p>
<p><a href="/wp-content/uploads/2014/06/ag36.png"><img class="alignnone size-full wp-image-2677" src="/wp-content/uploads/2014/06/ag36.png" alt="ag36" width="370" height="422" srcset="/wp-content/uploads/2014/06/ag36.png 370w, /wp-content/uploads/2014/06/ag36-263x300.png 263w" sizes="(max-width: 370px) 100vw, 370px" /></a></p>
<p>All changes should be performed in the Availability Group properties window.</p>
<p><a href="/wp-content/uploads/2014/06/ag37.png"><img class="alignnone size-full wp-image-2678" src="/wp-content/uploads/2014/06/ag37.png" alt="ag37" width="624" height="320" srcset="/wp-content/uploads/2014/06/ag37.png 624w, /wp-content/uploads/2014/06/ag37-300x153.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Changes that can be performed</p>
<p style="padding-left: 60px">1)      Add or remove replicas</p>
<p style="padding-left: 60px">2)      Enable read-only or read-intent replicas</p>
<p style="padding-left: 60px">3)      Switch between synchronous and asynchronous committing between replicas</p>
<p style="padding-left: 60px">4)      Modify endpoint utilization (Note: endpoints cannot be altered in this window. To modify an endpoint, go to server objectsàendpoints in SSMS.)</p>
<p style="padding-left: 60px">5)      Backup Preferences</p>
<p style="padding-left: 60px">6)      Primary and Secondary roles</p>
<p style="padding-left: 60px">7)      Permissions</p>
<h2>Failover Testing and Monitoring</h2>
<h3>Initiate a Failover</h3>
<p>To simulate and test a failover scenario, connect to the primary or listener via SSMS 2012.  Expand the AlawaysOn High Availability list and Availability Groups’ node.  Right click the Availability Group to be tested and select Failover.</p>
<p><a href="/wp-content/uploads/2014/06/ag38.png"><img class="alignnone size-full wp-image-2679" src="/wp-content/uploads/2014/06/ag38.png" alt="ag38" width="423" height="466" srcset="/wp-content/uploads/2014/06/ag38.png 423w, /wp-content/uploads/2014/06/ag38-272x300.png 272w" sizes="(max-width: 423px) 100vw, 423px" /></a></p>
<p>The failover wizard will be displayed.</p>
<p>Select the replica to failover to and complete the wizard.</p>
<p><a href="/wp-content/uploads/2014/06/ag39.png"><img class="alignnone size-full wp-image-2680" src="/wp-content/uploads/2014/06/ag39.png" alt="ag39" width="624" height="266" srcset="/wp-content/uploads/2014/06/ag39.png 624w, /wp-content/uploads/2014/06/ag39-300x127.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<h3>Monitoring Availability Groups</h3>
<p>When Availability Groups are enabled on SQL Server 2012, Extended Events are implemented for monitoring the state and health of the mirroring sessions and other session states.  To review the information that is being collected, connect to the listener name through SSMS and right click AlwaysOn High Availability and click Show Dashboard.</p>
<p><a href="/wp-content/uploads/2014/06/ag40.png"><img class="alignnone size-full wp-image-2681" src="/wp-content/uploads/2014/06/ag40.png" alt="ag40" width="423" height="266" srcset="/wp-content/uploads/2014/06/ag40.png 423w, /wp-content/uploads/2014/06/ag40-300x188.png 300w" sizes="(max-width: 423px) 100vw, 423px" /></a></p>
<p>A list of Availability Groups available to monitor will be shown.</p>
<p>Warning: The dashboard works on a refresh rate.  The queries pulling information may have an impact on performance if too many dashboards are active.  I do not recommend leaving any one dashboard open for a long period of time.</p>
<p><a href="/wp-content/uploads/2014/06/ag41.png"><img class="alignnone size-full wp-image-2682" src="/wp-content/uploads/2014/06/ag41.png" alt="ag41" width="624" height="139" srcset="/wp-content/uploads/2014/06/ag41.png 624w, /wp-content/uploads/2014/06/ag41-300x66.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>Click the Availability Group to review the health and status.</p>
<p>The overall health of the Availability Group, databases and replicas will be shown.</p>
<p><a href="/wp-content/uploads/2014/06/ag42.png"><img class="alignnone size-full wp-image-2683" src="/wp-content/uploads/2014/06/ag42.png" alt="ag42" width="624" height="336" srcset="/wp-content/uploads/2014/06/ag42.png 624w, /wp-content/uploads/2014/06/ag42-300x161.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>To review the extended health events, click the “View AlwaysOn Health Events” link.</p>
<p><a href="/wp-content/uploads/2014/06/ag43.png"><img class="alignnone size-full wp-image-2684" src="/wp-content/uploads/2014/06/ag43.png" alt="ag43" width="250" height="123" /></a></p>
<p>Review the events being captured by selecting each one to show the details.</p>
<p><a href="/wp-content/uploads/2014/06/ag44.png"><img class="alignnone size-full wp-image-2685" src="/wp-content/uploads/2014/06/ag44.png" alt="ag44" width="624" height="601" srcset="/wp-content/uploads/2014/06/ag44.png 624w, /wp-content/uploads/2014/06/ag44-300x288.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>To review the quorum configuration and votes per replica in the cluster, click the View Cluster Quorum Information link.</p>
<p><a href="/wp-content/uploads/2014/06/ag45.png"><img class="alignnone size-full wp-image-2686" src="/wp-content/uploads/2014/06/ag45.png" alt="ag45" width="624" height="415" srcset="/wp-content/uploads/2014/06/ag45.png 624w, /wp-content/uploads/2014/06/ag45-300x199.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>
<p>To make modifications to the quorum or votes (NodeWeight), use the Failover Cluster Manager or PowerShell.  For example: the following PowerShell statement is used to configure the votes shown above for NODE4 to have no votes in the health of the cluster.  This is a common configuration for a disaster and recovery replica node in the cluster and Availability Group setup.</p>
<p><a href="/wp-content/uploads/2014/06/ag46.png"><img class="alignnone size-full wp-image-2687" src="/wp-content/uploads/2014/06/ag46.png" alt="ag46" width="624" height="99" srcset="/wp-content/uploads/2014/06/ag46.png 624w, /wp-content/uploads/2014/06/ag46-300x47.png 300w" sizes="(max-width: 624px) 100vw, 624px" /></a></p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="powershell"><thead><tr><td colspan="2"  class="head">PowerShell</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1">Import<span class="sy0">-</span>Module FailoverClusters
<span class="br0">&#40;</span>Get<span class="sy0">-</span>ClusterNode NODE4<span class="br0">&#41;</span>.NodeWeight<span class="sy0">=</span><span class="nu0">0</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Import-Module FailoverClusters
(Get-ClusterNode NODE4).NodeWeight=0</pre></div></div>

<h2 style="margin: 2pt 0in 0pt"><span style="color: #000000;font-family: Calibri Light;font-size: large">What&#8217;s next?</span></h2>
<p style="margin: 0in 0in 8pt"><span style="color: #000000;font-family: Calibri;font-size: medium">Following this example of setting up a lab to test on with Availability groups, we’ll show how to script this entire solution with PoSh and T-SQL to ensure the setup, configuration and additional databases placed on the group, are not as long-winded of a process.</span></p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbadmin/setting-up-mirroring-to-sql/'>Setting up Mirroring to SQL 2012 Availability Groups Encryption Error</a><p>With SQL Server 2012, the power of Availability Groups is arguably one of the best&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbadmin/acl-azure-availability-groups/'>ACL added security for Availability Group Listener in Azure</a><p>Prior to the release of supporting listeners for availability groups in Azure running Windows Server&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Ted Krueger is a SQL Server MVP and Author that has been working in development and database administration and the owner of a successful consulting business, DataMetrics Consulting.  Specialties range from High Availability and Disaster / Recovery setup and testing methods down to custom assembly development for SQL Server Reporting Services.  Ted blogs and is also one of the founders of LessThanDot.com technology community.  Some of the articles focused on are Backup / Recovery, Security, SSIS and working on SQL Server and using all of the SQL Server features available to create stable and scalable database services.  <br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/onpnt" title="onpnt at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=https://www.facebook.com/onpntfirearms" title="onpnt at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/pub/ted-krueger/2/183/b66" title="onpnt at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://www.datametricsconsulting.com/" title="onpnt at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="/index.php/author/onpnt/feed/" title="Blog RSS feed for onpnt" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 18,983 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/onpnt/">Read More Posts by Ted Krueger (onpnt)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&text=RT @LessThanDot Blog - Availability Groups Setup and Configuration from A to Z by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&title=Availability Groups Setup and Configuration from A to Z&source=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&title=Availability Groups Setup and Configuration from A to Z" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&quote=Availability Groups Setup and Configuration from A to Z" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/&title=Availability Groups Setup and Configuration from A to Z" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		6 Comments	</h4>
			<ol class="comments-list">
					<li class="comment even thread-even depth-1" id="comment-1038135">
				<div id="div-comment-1038135" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7cd58f62165741ce671ee2e42a920055?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7cd58f62165741ce671ee2e42a920055?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://pietervanhove.azurewebsites.net/' rel='external nofollow' class='url'>Pieter Vanhove</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/#comment-1038135">
			June 4, 2014 at 2:40 am</a>		</div>

		<p>Hi Ted,</p>
<p>Thanks for sharing this, interesting post.<br />
I think it&#8217;s also worth to mention that you should copy your server logins to the secondary replica&#8217;s in case you don&#8217;t use contained databases. The same for specific database jobs and maintenance jobs.<br />
I&#8217;ve also noticed that the owner of the secondary database will be the login that is performing the restore. I&#8217;ve written a blog post about it here <a href="http://pietervanhove.azurewebsites.net/?p=3769" rel="nofollow">http://pietervanhove.azurewebsites.net/?p=3769</a></p>
<p>But again, good post and thanks for sharing</p>
<p>Regards<br />
Pieter</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/?replytocom=1038135#respond' onclick='return addComment.moveForm( "div-comment-1038135", "1038135", "respond", "2434" )' aria-label='Reply to Pieter Vanhove'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1052664">
				<div id="div-comment-1052664" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/#comment-1052664">
			June 5, 2014 at 6:46 am</a>		</div>

		<p>Thanks Pieter, although I don&#8217;t agree completely on the points being added here as they are not part of what availability groups is.  The ownership of a database is due to restoring under a user account, which should be corrected in any case of a restore (I see you&#8217;ve given that corrected method in your blog you referred to &#8211; nicely done).  Logins, SQL Agent Jobs, and everything else outside the control of AG, falls into the high availability strategy, not AG specifically.  Those types of objects, as you said, should be moved but they are again, not part of AG.  The same situations exist for mirroring, not just AG.  On a side note &#8211; copying the logins is not simply enough unless you failover and manually map the orphaned user to login.  So you should be placing a script, like my fix orphaned users script, on the replicas and have it run in the event a failover occurs, by catching the xevent.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/?replytocom=1052664#respond' onclick='return addComment.moveForm( "div-comment-1052664", "1052664", "respond", "2434" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1833996">
				<div id="div-comment-1833996" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0869acba4693f470d10d388913118d2c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0869acba4693f470d10d388913118d2c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Kangah</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/#comment-1833996">
			September 13, 2014 at 6:34 am</a>		</div>

		<p>This is the most detailed and best post on the Availability group setup I ever read. Thanks for sharing this very useful post.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/?replytocom=1833996#respond' onclick='return addComment.moveForm( "div-comment-1833996", "1833996", "respond", "2434" )' aria-label='Reply to Kangah'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2343761">
				<div id="div-comment-2343761" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a5156b0b870e1f3f78d9f76559ac0019?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a5156b0b870e1f3f78d9f76559ac0019?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Lana</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/#comment-2343761">
			October 29, 2014 at 6:04 pm</a>		</div>

		<p>Hello &#8211; This is very detailed &#8211; much better than what I&#8217;ve come across.  This issue I am having, though, is that all the different documentation I&#8217;ve seen talks about removing a database from the High Availability group, which was quite easy, but not what it takes to add it back in.  I have an issue where I needed to take a database out temporarily as Sharepoint wanted to update it.  Seemed rather simple just to take it out, but the database went into simple mode, so I had to change that back to Full and do a backup, but it is still saying there is an issue in the fact that there is an existing database on the replica.  How do I add it back, once I&#8217;ve taken it out?  Any assistance would be greatly appreciated! Thank you.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/?replytocom=2343761#respond' onclick='return addComment.moveForm( "div-comment-2343761", "2343761", "respond", "2434" )' aria-label='Reply to Lana'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-4438558">
				<div id="div-comment-4438558" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/aebefb8f9b3b5bd16685d7127c932b9f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/aebefb8f9b3b5bd16685d7127c932b9f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Perry Whittle</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/#comment-4438558">
			July 9, 2015 at 7:47 am</a>		</div>

		<p>Quorum configuration is probably the most misunderstood part of a WSFC, instead of adding a Fileshare witness, it&#8217;s better to just remove a vote from a node to maintain Majority Node Set for the cluster.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/?replytocom=4438558#respond' onclick='return addComment.moveForm( "div-comment-4438558", "4438558", "respond", "2434" )' aria-label='Reply to Perry Whittle'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5291056">
				<div id="div-comment-5291056" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/068ec5dddddcf416402cab19b44f2e0e?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/068ec5dddddcf416402cab19b44f2e0e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">ajay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/#comment-5291056">
			October 6, 2016 at 10:16 pm</a>		</div>

		<p>nice artical</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/?replytocom=5291056#respond' onclick='return addComment.moveForm( "div-comment-5291056", "5291056", "respond", "2434" )' aria-label='Reply to ajay'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/architect/availability-groups-setup-and-configuration-from-a-to-z/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='2434' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="f0adc8838f4bdedde4ec2cfad0515589"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765719"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
