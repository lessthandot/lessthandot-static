<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   How to return error messages from the SQL Server to the client using SQLDataSource</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   How to return error messages from the SQL Server to the client using SQLDataSource" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="The recent thread in ASP.NET forums is the primary reason for this blog post. I want to show how error messages from the SQL Server were handled in our web pages. The site I was working on had most of the functionality developed by the previous developer. Unfortunately, most pages didn&#8217;t use a separation of [&hellip;]" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; How to return error messages from the SQL Server to the client using SQLDataSource Comments Feed" href="/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Resources for Professional Development' href='/index.php/itprofessionals/professionaldevelopment/resources-for-professional-development/' />
<link rel='next' title='SQLCop A Tool To Highlight Potential Problems With Your Database' href='/index.php/datamgmt/dbprogramming/sqlcop-a-tool-to-highlight-potential-pro/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/" />
<link rel='shortlink' href='/?p=854' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fwebdev%2Fwebdesigngraphicsstyling%2Fhow-to-return-error-messages-from-the-sq%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fwebdev%2Fwebdesigngraphicsstyling%2Fhow-to-return-error-messages-from-the-sq%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbprogramming/sqlcop-a-tool-to-highlight-potential-pro/" rel="next">SQLCop A Tool To Highlight Potential Problems With Your Database</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/itprofessionals/professionaldevelopment/resources-for-professional-development/" rel="prev">Resources for Professional Development</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/" class="post-title">How to return error messages from the SQL Server to the client using SQLDataSource</a></h1>
					<div class="post-byline">by <a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky" rel="author">Naomi Nosonovsky</a> on July 25, 2010 in category <a href="/index.php/category/webdev/webdesigngraphicsstyling/" rel="category tag">Web Design, Graphics and Styling</a>. Article views: 14,748 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&text=RT @LessThanDot Blog - How to return error messages from the SQL Server to the client using SQLDataSource by naomi" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&title=How to return error messages from the SQL Server to the client using SQLDataSource&source=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&title=How to return error messages from the SQL Server to the client using SQLDataSource" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&quote=How to return error messages from the SQL Server to the client using SQLDataSource" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&title=How to return error messages from the SQL Server to the client using SQLDataSource" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>The recent <a href="http://forums.asp.net/t/1580016.aspx?PageIndex=1">thread</a> in ASP.NET forums is the primary reason for this blog post.</p>
<p>I want to show how error messages from the SQL Server were handled in our web pages. The site I was working on had most of the functionality developed by the previous developer. Unfortunately, most pages didn&#8217;t use a separation of layers and used SQLDataSource for data manipulations.</p>
<p>The sample I want to show was called from InsertPerson.aspx page. For inserting a person we used the stored procedure I showed in my previous blog <a href="/index.php/WebDev/?p=553">How to insert information into multiple related tables and return ID using SQLDataSource</a>.</p>
<p>For inserting a new person the InsertPerson.aspx page was used that had multiview control, FormView controls with different tabs using User Controls for each tab (the tab was a special control designed by my colleague).</p>
<p>Here is the beginning of the page&#8217;s code:</p>
<pre>&lt;asp:Label ID="UPDATE_OPENER" runat="server" Visible="false" Text=""&gt;&lt;/asp:Label&gt;
    
    &lt;form id="form1" runat="server"&gt;        
        
    &lt;asp:MultiView ID="MltvwViewForms" runat="server"&gt;
        &lt;asp:View ID="VwRegularPerson" runat="server"&gt;
            &lt;asp:SqlDataSource runat="server" ID="PeopleNoneDataSource" ConnectionString="&lt;%$ ConnectionStrings:FCCMSConnectionString %&gt;"
                InsertCommand="PersonInsert" InsertCommandType="StoredProcedure" OnInserted="DataSource_Inserted"&gt;
                &lt;InsertParameters&gt;
                    &lt;asp:Parameter Name="NewPersonID" Direction="Output" Type="Int32" /&gt;
                    &lt;asp:ProfileParameter Name="SiteID" PropertyName="SiteID" Type="Int32" /&gt;
                    &lt;asp:QueryStringParameter Name="PersonType" QueryStringField="ptype" Type="Char"
                        DefaultValue="N" /&gt;
                    &lt;asp:Parameter Name="Title" /&gt;
                    &lt;asp:Parameter Name="Occupation" /&gt;
                    &lt;asp:Parameter Name="BusinessName" /&gt;
                    &lt;asp:Parameter Name="BusAdd1" /&gt;
                    &lt;asp:Parameter Name="BusAdd2" /&gt;
                    &lt;asp:Parameter Name="BusCity" /&gt;
                    &lt;asp:Parameter Name="BusState" /&gt;
                    &lt;asp:Parameter Name="BusZip" /&gt;
                    &lt;asp:Parameter Name="BusEMail" /&gt;
                    &lt;asp:Parameter Name="Pager" /&gt;
                    &lt;asp:Parameter Name="Fax" /&gt;
                    &lt;asp:Parameter Name="BusinessPhone" /&gt;
                    &lt;asp:Parameter Name="SpouseFN" /&gt;
                    &lt;asp:Parameter Name="SpouseLN" /&gt;
                    &lt;asp:Parameter Name="SpouseID" /&gt;
                    &lt;asp:Parameter Name="Anniversary" /&gt;
                &lt;/InsertParameters&gt;
            &lt;/asp:SqlDataSource&gt;
            &lt;asp:FormView runat="server" ID="PeopleNoneForm" DefaultMode="Insert" EditRowStyle-CssClass="details_row"
                DataSourceID="PeopleNoneDataSource" OnItemInserted="Form_ItemInserted" 
                OnItemInserting="Form_ItemInserting"  OnItemCommand="Form_ItemCommand"&gt;
                &lt;InsertItemTemplate&gt;
                    &lt;div style="margin-top: 20px"&gt;
                        &amp;nbsp;&lt;/div&gt;
                    &lt;div id="links"&gt;
                        &lt;label class="link" id="tab1" onclick="showReport(1,&lt;%=clseditmode.NumTabs %&gt;)" title="Basic Info"&gt;
                            Basic Info&lt;/label&gt;
                        &lt;label class="link" id="tab2" onclick="showReport(2,&lt;%=clseditmode.NumTabs %&gt;)" title="Contact Info"&gt;
                            Contact Info&lt;/label&gt;
                        &lt;label class="link" id="tab3" onclick="showReport(3,&lt;%=clseditmode.NumTabs %&gt;)" title="User Info"&gt;
                            User Info&lt;/label&gt;
                        &lt;label class="link" id="tab4" onclick="showReport(4,&lt;%=clseditmode.NumTabs %&gt;)" title="Employment Info"&gt;
                            Employment Info&lt;/label&gt;
                        &lt;label class="link" id="tab5" onclick="showReport(5,&lt;%=clseditmode.NumTabs %&gt;)" title="Family Info"&gt;
                            Family Info&lt;/label&gt;
                         &lt;% if (clseditmode.NumTabs == 6) { %&gt;   
                                 &lt;label class="link" id="tab6" onclick="showReport(6,&lt;%=clseditmode.NumTabs %&gt;)" title="Membership Info"&gt;
                                    Membership Info&lt;/label&gt; 
                                 &lt;% } %&gt;      
                    &lt;/div&gt;
                    &lt;div class="boxMain"&gt;
                       &lt;UndoSave:UndoSaveButtons ID="btnRegular" runat="server" /&gt;
                        &lt;!-- 1st --&gt;
                        
                                &lt;div id="info1" class="cl"&gt;
                                    &lt;GenInfo:GeneralInfo ID="GenInfoRegular" runat="server" ShowTitle="true" DOB='&lt;%# Bind("DOB") %&gt;'
                                        FirstName='&lt;%# Bind("FirstName") %&gt;'
                                        LastName='&lt;%# Bind("LastName") %&gt;' MiddleName='&lt;%# Bind("MiddleName") %&gt;' Title='&lt;%# Bind("Title") %&gt;'
                                        Gender='&lt;%# Bind("Gender") %&gt;' ShowParents="false" SetGenderOnChangeEvent="true"
                                        ShowPicture ="true" DefaultPicture = '&lt;%# Bind("DefaultPicture") %&gt;'  /&gt;
                                
                                &lt;div class="cl" style="padding-top: 26px"&gt;
                                    &lt;script type="text/javascript"&gt;TabNav(1,&lt;%=clseditmode.NumTabs %&gt;)&lt;/script&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;!-- /1st --&gt;
                        &lt;!-- 2nd --&gt;
                        &lt;div id="info2" class="cl dn"&gt;
                            &lt;AddrInfo:AddressInfo ID="AddressInfoRegular" runat="server" Address1='&lt;%# Bind("Address1") %&gt;'
                                Address2='&lt;%# Bind("Address2") %&gt;' CellPhone='&lt;%# Bind("CellPhone") %&gt;' City='&lt;%# Bind("City") %&gt;'
                                Zip='&lt;%# Bind("Zip") %&gt;' State='&lt;%# Bind("State") %&gt;' ScreenName='&lt;%# Bind("ScreenName") %&gt;'
                                HomePhone='&lt;%# Bind("HomePhone") %&gt;' 
                                Email='&lt;%# Bind("Email") %&gt;' 
                                SecondEmail='&lt;%# Bind("SecondEmail") %&gt;'/&gt;                        
                        &lt;div class="cl" style="padding-top: 15px"&gt;
                            &lt;script type="text/javascript"&gt;TabNav(2,&lt;%=clseditmode.NumTabs %&gt;)&lt;/script&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;!-- /2nd --&gt;
                    &lt;!-- 3rd --&gt;
                    &lt;div id="info3" class="cl dn"&gt;
                        &lt;UserInfo:UserInfo ID="UserInfoRegular" runat="server" Pwd='&lt;%# Bind("Pwd") %&gt;' UserName='&lt;%# Bind("UserName") %&gt;' /&gt;
                        &lt;div class="cl" style="padding-top: 26px"&gt;
                            &lt;script type="text/javascript"&gt;TabNav(3,&lt;%=clseditmode.NumTabs %&gt;)&lt;/script&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;!-- /3rd --&gt;
                    &lt;!-- 4th --&gt;
                    &lt;div id="info4" class="cl dn"&gt;
                        &lt;BusInfo:BussinessInfo ID="BussinessInfoRegular" runat="server" Occupation='&lt;%# Bind("Occupation") %&gt;'
                            BusinessName='&lt;%# Bind("BusinessName") %&gt;' BusAdd1='&lt;%# Bind("BusAdd1") %&gt;' BusAdd2='&lt;%# Bind("BusAdd2") %&gt;'
                            BusCity='&lt;%# Bind("BusCity") %&gt;' BusState='&lt;%# Bind("BusState") %&gt;' BusZip='&lt;%# Bind("BusZip") %&gt;'
                            Pager='&lt;%# Bind("Pager") %&gt;' Fax='&lt;%# Bind("Fax") %&gt;' BusinessPhone='&lt;%# Bind("BusinessPhone") %&gt;' /&gt;
                        &lt;div class="cl" style="padding-top: 26px"&gt;
                            &lt;script type="text/javascript"&gt;TabNav(4,&lt;%=clseditmode.NumTabs %&gt;)&lt;/script&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;!-- /4th --&gt;
                    &lt;!-- 5th --&gt;
                    &lt;div id="info5" class="cl dn"&gt;
                    &lt;div class="cl"&gt;
                        &lt;label class="bx"&gt;
                            Spouse&lt;/label&gt;
                            &lt;span class="bx" id="spouseName"&gt;
                                
                                &lt;Custom:AutoSuggestBox ID="asbSpouse" ToolTip="Start typing and select from the list"
                                    runat="server" DataType = '&lt;%# Eval("Gender") =="M"?"Mother":"Father" %&gt;' IncludeMoreMenuItem="True" KeyPressDelay="300"
                                    MaxSuggestChars="5" MoreMenuItemLabel="..." NumMenuItems="10" ResourcesDir="/asb_includes"
                                    SelectedValue='&lt;%# Bind("SpouseID") %&gt;' SelMenuItemCSSClass="asbSelMenuItem"
                                    OnPreRender="AsbPrerender" UseIFrame="True" MaxLength="80"&gt;&lt;/Custom:AutoSuggestBox&gt;
                               
                            &lt;/span&gt;
                    &lt;span class="bx" style="width: 180px"&gt;
                    &lt;a href=&lt;%# clseditmode.CreateLink(Eval("SpouseID"),"AddressInfoRegular","Spouse") %&gt;&lt;/a&gt;&lt;/span&gt;
                       &lt;label class="bx"&gt;
                            Anniversary&lt;/label&gt;&lt;span class="bx"&gt;&lt;asp:TextBox ID="tbAnniversary" runat="server"
                                AutoCompleteType="Disabled" Text='&lt;%# Bind("Anniversary", "{0:M/d/yyyy}") %&gt;'&gt;&lt;/asp:TextBox&gt;
                                &lt;asp:RegularExpressionValidator ID="regexAnniversary" runat="server" ControlToValidate="tbAnniversary"
                                    Display="Dynamic" ErrorMessage="Incorrect Anniversary (m/d/yyyy)" 
                                    ValidationExpression="(?:(?:(?:0?[13578]|1[02])(/|-|.)31)1|(?:(?:0?[13-9]|1[0-2])(/|-|.)(?:29|30)2))(?:(?:1[6-9]|[2-9]d)?d{2})$|^(?:0?2(/|-|.)293(?:(?:(?:1[6-9]|[2-9]d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:(?:0?[1-9])|(?:1[0-2]))(/|-|.)(?:0?[1-9]|1d|2[0-8])4(?:(?:1[6-9]|[2-9]d)?d{2})"&gt;&lt;/asp:RegularExpressionValidator&gt;&lt;/span&gt;
                        &lt;label class="bx"&gt;Marital Status&lt;/label&gt;&lt;span class="bx"&gt;
                        &lt;asp:DropDownList runat="server" ID="drpMsts" SelectedValue='&lt;%# Bind("MaritalStatus") %&gt;'&gt;
                            &lt;asp:ListItem Value="M"&gt;Married&lt;/asp:ListItem&gt;
                            &lt;asp:ListItem Value="D"&gt;Divorced&lt;/asp:ListItem&gt;
                            &lt;asp:ListItem Value="S"&gt;Separated&lt;/asp:ListItem&gt;
                            &lt;asp:ListItem Value="W"&gt;Widowed&lt;/asp:ListItem&gt;
                        &lt;/asp:DropDownList&gt;&lt;/span&gt;&lt;/div&gt; 
                        
                        &lt;div class="cl"&gt;
                            &lt;label class="bx"&gt;
                                Father&lt;/label&gt;&lt;span class="bx" id = "fatherName"&gt;&lt;Custom:AutoSuggestBox ID="fatherName" Text='&lt;%# Bind("Father") %&gt;'
                                    DataType="Father" MaxLength="100" OnPreRender="AsbPrerender" ToolTip="Start typing and select from the list"
                                    runat="server" ResourcesDir="/asb_includes" /&gt;&lt;/span&gt;
                                    &lt;span class="bx" style="width: 180px"&gt; 
                                    &lt;a href=&lt;%# clseditmode.CreateLink(Eval("FatherID"),"AddressInfoRegular","Father") %&gt;&lt;/a&gt;&lt;/span&gt;
                           &lt;/div&gt;
                           &lt;div class="cl"&gt;
                            &lt;label class="bx"&gt;
                                Mother&lt;/label&gt;&lt;span class="bx" id ="motherName"&gt;&lt;Custom:AutoSuggestBox ID="motherName" Text='&lt;%# Bind("Mother") %&gt;'
                                    DataType="Mother" MaxLength="100" OnPreRender="AsbPrerender" ToolTip="Start typing and select from the list"
                                    runat="server" ResourcesDir="/asb_includes" /&gt;&lt;/span&gt;
                                    &lt;span class="bx" style="width: 180px"&gt;
                                    &lt;a href=&lt;%# clseditmode.CreateLink(Eval("MotherID"),"AddressInfoRegular","Mother") %&gt;&lt;/a&gt;&lt;/span&gt;
                        &lt;/div&gt;
                        &lt;div class="cl"&gt;
                            &lt;label class="bx"&gt;
                                Comment&lt;/label&gt;&lt;span class="bx"&gt;&lt;asp:TextBox ID="txtComment" Width="120" Text='&lt;%# Bind("Comment") %&gt;'
                                    TextMode="MultiLine" runat="server" AutoCompleteType="Disabled" /&gt;&lt;/span&gt;
                        &lt;/div&gt;
                        &lt;div class="cl" style="padding-top: 26px"&gt;
                            &lt;script type="text/javascript"&gt;TabNav(5,&lt;%=clseditmode.NumTabs %&gt;)&lt;/script&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;!-- /5th --&gt;
                     &lt;% if (clseditmode.NumTabs == 6) { %&gt; 
	                     
                                &lt;!-- 6th --&gt;
                                &lt;div id="info6" class="cl dn"&gt;
                                    &lt;MembInfo:MembershipInfo ID="MembershipInfoRegular" runat="server" 
                                    BillQuaterly ='&lt;%# Bind("BillQuaterly") %&gt;' IsMember ='&lt;%# Bind("IsMember") %&gt;'
                                    PaymentMethod='&lt;%# Bind("PaymentMethod") %&gt;' StartDate ='&lt;%# Bind("StartDate") %&gt;' /&gt;
                               &lt;div class="cl" style="padding-top: 26px"&gt;
                                    &lt;script type="text/javascript"&gt;TabNav(6,&lt;%=clseditmode.NumTabs %&gt;)&lt;/script&gt;
                                &lt;/div&gt;                                    
                                &lt;/div&gt;
                                &lt;!-- /6th --&gt;
                                &lt;% } %&gt;   
                                &lt;script type="text/javascript"&gt;showReport(1,&lt;%=clseditmode.NumTabs %&gt;);&lt;/script&gt;
                   &lt;/div&gt;
                &lt;/InsertItemTemplate&gt;
                &lt;EditRowStyle CssClass="details_row" /&gt;
            &lt;/asp:FormView&gt;
        &lt;/asp:View&gt;
        &lt;!-- End of the Regular Person --&gt;</pre>
<p>etc.</p>
<p>The InsertPerson.cs (code behind) had the following code in regards to showing the error message:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="de1"><pre class="de1"><span class="co1">/// &lt;summary&gt;</span>
&nbsp; &nbsp; <span class="co1">/// Display message</span>
&nbsp; &nbsp; <span class="co1">/// &lt;/summary&gt;</span>
&nbsp; &nbsp; <span class="co1">/// &lt;param name=&quot;msg&quot;&gt;&lt;/param&gt;</span>
&nbsp; &nbsp; <span class="co1">/// &lt;param name=&quot;CloseWindow&quot;&gt;&lt;/param&gt;</span>
&nbsp; &nbsp; <span class="kw1">protected</span> <span class="kw4">void</span> DisplayMessage<span class="br0">&#40;</span><span class="kw4">string</span> msg, <span class="kw4">bool</span> CloseWindow<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">string</span> Script<span class="sy0">=</span><span class="st0">&quot;&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>Request<span class="sy0">.</span><span class="me1">QueryString</span><span class="br0">&#91;</span><span class="st0">&quot;pid&quot;</span><span class="br0">&#93;</span> <span class="sy0">!=</span> <span class="kw1">null</span> <span class="sy0">&amp;&amp;</span> Request<span class="sy0">.</span><span class="me1">QueryString</span><span class="br0">&#91;</span><span class="st0">&quot;pid&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>msg <span class="sy0">!=</span> <span class="st0">&quot;&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> Script <span class="sy0">=</span> <span class="kw4">string</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span><span class="st0">&quot;alert(&quot;</span><span class="br0">&#123;</span><span class="nu0">0</span><span class="br0">&#125;</span><span class="st0">&quot;);&quot;</span>, msg<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="br0">&#40;</span>CloseWindow <span class="sy0">?</span> <span class="st0">&quot;window.close;&quot;</span> <span class="sy0">:</span> <span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span> <span class="br0">&#125;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">else</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Script <span class="sy0">=</span> <span class="kw4">string</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span><span class="st0">&quot;parent.DisplayMessage(&quot;</span><span class="br0">&#123;</span><span class="nu0">0</span><span class="br0">&#125;</span><span class="st0">&quot;);&quot;</span>, msg<span class="br0">&#41;</span><span class="sy0">;</span><span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>Script<span class="sy0">!=</span><span class="st0">&quot;&quot;</span><span class="br0">&#41;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">this</span><span class="sy0">.</span><span class="me1">ClientScript</span><span class="sy0">.</span><span class="me1">RegisterClientScriptBlock</span><span class="br0">&#40;</span><span class="kw1">this</span><span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span>, <span class="st0">&quot;Message&quot;</span>, Script, <span class="kw1">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">/// &lt;summary&gt;
    /// Display message
    /// &lt;/summary&gt;
    /// &lt;param name="msg"&gt;&lt;/param&gt;
    /// &lt;param name="CloseWindow"&gt;&lt;/param&gt;
    protected void DisplayMessage(string msg, bool CloseWindow)
    {
        string Script="";
        if (Request.QueryString["pid"] != null &amp;&amp; Request.QueryString["pid"].Length &gt; 0) {
            if (msg != "") { Script = string.Format("alert("{0}");", msg) + (CloseWindow ? "window.close;" : ""); } 
        }
        else
        {
            Script = string.Format("parent.DisplayMessage("{0}");", msg);}
        
        if (Script!="") 
           this.ClientScript.RegisterClientScriptBlock(this.GetType(), "Message", Script, true);
    }</pre></div></div>

<p>The way the error was passed back to the client was handled in Form_ItemInserted event:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="de1"><pre class="de1"><span class="kw1">protected</span> <span class="kw4">void</span> Form_ItemInserted<span class="br0">&#40;</span><span class="kw4">object</span> sender, FormViewInsertedEventArgs e<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">string</span> Text<span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw4">bool</span> CloseWindow <span class="sy0">=</span> <span class="kw1">false</span><span class="sy0">;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>e<span class="sy0">.</span><span class="me1">Exception</span> <span class="sy0">==</span> <span class="kw1">null</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>Request<span class="sy0">.</span><span class="me1">QueryString</span><span class="br0">&#91;</span><span class="st0">&quot;pid&quot;</span><span class="br0">&#93;</span> <span class="sy0">!=</span> <span class="kw1">null</span> <span class="sy0">&amp;&amp;</span> Request<span class="sy0">.</span><span class="me1">QueryString</span><span class="br0">&#91;</span><span class="st0">&quot;pid&quot;</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Text <span class="sy0">=</span> <span class="kw4">string</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span><span class="st0">&quot;You just inserted {0} {1}&quot;</span>, e<span class="sy0">.</span><span class="me1">Values</span><span class="br0">&#91;</span><span class="st0">&quot;FirstName&quot;</span><span class="br0">&#93;</span>, e<span class="sy0">.</span><span class="me1">Values</span><span class="br0">&#91;</span><span class="st0">&quot;LastName&quot;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span><span class="sy0">.</span><span class="me1">UPDATE_OPENER</span><span class="sy0">.</span><span class="me1">Text</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;script language=&quot;</span>JavaScript<span class="st0">&quot;&gt;changeParent('&quot;</span> <span class="sy0">+</span> Request<span class="sy0">.</span><span class="me1">QueryString</span><span class="br0">&#91;</span><span class="st0">&quot;pid&quot;</span><span class="br0">&#93;</span> <span class="sy0">+</span> <span class="st0">&quot;','&quot;</span> <span class="sy0">+</span> e<span class="sy0">.</span><span class="me1">Values</span><span class="br0">&#91;</span><span class="st0">&quot;LastName&quot;</span><span class="br0">&#93;</span> <span class="sy0">+</span> <span class="st0">&quot;, &quot;</span> <span class="sy0">+</span> e<span class="sy0">.</span><span class="me1">Values</span><span class="br0">&#91;</span><span class="st0">&quot;FirstName&quot;</span><span class="br0">&#93;</span> <span class="sy0">+</span> <span class="st0">&quot; &quot;</span> <span class="sy0">+</span> <span class="br0">&#40;</span>e<span class="sy0">.</span><span class="me1">Values</span><span class="br0">&#91;</span><span class="st0">&quot;MiddleName&quot;</span><span class="br0">&#93;</span> <span class="sy0">??</span> <span class="st0">&quot;&quot;</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot;',&quot;</span> <span class="sy0">+</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span><span class="sy0">.</span><span class="me1">NewPersonID</span> <span class="sy0">+</span> <span class="st0">&quot;,'&quot;</span> <span class="sy0">+</span> Text<span class="sy0">.</span><span class="me1">Replace</span><span class="br0">&#40;</span><span class="st0">&quot;'&quot;</span>,<span class="st0">&quot;<span class="es0">\'</span>&quot;</span><span class="br0">&#41;</span> &nbsp;<span class="sy0">+</span> <span class="st0">&quot;');&lt;/script&gt;&quot;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CloseWindow <span class="sy0">=</span> <span class="kw1">true</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span><span class="sy0">.</span><span class="me1">UPDATE_OPENER</span><span class="sy0">.</span><span class="me1">Visible</span> <span class="sy0">=</span> <span class="kw1">true</span><span class="sy0">;</span> &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">else</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Text <span class="sy0">=</span> <span class="kw4">string</span><span class="sy0">.</span><span class="me1">Format</span><span class="br0">&#40;</span><span class="st0">&quot;You just inserted {0} {1} &lt;a href='peopleV.aspx?perid={2}'&gt;&quot;</span> <span class="sy0">+</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="st0">&quot;Edit Here&lt;/a&gt;&quot;</span>, e<span class="sy0">.</span><span class="me1">Values</span><span class="br0">&#91;</span><span class="st0">&quot;FirstName&quot;</span><span class="br0">&#93;</span>, e<span class="sy0">.</span><span class="me1">Values</span><span class="br0">&#91;</span><span class="st0">&quot;LastName&quot;</span><span class="br0">&#93;</span>, <span class="kw1">this</span><span class="sy0">.</span><span class="me1">NewPersonID</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span><span class="sy0">.</span><span class="me1">DisplayMessage</span><span class="br0">&#40;</span>Text, CloseWindow<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span><span class="sy0">.</span><span class="me1">MltvwViewForms</span><span class="sy0">.</span><span class="me1">Visible</span> <span class="sy0">=</span> <span class="kw1">false</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">else</span> <span class="co1">// Exception case</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Text <span class="sy0">=</span> <span class="st0">&quot;The data was entered in an incorrect format, please check it over.&quot;</span> <span class="sy0">+</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="st0">&quot; &quot;</span> <span class="sy0">+</span> e<span class="sy0">.</span><span class="me1">Exception</span><span class="sy0">.</span><span class="me1">Message</span><span class="sy0">.</span><span class="me1">Replace</span><span class="br0">&#40;</span>Environment<span class="sy0">.</span><span class="me1">NewLine</span>, <span class="st0">&quot;<span class="es0">\n</span>&quot;</span><span class="br0">&#41;</span><span class="sy0">.</span><span class="me1">Replace</span><span class="br0">&#40;</span><span class="st0">&quot;&quot;</span><span class="st0">&quot;, &quot;</span>\<span class="st0">&quot;&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">this</span><span class="sy0">.</span><span class="me1">DisplayMessage</span><span class="br0">&#40;</span>Text, CloseWindow<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e<span class="sy0">.</span><span class="me1">ExceptionHandled</span> <span class="sy0">=</span> <span class="kw1">true</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e<span class="sy0">.</span><span class="me1">KeepInInsertMode</span> <span class="sy0">=</span> <span class="kw1">true</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">protected void Form_ItemInserted(object sender, FormViewInsertedEventArgs e)
    {
        string Text;
        bool CloseWindow = false;

        if (e.Exception == null)
        {
            if (Request.QueryString["pid"] != null &amp;&amp; Request.QueryString["pid"].Length &gt; 0)
            {               
                Text = string.Format("You just inserted {0} {1}", e.Values["FirstName"], e.Values["LastName"]);
                this.UPDATE_OPENER.Text = "&lt;script language="JavaScript"&gt;changeParent('" + Request.QueryString["pid"] + "','" + e.Values["LastName"] + ", " + e.Values["FirstName"] + " " + (e.Values["MiddleName"] ?? "") + "'," + 
                    this.NewPersonID + ",'" + Text.Replace("'","\'")  + "');&lt;/script&gt;";
                CloseWindow = true;
                this.UPDATE_OPENER.Visible = true;     
            }
            else
            {
                Text = string.Format("You just inserted {0} {1} &lt;a href='peopleV.aspx?perid={2}'&gt;" +
                   "Edit Here&lt;/a&gt;", e.Values["FirstName"], e.Values["LastName"], this.NewPersonID);
                this.DisplayMessage(Text, CloseWindow);
                this.MltvwViewForms.Visible = false;
            }
        }
        else // Exception case
           {
                Text = "The data was entered in an incorrect format, please check it over." +
                       " " + e.Exception.Message.Replace(Environment.NewLine, "\n").Replace(""", "\"");
                this.DisplayMessage(Text, CloseWindow);

                e.ExceptionHandled = true;
                e.KeepInInsertMode = true;
            }
    }</pre></div></div>

<p>The page calling the InsertPerson page was called CreatePerson.aspx and had the following ASPX code:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="html4strict"><thead><tr><td colspan="2"  class="head">HTML</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
</pre></td><td class="de1"><pre class="de1"><span class="sc2">&lt;%@ Page <span class="kw3">Language</span><span class="sy0">=</span><span class="st0">&quot;C#&quot;</span> MasterPageFile<span class="sy0">=</span><span class="st0">&quot;~/admin.master&quot;</span> AutoEventWireup<span class="sy0">=</span><span class="st0">&quot;true&quot;</span> CodeFile<span class="sy0">=</span><span class="st0">&quot;CreatePerson.aspx.cs&quot;</span></span>
<span class="sc2"> &nbsp; &nbsp;Theme<span class="sy0">=</span><span class="st0">&quot;Profesional&quot;</span> Inherits<span class="sy0">=</span><span class="st0">&quot;Coordinator_People_CreatePerson&quot;</span> <span class="kw3">Title</span><span class="sy0">=</span><span class="st0">&quot;Create Users&quot;</span> %&gt;</span>
&nbsp;
<span class="sc2">&lt;asp:<span class="kw3">Content</span> <span class="kw3">ID</span><span class="sy0">=</span><span class="st0">&quot;Content1&quot;</span> ContentPlaceHolderID<span class="sy0">=</span><span class="st0">&quot;ContentPlaceHolder1&quot;</span> runat<span class="sy0">=</span><span class="st0">&quot;Server&quot;</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">div</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;spnStatFrame&quot;</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;display:none;&quot;</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">table</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;font-weight: bolder; vertical-align: middle; color: #FFFFFF; width: 32%; text-align: center;&quot;</span> <span class="kw3">cellpadding</span><span class="sy0">=</span><span class="st0">&quot;0&quot;</span> <span class="kw3">cellspacing</span><span class="sy0">=</span><span class="st0">&quot;0&quot;</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span>&gt;&lt;<span class="kw2">img</span> <span class="kw3">alt</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span> <span class="kw3">src</span><span class="sy0">=</span><span class="st0">&quot;../../images/tl-LightBlue.gif&quot;</span> <span class="kw3">height</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="kw3">width</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="sy0">/</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;background-color: #5BA2EB;&quot;</span>&gt;</span><span class="sc1">&amp;nbsp;</span><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span>&gt;&lt;<span class="kw2">img</span> <span class="kw3">alt</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span> <span class="kw3">src</span><span class="sy0">=</span><span class="st0">&quot;../../images/tr-LightBlue.gif&quot;</span> <span class="kw3">height</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="kw3">width</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="sy0">/</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">tr</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;background-color: #5BA2EB;&quot;</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span><span class="sc1">&amp;nbsp;</span><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span>&gt;&lt;<span class="kw2">span</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;spnStat&quot;</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">span</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span>&gt;</span><span class="sc1">&amp;nbsp;</span><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span>&gt;&lt;<span class="kw2">img</span> <span class="kw3">alt</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span> <span class="kw3">src</span><span class="sy0">=</span><span class="st0">&quot;../../images/bl-LightBlue.gif&quot;</span> <span class="kw3">height</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="kw3">width</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="sy0">/</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;background-color: #5BA2EB;&quot;</span>&gt;</span><span class="sc1">&amp;nbsp;</span><span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">td</span>&gt;&lt;<span class="kw2">img</span> <span class="kw3">alt</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span> <span class="kw3">src</span><span class="sy0">=</span><span class="st0">&quot;../../images/br-LightBlue.gif&quot;</span> <span class="kw3">height</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="kw3">width</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="sy0">/</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">table</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">div</span>&gt;</span>
&nbsp;
<span class="sc2">&lt;<span class="kw2">script</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text/javascript&quot;</span>&gt;</span>
&nbsp; &nbsp; var dv = document.getElementById(&quot;spnStatFrame&quot;);
&nbsp; &nbsp; var Spn = document.getElementById(&quot;spnStat&quot;);
&nbsp; &nbsp; 
&nbsp; &nbsp; function DisplayMessage(Message)
&nbsp; &nbsp; { &nbsp; if (Message !=&quot;&quot;){ &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dv.style.display = &quot;inline&quot;; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Spn.innerHTML = Message;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setTimeout(&quot;dv.style.display = 'none'&quot;, 300000);}
&nbsp; &nbsp; &nbsp; &nbsp; else
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dv.style.display = &quot;none&quot;; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; }
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">script</span>&gt;</span>
&nbsp;
<span class="sc2">&lt;<span class="kw2">div</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;p5&quot;</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;text-align:right&quot;</span>&gt;</span>
&nbsp; &nbsp; View all People <span class="sc2">&lt;<span class="kw2">a</span> <span class="kw3">href</span><span class="sy0">=</span><span class="st0">&quot;peopleV.aspx&quot;</span>&gt;&lt;<span class="kw2">img</span> <span class="kw3">alt</span><span class="sy0">=</span><span class="st0">&quot;View People&quot;</span> <span class="kw3">src</span><span class="sy0">=</span><span class="st0">&quot;../../images/id_card_view.png&quot;</span> <span class="kw3">title</span><span class="sy0">=</span><span class="st0">&quot;View all People&quot;</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;peopleVNavIcon&quot;</span><span class="sy0">/</span>&gt;&lt;<span class="sy0">/</span><span class="kw2">a</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">div</span>&gt;</span>
&nbsp;
&nbsp;
<span class="sc2">&lt;<span class="kw2">div</span>&gt;</span>
Create a
<span class="sc2">&lt;<span class="kw2">select</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;PersonType&quot;</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;PersonType&quot;</span> <span class="kw3">onchange</span><span class="sy0">=</span><span class="st0">&quot;javascript:go();&quot;</span>&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">selected</span><span class="sy0">=</span><span class="st0">&quot;selected&quot;</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span>&gt;</span>--Choose a Person Type--<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;InsertPerson.aspx?ptype=B&quot;</span>&gt;</span>Special Friend<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;InsertPerson.aspx?ptype=N&quot;</span>&gt;</span>Regular Person<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;InsertPerson.aspx?ptype=A&quot;</span>&gt;</span>Adult Volunteer<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -- other options --
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">select</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">div</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">iframe</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;myframe&quot;</span> <span class="kw3">scrolling</span><span class="sy0">=</span><span class="st0">&quot;no&quot;</span> <span class="kw3">marginwidth</span><span class="sy0">=</span><span class="st0">&quot;0&quot;</span> <span class="kw3">marginheight</span><span class="sy0">=</span><span class="st0">&quot;0&quot;</span> </span>
<span class="sc2"><span class="kw3">frameborder</span><span class="sy0">=</span><span class="st0">&quot;0&quot;</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;text-align: center; overflow: visible; </span></span>
<span class="sc2"><span class="st0"> &nbsp; &nbsp;width:710px; display: none;&quot;</span> &gt;&lt;<span class="sy0">/</span><span class="kw2">iframe</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">div</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;loading&quot;</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;more&quot;</span>&gt;</span>Loading...<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">div</span>&gt;</span>
&nbsp;
&nbsp; &nbsp; <span class="sc2">&lt;<span class="kw2">script</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text/ecmascript&quot;</span>&gt;</span>
&nbsp; &nbsp; var loading = document.getElementById(&quot;loading&quot;);
&nbsp; &nbsp; function go()
&nbsp; &nbsp; {
&nbsp; &nbsp; &nbsp; &nbsp; var SelInsert = document.getElementById(&quot;PersonType&quot;);
&nbsp; &nbsp; &nbsp; &nbsp; if(SelInsert.selectedIndex != 0){
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loading.style.display = 'block'
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var frm =loadintoIframe('myframe', SelInsert.options[SelInsert.selectedIndex].value);
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DisplayMessage(&quot;&quot;); &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; //setTimeout(&quot;loading.style.display = 'none'&quot;, 5000); &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; //var x=document.getElementById(&quot;myframe&quot;).contentDocument;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // This doesn't work for User Controls &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //document.frames[&quot;myframe&quot;].onload = function() {showReqFld(); };
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; } 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; } &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">script</span>&gt;</span>
&nbsp;
<span class="sc2">&lt;<span class="sy0">/</span>asp:Content&gt;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">&lt;%@ Page Language="C#" MasterPageFile="~/admin.master" AutoEventWireup="true" CodeFile="CreatePerson.aspx.cs"
    Theme="Profesional" Inherits="Coordinator_People_CreatePerson" Title="Create Users" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server"&gt;
&lt;div id="spnStatFrame" style="display:none;"&gt;
&lt;table style="font-weight: bolder; vertical-align: middle; color: #FFFFFF; width: 32%; text-align: center;" cellpadding="0" cellspacing="0"&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;img alt="" src="../../images/tl-LightBlue.gif" height="10" width="10" /&gt;&lt;/td&gt;
    &lt;td style="background-color: #5BA2EB;"&gt;&amp;nbsp;&lt;/td&gt;
    &lt;td&gt;&lt;img alt="" src="../../images/tr-LightBlue.gif" height="10" width="10" /&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr style="background-color: #5BA2EB;"&gt;
    &lt;td&gt;&amp;nbsp;&lt;/td&gt;
    &lt;td&gt;&lt;span id="spnStat"&gt;&lt;/span&gt;&lt;/td&gt;
    &lt;td&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
    &lt;td&gt;&lt;img alt="" src="../../images/bl-LightBlue.gif" height="10" width="10" /&gt;&lt;/td&gt;
    &lt;td style="background-color: #5BA2EB;"&gt;&amp;nbsp;&lt;/td&gt;
    &lt;td&gt;&lt;img alt="" src="../../images/br-LightBlue.gif" height="10" width="10" /&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;script type="text/javascript"&gt;
    var dv = document.getElementById("spnStatFrame");
    var Spn = document.getElementById("spnStat");
    
    function DisplayMessage(Message)
    {   if (Message !=""){         
            dv.style.display = "inline";        
            Spn.innerHTML = Message;
            setTimeout("dv.style.display = 'none'", 300000);}
        else
            dv.style.display = "none";            
            
    }
&lt;/script&gt;

&lt;div class="p5" style="text-align:right"&gt;
    View all People &lt;a href="peopleV.aspx"&gt;&lt;img alt="View People" src="../../images/id_card_view.png" title="View all People" class="peopleVNavIcon"/&gt;&lt;/a&gt;
&lt;/div&gt;


&lt;div&gt;
Create a
&lt;select id="PersonType" name="PersonType" onchange="javascript:go();"&gt;
                        &lt;option selected="selected" value=""&gt;--Choose a Person Type--&lt;/option&gt;
                        &lt;option value="InsertPerson.aspx?ptype=B"&gt;Special Friend&lt;/option&gt;
                        &lt;option value="InsertPerson.aspx?ptype=N"&gt;Regular Person&lt;/option&gt;
                        &lt;option value="InsertPerson.aspx?ptype=A"&gt;Adult Volunteer&lt;/option&gt;
            -- other options --
&lt;/select&gt;
&lt;/div&gt;
&lt;iframe id="myframe" scrolling="no" marginwidth="0" marginheight="0" 
frameborder="0" style="text-align: center; overflow: visible; 
    width:710px; display: none;" &gt;&lt;/iframe&gt;
&lt;div id="loading" class="more"&gt;Loading...&lt;/div&gt;

    &lt;script type="text/ecmascript"&gt;
    var loading = document.getElementById("loading");
    function go()
    {
        var SelInsert = document.getElementById("PersonType");
        if(SelInsert.selectedIndex != 0){
            loading.style.display = 'block'
            var frm =loadintoIframe('myframe', SelInsert.options[SelInsert.selectedIndex].value);
            DisplayMessage("");   
        //setTimeout("loading.style.display = 'none'", 5000);    
        //var x=document.getElementById("myframe").contentDocument;
          // This doesn't work for User Controls    
                
          //document.frames["myframe"].onload = function() {showReqFld(); };
          
        } 
                 
    }   
       
    &lt;/script&gt;

&lt;/asp:Content&gt;</pre></div></div>

<p>So, hopefully you see the logic of the pages. The CreatePerson page had a place to show an error message or a link if the insert worked correctly. From the InsertPerson page we manipulated the parent CreatePerson page and displayed the appropriate message (either the error message or a link to edit a newly inserted person).</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/webdev/webdesigngraphicsstyling/how-to-insert-information-into-multiple/'>How to insert information into multiple related tables and return ID using SQLDataSource</a><p>In the ASP.NET forums I'm frequent the question of inserting information into multiple related tables&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/mirroring-sql-server-2005-to-sql-server-2008/'>Mirroring SQL Server 2005 to SQL Server 2008 (Part 1)</a><p>Over the weekend I started writing my documentation and lab work for a few database&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Naomi Nosonovsky, Senior Software Developer, has more than 15 years of enterprise experience in analysis, design, development and implementation of high-performance client/server data management solutions.

She is a Personality of the Year for 2008, 2009, 2010 and 2011 at www.universalthread.com in .NET, SQL Server & VFP categories.

She is also an All Star contributor/MCC Community Contributor at forums.asp.net and MSDN T-SQL forum.


 
	



    

    


<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/?sk=messages&tid=1240691655679#!/profile.php?id=10395470" title="Naomi at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/profile?viewProfile=&key=55538716&trk=tab_pro" title="Naomi at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://delicious.com/http://delicious.com/naomi_nos" title="Naomi at delicious" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_delicious.png" alt="delicious" /></a><a href="/index.php/author/naomi/feed/" title="Blog RSS feed for Naomi" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 14,748 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/naomi/">Read More Posts by Naomi Nosonovsky</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&text=RT @LessThanDot Blog - How to return error messages from the SQL Server to the client using SQLDataSource by naomi" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&title=How to return error messages from the SQL Server to the client using SQLDataSource&source=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&title=How to return error messages from the SQL Server to the client using SQLDataSource" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&quote=How to return error messages from the SQL Server to the client using SQLDataSource" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/&title=How to return error messages from the SQL Server to the client using SQLDataSource" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		2 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-SQLDenis even thread-even depth-1" id="comment-3014">
				<div id="div-comment-3014" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/#comment-3014">
			July 25, 2010 at 12:06 pm</a>		</div>

		<p>At least you return an error, I can&#8217;t tell you how many times I have see code back in the day where the first thing was On Error Resume Next</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/?replytocom=3014#respond' onclick='return addComment.moveForm( "div-comment-3014", "3014", "respond", "854" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-3015">
				<div id="div-comment-3015" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/cd3057ea53cccfcab8b7ef18baa9faa9?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/cd3057ea53cccfcab8b7ef18baa9faa9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.kodyaz.com/articles/sql-string-manipulation-to-find-difference.aspx' rel='external nofollow' class='url'>Eralper</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/#comment-3015">
			July 29, 2010 at 11:38 pm</a>		</div>

		<p>Hello Naomi,<br />
Another great post of you. It is nice to gather the solution together for other ASP.NET developers to benefit from this article.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/?replytocom=3015#respond' onclick='return addComment.moveForm( "div-comment-3015", "3015", "respond", "854" )' aria-label='Reply to Eralper'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/webdev/webdesigngraphicsstyling/how-to-return-error-messages-from-the-sq/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='854' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="cf67355a3333e6e143439161adc2d82e"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552766015"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
