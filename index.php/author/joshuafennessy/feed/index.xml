<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>joshuafennessy &#8211; LessthanDot</title>
	<atom:link href="/index.php/author/joshuafennessy/feed/" rel="self" type="application/rss+xml" />
	<link>/</link>
	<description>A Technical Community for IT Professionals</description>
	<lastBuildDate>Sat, 09 Mar 2019 12:50:36 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>
	<generator>https://wordpress.org/?v=4.6.1</generator>
	<item>
		<title>Introducing Windows Azure Infrastructure as a Service</title>
		<link>/index.php/enterprisedev/entdev/entarch/introducting-windows-azure-infrastructure-as-1/</link>
		<comments>/index.php/enterprisedev/entdev/entarch/introducting-windows-azure-infrastructure-as-1/#respond</comments>
		<pubDate>Wed, 02 Oct 2013 17:41:00 +0000</pubDate>
		<dc:creator><![CDATA[joshuafennessy]]></dc:creator>
				<category><![CDATA[Architecture]]></category>

		<guid isPermaLink="false">/index.php/2013/10/introducting-windows-azure-infrastructure-as-1/</guid>
		<description><![CDATA[If you haven’t heard about Azure yet, I’d be surprised. Cloud based Platform applications like Windows Azure SQL Databases (WASDs) have been around for several years, and are becoming highly popular.  WASDs (for example) don’t quite have all of the same&#8230;]]></description>
				<content:encoded><![CDATA[<p>If you haven’t heard about Azure yet, I’d be surprised. Cloud based Platform applications like Windows Azure SQL Databases (WASDs) have been around for several years, and are becoming highly popular.  WASDs (for example) don’t quite have all of the same features as Infrastructure based SQL Server. For those times when you need infrastructure based technologies, but still want to leverage the portability and ease of provisioning benefits of cloud based computing, Windows Azure Infrastructure as a Service (Iaas) may offer a solution. And IasS is… That rack you have in your datacenter with a bunch of blades that runs your virtual environment – you know the one.  IaaS is that. Only bigger. Lots bigger. Massively big. The fact is, Windows Azure IaaS allows YOU to spin up any kind of virtual machine you wish – with a variety of different size options.  These machines run in a remote datacenter, and come with full RDP access as well as Remote PowerShell script access enabled. Managing these machines is easy and done over standard Internet connections. Really? How does all of this work? If you’re familiar with Hyper-V or VMWare technologies, it’s very similar to that. Essentially, there are large datacenters based worldwide. When you provision a new machine – that is, create a new server – a VHD is created using one of the predefined image templates or one you define on your own.  This machine is then housed in one of the Azure datacenter – should a disaster happen, The Azure infrastructure will handle moving it to another place that is not currently experiencing said disaster. So, as a SQL professional, what does this mean to me? Great question – Here are a few use cases to think about: If you’re building a new SQL environment, and want to have a place to test things, using Azure IaaS to temporarily build a DEV/TEST environment can be a quick way to get started. Azure IaaS machines are billed by the minute and only billed when powered on, so by managing the operational time of those environments costs can be easily managed. Azure IaaS can be used to extend your SQL environment. You can provision machines in the cloud to extend your AlwaysOn group. Joey D’antoni (b | t) talks about this as SQL Saturday. You can create virtual networks in IaaS to connect those machines that are in the cloud directly to your on premise network and use Azure as a remote datacenter. This can either be used in a DR plan, or to provide geocentric mirroring for users based worldwide. As Azure IaaS machines can be configured with different OSes like Windows or Linux, it can be a great option to run a Hadoop Cluster. This cluster can be easily scaled out during high processing times – like end of the month archival, and then scaled back during lower usage periods to help save costs What other options are there? I’d love to hear in the comments section at the bottom of this post. <!--[if !supportLineBreakNewLine]--> <!--[endif]--> How do I get started? Get started is pretty easy. First, you can get access to a free 30 day trial at http://www.windowsazure.com/ – before you can start creating any machines, you’ll need to make an account there.  Once your account is provisioned, you are all set to begin provisioning new machines. We’ll take a look at two options for creating those machines in the next segment.</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/enterprisedev/entdev/entarch/introducting-windows-azure-infrastructure-as-1/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>SQL Saturday #160 &#8212; To each end, a beginning</title>
		<link>/index.php/datamgmt/dbprogramming/mssqlserver/sql-saturday-160-to-each/</link>
		<comments>/index.php/datamgmt/dbprogramming/mssqlserver/sql-saturday-160-to-each/#comments</comments>
		<pubDate>Sun, 30 Sep 2012 23:56:00 +0000</pubDate>
		<dc:creator><![CDATA[joshuafennessy]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server]]></category>

		<guid isPermaLink="false">/index.php/2012/09/sql-saturday-160-to-each/</guid>
		<description><![CDATA[It’s over. I still can’t believe it.  Something that I’ve worked on so hard and cared for 6 months is over.  So many great things happened during the day, and so many great people were involved.  I’m going to use this space to try to thank everyone, and&#8230;]]></description>
				<content:encoded><![CDATA[<p class="MsoNormal"><span style="font-family: verdana,geneva;">It’s over. I still can’t believe it.  Something that I’ve worked on so hard and cared for 6 months is over.  So many great things happened during the day, and so many great people were involved.  I’m going to use this space to try to thank everyone, and give a respectful remembrance to the day of my life: Sept 22, 2012 – SQL Saturday #160 day.</span></p>
<h2 class="MsoNormal"><span style="font-family: verdana,geneva;"><strong style="mso-bidi-font-weight: normal;">So many people to thank….</strong></span></h2>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">Before I begin, I know I’m going to mess up and forget someone, please believe me when I say that it’s not on purpose.  The following Thank YOUs are not in any specific order.</span></p>
<p class="MsoNormal"><span style="text-decoration: underline;"><span style="font-family: verdana,geneva;"><em style="mso-bidi-font-style: normal;">Kalamazoo Valley Community College</em></span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">KVCC owns one of the most beautiful campuses I have had the pleasure of witnessing, Community College or no. The Student Commons area of the Texas Township campus is nothing short of amazing. It’s an indoor arboretum, and absolutely stunning.  I owe special thanks to Dawn Pantaleo – <em style="mso-bidi-font-style: normal;">Faculty Advisor to AITP</em>, Mary Johnson – <em style="mso-bidi-font-style: normal;">Student Activities and Program Coordinator </em>and John Burns – <em style="mso-bidi-font-style: normal;">KVCC Faculty</em>.  You were all INCREDIBLY pivotal in pulling this event off, and I can’t thank you enough for your time and patience.</span></p>
<p class="MsoNormal"><span style="text-decoration: underline;"><span style="font-family: verdana,geneva;"><em style="mso-bidi-font-style: normal;">Tim and Amy Ford and Family</em></span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">Tim and Amy once again opened their doors to a bunch of SQL Server professionals and not only let us host a speaker gathering the night before the event, but also an impromptu gathering after the official after party.  I know we were loud, and your house is probably still not in the condition that you are used to.  Your family is amazing, and I could thank you every day for a year, and it still would not be enough.  (Have I said Thank You yet today?)</span></p>
<p class="MsoNormal"><span style="text-decoration: underline;"><span style="font-family: verdana,geneva;"><em style="mso-bidi-font-style: normal;">Shelly Noll</em></span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">If I had a “right hand” in planning this event, it would be Shelly.  Not only did she put up with my late night ideas, she also helped to reign me in to ensure that I didn’t try to take on more than I could handle. In addition to keeping me in check, Shelly also volunteered to be the Sponsor Coordinator, ensuring that the sponsors had everything they needed I the days leading up to the event, as well as the day of.  Thanks Shelly, and I look forward to working with you in the future, if you’ll agree to it again.</span></p>
<p class="MsoNormal"><span style="text-decoration: underline;"><span style="font-family: verdana,geneva;"><em style="mso-bidi-font-style: normal;">Joe Fleming</em></span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">I asked Joe to help to act as my volunteer coordinator pretty late in the game, and in true “Joe” style, he agreed with bounds of enthusiasm. Joe and I worked together a few weeks before the event to design a Volunteer plan and held a series of meetings to ensure that everyone knew what their roles would be.  Joe was able to successfully run at team of 15 people with minimal instruction from me.  Thanks Joe. I look forward to working further with you on our various projects!</span></p>
<p class="MsoNormal"><span style="text-decoration: underline;"><span style="font-family: verdana,geneva;"><em style="mso-bidi-font-style: normal;">SQLPass and Karla Landrum</em></span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">SQLPass has created an EXCELLENT brand with SQL Saturday.  In addition to that, they have created a wonderful set of tools to make it EASY for organizers to plan these events.  Not only that, but they have employed a true gem, Karla Landrum, to ensure that organizers are NOT ALONE, have support, and are equipped with the knowledge they need to successfully execute a large format event.  Thank you Karla for taking my crazy questions in stride, and helping ME to look like an old pro at holding events.</span></p>
<p class="MsoNormal" style="margin-left: 1in; text-indent: -1in;"><span style="text-decoration: underline;"><span style="font-family: verdana,geneva;"><em style="mso-bidi-font-style: normal;">The Presenters</em></span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">I am still amazed at the schedule that we were able to put together.  It was completely 100% amazing, and I thank each one of the presenters for volunteering your time to help provide world-class traning to the West MI Community. Each speaker paid their own way to get to Kalamazoo, so in addition to to time, many also have a significant financial investment into this event.  Thank you. I hope you enjoy the jacket, and don’t forget to bring it to Seattle in November!  Let’s have #sqlsat160 dominate SQL Saturday shirt day!</span></p>
<p class="MsoNormal"><span style="text-decoration: underline;"><span style="font-family: verdana,geneva;"><em style="mso-bidi-font-style: normal;">The Volunteers</em></span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">We had a volunteer team this year that was nothing short of excellent.  Pulled together in the final weeks before the event, they operated like a well-oiled machine.  Manning the registration desk, helping speakers get ready in their rooms, ensuring lunch ran without a hitch.  I can’t thank you all enough.  I am so appreciative of the time you offered during the day, and I hope that you all were still able to attend those sessions that interested you the most.  Thank you!</span></p>
<p class="MsoNormal"><span style="text-decoration: underline;"><span style="font-family: verdana,geneva;"><em style="mso-bidi-font-style: normal;">The Sponsors</em></span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">My final thank you goes to our amazing sponsors.  Without your support, this event could’ve never happened.  It’s no secret that pulling off a successful one day training event for over 250 people costs a significant amount of money.  Thank you for offering those financial resources to ensure a successful day.  I hope that you all had a great number of visitors and will consider sponsoring again next year!</span></p>
<h2 class="MsoNormal"><span style="font-family: verdana,geneva;"><strong style="mso-bidi-font-weight: normal;">Event Recap</strong></span></h2>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">SQL Saturday “day” actually started on Friday morning for me.  Knowing that I would have a lot of things to focus on starting Friday afternoon, I decided to take some “me” time and head out for a run.  1.5 hours and 7 miles later, I was feeling refreshed but tired, and ready to attack the day. </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">After a quick shower, I packed up the remainder of SQL Saturday stuff and made the 2 hour trip to Kalamazoo for the weekend.  I arrived early enough to head to Tim and Amy’s house to help get a couple of tables set up for dinner, and some initial bag stuffing.  I headed to KVCC to talk to the volunteer team and make sure that the event bag stuffing was going well and also to walk the classrooms.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">On my way there, I received a phone call from Joe Fleming, my volunteer coordinator. “We don’t’ have any lanyards here.”  LANYARDS!!  I left the lanyards at home, two hours away.  There was no way I could make it home and back before the speaker dinner.  Luckily I was able to get ahold of some family members and they were able to “get” into my house and meet me halfway.  So I only ate up two hours of time instead of four.  Big thanks to Joe and Shelly for covering for me while I made that trip, and also to my family members for making a trip for me.<br /></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">The speaker dinner, which was held and Tim and Amy Ford’s house, was a nice relaxing meal catered by local Kalamazoo company Que-It-Up.  They make all of the food onsite, and included fresh made fire roasted salsa, brisket, chicken, vegetarian pintos/green beans, bread, chips…the works.  It was a wonderful dinner.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">After eating, we enjoyed some billiards and a little impromptu Rock Band session before calling it a <em>relatively</em> early night.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">I of course, accidentally slept in the morning of the event – thanks to a dead cell phone battery.  Still, I arrived JUST in time for a quick meeting with the volunteers, and to help with the last 30 minutes of set up before the doors opened. </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">We had fresh made donut holes, energy bars, and coffee for breakfast lined up to welcome our attendees and at 8:30 everyone gathered into the theatre room where I made some morning announcements.  We had a few new features at SQL Saturday Kalamazoo this year, and I wanted to make sure to cover them all.</span></p>
<ul>
<li><span style="font-family: verdana,geneva;"><span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;"> </span>Spotlight sessions – we had two double length sessions, one by Eddie Wuerch and the other by Rob Kerr</span></li>
<li><span style="font-family: verdana,geneva;">Resume Review service – TekSystems came on site to review resumes and make suggestions for improvements with no strings attached</span></li>
<li><span style="font-family: verdana,geneva;">Hourly give-a-ways – Between each session, tickets were drawn for a chance to win a custom messenger bag which included a T-Shirt and a flash drive of either 8GB or 32GB capacity.</span></li>
</ul>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">Then, just like that, the sessions were rolling.  I didn’t attend much, but rather walked around and made sure that everything was covered.  After the first couple of hours were completed, it was time to set up for the lunch arrival.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">This year, we went with Taco Bob’s a local catering company specializing in a wonderful taco buffet.  One of my goals this year was to provide a meal that would cater to everyone.  This turned out to be a great choice and vegetarians and non-vegetarians were able to share the same meal, and no one felt left out of a hot lunch.  I urge other organizers to attempt to do the same.  The last thing anyone wants is a veggie wrap, while everyone else is eating a delicious looking catered lunch.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">The rest of the day executed perfectly.  There really was very few issues for me to track down, and most were so minor that not many even knew they existed.  The final big part of the day was the raffle!  Due to the overwhelming response we had from sponsors this year, we had a lot to give away!  I’m so happy for all of the winners, and I hope you are enjoying the various bits of technology and training materials that you received.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">The after party was once again held at the Kalamazoo Beer Exchange – a local sports bar with an interesting twist on pricing.  The draft beer price is dynamically set buy the sales of the previous 15 minutes.  I know I’d sure like to get my hands on that algorithm to see how it works.  Unfortunately, it was awfully busy there, and not all of us got fed.  So, a few of us retreated back to Tim and Amy’s house for some speaker dinner leftovers, and a really amazing game &#8212; Cards Against Humanity.  Laughter roared through the house, and I’m sure we disturbed Tim’s children more than once.  Thanks again to Tim and Amy for letting us all invade.</span></p>
<h2 class="MsoNormal"><span style="font-family: verdana,geneva;"><strong style="mso-bidi-font-weight: normal;">Final Thoughts</strong></span></h2>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">I’m still having a hard time believing that it’s all over for this year.  The day after it was done, I was ready to start planning the next one.  I still am.  Watch out Kalamazoo, the #sqlfamily is coming back in 2013.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"> </span></p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbprogramming/mssqlserver/sql-saturday-160-to-each/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Calculating Week-To-Date values using DAX</title>
		<link>/index.php/datamgmt/datadesign/calculating-week-to-date-values/</link>
		<comments>/index.php/datamgmt/datadesign/calculating-week-to-date-values/#comments</comments>
		<pubDate>Thu, 06 Sep 2012 01:17:00 +0000</pubDate>
		<dc:creator><![CDATA[joshuafennessy]]></dc:creator>
				<category><![CDATA[Data Modelling and Design]]></category>
		<category><![CDATA[SSAS]]></category>

		<guid isPermaLink="false">/index.php/2012/09/calculating-week-to-date-values/</guid>
		<description><![CDATA[The expression language of Tabular Mode SSAS – DAX – provides several great time intelligence functions.  One of those it does not provide though a composite function – like DATESMTD or DATESQTD – is one to calculate Week-To-Date summations.  To calcula&#8230;]]></description>
				<content:encoded><![CDATA[<p class="MsoNormal"><span style="font-family: verdana,geneva;">The expression language of Tabular Mode SSAS – DAX – provides several great time intelligence functions.  One of those it does not provide though a composite function – like DATESMTD or DATESQTD – is one to calculate Week-To-Date summations.  To calculate this type of value, a custom expression using the DATESBETWEEN function is needed.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">In this post, I’ll show you what inputs are needed for the DATESBETWEEN function, how to create a custom start date using DAX, and how to implement this solution in your Tabular Model.  Note that this solution will also work with PowerPivot for Excel, but the examples show will be using SQL Server Data Tools.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">First, let’s take a look a simple model I have here: </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"><img src="/wp-content/uploads/users/joshuafennessy/1.png?mtime=1346900843&quot;&gt;&lt;img alt=&quot;&quot; src=&quot;/wp-content/uploads/users/joshuafennessy/1.png" alt="" /><br /></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"> </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">One <em style="mso-bidi-font-style: normal;">fact</em> table &#8212; Internet Sales – which relates to a single dimension – Dates.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">This model has the correct relationships created, as well as the Dates table being marked as the <em style="mso-bidi-font-style: normal;">Date Table</em> of the model, and the field <em style="mso-bidi-font-style: normal;">Actual Date</em> flagged as the date field.  With these steps complete I can begin building the pieces I need to create my Week-To-Date calculation.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">The DATESBETWEEN function requires three parameters;</span></p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left: 38.25pt; text-indent: -0.25in;"><span style="font-family: verdana,geneva;">·<span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;"> </span>A list of dates</span></p>
<p class="MsoListParagraphCxSpMiddle" style="margin-left: 38.25pt; text-indent: -0.25in;"><span style="font-family: verdana,geneva;">·<span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;"> </span>the start date</span></p>
<p class="MsoListParagraphCxSpLast" style="margin-left: 38.25pt; text-indent: -0.25in;"><span style="font-family: verdana,geneva;">·<span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;"> </span> the end date. </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">In this calculation, I want to use the <em style="mso-bidi-font-style: normal;">week start date</em> in the second parameter, and the currently selected date in the third parameter.  Let’s take a look at how to create the <em style="mso-bidi-font-style: normal;">week start date</em>.</span></p>
<h3 class="MsoNormal"><span style="font-family: verdana,geneva;">Creating the Week Start Date</span></h3>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">In order to create the <em style="mso-bidi-font-style: normal;">week start date</em> I need to first decide what day my week starts on.  For example purposes, let’s pick Tuesday.  To support this, first I need to add a column that contains the <em style="mso-bidi-font-style: normal;">DayNameOfWeek</em> value.  Use the following expression in a calculated field:<br /></span></p>
<p class="MsoNormal"><span style="font-family: courier new,courier;"> =FORMAT(‘Dates’[ActualDate], “dddd”)</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">Note that my Dates table now looks like this:</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"><img src="/wp-content/uploads/users/joshuafennessy/2.png" alt="" /><br /></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"> </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">Next I need to create an expression that will return to me the previous <em style="mso-bidi-font-style: normal;">Tuesday</em> for every date in my table.  Again, I need to create a new column.  The expression to do this is a bit more complicated.  It uses the EARLIER function, which recursively scans the table.</span></p>
<p class="MsoNormal"><span style="font-family: courier new,courier;"><span style="font-size: 9pt; line-height: 115%;">=CALCULATE(<br /> MAX(Dates[ActualDate]),<br /> FILTER(ALL(Dates), <br /> Dates[DayNameOfWeek]=&#8221;Tuesday&#8221; &amp;&amp; <br /> Dates[ActualDate] &lt;= EARLIER(Dates[ActualDate])<br /> )<br /> )</span></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">This function is using a clever switching of filtering context to return a set of dates less than the current date, and filter that to include only Tuesdays.  Then, with that set handy, the MAX() function is used to return the latest Tuesday.  This equates to the latest Tuesday less than the current date; or in other words, last Tuesday.  My Dates table now looks like this…</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"><img src="/wp-content/uploads/users/joshuafennessy/3.png" alt="" /><br /></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"> </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">Now that I have a start date AND an end date.  I can finally write my Week-To-Date calculation.  To do this switch over to the fact table and create a new calculation.</span></p>
<h3 class="MsoNormal"><span style="font-family: verdana,geneva;">Creating the Week-To-Date calculated measure</span></h3>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">In my InternetSales table, I want to create the following calculated measure:</span></p>
<p class="MsoNormal"><span style="font-family: courier new,courier;">[Sales WTD]:=CALCULATE(</span><br /><span style="font-family: courier new,courier;"> SUM(&#8216;Internet Sales'[SalesAmount]),                         <br /> DATESBETWEEN(          <br /> Dates[ActualDate],<br /> LASTDATE(Dates[WeekStartDate]), <br /> LASTDATE(Dates[ActualDate])</span><span style="font-family: courier new,courier;"><br /> )<br /> );</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">With all of the ground work done in the date table, this expression ends up to be pretty easy!  It’s simply calculating the SUM of [SalesAmount] over a filtered set of DATESBETWEEN() our predefined start date and the end date selected on a report.  Note that in order for this to work, the LASTDATE() function will need to be used.  The DATESBETWEEN() function expects a date value, not a column.  With this calculation created, I can browse the model in Excel and see that it is correctly calculating values.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"><img src="/wp-content/uploads/users/joshuafennessy/4.png" alt="" /><br /></span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"> </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"> </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"> </span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;">If you would like to see this in action, I’ve created a version of this in PowerPivot.  You can download it <a href="https://skydrive.live.com/redir?resid=B33397EE4D528C9A!9620" target="_blank">here</a>.</span></p>
<p class="MsoNormal"><span style="font-family: verdana,geneva;"> </span></p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/datadesign/calculating-week-to-date-values/feed/</wfw:commentRss>
		<slash:comments>4</slash:comments>
		</item>
		<item>
		<title>SQL Saturday #126 (Indy) &#8211; Tabular Mode SSAS</title>
		<link>/index.php/datamgmt/datadesign/sql-saturday-126-indy-tabular/</link>
		<comments>/index.php/datamgmt/datadesign/sql-saturday-126-indy-tabular/#comments</comments>
		<pubDate>Thu, 26 Jul 2012 13:29:00 +0000</pubDate>
		<dc:creator><![CDATA[joshuafennessy]]></dc:creator>
				<category><![CDATA[Data Modelling and Design]]></category>

		<guid isPermaLink="false">/index.php/2012/07/sql-saturday-126-indy-tabular/</guid>
		<description><![CDATA[SQL Saturday #126 is ALMOST HERE!  I've been looking forward to this event for a long time, and I'm excited to be selected as a presenter.
Join me this Saturday, 7/28/2012, in Indianapolis, IN for an introduction to Tabular Mode SSAS in SQL 2012.  We'l&#8230;]]></description>
				<content:encoded><![CDATA[<p><img style="float: left; margin-left: 5px; margin-right: 5px;" src="http://cdn.memegenerator.net/instances/400x/23994657.jpg" alt="" width="301" height="194" /></p>
<p>SQL Saturday #126 is ALMOST HERE!  I&#8217;ve been looking forward to this event for a long time, and I&#8217;m excited to be selected as a presenter.</p>
<p>Join me this Saturday, 7/28/2012, in Indianapolis, IN for an introduction to Tabular Mode SSAS in SQL 2012.  We&#8217;ll spend lots of time talking about the Business Intelligence Semantic Model and what it means for you as a developer and for users as well.</p>
<p>You may have heard that building tabular models is fast?  We&#8217;ll find out just HOW fast it can be as we build a model from the ground up all while under the stopwatch.</p>
<p>Wondering whether your new project should be created as a tabular or multi-dimensional model?  We&#8217;ll talk about differences and limitations of both modeling paradigms, and I&#8217;ll offer up some suggestions on when to use which.</p>
<p>I hope you can join me at 1:00 PM at SQL Saturday #126 in Indianapolis, IN.  I look forward to seeing you there!</p>
<p>-Josh</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<p><em><strong>Update</strong></em></p>
<p>Thank you all who attended my session!  If you would like a copy of my slides/database project please see the following links:</p>
<p>Slides &#8212; http://sdrv.ms/OZgEL1<br />Database Project &#8212; http://sdrv.ms/O4yoDx</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/datadesign/sql-saturday-126-indy-tabular/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>&#8220;Connect&#8221; an Excel 2010 Slicer to an unrelated object.</title>
		<link>/index.php/datamgmt/datadesign/connect-a-slicer-to-an/</link>
		<comments>/index.php/datamgmt/datadesign/connect-a-slicer-to-an/#comments</comments>
		<pubDate>Tue, 24 Jul 2012 01:15:00 +0000</pubDate>
		<dc:creator><![CDATA[joshuafennessy]]></dc:creator>
				<category><![CDATA[Data Modelling and Design]]></category>
		<category><![CDATA[Excel Reporting]]></category>

		<guid isPermaLink="false">/index.php/2012/07/connect-a-slicer-to-an/</guid>
		<description><![CDATA[Slicers are super cool!  By extending the power of filtering to apply to multiple PivotTables (or PivotCharts) they have really increas ed the reporting and data delivery power of Excel 2010.  Not only do they look cool and are fun to interact with, the&#8230;]]></description>
				<content:encoded><![CDATA[<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;">Slicers are sup</span><span style="font-family: tahoma,arial,helvetica,sans-serif;"><a href="/media/users/joshuafennessy/Slicer.png?mtime=1343099573"><img style="float: left;" src="/wp-content/uploads/users/joshuafennessy/Slicer.png?mtime=1343099573" alt="" width="167" height="223" /></a></span><span style="font-family: tahoma,arial,helvetica,sans-serif;">er cool!  By extending the power of filtering to apply to multiple PivotTables (or PivotCharts) they have really increas</span><span style="font-family: tahoma,arial,helvetica,sans-serif;"> </span><span style="font-family: tahoma,arial,helvetica,sans-serif;">ed the reporting and data delivery power of Excel 2010.  Not only do they look cool and are fun to interact with, t</span><span style="font-family: tahoma,arial,helvetica,sans-serif;"></span><span style="font-family: tahoma,arial,helvetica,sans-serif;">hey are also extremely functional.  The fact that you can indeed apply a slicer value to multiple PivotTable objects was a big step forward for Excel based dashboarding and reporting.  I’ve used them in nearly every Excel 2010 report that I’ve written since the product release.</span></p>
<p><span style="font-family: tahoma,arial,helvetica,sans-serif;">One thing that they are not so good at doing</span> <span style="font-family: tahoma,arial,helvetica,sans-serif;">is interacting with objects that are based on a different data source.  I know, you’re going to say “But THAT’S how they are designed!”  Sure, it’s true that they are, but as data developers we are often asked to do the impossible (or the improbable)</span></p>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;">Often, I’ve had to tell users that “this isn’t possible”.  Connecting a slicer to an object created from a different data source was one of those things.  I finally ran into a situation that I couldn’t just brush off as “impossible”.  I was working on some Excel reporting that used PivotTables based on a TSQL query.  I needed to create a slicer based on one of the data sets and have it interact with the other. </span></p>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;">I decided that I was going to solve this problem, and solve it I did.  It DOES require the use of VBA, which I normally try to avoid, but in this case, it was the right solution.  Let’s take a look at the anatomy of this solution.</span></p>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;"><strong>The Players</strong></span></p>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;">First, we have to take note of some of the objects that we are going to be interacting with.</span></p>
<ul>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;"><span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;"> </span>ActiveWorkbook – The currently open Excel workbook.</span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">Slicer – A slicer object embedded in the worksheet.  It will have a name (typically <em>SlicerN</em> where <em>N</em> is a number designating which order it was placed)</span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;"><span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7pt; line-height: normal; font-size-adjust: none; font-stretch: normal;"> </span>PivotTable –A PivotTable object embedded in a report (see naming above)</span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">PivotField – A specific field in the PivotTable</span></li>
</ul>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;"><strong>The Order of Operations</strong></span></p>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;">In order to complete this solution, some understand of what needs to be done is required.  Here is the basic order of operations required to make this happen:</span></p>
<ol>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">Identify all of the correct objects in play<br /></span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">Collect a list of selected values in the slicer object</span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">Find the correct field to filter on in the PivotTable.  This field NEEDS to be what’s known as a PAGE type field.  Most commonly, this is a field in the FILTERS section of the PivotTable.</span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">Pass the list of selected values to the PivotTable object.  <strong> </strong></span></li>
</ol>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;"><strong>Only a few Limitations:</strong></span></p>
<ul>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">OLAP data sources can accept multiple slicer values.  Non-OLAP data sources can only accept ONE slicer value</span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">As this solution works with strings, the values in the slicer NEED to match the values in the PivotObject  Creating them based on the same field should ensure this to be the case.</span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">This does require a macro-enable workbook, which can cause an extra layer of security to be used in collaboration scenarios.</span></li>
<li><span style="font-family: tahoma,arial,helvetica,sans-serif;">Slicers with extremely large number of filter options may cause performance issues.</span></li>
</ul>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;"><strong>The code</strong></span></p>
<p class="MsoNormal"><span style="font-family: tahoma,arial,helvetica,sans-serif;">Ok, this is where we get a little technical.  Here is the basic code needed to pass a <strong>SINGLE</strong> slicer value to a PivotTable.  Modification would need to be made &#8212; and are shown in comments – to allow for multiple values to be passed.  <strong>REMEMBER.  THIS IS IMPORTANT!</strong> Multiple values can ONLY be passed if the data source is from an OLAP database.  This is from the Excel Object Model documentation.  If you try to pass multiple values to a non-OLAP source object, a run-time error will occur.</span></p>
<p> </p>
<pre>' Author:     Josh Fennessy (http://www.joshuafennessy.com)/</pre>
<pre>'</pre>
<pre>' This short method will allow a value from a selected slicer to be</pre>
<pre>' passed to a PivotObject that is connected to a different data source</pre>
<pre>' Since this is based on string matching, data would need to be indentical</pre>
<pre>' from the two sources.</pre>
<pre>'</pre>
<pre>' Use cases for this could be PivotObject based on different T-SQL queries or</pre>
<pre>' cubes/perspectives in the same SSAS database.</pre>
<pre>&lt;br /&gt;' We want this code to fire with an object connected to our slicer</pre>
<pre>' is updated.  This means that the slicer was likely interacted with.</pre>
<pre>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)</pre>
<pre>    </pre>
<pre>    'find the right object in the workbook. AKA: The Source</pre>
<pre>    If Target.Name = "PivotTable0" Then</pre>
<pre>    </pre>
<pre>        Dim objSlicerItem As SlicerItem</pre>
<pre>        Dim ptSummary As PivotTable</pre>
<pre>        Dim ptField As PivotField</pre>
<pre>        Dim objField As PivotField</pre>
<pre>        Dim strValues() As String</pre>
<pre>        'Dim intIndex as Integer</pre>
<pre>        </pre>
<pre>        'get a reference to the PivotTable to be filtered  AKA: The Target</pre>
<pre>        Set ptSummary = Worksheets("Sheet1").PivotTables("Sheet1")</pre>
<pre>                </pre>
<pre>        'locate the correct field (by name) to be filtered</pre>
<pre>        'this field MUST be a "page" type -- on a normal PivotTable this</pre>
<pre>        'is the FILTERS section</pre>
<pre>        For Each ptField In ptSummary.PageFields</pre>
<pre>            If ptField.Name = "Field1" Then</pre>
<pre>                 Set objField = ptField</pre>
<pre>            End If</pre>
<pre>        Next</pre>
<pre>                        </pre>
<pre>        'intIndex = 1</pre>
<pre>                </pre>
<pre>        'loop through each item in the slicer and check to see if it's selected</pre>
<pre>        'if so, add it to the current pages property of the field selected above</pre>
<pre>        For Each objSlicerItem In ActiveWorkbook.SlicerCaches.Item(1).SlicerItems</pre>
<pre>            </pre>
<pre>            If objSlicerItem.Selected = True Then</pre>
<pre>                ''NOTE: The following commented code is for use with PivotTables connected to an OLAP source</pre>
<pre>                </pre>
<pre>                'ReDim Preserve strValues(1 To intIndex)</pre>
<pre>                'strValues(intIndex) = objSlicerItem.Value</pre>
<pre>                'intIndex = intIndex + 1</pre>
<pre>                </pre>
<pre>                'this is for setting a single filter value -- required for non-olap sources</pre>
<pre>                objField.CurrentPage = objSlicerItem.Value</pre>
<pre>            End If</pre>
<pre>        Next</pre>
<pre>        </pre>
<pre>        ''NOTE: If working with a PivotTable connected to an OLAP source</pre>
<pre>        ''      You can set the CurrentPageList property to a string array</pre>
<pre>        ''      of values.  The EnableMultiplePageItems property also</pre>
<pre>        ''      needs to be set to TRUE.</pre>
<pre>        </pre>
<pre>        ''      This means that when working with non-OLAP sources, only single</pre>
<pre>        ''      select filters are enabled.  Important to note when working with</pre>
<pre>        ''      slicers.</pre>
<pre>        </pre>
<pre>        'objField.EnableMultiplePageItems = True</pre>
<pre>        </pre>
<pre>        ''use the following command to clear all filters before setting new values</pre>
<pre>        ''important when setting multi-value filters.</pre>
<pre>        </pre>
<pre>        'objField.ClearAllFilters</pre>
<pre>        'objField.CurrentPageList = strValues()</pre>
<pre>&lt;br /&gt;    End If</pre>
<pre>    </pre>
<pre>End Sub</pre>
<p> </p>
<p class="MsoNormal">
<p></p>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/datadesign/connect-a-slicer-to-an/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>TSQL Tuesday #32 &#8211; A wicked fun day.</title>
		<link>/index.php/itprofessionals/itprocesses/tsql-tuesday-a-wicked-fun/</link>
		<comments>/index.php/itprofessionals/itprocesses/tsql-tuesday-a-wicked-fun/#respond</comments>
		<pubDate>Wed, 18 Jul 2012 00:09:00 +0000</pubDate>
		<dc:creator><![CDATA[joshuafennessy]]></dc:creator>
				<category><![CDATA[IT Processes]]></category>
		<category><![CDATA[Professional Development]]></category>

		<guid isPermaLink="false">/index.php/2012/07/tsql-tuesday-a-wicked-fun/</guid>
		<description><![CDATA[Erin Stellato (blog &#124; twitter) announced the most recent incaration of TSQL Tuesday a couple of weeks ago.  A Day in the Life.  A very interesting topic indeed.  I knew I wanted to participate, but I didn't want it to be a normal day, as those are litte&#8230;]]></description>
				<content:encoded><![CDATA[<p>Erin Stellato (<a href="http://erinstellato.com/">blog</a> | <a href="http://twitter.com/erinstellato">twitter</a>) announced the most recent incaration of TSQL Tuesday a couple of weeks ago.  <a title="TSQL Tuesday: A Day in the Life" href="http://erinstellato.com/2012/07/invitation-for-tsql-tuesday-day-life/" target="_blank">A Day in the Life</a>.  A very interesting topic indeed.  I knew I wanted to participate, but I didn&#8217;t want it to be a normal day, as those are littered with meals, work, and answering a billion questions from a 6 year old mind..</p>
<p>I knew I had a trip to Boston coming up, so I thought, hey, I should chronicle a day on the road.</p>
<p>I&#8217;m going to actually follow a proper 24 hour day, starting at 9pm on Monday 7/16, finishing on 9pm Tuesday 7/17. Here goes&#8230;</p>
<p><strong>Monday </strong></p>
<p><strong>9:00 pm </strong> &#8212; I&#8217;m in Baltimore at the airport.  THERE ARE CHARGING STATIONS EVERYWHERE.</p>
<p><strong>9:15 pm</strong> &#8212; Wrapped up a call with a coworker sharing a Cognos migration story</p>
<p><strong>9:30 pm </strong>&#8212; Time to leave.  Where&#8217;s the plane?</p>
<p><strong>9:55 pm</strong> &#8212; Oh, there it is.</p>
<p><strong>10:15 pm</strong> &#8212; Airborne.</p>
<p><strong>11:52 pm</strong> &#8212; Deplaning at Logan</p>
<p><strong>Tuesday</strong></p>
<p><strong>12:05 am</strong> &#8212; Got my bags</p>
<p><strong>12:30 am</strong> &#8212; Hey look, there are only minivans left.  Sweet.  Damn this thing is comfortable.  It feels wrong, but oh so right.</p>
<p><strong>1:15 am</strong> &#8212; Nice room.  Got a suite with a kitchen so I can cook instead of going out.</p>
<p><strong>1:45 am</strong> &#8212; Log in to work.  Index rebuild finished.  Check various other things, enter my time for the day.</p>
<p><strong>2:30 am</strong> &#8212; Sleep</p>
<p><strong>7:30 am</strong> &#8212; I&#8217;m up.  Not happy.</p>
<p><strong>8:30 am</strong> &#8212; Ok, I&#8217;m fed and on my way to my client.</p>
<p><strong>8:40 am</strong> &#8212; Wait, wasn&#8217;t that my exit.</p>
<p><strong>9:00 am</strong> &#8212; Finally here.</p>
<p><strong>9:05 am</strong> &#8212; 5th floor.  Hand the IT manager a &#8216;bag of Kerberos&#8217;.  Inside joke.  Laughter ensues</p>
<p><strong>9:15 am</strong> &#8212; Logged in, whiteboarding already.  Working through execution paths for ETL processes.  Making <br /> sure that timing of all data files are scheduled correctly.</p>
<p><strong>9:25 am</strong> &#8212; Discussed some new data irregularities.  Worked through solution on whiteboard.  Minor changes <br /> will be required, mostly to a couple of queries.  SSIS work <em>probably</em> won&#8217;t be needed.</p>
<p><strong>9:45 am</strong> &#8212;  Showed off some of the ETL and auditing reports I&#8217;ve implemented.  Discussed a few new <br /> features that we would like to add.</p>
<p><strong>10:30 am</strong> &#8212; Reviewing latest data load.  Something seems off with a few of the fields.  A handful of them are <br /> correct, but the data is right in the final 3 fields. This is sourced from COBOL fixed width files, so <br /> either my code that parses the file is off  a bit, the mapping document is off.  Working out which <br /> one it is.</p>
<p><strong>11:30 am</strong> &#8212; Manually parsing through fixed width COBOL output is hard.</p>
<p><strong>11:45 am</strong> &#8212; It&#8217;s my code.  Correct quickly made and deployed to DEV.</p>
<p><strong>12:00 pm</strong> &#8212; Code executed.  Looks much better.</p>
<p><strong>12:30 pm</strong> &#8212; Lunch.  Roast Beef panini.  Yum.</p>
<p><strong>12:45 pm</strong> &#8212; Everyone is making jokes about Twitter.  I show them #sqlhelp.  3 of the 4 are now on Twitter.</p>
<p><strong>1:00 pm</strong> &#8212; Back for some new ETL development that we discovered.  I&#8217;m mentoring this client a bit, so we      <br /> did some of the work together.  Really enjoyed watching his face when &#8220;it clicked&#8221;.</p>
<p><strong>2:00 pm</strong> &#8212; Working through some questions on the data warehouse load.  Originally we were going to load <br /> by date, but it appears that we are going to have to load by date and SystemCode.  A wrinkle, but <br /> nothing too major.</p>
<p><strong>3:00 pm</strong> &#8212; After finally having enough of dealing with poor performance of the dev server, decided with <br /> client&#8217;s support to set memory limits on SQL.  6GB should be enough for now.  At least we&#8217;ll have <br /> some free RAM so the server isn&#8217;t paging constantly.  Things seem a bit better.  Server is still <br /> WAY to small to be working with a dataset of this size, but at least I can open SSMS now.</p>
<p><strong>3:30 pm</strong> &#8212; Meeting to discuss project status, as well as some other things on a list they have going.  The IT <br /> manager is extremely interested in Kerberos as he is getting lots of conflicting stories internally <br /> about how it works.  I tell him about DelegConfig.  He is ecstatic.  Interal resources mentioned <br /> that there would be now way of testing the infrastructure after configuration. I think he&#8217;s going <br /> to keep it in his back pocket and use it when the time is right.</p>
<p><strong>4:00 pm </strong>&#8212;  Hmmm, test job failed&#8230;.this isn&#8217;t good.</p>
<p><strong>4:10 pm</strong> &#8212;  Appears that tempdb is suffering some issues with an ACTIVE_TRANSACTION status in the <br /> log_reuse_wait_description column.  To the boogle!</p>
<p><strong>4:45pm</strong> &#8212; Still nothing really, confused.  Client finds Robert Davis&#8217; ( <a title="Robert Davis on Twitter" href="http://www.twitter.com/SQLSoldier/">twitter</a> | <a title="SQLSoldier dot com" href="http://www.sqlsoldier.com/">blog</a> ) blog while searching for <br /> info.  Makes joke about SQL Cruise.  I explain that my friend Tim Ford (<a title="Tim Ford on Twitter" href="http://www.twitter.com/SQLAgentMan/">twitter</a> | <a title="The SQLAgentMan dot com" href="http://www.thesqlagentman.com/">blog</a>) runs it.  <br /> I explain what it is.  He sends email to manager asking about training funds&#8230;</p>
<p><strong>5:00 pm</strong> &#8212; Figure out (with client&#8217;s help) how to get to Fenway from their office.  Going to a game <br /> tomorrow night.</p>
<p><strong>5:30 pm</strong> &#8212; Wrap up at the office, still no solution to tempdb issue.</p>
<p><strong>6:30 pm</strong> &#8212; Stopped at Target for groceries for the week.  Back at the hotel now.  Logging in to kick off job <br /> again and see if it &#8220;just works&#8221;.  It doesn&#8217;t.  Making list of changes made today so we can back <br /> the out one-by-one tomorrow while the DBA monitors the situation.</p>
<p><strong>7:00 pm</strong> &#8212; Running gear on.  Heading to <a title="Pond Meadow Park" href="http://pondmeadowpark.org/" target="_blank">Pond Meadow Park</a> for a run.  Client warned it was hilly.</p>
<p><strong>7:30 pm</strong> &#8212; At the park.  HOLY BALLS THIS IS A FRICKEN MOUNTAIN CLIMB.</p>
<p><strong>8:02 pm</strong> &#8212; KICKED THAT TRAIL STRAIGHT IN THE JUNK FOR NEARLY 3 MILES.  Seriously.  I feel so <br /> strong right now.  I can do anything, so I don&#8217;t know, call me maybe.</p>
<p><strong>9:00 pm</strong> &#8212; Stopped back at Target to get a couple of things that I forgot the first time.  Made a wrong turn <br /> to get back to the hotel, ended up on the expressway again.  Turned back around.  Finally back <br /> to &#8220;home&#8221;.  My brain never seems to work right after a good run.  Takes an hour for it to reset.</p>
<p><strong>9:30 pm</strong> &#8212; Salmon filets cooked.  Rice and broccoli as well.  Begin writing blog post for TSQL Tuesday.</p>
<p><strong>10:12 pm</strong> &#8212; HOLY CRAP IT&#8217;S NOW</p>
<p><strong>10:20 pm</strong> &#8212; I THINK I BROKE THE TIME-SPACE CONTINUIUM.</p>
<p><strong>10:45 pm</strong> &#8212; Future Josh is logging back into work.  Going to get a head start on some changes discussed today for <br /> tomorrow. I have a feeling tomorrow is going to be full of figuring out the tempdb issue&#8230;</p>
<p>#CONNECTIONTERMINATED</p>
]]></content:encoded>
			<wfw:commentRss>/index.php/itprofessionals/itprocesses/tsql-tuesday-a-wicked-fun/feed/</wfw:commentRss>
		<slash:comments>0</slash:comments>
		</item>
		<item>
		<title>See Exactly What’s Happenin’ with SSIS 2012 Data Taps</title>
		<link>/index.php/datamgmt/dbadmin/mssqlserveradmin/see-exactly-what-s-happenin/</link>
		<comments>/index.php/datamgmt/dbadmin/mssqlserveradmin/see-exactly-what-s-happenin/#comments</comments>
		<pubDate>Thu, 12 Jul 2012 20:49:00 +0000</pubDate>
		<dc:creator><![CDATA[joshuafennessy]]></dc:creator>
				<category><![CDATA[Microsoft SQL Server Admin]]></category>
		<category><![CDATA[SSIS]]></category>

		<guid isPermaLink="false">/index.php/2012/07/see-exactly-what-s-happenin/</guid>
		<description><![CDATA[-- The Story --
Experienced SSIS developers will recognize the usefulness of the simple  data viewer object used during the development process to peek into the  data set and see what is going on at various stages of execution.
One piece of functional&#8230;]]></description>
				<content:encoded><![CDATA[<p><strong>&#8212; The Story &#8212;</strong><em><img width="315" style="float: right;" src="http://joshuafennessy.files.wordpress.com/2012/07/dataviewer.jpg" alt="Yay!  Data Viewer!" height="315" /></em></p>
<p>Experienced SSIS developers will recognize the usefulness of the simple  <em>data viewer</em> object used during the development process to peek into the  data set and see what is going on at various stages of execution.</p>
<p>One piece of functionality that has been missing since SQL 2005 is the  ability to do this from a production SSIS server. Since the data viewer required  the use of BIDS, and most organizations don’t allow development tools to be  connected to production; troubleshooting data issues often involved lots of  blind poking around and vague assumptions.</p>
<p>This problem is nullified in SQL 2012 with the introduction of the SSIS Data  Tap. This is a <strong>run-time</strong> utility than can be used to peek into the data at  various stages of execution – JUST LIKE THE DATA VIEWER!</p>
<hr />
<p><strong>&#8212; Information Collection &#8212;<br /></strong></p>
<p>Data tap files are output to the SSIS root install directory, and must be  configured through SSMS. First some information about the package must be  gathered in SSDT, so fire up your development environment and follow along.</p>
<p>1. Collect the <strong>PackagePath</strong>. To find this, start in the control flow  and click on the <strong>Data Flow</strong> object that you want to tap. Copy the value of  <em>PackagePath</em></p>
<p><em><img src="http://joshuafennessy.files.wordpress.com/2012/07/clip_image003.png" alt="PackagePath Property Value" /><br /></em></p>
<p>2. Collect the <strong>IdentificationString</strong>. To find this, enter the <strong>Data  Flow</strong> object and select the <strong>connector</strong> that exists between the two  transformations that you wish to tap. Copy the value of  <em>IdentificationString<br /><img width="372" src="http://joshuafennessy.files.wordpress.com/2012/07/clip_image004.png" alt="IdentificationString property value" height="27" /><br /></em></p>
<p>With these two pieces of information, it’s off to SSMS for the rest of the  procedure!</p>
<hr />
<p><strong>&#8212; Execution &#8212;<br /></strong></p>
<p>Connect to your SQL Server 2012 Instance that hosts the SQL 2012 Integration  Services Catalog. Mine is SSISDB on my default instance. Once there, execute the  following stored procedures in order.</p>
<p>catalog.create_execution (<a href="http://msdn.microsoft.com/en-us/library/ff878034.aspx" target="_blank">MSDN</a>)<br />catalog.add_data_tap (<a href="http://msdn.microsoft.com/en-us/library/hh230989" target="_blank">MSDN</a>)<br />catalog.start_execution (<a href="http://msdn.microsoft.com/en-us/library/ff878160" target="_blank">MSDN</a>)</p>
<p>To make it REALLY easy, I’ve written a SQL Script using template parameters  that YOU CAN HAVE! All you need to do is use &lt;CTRL&gt;+&lt;SHIFT&gt;+M to  replace the defaults with the values that are required for your instance. Get a  copy of the script <a href="http://sdrv.ms/PNTRDo">here</a>. If you  have trouble with the download <a href="mailto:josh@joshuafennessy.com">email me</a> and I’ll be happy to send it to you.</p>
<hr />
<p><strong> &#8212; Data Review &#8212;<br /></strong></p>
<p>After the package is executed, check your SSIS Install directory – mine is <br /><span style="font-size: xx-small;"><strong><em>C:Program FilesMicrosoft SQL  Server110DTS</em></strong></span> – for a subfolder called <strong>DataDumps.</strong> You should see a file there with the name  specified in the catalog.add_data_tap  stored procedure.</p>
<p>There is your output! Now you can see EXACTLY what SSIS was working with at  any point of the execution, EVEN IN PRODUCTION!</p>
<hr />
<p><strong>&#8212; Some Important Notes &#8212;<br /></strong></p>
<ul>
<li>Data taps are only valid for ONE execution, so unless you create a job  step with all of this code, you’ll only get a data tap when you explicitly  specify it.</li>
<li>Data taps create I/O (go figure). This means that performance WILL be  affected when running a data tap. I wouldn’t recommend running them for every  execution. Only use them when needed.</li>
<li>Data taps use the catalog schema, which means they require an SSIS 2012  Integration Services Catalog to be used.  Tapped packages also need to be  deployed to this catalog.</li>
</ul>
]]></content:encoded>
			<wfw:commentRss>/index.php/datamgmt/dbadmin/mssqlserveradmin/see-exactly-what-s-happenin/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
	</channel>
</rss>
