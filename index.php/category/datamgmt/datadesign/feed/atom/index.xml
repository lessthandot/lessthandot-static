<?xml version="1.0" encoding="UTF-8"?><feed
  xmlns="http://www.w3.org/2005/Atom"
  xmlns:thr="http://purl.org/syndication/thread/1.0"
  xml:lang="en-US"
  xml:base="/wp-atom.php"
   >
	<title type="text">Data Modelling and Design &#8211; LessthanDot</title>
	<subtitle type="text">A Technical Community for IT Professionals</subtitle>

	<updated>2019-03-09T12:50:36Z</updated>

	<link rel="alternate" type="text/html" href="/" />
	<id>/index.php/feed/atom/</id>
	<link rel="self" type="application/atom+xml" href="/index.php/category/datamgmt/datadesign/feed/atom/" />

	<generator uri="https://wordpress.org/" version="4.6.1">WordPress</generator>
	<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[Modeling the Agile Data Warehouse with Data Vault – Review]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/modeling-the-agile-data-warehouse-with-data-vault-review-2/" />
		<id>/?p=2842</id>
		<updated>2014-07-17T11:18:38Z</updated>
		<published>2014-07-17T11:18:38Z</published>
		<category scheme="/" term="Book Review" /><category scheme="/" term="Business Intelligence" /><category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="agile" /><category scheme="/" term="data modeling" /><category scheme="/" term="data vault" /><category scheme="/" term="data warehouse" /><category scheme="/" term="syndicated" />		<summary type="html"><![CDATA[A few months ago I followed an introductory course about the data vault modeling technique for data warehouses at a local training provider. As part of the training, I received the book Modeling the Agile Data Warehouse with Data Vault written by Hans Hultgren who also is an instructor for the official data vault certification. [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/modeling-the-agile-data-warehouse-with-data-vault-review-2/"><![CDATA[<p style="text-align: justify">A few months ago I followed an introductory course about <a href="http://en.wikipedia.org/wiki/Data_Vault_Modeling">the data vault modeling</a> technique for data warehouses at a <a href="https://www.infosupport.com/">local training provider</a>. As part of the training, I received the book <a href="http://www.amazon.com/Modeling-Agile-Warehouse-Vault-Volume/dp/061572308X/ref=tmm_pap_title_0?ie=UTF8&amp;qid=1405584375&amp;sr=8-2">Modeling the Agile Data Warehouse with Data Vault</a> written by <a href="http://hanshultgren.wordpress.com/">Hans Hultgren</a> who also is an instructor for the official data vault certification. This blog post is a review of this book; I will not introduce the concepts of data vault modeling.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/07/datavault.jpg"><img class="alignnone wp-image-2841 size-medium" src="/wp-content/uploads/2014/07/datavault-200x300.jpg" alt="datavault" width="200" height="300" srcset="/wp-content/uploads/2014/07/datavault-200x300.jpg 200w, /wp-content/uploads/2014/07/datavault.jpg 231w" sizes="(max-width: 200px) 100vw, 200px" /></a></p>
<p style="text-align: justify">First of all I am glad I received this book for “free” (read: it was most likely included in the price of the training), because the book has a list price of a whopping $95 (Amazon fortunately gives a steep discount on the paperback edition). No, the 434-page book is not made of pure gold, as you might think, but there are quite a lot of pages in color. There are 212 figures in color in the book, so I guess this contributes to the total price, but <a href="http://www.amazon.com/Information-Dashboard-Design-At---Glance/dp/1938377001/ref=sr_1_1?s=books&amp;ie=UTF8&amp;qid=1405585061&amp;sr=1-1&amp;keywords=information+dashboard+design&amp;dpPl=1">Information Dashboard Design</a> is also in color and has a list price of $40, less than half of the data vault book. This is of course only relevant to printed copies, where they have to cut down trees and use quite some ink, but the Kindle edition is even more expensive and is yours for a mere $84.09. Sense, it makes none. To top it off, the book unfortunately has a bit of an amateur look-‘n-feel. The cover art and the pictures used at the start of each section aren’t exactly world class. Anyway, you can’t judge a book by its cover, so we’ll take a look at the content itself.</p>
<p style="text-align: justify">I have to say, this books reads like a breeze. I finished the book in a couple of days, despite being over 400 hundred pages. This is due to the writing style of the author but also because there are 31 (!) chapters in this book. That’s about 14 pages average for one chapter only. But as I said before, there are 212 figures and each chapter has its own title page (so 31 pages less to read) and usually some white space at the end. Because each chapter finished so quickly, you have the feeling you advance really fast through the book. There are a few spelling mistakes and typos here and there, but nothing too worse. The only thing that irritated me some times is the way the author emphasizes words. A hint: he emphasizes a lot. In almost every paragraph, there is something underlined, in italic or in bold or every possible combination of those three. This gives you the feeling you are reading a high-school text book or a supermarket tabloid. And <a href="http://practicaltypography.com/underlining.html">underlining is not done</a> (yes, I am painfully aware that the URL hyperlink is underlined). Any decent editor should have paid attention to that. Another point is that the author frequently repeats itself. I guess this is because he really wants to make a point (how fantastic data vault is compared with 3NF and dimensional modeling in some aspects), but after a few times I already got the point. No need in repeating it in almost every chapter. This is also the case for figures. There’s this one particular figure that I’ve encountered about 11 times throughout the book (sometimes in very slight variations). That is being thorough all right.</p>
<p style="text-align: justify">OK, so there may be some improvements possible for form and layout, but what about the data vault stuff itself? Well, it is explained pretty well. If you have had no exposure to data vault yet, this book will teach you a solid understanding of its principles (I consider myself to this category of readers). I guess if you are a more advanced data vault modeler, there is some nuggets here and there to pick up or you can use the book as a reference.</p>
<p style="text-align: justify">The first section (Data Vault Ensemble, which teaches you why data vault is what it is) and the third section (Working with Data Vault) really dive into data vault and how you should design such a model, but there’s a large section in the middle – Data Warehousing and Business Intelligence – which is a bunch of loosely tied chapters about a variety of subjects. Some of these chapters are in my opinion not needed to explain data vault or agile modeling. They are filler and can easily be omitted from the book. It would have made the book at least 100 pages thinner (and probably a bit cheaper in price). At the back cover Hans says “This is a guide to data vault modeling and at the same time an exploration of the broader concepts surrounding data warehousing &amp; business intelligence today”, so I should not have been that surprised about those chapters, but on the other hand, if the book contains the words “agile data warehouse” and “data vault”, I expect a deep dive into both subjects. The problem is that because of all those <em>broader concepts</em>, these two subjects don’t get the attention they deserve. Especially the agile part. From time to time the author mentions agile and how data vault can quickly adapt to changes and how fast it can be loaded because of parallelism and how agile all of this is, but it never goes any deeper. There is no treatment on how to develop the data vault in an agile project setting. How to deal with scrum or sprints or whatever. None of that. But I can still live with it, I read the book to learn more about data vault and the book succeeded in that goal. It seems the word agile is just thrown into the title to serve as link bait.</p>
<p style="text-align: justify">However, I would have liked some more detailed examples. Most of the time it is a really easy example about customers and customers classes and in some cases there is also a sale, products and employees involved, but nothing more complicated than that. This is in my opinion the biggest downside of the book. I really would have liked to see for example a whole transactional process modeled in 3NF, how it is ported into data vault and how at the end the (dimensional) data marts are generated. The book stays too basic. The last chapter of the book – titled Comparison Example – shows some tables with actual rows and data and how they are transformed. I was looking forward to that chapter while reading through the book because I hoped it would finally give a thorough hands-on example. Alas, it was the same customer table used in any other example. This book is not enough hands-on. I guess you have to follow the (paid) courses to get more hands-on material.</p>
<p style="text-align: justify">The conclusion. I may have sounded a bit harsh in the previous paragraphs, but don’t get me wrong. I liked reading the book and I definitely learned a lot about data vault. I just wished the book got more hands-on examples (and maybe a decent editor). I do recommend this book to everyone who wants a solid introduction to data vault (there are not that many alternatives to be honest).</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/modeling-the-agile-data-warehouse-with-data-vault-review-2/#comments" thr:count="0"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/modeling-the-agile-data-warehouse-with-data-vault-review-2/feed/atom/" thr:count="0"/>
		<thr:total>0</thr:total>
		</entry>
		<entry>
		<author>
			<name>Eli Weinstock-Herman (tarwn)</name>
					</author>
		<title type="html"><![CDATA[Six (and a bit) years of LessThanDot, Visualized]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/six-and-a-bit-years-of-lessthandot-visualized/" />
		<id>/?p=2601</id>
		<updated>2014-05-05T16:35:58Z</updated>
		<published>2014-05-05T16:34:13Z</published>
		<category scheme="/" term="Data Modelling and Design" />		<summary type="html"><![CDATA[I ran into a tool named Gource while searching for ways to visualize activity from my git repositories. Besides creating awesome visualizations from my code, it also has the capability to take custom logs for visualizations. Which led me to think, what if I fed in blog posts from LessThanDot, using the primary categories in [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/six-and-a-bit-years-of-lessthandot-visualized/"><![CDATA[<p>I ran into a tool named <a href="https://code.google.com/p/gource/">Gource</a> while searching for ways to visualize activity from my git repositories. Besides creating awesome visualizations from my code, it also has the capability to take custom logs for visualizations.</p>
<p>Which led me to think, what if I fed in blog posts from LessThanDot, using the primary categories in place of directory paths?</p>
<p><iframe width="500" height="281" src="http://www.youtube.com/embed/WfEvuLY3nkQ?feature=oembed" frameborder="0" allowfullscreen></iframe></p>
<p>The color-coding for my git repositories is assigned by file type, but here I assigned colors to each of the authors. The final view is what we have built over the past 6+ years, a beautiful collection of useful knowledge from 38 different authors.</p>
<h2>The Nitty Gritty Details</h2>
<p>This is by no means a polished, automated process, but here is how I converted WordPress data into a custom log I could feed into Gource.</p>
<h3>1. Query Posts from WordPress</h3>
<p>First I queried MySQL for the post data:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> 
&nbsp; &nbsp;UNIX_TIMESTAMP<span class="br0">&#40;</span><span class="kw1">CASE</span> <span class="kw1">WHEN</span> P<span class="sy0">.</span>post_date_gmt <span class="sy0">&lt;</span> <span class="st0">'2001-1-1'</span> <span class="kw1">THEN</span> P<span class="sy0">.</span>post_date <span class="kw1">ELSE</span> P<span class="sy0">.</span>post_date_gmt <span class="kw1">END</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="st0">&quot;timestamp&quot;</span><span class="sy0">,</span>
&nbsp; &nbsp;U<span class="sy0">.</span>display_name<span class="sy0">,</span> 
&nbsp; &nbsp;<span class="br0">&#40;</span><span class="kw1">CASE</span> post_type <span class="kw1">WHEN</span> <span class="st0">'post'</span> <span class="kw1">THEN</span> <span class="st0">'A'</span> <span class="kw1">WHEN</span> <span class="st0">'revision'</span> <span class="kw1">THEN</span> <span class="st0">'M'</span> <span class="kw1">ELSE</span> post_type <span class="kw1">END</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="st0">&quot;change&quot;</span><span class="sy0">,</span> 
&nbsp; &nbsp;P<span class="sy0">.</span>post_title<span class="sy0">,</span>
&nbsp; &nbsp;TT<span class="sy0">.</span>term_taxonomy_id
<span class="kw1">FROM</span> wp_posts P
&nbsp; &nbsp;<span class="kw1">INNER</span> <span class="kw1">JOIN</span> wp_users U <span class="kw1">ON</span> P<span class="sy0">.</span>post_author <span class="sy0">=</span> U<span class="sy0">.</span>ID
&nbsp; &nbsp;<span class="kw1">INNER</span> <span class="kw1">JOIN</span> wp_term_relationships TR <span class="kw1">ON</span> TR<span class="sy0">.</span>object_id <span class="sy0">=</span> P<span class="sy0">.</span>ID
&nbsp; &nbsp;<span class="kw1">INNER</span> <span class="kw1">JOIN</span> wp_term_taxonomy TT <span class="kw1">ON</span> TT<span class="sy0">.</span>term_taxonomy_id <span class="sy0">=</span> TR<span class="sy0">.</span>term_taxonomy_id
&nbsp; &nbsp;<span class="kw1">LEFT</span> <span class="kw1">JOIN</span> wp_term_relationships TR2 <span class="kw1">ON</span> TR2<span class="sy0">.</span>object_id <span class="sy0">=</span> P<span class="sy0">.</span>ID <span class="kw1">AND</span> TR2<span class="sy0">.</span>term_taxonomy_id <span class="sy0">&lt;</span> TR<span class="sy0">.</span>term_taxonomy_id
<span class="kw1">WHERE</span> P<span class="sy0">.</span>post_type <span class="kw1">IN</span> <span class="br0">&#40;</span><span class="st0">'post'</span><span class="sy0">,</span><span class="st0">'revision'</span><span class="br0">&#41;</span>
&nbsp; &nbsp;<span class="kw1">AND</span> P<span class="sy0">.</span>post_status <span class="sy0">&lt;&gt;</span> <span class="st0">'auto-draft'</span>
&nbsp; &nbsp;<span class="kw1">AND</span> post_title <span class="sy0">&lt;&gt;</span> <span class="st0">''</span>
&nbsp; &nbsp;<span class="kw1">AND</span> TT<span class="sy0">.</span>taxonomy <span class="sy0">=</span> <span class="st0">'category'</span>
&nbsp; &nbsp;<span class="kw1">AND</span> TR2<span class="sy0">.</span>term_taxonomy_id <span class="kw1">IS</span> <span class="kw1">NULL</span>
<span class="kw1">ORDER</span> <span class="kw1">BY</span> P<span class="sy0">.</span>post_date</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT 
   UNIX_TIMESTAMP(CASE WHEN P.post_date_gmt &lt; '2001-1-1' THEN P.post_date ELSE P.post_date_gmt END) AS "timestamp",
   U.display_name, 
   (CASE post_type WHEN 'post' THEN 'A' WHEN 'revision' THEN 'M' ELSE post_type END) as "change", 
   P.post_title,
   TT.term_taxonomy_id
FROM wp_posts P
   INNER JOIN wp_users U ON P.post_author = U.ID
   INNER JOIN wp_term_relationships TR ON TR.object_id = P.ID
   INNER JOIN wp_term_taxonomy TT ON TT.term_taxonomy_id = TR.term_taxonomy_id
   LEFT JOIN wp_term_relationships TR2 ON TR2.object_id = P.ID AND TR2.term_taxonomy_id &lt; TR.term_taxonomy_id
WHERE P.post_type IN ('post','revision')
   AND P.post_status &lt;&gt; 'auto-draft'
   AND post_title &lt;&gt; ''
   AND TT.taxonomy = 'category'
   AND TR2.term_taxonomy_id IS NULL
ORDER BY P.post_date</pre></div></div>

<p>Note that I gathered both additions and revisions, filtering out only drafts. I did have a few posts without a valid GMT date, so I failed those over to the local post date. Because we assign multiple categories to posts, I needed to be careful to select only a single one for each post.</p>
<h3>2. Query Categories from WordPress</h3>
<p>Next I needed the categories (terms) from WordPress. </p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> 
&nbsp; &nbsp;TT<span class="sy0">.</span>term_taxonomy_id<span class="sy0">,</span>
&nbsp; &nbsp;TT<span class="sy0">.</span>parent<span class="sy0">,</span>
&nbsp; &nbsp;T<span class="sy0">.</span>Name<span class="sy0">,</span>
&nbsp; &nbsp;T<span class="sy0">.</span>slug
<span class="kw1">FROM</span> wp_term_taxonomy TT
&nbsp; &nbsp;<span class="kw1">INNER</span> <span class="kw1">JOIN</span> wp_terms T <span class="kw1">ON</span> T<span class="sy0">.</span>term_id <span class="sy0">=</span> TT<span class="sy0">.</span>term_id
<span class="kw1">WHERE</span> taxonomy <span class="sy0">=</span> <span class="st0">'category'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT 
   TT.term_taxonomy_id,
   TT.parent,
   T.Name,
   T.slug
FROM wp_term_taxonomy TT
   INNER JOIN wp_terms T ON T.term_id = TT.term_id
WHERE taxonomy = 'category'</pre></div></div>

<p>I wasn&#8217;t sure if I was going to use the name or slug in the &#8220;file path&#8221;, so I grabbed both. I also grabbed the parent so I could recursively build the paths in Excel.</p>
<h3>3. Generate Category Paths in Excel</h3>
<p>Before building out my final list of post data, I need to recursively build out the category taxonomy. My category query results above go into an excel tab, which I then add a column that calculates the category path:</p>
<p><code>=IF($B1=0,$C1,VLOOKUP($B1,$A$1:$E$126,5) &amp; "/" &amp; $C1)</code></p>
<p>If the category has a parent id of 0, we know it&#8217;s a parent category and output it&#8217;s name alone. Otherwise we VLOOKUP to find the name of the parent and prepend it to the current rows category name. This gives us a table of category paths to reference from our post data.</p>
<h3>4. Assign Colors in Excel</h3>
<p>I found a website that had a list of color codes and pasted it into a new excel tab. I then grabbed the column of authors from the posts query, remove duplicates, and pasted it in Column A of my colors sheet (the codes are in column D).</p>
<p>Nothing fancy, but this will let me use a VLOOKUP from the posts tab to produce color codes for each posts by author.</p>
<h3>5. Build the log file in Excel</h3>
<p>With the results of the first query in an excel tab named &#8220;wp_posts&#8221; and the categories in &#8220;wp_term_taxonomy&#8221;, I add some extra rows in the wp_posts sheet to accommodate calculated fields I will be adding:</p>
<p>A:unix timestamp, B:author, C:A/M, D:(inserted), E:(inserted), F:(inserted), G:post title, H:category/term id</p>
<p>In Column D, I add the following lookup to build the &#8220;File path&#8221;:</p>
<p><code>="LessThanDot/" &amp; VLOOKUP($H1,wp_term_taxonomy!$A$1:$E$126,5,FALSE) &amp; "/" &amp; G1</code></p>
<p>This uses VLOOKUP to find the category &#8220;path&#8221;, prepends a root of &#8220;LessThanDot&#8221; and appends the post title, giving me something that looks like a file path.</p>
<p>In Column E, I do the VLOOKUP that grabs each authors assigned color:</p>
<p><code>=VLOOKUP(B1,colors!$A$2:$D$39,4,FALSE)</code></p>
<p>In Column F, I create a value that matches the format for Gource&#8217;s <a href="http://code.google.com/p/gource/wiki/CustomLogFormat">Custom Log Format</a>:</p>
<p><code>=A1&amp;"|"&amp;B1&amp;"|"&amp;C1&amp;"|"&amp;D1&amp;"|"&amp;E1</code></p>
<p>Copying that column into a text file gives me something like this:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="text"><thead><tr><td colspan="2"  class="head">Text</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1">1198243476|Christiaan Baes (chrissie1)|A|LessThanDot/Web Developer/Server Programming/ASP.NET/The concepts of OOP|00AEEF
1202432676|SQLDenis|A|LessThanDot/Data Management/Data Modelling and Design/Review of Inside Microsoft SQL Server 2005 Query Tuning and Optimization|F9AD81
1204209656|Christiaan Baes (chrissie1)|A|LessThanDot/Desktop Developer/Microsoft Technologies/VB.NET/VS 2008 ErrorMessage|00AEEF
1204243512|Christiaan Baes (chrissie1)|A|LessThanDot/Desktop Developer/Microsoft Technologies/VB.NET/Listen to yourself|00AEEF
...</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">1198243476|Christiaan Baes (chrissie1)|A|LessThanDot/Web Developer/Server Programming/ASP.NET/The concepts of OOP|00AEEF
1202432676|SQLDenis|A|LessThanDot/Data Management/Data Modelling and Design/Review of Inside Microsoft SQL Server 2005 Query Tuning and Optimization|F9AD81
1204209656|Christiaan Baes (chrissie1)|A|LessThanDot/Desktop Developer/Microsoft Technologies/VB.NET/VS 2008 ErrorMessage|00AEEF
1204243512|Christiaan Baes (chrissie1)|A|LessThanDot/Desktop Developer/Microsoft Technologies/VB.NET/Listen to yourself|00AEEF
...</pre></div></div>

<h3>Run Gource</h3>
<p>I&#8217;ve done several runs with Gource this weekend, so I&#8217;ve been playing with various combinations of settings. For this video, I wanted to display one of our old LessThanDot footer logos in the bottom right of the visualization, I suppressed the progress bar from the video, and made various tweaks to the time settings to speed up (5.5 years of posts with the default settings would have been loooong). 1280&#215;720 matches YouTube&#8217;s HD setting, and I tweaked the date format and color to make it stand out less.</p>
<p><code>gource --logo site_logo_footer.png -1280x720 --logo-offset 30x30&lt;br /&gt;
 --hide "progress" --font-colour 454545 --seconds-per-day .25 --auto-skip-seconds 1 -o gource.ppm --path posts.log --dat&lt;br /&gt;
e-format "%B %d, %Y"</code></p>
<p>I then used ffmpeg to convert that 95GB ppm file into a 3.2 GB mp4 and uploaded it to youtube.</p>
<p><code>C:\ffmpeg\bin\ffmpeg -an -threads 4 -y -r 60 -f image2pipe -vcodec ppm -i gource.pp&lt;br /&gt;
m -vcodec libx264 -preset ultrafast -pix_fmt yuv420p -crf 1 -threads 0 -bf 0 -r 30 gource_blogposts.x264.mp4</code></p>
<p>And there we go, 6+ years of blog posts visualized.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/six-and-a-bit-years-of-lessthandot-visualized/#comments" thr:count="1"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/six-and-a-bit-years-of-lessthandot-visualized/feed/atom/" thr:count="1"/>
		<thr:total>1</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[Star Schema The Complete Reference – Review]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/star-schema-the-complete-reference-review/" />
		<id>/?p=2315</id>
		<updated>2015-07-15T19:33:34Z</updated>
		<published>2014-01-23T15:02:48Z</published>
		<category scheme="/" term="Book Review" /><category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="dimensional modelling" /><category scheme="/" term="review" /><category scheme="/" term="star schema" /><category scheme="/" term="syndicated" />		<summary type="html"><![CDATA[I finished my first book of this year and here’s the review! After I finished the newest edition of Ralph Kimball’s Data Warehouse Toolkit, a senior colleague of mine recommended the book Star Schema The Complete Reference by Christopher Adamson. To be honest, I had never heard about it. But was I wrong: this book [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/star-schema-the-complete-reference-review/"><![CDATA[<p style="text-align: justify">I finished my first book of this year and here’s the review! After I finished the newest edition of Ralph Kimball’s Data Warehouse Toolkit, a senior colleague of mine recommended the book <a href="http://www.amazon.com/Star-Schema-The-Complete-Reference/dp/0071744320">Star Schema The Complete Reference</a> by Christopher Adamson. To be honest, I had never heard about it. But was I wrong: this book is an absolute must read for every data warehouse professional who takes himself/herself seriously. The book is extremely well written and it explains the concepts of star schemas (hence the title of course) very thoroughly with great detailed examples. I would even go as far by proclaiming that I like this book better than the “Toolkit”. If I had to choose only one book to take with me on new projects, it would be this one.</p>
<p style="text-align: justify">One of the strengths of this book is that it is vendor independent and also architecture independent. The book begins by introducing how dimensional modelling is used in the methodologies used by Inmon and Kimball and it debunks quite a few myths that exist about both methodologies. It also explains the concept of stand-alone data marts and which advantages and especially which disadvantages this technique has. Throughout the book, the author explains how the different methodologies can have an impact on how certain concepts are implemented.</p>
<p style="text-align: justify">Another great piece was the explanation of drilling-across and the importance of it for cross analysis of different process. While reading Kimball’s book, I didn’t pick up the significance of this, but because of the attention Christopher gives to conformed dimensions – a whole chapter – I could really put it in perspective. The different types of conformity are well explained and are illustrated with clear examples. The book also gives different ways of drilling across and provides a few code samples.</p>
<p><a href="http://amzn.to/1fJVq5q"><img class="alignnone wp-image-2317 size-medium" src="/wp-content/uploads/2014/01/bookcover-241x300.jpg" alt="bookcover" width="241" height="300" srcset="/wp-content/uploads/2014/01/bookcover-241x300.jpg 241w, /wp-content/uploads/2014/01/bookcover.jpg 322w" sizes="(max-width: 241px) 100vw, 241px" /></a></p>
<p style="text-align: justify">There are the usual chapters that you expect from a book like this: dimension design, slowly changing attributes, snowflaking, different kinds of fact tables et cetera. But there is the occasional deep dive: multi-valued dimensions/ attributes and how they relate to bridge tables, type-specific stars, recursive hierarchies and so on. He even explains how to handle all these exotic features when there are slowly changing attributes, but unfortunately he doesn’t back it up with detailed examples. It’s the only weak point of the book, but making the book too detailed would perhaps make it too long and harder to read. And hopefully we never have to implement a slowly changing many to many relationship.</p>
<p style="text-align: justify">There are also some chapters on performance enhancements, such as derived tables and aggregates. These solutions might become somewhat obsolete in the past years thanks to hardware advancements and the introduction of columnar and in-memory databases, but since not every company has Enterprise edition these tools might still be very useful.</p>
<p style="text-align: justify">The last three chapters are more about how to design the ETL, how to work with BI tools and how to document models. Personally I found those less interesting, but there’s still some value in it.</p>
<p style="text-align: justify"><b>Conclusion</b></p>
<p style="text-align: justify">It’s a great book about designing data warehouses using star schemas. Buy it, read it and take it with you on every data warehouse project you encounter. You won’t regret it.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/star-schema-the-complete-reference-review/#comments" thr:count="3"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/star-schema-the-complete-reference-review/feed/atom/" thr:count="3"/>
		<thr:total>3</thr:total>
		</entry>
		<entry>
		<author>
			<name>Jes Borland</name>
					</author>
		<title type="html"><![CDATA[Document Your SQL Server Databases with Extended Properties]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/document-your-sql-server-databases/" />
		<id>/index.php/2013/11/document-your-sql-server-databases/</id>
		<updated>2013-11-06T15:08:00Z</updated>
		<published>2013-11-06T15:08:00Z</published>
		<category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="Database Administration" /><category scheme="/" term="Database Programming" /><category scheme="/" term="Microsoft SQL Server" /><category scheme="/" term="Microsoft SQL Server Admin" />		<summary type="html"><![CDATA[How important is database documentation to you? I know you have a hundred “more important” things to do. But consider this: how much time is it going to take you to document the purpose of a constraint right now? How much time will you spend trying to r&#8230;]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/document-your-sql-server-databases/"><![CDATA[<p>How important is database documentation to you? I know you have a hundred “more important” things to do. But consider this: how much time is it going to take you to document the purpose of a constraint right now? How much time will you spend trying to remember that purpose in seven months when a developer has a question about it? Documenting a database and its objects when they are created can save you hours of work in the long run.</p>
<p>There are many ways to create and store documentation. You could create a spreadsheet for each database, with information about each table, view, and stored procedure – and update it manually. You could buy a third party product and use it – but then you’re paying for a method to track this information. Or you could use a built-in tool in SQL Server to add the information, and use Reporting Services to display it.</p>
<h3><strong>Extended Properties </strong></h3>
<p>Many objects in SQL Server – tables, filegroups, triggers, and more – have a mechanism for you to add properties to them beyond the built-in information such as names. <strong>Extended properties</strong> allow you to customize the information, storing the data within the database itself. When you need to retrieve the information, you simply query it.</p>
<p>Extended properties have been available since at least SQL Server 2000. They’re available in all editions – this isn’t an Enterprise Edition only feature. You can use them on databases you’ve created, and in third party databases – they don’t modify the data structure at all.</p>
<p>How cool is that? All you need is a little knowledge on how to get the data in and how to get it out, and you’ll be all set.</p>
<h3><strong>To What Can You Add Extended Properties? </strong></h3>
<p>You can add extended properties to many – but not all – objects in SQL Server. Common items with the functionality are the database, schemas, tables, views, columns, constraints, functions, parameters, and triggers. Less-used items such as service broker queues, partition functions and schemes, and plan guides can also be documented! The list of items you can add properties to is shown in Figure 1.</p>
<p> </p>
<p style="text-align: center;"><img src="/wp-content/uploads/users/grrlgeek/xp hierarchy.JPG?mtime=1383748570" alt="" /></p>
<p style="text-align: center;"><em>Figure 1: Extended Properties hierarchy</em></p>
<h3><strong>Use Cases </strong></h3>
<p>Let’s start with the database itself – you could add an “Application” property with the name of the application it’s tied into.  For each schema in the database, you can document the purpose of it – was it to support application functionality, for readability, or for security? In functions and procedures, comments should explain the “why”, but properties could be added to document the data types and default values for parameters – just in case they accidentally get changed. If you have a column with a default constraint or a default value, document what it is and why if appropriate. If there is a trigger, document why that’s necessary.</p>
<p>These are just a few examples of the “why”. Let’s look at the “how”.</p>
<h3>Security</h3>
<p>Not just anyone can add or modify extended properties. Any users in the db_owner role can add and make any changes. Users in the ddl_admin role can add or update properties on objects, but not the database, users, or roles. Also, if a user owns an object or has ALTER or CONTROL permissions on an object, they can add or update properties. Be careful with permissions – even db_owner can be a higher level of permission than you wish to assign to some users.</p>
<h3><strong>Creating Extended Properties </strong></h3>
<p>To add extended properties to an object, you’ll use the stored procedure <a href="http://technet.microsoft.com/en-us/library/ms180047.aspx">sp_addextendedproperty</a>. There are four major parameters to this procedure – name, value, level type, and level name. Name is just that – a name to describe the property. The value is the description – what is this property for, and why are you adding it? The level type is a <em>pre-defined value</em> – refer back to Figure 1 for the values available. The level name is the <em>specific object</em> you are adding the property to – a plan guide name, a table name, an index name.</p>
<p>Let’s review the concept of levels – 0, 1, and 2. The highest-level property is the database. All other properties fall under this. Some properties are at level 0 – they are the top of the food chain, and aren’t tied to anything except the database. Schemas, certificates, triggers, and plan guides are just a few examples. Then properties become nested. Tables and views are level 1 properties, under schema. A few properties even are at level 2 – column is level 2, under table and view, for example. Again,  reference the hierarchy in Figure 1 for complete details.</p>
<p>The syntax from <a href="http://technet.microsoft.com/en-us/library/ms180047.aspx">Books Online</a> is:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1">sp_addextendedproperty
&nbsp; &nbsp; <span class="br0">&#91;</span> @name <span class="sy0">=</span> <span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="st0">'property_name'</span> <span class="br0">&#125;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span> <span class="sy0">,</span> <span class="br0">&#91;</span> @<span class="kw1">VALUE</span> <span class="sy0">=</span> <span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="st0">'value'</span> <span class="br0">&#125;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#91;</span> <span class="sy0">,</span> <span class="br0">&#91;</span> @level0type <span class="sy0">=</span> <span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="st0">'level0_object_type'</span> <span class="br0">&#125;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">,</span> <span class="br0">&#91;</span> @level0name <span class="sy0">=</span> <span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="st0">'level0_object_name'</span> <span class="br0">&#125;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#91;</span> <span class="sy0">,</span> <span class="br0">&#91;</span> @level1type <span class="sy0">=</span> <span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="st0">'level1_object_type'</span> <span class="br0">&#125;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">,</span> <span class="br0">&#91;</span> @level1name <span class="sy0">=</span> <span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="st0">'level1_object_name'</span> <span class="br0">&#125;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#91;</span> <span class="sy0">,</span> <span class="br0">&#91;</span> @level2type <span class="sy0">=</span> <span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="st0">'level2_object_type'</span> <span class="br0">&#125;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">,</span> <span class="br0">&#91;</span> @level2name <span class="sy0">=</span> <span class="br0">&#93;</span> <span class="br0">&#123;</span> <span class="st0">'level2_object_name'</span> <span class="br0">&#125;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#93;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#93;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#93;</span> 
&nbsp; &nbsp; <span class="br0">&#93;</span> 
<span class="br0">&#91;</span>;<span class="br0">&#93;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">sp_addextendedproperty
    [ @name = ] { 'property_name' }
    [ , [ @value = ] { 'value' } 
        [ , [ @level0type = ] { 'level0_object_type' } 
          , [ @level0name = ] { 'level0_object_name' } 
                [ , [ @level1type = ] { 'level1_object_type' } 
                  , [ @level1name = ] { 'level1_object_name' } 
                        [ , [ @level2type = ] { 'level2_object_type' } 
                          , [ @level2name = ] { 'level2_object_name' } 
                        ] 
                ]
        ] 
    ] 
[;]</pre></div></div>

<p> </p>
<p>That’s ugly, but let’s walk through it. First are the name and value. You’ll add these for every property. Then, you see a type and name for each level – 0, 1, and 2. If you add a level 0 property, you don’t add any information for 1 or 2. If you add a level 1 property, you add the level 0 and level 1 information. If you want a level 2 property, you enter information for all three levels.</p>
<p>Let’s add a property to the highest level, the database.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXEC</span> sp_addextendedproperty 
@name <span class="sy0">=</span> N<span class="st0">'Purpose'</span><span class="sy0">,</span> 
@<span class="kw1">VALUE</span> <span class="sy0">=</span> <span class="st0">'Holds employee, customer, supplier, and order details for the company.'</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXEC sp_addextendedproperty 
@name = N'Purpose', 
@value = 'Holds employee, customer, supplier, and order details for the company.';</pre></div></div>

<p> </p>
<p>Note that I only used the @name and @value parameters. There are no level types or names. I’m documenting the purpose of the database.</p>
<p>Let’s add a property to a level 0 – a schema.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXECUTE</span> sys<span class="sy0">.</span>sp_addextendedproperty 
@name <span class="sy0">=</span> N<span class="st0">'Purpose'</span><span class="sy0">,</span>
@<span class="kw1">VALUE</span> <span class="sy0">=</span> N<span class="st0">'Holds info for Jes.'</span><span class="sy0">,</span>
&nbsp; &nbsp; @level0type <span class="sy0">=</span> N<span class="st0">'SCHEMA'</span><span class="sy0">,</span> 
&nbsp; &nbsp; @level0name <span class="sy0">=</span> <span class="st0">'Jes'</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXECUTE sys.sp_addextendedproperty 
@name = N'Purpose',
@value = N'Holds info for Jes.',
	@level0type = N'SCHEMA', 
	@level0name = 'Jes';</pre></div></div>

<p> </p>
<p>I find it easiest to start at the bottom to read this. The property is for a Schema, and the schema is Jes.  This property documents the purpose of the schema – it holds information for one user, Jes.</p>
<p>Let’s add to a level 1 – a table.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXECUTE</span> sys<span class="sy0">.</span>sp_addextendedproperty 
@name <span class="sy0">=</span> N<span class="st0">'Purpose'</span><span class="sy0">,</span>
@<span class="kw1">VALUE</span> <span class="sy0">=</span> N<span class="st0">'Holds running data.'</span><span class="sy0">,</span>
&nbsp; &nbsp; @level0type <span class="sy0">=</span> N<span class="st0">'SCHEMA'</span><span class="sy0">,</span> 
&nbsp; &nbsp; @level0name <span class="sy0">=</span> <span class="st0">'Jes'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; @level1type <span class="sy0">=</span> N<span class="st0">'Table'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; @level1name <span class="sy0">=</span> <span class="st0">'Running'</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXECUTE sys.sp_addextendedproperty 
@name = N'Purpose',
@value = N'Holds running data.',
	@level0type = N'SCHEMA', 
	@level0name = 'Jes', 
		@level1type = N'Table', 
		@level1name = 'Running';</pre></div></div>

<p> </p>
<p>Let’s start at the bottom. I’m documenting a Table, which is named Running. This is under the type Schema, and the schema name is Jes. I’m documenting the purpose of the table – to hold running data for this user, Jes.</p>
<p>Now let’s add to a level 2, column.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXECUTE</span> sys<span class="sy0">.</span>sp_addextendedproperty 
@name <span class="sy0">=</span> <span class="st0">'Measurement'</span><span class="sy0">,</span> 
@<span class="kw1">VALUE</span> <span class="sy0">=</span> <span class="st0">'Distance run measured in miles.'</span><span class="sy0">,</span> 
&nbsp; &nbsp; @level0type <span class="sy0">=</span> <span class="st0">'SCHEMA'</span><span class="sy0">,</span> 
&nbsp; &nbsp; @level0name <span class="sy0">=</span> <span class="st0">'Jes'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; @level1type <span class="sy0">=</span> <span class="st0">'Table'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; @level1name <span class="sy0">=</span> <span class="st0">'Running'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @level2type <span class="sy0">=</span> <span class="st0">'Column'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @level2name <span class="sy0">=</span> <span class="st0">'RunDistance'</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXECUTE sys.sp_addextendedproperty 
@name = 'Measurement', 
@value = 'Distance run measured in miles.', 
	@level0type = 'SCHEMA', 
	@level0name = 'Jes', 
		@level1type = 'Table', 
		@level1name = 'Running', 
			@level2type = 'Column', 
			@level2name = 'RunDistance';</pre></div></div>

<p> </p>
<p>Reading up from the bottom, again: this property is for a Column named RunDistance. It’s in the Table Running, which is in the Schema Jes. I’m documenting the measurement, since there are different options – in my case the distance is in miles.</p>
<p>You should now understand the hierarchy of sp_addextendedproperty. Once you’ve added properties, though, how do you updated, remove, or extract the information?</p>
<h3><strong>Updating Extended Properties </strong></h3>
<p>What if something changes? Maybe a default value changes, or you want to add more information. You can execute <a href="http://technet.microsoft.com/en-us/library/ms186989(v=sql.105).aspx">sp_updateextendedproperty</a> to update the information. This is very similar to adding – pass in the property name and the updated value, then the appropriate levels.</p>
<p>Let’s say I want to be more specific about the purpose of the schema Jes. I can update the ‘Purpose’ property easily.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXEC</span> sp_updateextendedproperty 
@name <span class="sy0">=</span> N<span class="st0">'Purpose'</span><span class="sy0">,</span>
@<span class="kw1">VALUE</span> <span class="sy0">=</span> N<span class="st0">'Holds tables created by user Jes.'</span><span class="sy0">,</span>
&nbsp; &nbsp; @level0type <span class="sy0">=</span> N<span class="st0">'SCHEMA'</span><span class="sy0">,</span> 
&nbsp; &nbsp; @level0name <span class="sy0">=</span> <span class="st0">'Jes'</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">exec sp_updateextendedproperty 
@name = N'Purpose',
@value = N'Holds tables created by user Jes.',
	@level0type = N'SCHEMA', 
	@level0name = 'Jes';</pre></div></div>

<p> </p>
<h3><strong>Deleting Extended Properties </strong></h3>
<p>What if you decide an extended event has outlived its purpose or for some reason need to remove it? You can execute <a href="http://technet.microsoft.com/en-us/library/ms178595.aspx">sp_dropextendedproperty</a>, passing in the same parameters as before.</p>
<p>In this example, I’ve added a property, Purpose, to Jes.Running.RunDistance that I want to remove.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXEC</span> sp_dropextendedproperty 
&nbsp; &nbsp; @name <span class="sy0">=</span> <span class="st0">'Purpose'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; @level0type <span class="sy0">=</span> <span class="st0">'SCHEMA'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; @level0name <span class="sy0">=</span> <span class="st0">'Jes'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @level1type <span class="sy0">=</span> <span class="st0">'Table'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @level1name <span class="sy0">=</span> <span class="st0">'Running'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @level2type <span class="sy0">=</span> <span class="st0">'Column'</span><span class="sy0">,</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @level2name <span class="sy0">=</span> <span class="st0">'RunDistance'</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">exec sp_dropextendedproperty 
	@name = 'Purpose', 
		@level0type = 'SCHEMA', 
		@level0name = 'Jes', 
			@level1type = 'Table', 
			@level1name = 'Running', 
				@level2type = 'Column', 
				@level2name = 'RunDistance';</pre></div></div>

<p> </p>
<p>Executing this removes the property from the database.</p>
<h3><strong>Viewing Extended Properties </strong></h3>
<p>Once you’ve decided what you’re going to document and you add the information, you’ll want a way to look it up! There are two main methods – executing <a href="http://technet.microsoft.com/en-us/library/ms179853(v=sql.105).aspx">fn_listextendedproperty</a> and querying <a href="http://technet.microsoft.com/en-us/library/ms177541.aspx">sys.extended_properties</a>. I prefer the latter method, as it allows you to join the results with other catalog views to get more information, and  we  will focus on this method.</p>
<p>The view returns a class, class description, major ID, minor ID, name, and value. Name and value are the easiest to remember – they are the same values you entered in sp_addextendedproperty.</p>
<p>Then things start getting a little different. Most of the level 0 properties tie into a specific class. Rather than querying levels to find objects – the way we added the properties – we query for classes. To view database-level extended properties, we look for class 0. To view plan guide properties, we look for class 27. (A full list can be found <a href="http://technet.microsoft.com/en-us/library/ms177541.aspx">here</a>.) Then details about level 1 and level 2 objects are found by using the major ID and minor ID.</p>
<p>For example, I want to view the extended properties for an index on a table in a specific schema. In my WHERE clause, I would set the class = 7. To find the table name, I’d join sys.extended_properties.major_id to sys.tables.object_id. To find the index name, I’d join sys.extended_properties.major_id to sys.indexes.object_id and sys.extended_properties.minorid to sys.indexes.index_id.</p>
<p>Let’s look at this by using only the information available in sys.extended_properties.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> EP<span class="sy0">.</span>class_desc <span class="kw1">AS</span> PropertyOn<span class="sy0">,</span> 
&nbsp; &nbsp; DB_NAME<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> DatabaseName<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span>name <span class="kw1">AS</span> ExtendedPropertyDescription<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span><span class="kw1">VALUE</span> <span class="kw1">AS</span> ExtendedPropertyValue 
<span class="kw1">FROM</span> sys<span class="sy0">.</span>extended_properties <span class="kw1">AS</span> EP 
<span class="kw1">WHERE</span> EP<span class="sy0">.</span>name <span class="sy0">&lt;&gt;</span> <span class="st0">'MS_Description'</span> 
&nbsp; &nbsp; <span class="kw1">AND</span> EP<span class="sy0">.</span>class <span class="sy0">=</span> <span class="nu0">7</span>; </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT EP.class_desc AS PropertyOn, 
	DB_NAME() AS DatabaseName, 
	EP.name AS ExtendedPropertyDescription, 
	EP.value AS ExtendedPropertyValue 
FROM sys.extended_properties AS EP 
WHERE EP.name &lt;&gt; 'MS_Description' 
	AND EP.class = 7; </pre></div></div>

<p style="text-align: center;"><img src="/wp-content/uploads/users/grrlgeek/xp 1.JPG?mtime=1383748570" alt="" /></p>
<p style="text-align: center;"><em>Figure 2: sys.extended_properties results</em></p>
<p>The information returned is very basic. I can tell this property is for an index, but I can’t tell for which table or index. I can join this view to others to get more information.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> EP<span class="sy0">.</span>class_desc <span class="kw1">AS</span> PropertyOn<span class="sy0">,</span> 
&nbsp; &nbsp; DB_NAME<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> DatabaseName<span class="sy0">,</span> 
&nbsp; &nbsp; SCH<span class="sy0">.</span>name <span class="kw1">AS</span> SchemaName <span class="sy0">,</span> 
&nbsp; &nbsp; TBL<span class="sy0">.</span>name <span class="kw1">AS</span> TableName<span class="sy0">,</span> 
&nbsp; &nbsp; IND<span class="sy0">.</span>name <span class="kw1">AS</span> IndexName<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span>name <span class="kw1">AS</span> ExtendedPropertyDescription<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span><span class="kw1">VALUE</span> <span class="kw1">AS</span> ExtendedPropertyValue 
<span class="kw1">FROM</span> sys<span class="sy0">.</span>extended_properties <span class="kw1">AS</span> EP 
&nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="kw1">JOIN</span> sys<span class="sy0">.</span><span class="kw1">TABLES</span> TBL <span class="kw1">ON</span> TBL<span class="sy0">.</span>object_id <span class="sy0">=</span> EP<span class="sy0">.</span>major_id 
&nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="kw1">JOIN</span> sys<span class="sy0">.</span>schemas SCH <span class="kw1">ON</span> SCH<span class="sy0">.</span>schema_id <span class="sy0">=</span> TBL<span class="sy0">.</span>schema_id 
&nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="kw1">JOIN</span> sys<span class="sy0">.</span>indexes IND <span class="kw1">ON</span> IND<span class="sy0">.</span>object_id <span class="sy0">=</span> TBL<span class="sy0">.</span>object_id 
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">AND</span> IND<span class="sy0">.</span>index_id <span class="sy0">=</span> EP<span class="sy0">.</span>minor_id
<span class="kw1">WHERE</span> EP<span class="sy0">.</span>name <span class="sy0">&lt;&gt;</span> <span class="st0">'MS_Description'</span> 
&nbsp; &nbsp; <span class="kw1">AND</span> EP<span class="sy0">.</span>class <span class="sy0">=</span> <span class="nu0">7</span>; &nbsp;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT EP.class_desc AS PropertyOn, 
	DB_NAME() AS DatabaseName, 
	SCH.name AS SchemaName , 
	TBL.name AS TableName, 
	IND.name AS IndexName, 
	EP.name AS ExtendedPropertyDescription, 
	EP.value AS ExtendedPropertyValue 
FROM sys.extended_properties AS EP 
	LEFT JOIN sys.tables TBL ON TBL.object_id = EP.major_id 
	LEFT JOIN sys.schemas SCH ON SCH.schema_id = TBL.schema_id 
	LEFT JOIN sys.indexes IND ON IND.object_id = TBL.object_id 
		AND IND.index_id = EP.minor_id
WHERE EP.name &lt;&gt; 'MS_Description' 
	AND EP.class = 7;  </pre></div></div>

<p> </p>
<p>The results are much more comprehensive now.</p>
<p> </p>
<p style="text-align: center;"><img src="/wp-content/uploads/users/grrlgeek/xp 2.JPG?mtime=1383748570" alt="" /></p>
<p style="text-align: center;"><em>Figure 3: Joining sys.extended_properties to other views for better results</em></p>
<p>Let’s look at a few other examples. (Note that our end goal is to have “one query to rule them all” – I want to be able to run one general query to get the results into an SSRS report. Thus, there will be some NULL columns.)</p>
<p>I added some database-level properties. To query those, I look for class 0. Note that I’m not joining it to any other views – all the information is contained in sys.extended_properties.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> EP<span class="sy0">.</span>class_desc <span class="kw1">AS</span> PropertyOn<span class="sy0">,</span> 
&nbsp; &nbsp; DB_NAME<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> DatabaseName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> SchemaName <span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> TableName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> ColumnName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> IndexName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> ProcedureName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> ParameterName<span class="sy0">,</span>
&nbsp; &nbsp; EP<span class="sy0">.</span>name <span class="kw1">AS</span> ExtendedPropertyDescription<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span><span class="kw1">VALUE</span> <span class="kw1">AS</span> ExtendedPropertyValue
<span class="kw1">FROM</span> sys<span class="sy0">.</span>extended_properties <span class="kw1">AS</span> EP 
<span class="kw1">WHERE</span> EP<span class="sy0">.</span>name <span class="sy0">&lt;&gt;</span> <span class="st0">'MS_Description'</span> 
&nbsp; &nbsp; <span class="kw1">AND</span> EP<span class="sy0">.</span>class <span class="sy0">=</span> <span class="nu0">0</span>; </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT EP.class_desc AS PropertyOn, 
	DB_NAME() AS DatabaseName, 
	NULL AS SchemaName , 
	NULL AS TableName, 
	NULL AS ColumnName, 
	NULL AS IndexName, 
	NULL AS ProcedureName, 
	NULL AS ParameterName,
	EP.name AS ExtendedPropertyDescription, 
	EP.value AS ExtendedPropertyValue
FROM sys.extended_properties AS EP 
WHERE EP.name &lt;&gt; 'MS_Description' 
	AND EP.class = 0; </pre></div></div>

<p style="text-align: center;"><img src="/wp-content/uploads/users/grrlgeek/xp 3.JPG?mtime=1383748570" alt="" /></p>
<p style="text-align: center;"><em>Figure 4: database results</em></p>
<p>I’ve documented the schemas in the database – remember, these were level 0. To get the properties, I’ll query class 3. Here, I want to join to sys.schemas to get the schema name.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> EP<span class="sy0">.</span>class_desc <span class="kw1">AS</span> PropertyOn<span class="sy0">,</span> 
&nbsp; &nbsp; DB_NAME<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> DatabaseName<span class="sy0">,</span> 
&nbsp; &nbsp; SCH<span class="sy0">.</span>name <span class="kw1">AS</span> SchemaName <span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> TableName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> ColumnName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> IndexName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> ProcedureName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> ParameterName<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span>name <span class="kw1">AS</span> ExtendedPropertyDescription<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span><span class="kw1">VALUE</span> <span class="kw1">AS</span> ExtendedPropertyValue
<span class="kw1">FROM</span> sys<span class="sy0">.</span>extended_properties <span class="kw1">AS</span> EP 
&nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="kw1">JOIN</span> sys<span class="sy0">.</span>schemas SCH <span class="kw1">ON</span> SCH<span class="sy0">.</span>schema_id <span class="sy0">=</span> EP<span class="sy0">.</span>major_id 
<span class="kw1">WHERE</span> EP<span class="sy0">.</span>name <span class="sy0">&lt;&gt;</span> <span class="st0">'MS_Description'</span> 
&nbsp; &nbsp; <span class="kw1">AND</span> EP<span class="sy0">.</span>class <span class="sy0">=</span> <span class="nu0">3</span>; </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT EP.class_desc AS PropertyOn, 
	DB_NAME() AS DatabaseName, 
	SCH.name AS SchemaName , 
	NULL AS TableName, 
	NULL AS ColumnName, 
	NULL AS IndexName, 
	NULL AS ProcedureName, 
	NULL AS ParameterName, 
	EP.name AS ExtendedPropertyDescription, 
	EP.value AS ExtendedPropertyValue
FROM sys.extended_properties AS EP 
	LEFT JOIN sys.schemas SCH ON SCH.schema_id = EP.major_id 
WHERE EP.name &lt;&gt; 'MS_Description' 
	AND EP.class = 3; </pre></div></div>

<p style="text-align: center;"><img src="/wp-content/uploads/users/grrlgeek/xp 4.JPG?mtime=1383748570" alt="" /></p>
<p style="text-align: center;"><em>Figure 5: schema results</em></p>
<p>I also documented table information – this was a level 1 property, and is a class 1 – and column information, which is a level 2. Much like my index query above, I join to the sys.tables, sys.schemas, and sys.columns view to get additional information about the table and columns.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="sql"><thead><tr><td colspan="2"  class="head">SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> EP<span class="sy0">.</span>class_desc <span class="kw1">AS</span> PropertyOn<span class="sy0">,</span> 
&nbsp; &nbsp; DB_NAME<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> DatabaseName<span class="sy0">,</span> 
&nbsp; &nbsp; SCH<span class="sy0">.</span>name <span class="kw1">AS</span> SchemaName <span class="sy0">,</span> 
&nbsp; &nbsp; TBL<span class="sy0">.</span>name <span class="kw1">AS</span> TableName<span class="sy0">,</span> 
&nbsp; &nbsp; COL<span class="sy0">.</span>name <span class="kw1">AS</span> ColumnName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> IndexName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> ProcedureName<span class="sy0">,</span> 
&nbsp; &nbsp; <span class="kw1">NULL</span> <span class="kw1">AS</span> ParameterName<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span>name <span class="kw1">AS</span> ExtendedPropertyDescription<span class="sy0">,</span> 
&nbsp; &nbsp; EP<span class="sy0">.</span><span class="kw1">VALUE</span> <span class="kw1">AS</span> ExtendedPropertyValue 
<span class="kw1">FROM</span> sys<span class="sy0">.</span>extended_properties <span class="kw1">AS</span> EP 
&nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="kw1">JOIN</span> sys<span class="sy0">.</span><span class="kw1">TABLES</span> TBL <span class="kw1">ON</span> TBL<span class="sy0">.</span>object_id <span class="sy0">=</span> EP<span class="sy0">.</span>major_id 
&nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="kw1">JOIN</span> sys<span class="sy0">.</span>schemas SCH <span class="kw1">ON</span> SCH<span class="sy0">.</span>schema_id <span class="sy0">=</span> TBL<span class="sy0">.</span>schema_id 
&nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="kw1">JOIN</span> sys<span class="sy0">.</span><span class="kw1">COLUMNS</span> COL <span class="kw1">ON</span> COL<span class="sy0">.</span>object_id <span class="sy0">=</span> TBL<span class="sy0">.</span>object_id 
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">AND</span> COL<span class="sy0">.</span>column_id <span class="sy0">=</span> EP<span class="sy0">.</span>minor_id
<span class="kw1">WHERE</span> EP<span class="sy0">.</span>name <span class="sy0">&lt;&gt;</span> <span class="st0">'MS_Description'</span> 
&nbsp; &nbsp; <span class="kw1">AND</span> EP<span class="sy0">.</span>class <span class="sy0">=</span> <span class="nu0">1</span>; &nbsp;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT EP.class_desc AS PropertyOn, 
	DB_NAME() AS DatabaseName, 
	SCH.name AS SchemaName , 
	TBL.name AS TableName, 
	COL.name AS ColumnName, 
	NULL AS IndexName, 
	NULL AS ProcedureName, 
	NULL AS ParameterName, 
	EP.name AS ExtendedPropertyDescription, 
	EP.value AS ExtendedPropertyValue 
FROM sys.extended_properties AS EP 
	LEFT JOIN sys.tables TBL ON TBL.object_id = EP.major_id 
	LEFT JOIN sys.schemas SCH ON SCH.schema_id = TBL.schema_id 
	LEFT JOIN sys.columns COL ON COL.object_id = TBL.object_id 
		AND COL.column_id = EP.minor_id
WHERE EP.name &lt;&gt; 'MS_Description' 
	AND EP.class = 1;  </pre></div></div>

<p style="text-align: center;"><img src="/wp-content/uploads/users/grrlgeek/xp 5.JPG?mtime=1383748571" alt="" /></p>
<p style="text-align: center;"><em>Figure 6: table and column information</em></p>
<p>The hardest part of using extended properties is understanding what class, major ID, and minor ID stand for. As  you use them more, it will become much easier to understand, and I hope that these examples help as you document your databases.</p>
<h3><strong>What’s Next? </strong></h3>
<p>Having the information in your database is great – but it’s only the start. You’ll want to be able to easily pull the information when needed. You could write a series of queries, save the .sql files, and run them over and over again. But that isn’t going to help other people in your organization – the junior DBA who isn’t sure which table to modify, the developer who needs to understand why a certain index was added, or the analyst who is trying to understand the database layout to write reports.</p>
<p>But what if you could write these queries and add them to an SSRS report?</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/document-your-sql-server-databases/#comments" thr:count="8"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/document-your-sql-server-databases/feed/atom/" thr:count="8"/>
		<thr:total>8</thr:total>
		</entry>
		<entry>
		<author>
			<name>SQLDenis</name>
					</author>
		<title type="html"><![CDATA[Nice Collection Of Free SQL Server, Visual Studio, Azure ebooks]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/nice-collection-of-free-sql/" />
		<id>/index.php/2013/06/nice-collection-of-free-sql/</id>
		<updated>2013-06-19T12:17:00Z</updated>
		<published>2013-06-19T12:17:00Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="Database Programming" /><category scheme="/" term="Excel Reporting" /><category scheme="/" term="Microsoft SQL Server" /><category scheme="/" term="Microsoft SQL Server Admin" /><category scheme="/" term="SSAS" /><category scheme="/" term="SSIS" /><category scheme="/" term="SSRS" /><category scheme="/" term="ebook" /><category scheme="/" term="sql server" /><category scheme="/" term="sql server 2012" />		<summary type="html"><![CDATA[Eric Ligman has posted a nice collection of ebooks available in pdf, epub and mobi formats. The books cover Office, Office 365, SharePoint, SQL Server, System Center, Visual Studio, Web Development, Windows, Windows Azure, and Windows Server

Here is&#8230;]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/nice-collection-of-free-sql/"><![CDATA[<p>Eric Ligman has posted a nice collection of ebooks available in pdf, epub and mobi formats. The books cover Office, Office 365, SharePoint, SQL Server, System Center, Visual Studio, Web Development, Windows, Windows Azure, and Windows Server</p>
<p>Here is what is available for SQL Server</p>
<p>5 Tips for a Smooth SSIS Upgrade to SQL Server 2012<br />
A Hitchiker&#8217;s Guide to Microsoft StreamInsight Queries<br />
Data Mining Extensions (DMX) Reference<br />
Data Quality Services<br />
High Availability Solutions<br />
Master Data Services<br />
Monitor and Tune for Performance<br />
Multidimensional Expressions (MDX) Reference<br />
SQL Server Distributed Replay<br />
Transact-SQL Data Definition Language (DDL) Reference<br />
XQuery Language Reference<br />
Extracting and Loading SharePoint Data in SQL Server Integration Services<br />
Integration Services: Extending Packages with Scripting<br />
Multidimensional Model Programming<br />
Optimized Bulk Loading of Data into Oracle<br />
Planning Disaster Recovery for Microsoft SQL Server Reporting Services in SharePoint Integrated Mode<br />
SQL Server 2012 Tutorials: Reporting Services<br />
SQL Server 2012 Tutorials: Writing Transact-SQL Statements<br />
SQL Server Community FAQs Manual </p>
<p>You can get all the links from here: http://blogs.msdn.com/b/mssmallbiz/archive/2013/06/18/huge-collection-of-free-microsoft-ebooks-for-you-including-office-office-365-sharepoint-sql-server-system-center-visual-studio-web-development-windows-windows-azure-and-windows-server.aspx?Redirected=true</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/nice-collection-of-free-sql/#comments" thr:count="0"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/nice-collection-of-free-sql/feed/atom/" thr:count="0"/>
		<thr:total>0</thr:total>
		</entry>
		<entry>
		<author>
			<name>Ted Krueger (onpnt)</name>
					</author>
		<title type="html"><![CDATA[Define Microsoft Business Intelligence for me?]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/define-microsoft-business-intelligence-for/" />
		<id>/index.php/2013/01/define-microsoft-business-intelligence-for/</id>
		<updated>2013-01-29T20:45:00Z</updated>
		<published>2013-01-29T20:45:00Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="Microsoft SQL Server" />		<summary type="html"><![CDATA[What is Microsoft Business Intelligence?  I’m not asked this question very often because it’s typically an assumption.  As we know, assumptions can lead to misguidance or misrepresentation of a topic. This topic has been defined in so many different way&#8230;]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/define-microsoft-business-intelligence-for/"><![CDATA[<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-215.png?mtime=1359498894"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-215.png?mtime=1359498894" width="150" height="165" align="left" /></a></div>
<p>What is Microsoft Business Intelligence?  I’m not asked this question very often because it’s typically an assumption.  As we know, assumptions can lead to misguidance or misrepresentation of a topic. This topic has been defined in so many different ways; I ask it in almost every interview I perform that has the word, “Data” in it.  The reasoning for asking that question isn’t directly to say a person is wrong or right but to see the range they’ve taken on in knowing all the factors that lead to end solutions in data.  </p>
<p> </p>
<p>First, I should probably answer the question as it is, from my own experience with Microsoft Business Intelligence.  </p>
<p><em>Microsoft Business Intelligence is a set of tools, features and services that help business visualize data.  The evolution of data in which it transforms from raw data to an analytical view or visualization of data, is the overall process of both data services and business intelligence.  In the concept from raw data to analytical or visualization, business intelligence lies on the right side of the model – analytical and visualization.  With Microsoft, this encompasses technology such as PowerPivot, Power View, SQL Server Analysis Services, SQL Server Reporting Services, SQL Server Warehouse fundamentals (a cool way of saying, OLAP designed data storage) and pieces of SQL Server Integration Services.</em></p>
<p>As we can see, my definition does not have much revolving around SQL Server form a performance stand point.  The word performance lends itself to many areas, such as database design, SQL Server setup/configuration/maintainability, ETL and scalability.  </p>
<p>A great example of how these two topics relate but can be considered on a different level of focus is the path one or more OLTP designed databases take to an OLAP designed database.  With Microsoft, we look to a normal on-premise landscape that consists of one or more transactional databases housed on SQL Server; a push and pull method using SQL Server Integration Services as a high performance extract, transform and load structure; ending with SQL Server Analysis Services in a cube type layout of the data after manipulation or, real time manipulation occurring.  </p>
<p>Seeing this path, we’ve only touched on the Business Intelligence area with the ending on SSAS.  Once this task is completed, the real BI landscape sets in with the visualization of the data.  During this entire transfer, BI and Performance cross each other in a few areas.  To best illustrate this crossing of utilization, we can draw a guide. </p>
<p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/-214.png?mtime=1359498781"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/-214.png?mtime=1359498781" width="839" height="224" /></a></div>
</p>
<p>As we can see from above, there are two areas of overlap, SQL Server Analysis Service and SQL Server Integration Services.  This comes in because both have a performance aspect and a BI aspect to how successfully they will be utilized.  SQL Server Analysis Services relates directly to how the data is stored and the analytical behavior it takes on pulling calculated fields into a visualization form. A poor OLAP design can create a bottleneck or ineffective ability to utilize SQL Server Analysis Services without added effort on altering the data.  This is even more relevant in SQL Server Integration Services. While performance is important in SQL Server Analysis Service, it is brought to an entirely new level in SQL Server Integration Services.  The extraction of data requires a high performance method so the sources and destinations can withstand the high volume of requirements.  SQL Server Integration Services is also highly accountable for in-process transformation or manipulation of the data.  The transformation of the data is also a key area that requires being attentive to how it is done as it relates to performance.  </p>
<p>Once we define what business intelligence is and can be for business, the next step is defining how it relates to implementing and structuring the design of a business intelligence implementation. Taking how we define business intelligence has a direct impact to how we gauge infrastructure and technology utilization, and skills utilization.  This leads to cost effectively placing resources accurately as it pertains to budgets, purchasing of the right technology and services.  </p>
<p><strong>Summary</strong></p>
<p>With any high level topic or focus point in technology, defining how we utilize it effectively from the correct impact of skills to hardware consumption will define the success of consuming the technology into your business.  </p>
<p>While SQL Server Analysis Services and SQL Server Integration Services share resources from both performance and business intelligence, the two skillsets are unique in mastering their areas.  Fully understanding one takes a great deal of discipline and motivation.  Falling into a range of working on both can lead to a lack of fully representing the sides as best as they can be.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/define-microsoft-business-intelligence-for/#comments" thr:count="0"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/define-microsoft-business-intelligence-for/feed/atom/" thr:count="0"/>
		<thr:total>0</thr:total>
		</entry>
		<entry>
		<author>
			<name>Ted Krueger (onpnt)</name>
					</author>
		<title type="html"><![CDATA[Driving Predictive Analytics]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/driving-predictive-analytics/" />
		<id>/index.php/2013/01/driving-predictive-analytics/</id>
		<updated>2013-01-23T14:31:00Z</updated>
		<published>2013-01-23T14:31:00Z</published>
		<category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="Microsoft SQL Server" />		<summary type="html"><![CDATA[Remember this article, “Comparing the Chicago Highway System to your Disaster/Recovery”?

Well, today, as with most days that I drive to the office or a client, the drive was lengthy and I started to compare the complete system of driving to a topic. &#8230;]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/driving-predictive-analytics/"><![CDATA[<p>Remember this article, “<a href="/index.php/DataMgmt/DataDesign/comparing-the-chicago-highway-system-to-">Comparing the Chicago Highway System to your Disaster/Recovery</a>”?</p>
<p style="text-align: center;"> </p>
<div class="image_block"><a href="/media/blogs/DataMgmt/pred_1.gif?mtime=1358960651"><img src="/wp-content/uploads/blogs/DataMgmt/pred_1.gif?mtime=1358960651" alt="" width="617" height="158" /></a></div>
<p> </p>
<p>Well, today, as with most days that I drive to the office or a client, the drive was lengthy and I started to compare the complete system of driving to a topic.  This time, instead of DR, I was thinking about <a href="http://en.wikipedia.org/wiki/Predictive_analytics">predictive analytics</a>.  To this day, I’ve been fortunate and not been in a major accident.  In fact, the only accident I was in was a bump on the bumper that didn’t warrant much more than an, “I’m sorry”.   The reason for that comes from the same concept as predictive analytics follows.</p>
<p><strong>Predictive Driving vs. Analytics </strong></p>
<div class="image_block"><a href="/media/blogs/DataMgmt/-195.png?mtime=1358960652"><img src="/wp-content/uploads/blogs/DataMgmt/-195.png?mtime=1358960652" alt="" width="208" height="156" align="left" /></a></div>
<p>The method I’ve chosen in driving is a predictive, offensive method.  While driving, I’m attentive to the objects around me.  These objects are break lights, manner in which a person is seated while driving and even, how a car is maintaining a path between the lines.  What also comes to mind is the past.  When you drive on a road, roughly the same time, you begin to retain a historical picture of the road, merges and even cars that are familiar and how they drove the last time you were near them.  Given that compilation or, aggregation of data in my own head, I predictively can make judgment calls on whether I’ll slow down to avoid a driver, switch lanes a mile early to avoid a backup for an on ramp or even, prepare to stop when I know, traffic will be stopping or slowing.</p>
<p> </p>
<p><img style="float: left;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADoAAAA7CAIAAAClhQ7aAAATB0lEQVRogbWZeVhTV/7GmeloF/eFiitqrXu1+qt1po5PW9tqq9Pa0ZnadtraTlFbbeuudUEUN1q01qVuoGwFBBEkIGsQAjGQAAnZFxKSANlXwpLl3nu+vz9OEoOlnar1fXgCSe4953Pe+97vPecQBn+0ECAECPn/pAABAgCgACgSEInfU4CA8n9zPwr7o2kB0wAg8NMg/4//N4IHAsV6BLgQxEMIqKDdCBAFAEBRQJBAAnoQ5j8el8TmBi45QoAQhYAigURABkZCIXzUfeqPxw11FiEggCRRLzI8AOqB4vDIwkABQiSJKAoBQiTh0XSbSrtbr3udXBI8AIDQg/A+CncpCnBSfQgAeZ09xqSe1m3etk0+1Zoe7ltOzjeEQwTwILfbo3AXUQC4YCGyq0d7imj9Aqx7wLYXrF+D7l2icpr95nJfp+YBmn4UhYwCAAoBANVtzPcqV4F1F2H/DtliwbQdta9BjS90pgw3lu8AIO7X4EfhLgmIAhIQcrrEO0nVu2DaTNkOQ8dhMGxEiqVk9Uxv+gj12QUeh/qXJ/92ph9FdhECBAjIbkNn9TsgfRXaPgH950j3GchXINZcuDnZd2V4/a6nTRImALjd7q6urq6urp6eHoIgMPGvQT+SykDh2uAxdZS+SVVNRU2LKMEixPkrqpyJaON8SeGtP4xqPPeOUSWw2h0Gg0Gv1xsMBoPBYDabe3p6fqPlR1PI/Hc9YaDvcCePhKLJqCgSaBOo7IiOxOHGtFdM7CSbuc1ksegNBpPJZDGbbTabzWYzmUxms5kgSQDo09+HxkUIAQQfURRlpyg7gA+/7WpvaDk5tfvyKCp1TPfVcPOZp035XzrahHa702i2WIwGq8lkMJpUam1VVeXVhAtpqcm5eblV9NIuh6nP3h4KFwGecgEFJNkj8OoTXeJvnLX/7anb3t14zC3NIOy1muKt3J2DVAeGCg6E68piXSarydplMOntNodBZ1IqldWMsiuXzp09ezrr59SS0qKqGsatGxn5aee6XS7wX6W7Pj8cLqIQRQECopPn1u6m2j4A6RJEjySuD/ZdHdh1fpz90kzjpXnMDf0z/9VPmhvn6HAYzBazxeaydSqE/HouOz/7XOLpmILrGazaeq5AyBdJJDKFRiEpup7M5/GC3fwxuHj6SnnNnvYjhOVLqvUjVLsAaKPJrFFUaoQvcUzX+RHdPw6U7hrCSdpmt9t1FovJZnXYzPWF57MOLE6NWfJz3Frm7fJ6Lq9JwOVJZFKpQtqs0qiUFcV5ZWXlgW7uTjkeNrsIKK/9GmnYgAyfA3sRZI/zXBnlPB/hPDPadTbCemZk27FB2qTVHWaN3uy0mE0Og64mKTr568i0LcNv7BzHyjwoFki4fKFQzBfLmuWK5uYWjaZFlZ52tbyiwt9DiB4Wl/IofW27wfw5kv2DLHjW+WO4fN8wUfRQ0b5h8v0j5PsGcqLH2wQ0q63DZLZZzLrSC9svfjYubfvk8riZFbHTGZe/kEjFAolEKpXL5SqlUq5tbZUKBT+dOyOWSAHwM/KPCgMQHnM60m9Auk9I1nxv0ljmV8N+/teTuWsH53wy+ObaQdnv92OdW+twOkxGm8Nuo2efP/XRs8k7JhadnM2Mn86KfbbswHP19KRmlUYmV8iULS0tar1en5udkZaW3NXVDQCASPRA2Q1d05CASAAgPfKe1m1giEKit4E2uS1uaPzSx6KXPHn87QHx/3ji5Iqnjr0Rxru2qbvbZrV18nmcE9veu7r1peJD02riZrDiptbFzWAfmVx9YomMXShv1cnVKr3exKqp/u5odENtZaBb9GC4FAIK/GWLAgoh8LpNV6nm1cB/HcpnoaQJxVEDty7qt+fVp2KWPXFkxYCjb/X/4Z9PVR2c3V4aa9ErEy9fuvLTD7RTG2jbxjNjZ7C+n8U9NYf/0yz+2dmNCSvUvAKDwdiskMXHbv357NbEvas7zC0QsOcBcAMWB9aIPrfcLViFqmf5cka7kyLUx0bHL+2/45V+u1/7S8xrfz6+/E/xy8PyDizjZMdWnv3kZmr8Txcv32Zw2JUFuftfLdkxpf77acJzz0kT58pT5isTnhenvKUXlmUkXbocvTrn2+cT109ymdXgf57fje994SIKCECIAgoBeKxMX/l0VDiByIiwnxtB+/TJ7S89vvv1gTuXDTi4fEjm1/MFN44bNU0CAZdVVZafcz0v7yab0yAUSUQ1hcVH3q3aP0l4dpbi6nxxxjxF5kJV3rtZpzae3P/x1W+XJa6fwC/9EddbBIgMKbz3gYsAMC4Ok8dU6csbD7ciIX8CZI8RHw7f9deBn84cdvjDVxV3bjqNmq5uj97qauJxM1ITi4pLqhm1DTxhk5AvVzQ382srz0cxjz2nuDhXk/WKhX+Yfv3IxZioZl6xgl/j0KtxhwhIv0sPiuufIAIA9Ih8xYu82dN8tClAn4joM29tnrh+6siNLz7Hq2YY7R0KIZtXmpQTt/bK4c/KS2mNjbwmgYInk4nlcrla266S8JOiBOeWNaZtyjzzdfqF/dZ2RWh3FFAAJOqVhfvC7b0xYNQIsve8Gb1wQOWBiSBZCg0LyYK5Z94e9d6YET/t2lB7PZb5/cuCAxMr98zgFV/MTT3NZZYrFSqZRtui0Wm12pZmRVVG/MU9K+J2rr6dd4lwdwBegyBEAUnh5yUAAh8C6n+FAd39Cbz41eVysIryT2xaF7Vg7sczp6yb8ezlNRNQzWKong754wo2jv/39Anxq6bd2TJaFTtEc+Bx6bmVQHnqaytyUs+W5CRVFWRV5GZnpVxMuvzDuZM78jKOGDWcQKf+zQd/MQjsVoX23jcuhfzzwlA7ZXxeyrHD25YsXjtt3PpZkTtfnLNz4byv5k774vmnNWemwY0Jrkujb60bdeDNYSlrhjZuGdQWN1K5/ylRahQAECQlEglpNzNvZiUX5mbTy0pEIr7T2hYy5SLxevS31ScuCt1isRlaS1KTDn/43oY5U9fPnLTzxdn7/j5vx8JZX86Z/NHkUasjI9a9GMGNGddxZhR319BL7wyIW/Z44srHKr58Qn1kRPO3g1R50cGmfIjoIdweirxL5V8qUQgIvOvzALgAAITHw6uin9mxadOi+VEzJu1cMPvQKy/se3n+5hdmfDZt/OoJI/41c9zO95cXpKXq6F/48sZ0JkTQ1w2If/2xlFUDC/4zqGr9k7xdAzjbh1jvpPn96708QIgC8CEg/cD+0P0P3l64uEI5bbbsM6d3L39rw+ypWxdMP7B0YezSRbsXPb9u7uT3J4evjgxf/8rC8wf3NrGZJEkAAJIe8KYP056ISPtnP9pH/eT7BtlOhLsuj1XHDS2O6q+tvgL+OyZ0ExIF9k1D+UjAleu+cAUs5udzJx9846Xv3156aMniLS889/HUcSsnDF8zZ/LBTz+oyEp3mHutTDzCuI6EpxnbB2d80M90OoIsmAI1c4AxHeVENm55Iveb6Z0GEW49cK0pPygVWIWiwPe/PwzB5bLLajm59t/b/jrni1mTPpgYvmrK2I3LXk48HisX8HqdGph7uPVlqpPPXPvwsVtfDoSSGSB/C7RrCOFrUDJNeWTkDy+HXd20qMvWChAsn0EXQ5ED5eD3uxtU7vlTy4YP+u+8GXFfRVXdutnhtN+FvGsU8l9byi2/tvHUG2Ep74d5KueD/nNk/YqUvQO3Z6rjwo+/3H//38LSvn3D02nGY/RX17vFspcH942LAFxOa0F6slbK/+2TEQCiKABE9JgrkvZkbp3RWf13MEUh/ToQLYPyqbJjTx9a0u/km3+5uvJxTuJniOwAAAp7+0vU36G+cENaofzTedTn7jEFiKIQkF58BuGoJTmLQbMKKd+F2v9DeeM5e4fGvPqns8ufuPXJIMHeQSb6PgCSAiCCt93D4wb2vUkSCAqRgCiEN777EAkUhShEAQUAHmOpp24BiF9FDQugaIIveWxe1MB9i/+csHJgedQA64mRrstjXQ2n8I4q9WD/SkG9BYE5GwW4TYpCiMLb9b2FEKIQhRBF+tcnqEt60lszG7HnkBXPQvZo/YnRjSkbv/9w9pWVj7O/HtCdOBqKxrlynu1WXQMARCIK3W3ql+rz83txsUhABAIgAEggESACgED34JJYlM9LIZIEhDpdDZvJ21MoxhREm0ikjhfsHy7N2Fh19vOklf3FOwaROZHA+zvizHMWvUZYRRQCkiSp+1TYLz9CJIVIwosQRSCCIj3IS5AekvARveXzy016vD4CyB6dh7GSoj9DlU6A62M6L42T7BnC3jIocdXgs0v7S/cNQ7emg+pDaH7HVzLFxYr2IMLr8wYaubdxLLK3/LjB9/4jCJL0ET6S8BGE1+f1+jxen8fr9Xq9Xo/H4/F43G632+3u6enpdnu6e7qJTleXF3VbBL7CuVASSdEiicwI06lR4u3hd74ZfOKNPx36W1jtxgGQPwWEb4FsOVRMMeSs6HFqu9yerq5urJ6AcOOegLwh8vl8YZgyxC2fz+cLwuFz/XDd3XgjtrOz0+VydXR0OJ0up6PD6nDaXV2d8muewkmoeAy6MZ5IGaU6MqJu84if//PU0deein/9ceZXQ4iMSGDOAfZ8dOPptrQVTp3aYu2wWCxWq9Vms9ntdofD4XA4nE5nR0eHy+VyuVydnZ24Rzwet9sdFuQLOodH2Rec026322w2i8ViNpuNRqNBp9O1t2tadTptm6V6vzdvIiocC5lj3Rcj+HuHpHw04siy/tGL/nx62ZPC/eFE+mjIHw03IzvODlVk71So2hXNLUqlUq1WazSa1tbW9vZ2vV6v1+uNRqPJZLJYLBaLJTgSPIyw4JUNImI+l8vldDodDofdbrdarZhPp9O1tbVptdqWlpbmZqVMLhFLBE1NEl5jra5kHbo5CWijqIwJjjOjKraO2ffpiqhVr3y65JltL4cXRIXb4yN8F0fZTo68c3QRozCzillbV1vX0NDQ1NQkEAjEYrFMJlMoFEqlsqWlRavVBgdgwHvAFovVag37pYv3IBoMhvb2dq1Wq9FoVCqVXC6XSCQCgYDL5Tay2bV3am8z7pSV01R5H0P+RLgxjkgZbTw6OGfLS98dPv5t9MHNm7/+Yu2azWveOPDh4kMfzYte+7fj0dsSklNu5OaUlpRUVlbW1NSwWCwOh8Plcvl8vlAoxOhyuRyjazSatrY2jB72u71slslkYrGYz+dzuVw2m33nzp3bVZWlZWWFtIKs61klibvtqTOprMiei6NZ28ef/Oa9wzGxhw7GHI6NPXTkaEzs93tjj8YcOXw0/vQPFy5cSbp8PfNaQT6tpKSETqdXVlYymcza2loOh9PY2Mjj8TC3VCqVy+XNzc0qlUqtVre2tob1CarX63U6XWtrq1qtVqlUCoVCIpEIhcKmpqbGxkbMymAwysrLiwqL83Ly0jMyLp0/fSH6g+w9L6ZvWRiz4d1dO7fEHIg5evTodydOnjr944Wfzl9KuJh8NSUjOTMzMzsrJzM3N7eAVlBcXFxWVlZRUcFgMJhMJovFYrPZ9fX1XC63qakJOy2VSnFI1Gp1WPAGCmVtb2/HrEqlUqFQSKVSkUiEA1BfX89ms1ksVk1NTWVlJb2cXlxcXFhYePNmfnpGZsKlCxfOnbt46fLlhMSEhISEhMQrV68mJyenpaWlp6dnZWXnXM/Jy83Lp+UXFhYWFRWVlpbS6fTbt28zGAycirq6uvr6+sbGRpxpkUgU6nGYw+HArBaLxWQyGQwGnAGc1HtweTxeQ0MDh8Opq6tjsVhMJrO6urqqqqqysrKiooJOrygtoxeVlBYVFRUWFtJotPz8fFp+Po1GKygoKCgouHXrVlFRUXFxcWlJaVlZGZ1Or6ioqKqqClpbV1fH4XAaGhqC7opEIolEErwLw3AGgrUpaK1Go2lpaQniisViHAYej9fY2FhfX8/hcNhsdl1dXW1tLYvFunPnDpPJxK81NTXV1dUMBgOPJFQYjsFgVFdX19TU4MjW1tay2ewgaDC7YrE4lFWlUt3FNZlMwdQG7zCVStXc3CyXyzGxSCQSCoUCgQBz83g8LpfbGFBDb+HxYNUFFPyEw+HU19fj644Rm5qa+Hy+QCAIBcUxwKxqtfpeXBwGbLBWq1Wr1djj5uZmhUKBuaVSqUQiwfR4AH2Kz+fz+fymXxEmwy7ii44Rg5QKhSII2tLSgp8mvbJrNpuD8cXQ2GaNRqNWq3GVUAaEB4Al70symUwmk0l/XbKA8PGY7x5ETBl8avhx8aMVK2gzDkZ7ezvmxn5j+uAAsP2hUv1Cyl9R6DFBuCAfRmxtbcXPCJ1Op9frw4JFF0Njm4NOG43GIDqmDx1AqFp/U6Hda3sreEywKdw+7ksfkMFgMBqNYXjugqsv1j3QQfRQeix9X9L9PgWBggolw3BYpoDMZnMYnicEobHToWZjBaNiNpuD9KEyPrSCTKGyhMhqtd6dM3QEFOQOoocaf49Cx2P9dVn60m8cjyfB+BULA/w/pI9lYdywA7QAAAAASUVORK5CYII=" alt="" />All of these aspects are right in line with a successful design methodology for predictive analytics.  A successful design brings in historic views of how data was, how it changed and how it may appear in the future.  This works much the same as driving.  In fact, I’d push to the point that if more drivers acted in this manner, they may have less accidents and traffic would flow better.</p>
<p>Essentially, predictive analytics makes business flow better just as predictive driving may help traffic move better.  Think about that while tasked with a predictive analytics design in front of you.  Also, think about it while you are driving next time.  You may just miss rear ending that car in front of you.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/driving-predictive-analytics/#comments" thr:count="2"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/driving-predictive-analytics/feed/atom/" thr:count="2"/>
		<thr:total>2</thr:total>
		</entry>
		<entry>
		<author>
			<name>Ted Krueger (onpnt)</name>
					</author>
		<title type="html"><![CDATA[Database Designing With Performance In Mind]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/database-design-for-performance/" />
		<id>/index.php/2013/01/database-design-for-performance/</id>
		<updated>2013-01-22T10:53:00Z</updated>
		<published>2013-01-22T10:53:00Z</published>
		<category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="Database Administration" /><category scheme="/" term="Microsoft SQL Server" /><category scheme="/" term="Microsoft SQL Server Admin" />		<summary type="html"><![CDATA[Database design is the foundation on which we can build a successful initiative for maintenance and scalability.  Administrators have the ability to maintain indexing, statistics, integrity checks and so on, but if a database is designed extremely poorl&#8230;]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/database-design-for-performance/"><![CDATA[<p>Database design is the foundation on which we can build a successful initiative for maintenance and scalability.  Administrators have the ability to maintain indexing, statistics, integrity checks and so on, but if a database is designed extremely poorly, even the tasks of indexing or maintaining statistics accurately, becomes very difficult.  In some cases, the database is all but lost and a redesign initiative is needed, costly massive expenses.</p>
<p>When considering a database design, thinking of performance such as, how would this be indexed, in mind.  While maintaining that thought process, also keep in mind the type of design that is being created.  Historically, OLTP and OLAP are the high level designs to choose from.  OLTP being a highly transactional or insert/update/delete, database design while OLAP, retains a wide table concept and de-normalized approach due to highly readable and little changes made.</p>
<ol> </ol>
<p>In order to ascertain which of these designs required, there are two simple questions to ask.</p>
<ol>
<li>Is this for an <a href="http://en.wikipedia.org/wiki/Online_transaction_processing">OLTP</a> or <a href="http://en.wikipedia.org/wiki/Online_analytical_processing">OLAP</a> installation?</li>
<li>Do I normalize or de-normalize?</li>
</ol>
<p>These two questions are truly one and the same.  The first, OLTP or OLAP, dictates the second.  In an OLTP situation, what we’ll talk about today, normalization is going to effectively be critical to the performance we will have.  On the same side, OLAP designed database can suffer drastically from a deeply normalized design due to the movement from high write to high read events.  With the normalization being so critical, the first stage in that is to meet some level of normalization in an OLTP situation.  If situations do present themselves where normalization has become a performance problem due to read/write variations, de-normalization can be effective.</p>
<p><a href="http://en.wikipedia.org/wiki/Database_normalization">Normalization</a> is the standard process of reducing redundancy in a database.  Although there are many levels of normalization, called normalized form, we’re going to focus on a simplistic level of normalization and a secondary level or 2NF for the example shown in this article.  In this state of normalization, we will still see a high benefit in performance enhancements.</p>
<p>In the following two table structures, an ordering system was needed.  Both table structures meet the needs of an order header, details and shipment storage.  As shown in figure 1, the non-normalized structure has the word “poor” in the naming convention.</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/design_perf_1.gif?mtime=1358783965"><img alt="" src="/wp-content/uploads/blogs/All/design_perf_1.gif?mtime=1358783965" width="419" height="417" /></a></div>
<p>Figure 1 – Poor design showing lack of normalization</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-46.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-46.png?mtime=1358783966" width="624" height="355" /></a></div>
<p>Figure 2 – Better design moving to normalizing levels</p>
<p>Both designs have been preloaded with 116,000 header rows, 4.2 million detail rows and 10,000 shipment rows.  In the second, normalized structure, the Contact and Carrier tables are retaining data for 2000 contacts and 1000 carriers.</p>
<p><strong>The basic view of redundancy</strong></p>
<p>While designing, it is important to take the step of preloading expected data into your design.  This data is completely volatile, but valuable from the aspect of seeing where redundancy can occur.  Take the following queries:</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">TOP</span> <span class="nu0">1000</span> <span class="sy0">*</span> <span class="kw1">FROM</span> OrderHDR_Poor</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT TOP 1000 * FROM OrderHDR_Poor</pre></div></div>

</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">TOP</span> <span class="nu0">1000</span> <span class="sy0">*</span> <span class="kw1">FROM</span> OrderHDR</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT TOP 1000 * FROM OrderHDR</pre></div></div>

</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-47.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-47.png?mtime=1358783966" width="624" height="284" /></a></div>
<p>In the results above, we can see that the data in customerAddress, customerCity, customerRegion, and customerCountry is repeated.  This is a key indicator that normalizing the data is needed.  This has been done in the second structure shown in figure 2 with Contact and further with Carrier.</p>
<p><strong>Internal Structure Effects</strong></p>
<p>Internally, these designs also affect storage.  Since the designs are similar and the tables are relatively small, you may thing normalization isn’t needed.  Normalization relates to performance, though.  Some of the poor designs lead to inability to enhance performance with features available due to growth or scalability.  Take a simple tuning effort such as the disk subsystems.  A common standard is to locate files of different read and write needs on differently configured disks.  In another simplistic example, allocating tables to specific physical disk heads can have a major increase on overall performance.  Given the poor design in Figure 1, we have few options to effectively perform some of these methods to increase performance For example, if we rarely update customer addresses but insert a high number of order headers, we would want order headers to be located on a highly writable disk configuration, with the address data on cheaper, slower disk.</p>
<p>Another aspect to look at is how the design is affecting the overall page storage needs.  Setting data types aside, the normalization level will have a direct effect on how many pages are needed. In both designs, we can use catalog views to look at how this impacts page counts.</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> 
&nbsp; &nbsp; obj.<span class="me1">name</span>, 
&nbsp; &nbsp; idx.<span class="me1">name</span>,
&nbsp; &nbsp; all_units.<span class="me1">type_desc</span>, 
&nbsp; &nbsp; all_units.<span class="me1">total_pages</span>
<span class="kw1">from</span> sys.<span class="me1">objects</span> obj
&nbsp; <span class="kw1">inner</span> join sys.<span class="me1">partitions</span> parts <span class="kw1">on</span> obj.<span class="kw2">object_id</span> <span class="sy0">=</span> parts.<span class="kw2">object_id</span>
&nbsp; <span class="kw1">inner</span> join sys.<span class="me1">allocation_units</span> all_units <span class="kw1">on</span> all_units.<span class="me1">container_id</span> <span class="sy0">=</span> parts.<span class="me1">hobt_id</span>
&nbsp; <span class="kw1">inner</span> join sys.<span class="me1">indexes</span> idx <span class="kw1">on</span> parts.<span class="me1">index_id</span> <span class="sy0">=</span> idx.<span class="me1">index_id</span> and obj.<span class="kw2">object_id</span> <span class="sy0">=</span> idx.<span class="kw2">object_id</span>
<span class="kw1">where</span> obj.<span class="me1">type</span> <span class="sy0">=</span> <span class="st0">'U'</span> and obj.<span class="me1">name</span> <span class="sy0">&lt;&gt;</span> <span class="st0">'sysdiagrams'</span>
<span class="kw1">order</span> <span class="kw1">by</span> obj.<span class="me1">name</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select 
    obj.name, 
    idx.name,
    all_units.type_desc, 
    all_units.total_pages
from sys.objects obj
  inner join sys.partitions parts on obj.object_id = parts.object_id
  inner join sys.allocation_units all_units on all_units.container_id = parts.hobt_id
  inner join sys.indexes idx on parts.index_id = idx.index_id and obj.object_id = idx.object_id
where obj.type = 'U' and obj.name &lt;&gt; 'sysdiagrams'
order by obj.name</pre></div></div>

</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-48.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-48.png?mtime=1358783966" width="408" height="149" /></a></div>
<p>Figure 3 – Reviewing pages with catalog views</p>
<p>Although this information may not seem useful initially, it is critical to the performance of the database and what will be needed to satisfy the needs of both reads and writes in the database.  The amount of data is exactly the same while one design has been normalized and the other has not been. We can see that the normalized design is consuming 29,721 pages (based on the data volume discussed earlier) and with the non-normalized design using 39,611pages, or an increase in storage needs of 30%.</p>
<p><strong>Looking at Query Basics</strong></p>
<p>Querying data that is not normalized has a few concerns and performance aspects that should be taken into consideration.  The first is, querying data is faster when you have less need for joining tables. In a normalized design, joining tables is required.  As you normalize to higher forms, more joins may be needed.  Although this isn’t a new concept, you will still see a performance increase from simple queries from a normalized factor over the non-normalized design due to the overall page counts pulled into the buffer or, memory.</p>
<p>Take the example below and the plan generated from the query</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>select_OrderDetailsByOrderNum<span class="br0">&#93;</span> <span class="br0">&#40;</span>@ordernum <span class="kw1">INT</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="kw1">SELECT</span> 
&nbsp; &nbsp; hdr.<span class="me1">ordernum</span>,
&nbsp; &nbsp; hdr.<span class="me1">orderdate</span>,
&nbsp; &nbsp; dtl.<span class="me1">item</span>,
&nbsp; &nbsp; dtl.<span class="me1">itemcost</span>,
&nbsp; &nbsp; dtl.<span class="me1">itemqty</span>,
&nbsp; &nbsp; <span class="kw1">CASE</span> <span class="kw1">WHEN</span> ship.<span class="me1">ShipID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span> <span class="kw1">THEN</span> <span class="st0">'Not Shipped'</span> 
&nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="kw1">CAST</span><span class="br0">&#40;</span>shipDate <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">12</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">END</span> <span class="br0">&#91;</span>Ship <span class="kw1">Date</span><span class="br0">&#93;</span>
<span class="kw1">FROM</span> OrderHDR_Poor hdr
<span class="sy0">JOIN</span> OrderDTL_Poor dtl <span class="kw1">ON</span> hdr.<span class="me1">ordernum</span> <span class="sy0">=</span> dtl.<span class="me1">ordernum</span>
<span class="kw1">LEFT</span> <span class="sy0">JOIN</span> Shipment_Poor ship <span class="kw1">ON</span> dtl.<span class="me1">ShipID</span> <span class="sy0">=</span> ship.<span class="me1">shipID</span>
<span class="kw1">WHERE</span> hdr.<span class="me1">ordernum</span> <span class="sy0">=</span> @ordernum
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE [dbo].[select_OrderDetailsByOrderNum] (@ordernum INT)
AS
SELECT 
	hdr.ordernum,
	hdr.orderdate,
	dtl.item,
	dtl.itemcost,
	dtl.itemqty,
	CASE WHEN ship.ShipID IS NULL THEN 'Not Shipped' 
	ELSE CAST(shipDate AS VARCHAR(12)) END [Ship Date]
FROM OrderHDR_Poor hdr
JOIN OrderDTL_Poor dtl ON hdr.ordernum = dtl.ordernum
LEFT JOIN Shipment_Poor ship ON dtl.ShipID = ship.shipID
WHERE hdr.ordernum = @ordernum
GO</pre></div></div>

</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-49.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-49.png?mtime=1358783966" width="624" height="156" /></a></div>
<p>Figure 4 – Querying a poor design</p>
<p>In order to tune this plan, an index would help the overall performance on ordernum in the order details table.</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">NONCLUSTERED</span> <span class="kw1">INDEX</span> IDX_ordernum_ASC
<span class="kw1">ON</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>OrderDTL_Poor<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>ordernum<span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="sy0">IN</span>CLUDE <span class="br0">&#40;</span><span class="br0">&#91;</span>item<span class="br0">&#93;</span>,<span class="br0">&#91;</span>itemcost<span class="br0">&#93;</span>,<span class="br0">&#91;</span>itemqty<span class="br0">&#93;</span>,<span class="br0">&#91;</span>shipid<span class="br0">&#93;</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE NONCLUSTERED INDEX IDX_ordernum_ASC
ON [dbo].[OrderDTL_Poor] ([ordernum])
INCLUDE ([item],[itemcost],[itemqty],[shipid])
GO</pre></div></div>

</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-50.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-50.png?mtime=1358783966" width="426" height="146" /></a></div>
<p>Figure 5 – Plan after tuning</p>
<p>With the new plan after tuning with the indexing, the number of pages being pulled into the buffer are shown below in Figure 6.  Overall, the page count is not high.</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-51.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-51.png?mtime=1358783966" width="624" height="82" /></a></div>
<p>Figure 6 – Buffer review after tuning</p>
<p>This plan isn’t bad and will perform fairly well under normal conditions.  Let’s compare this to the same procedure and the plan that is generated based on the design of the normalized tables.</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> select_OrderDetailsByOrderNumv2 <span class="br0">&#40;</span>@ordernum <span class="kw1">INT</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="kw1">SELECT</span> 
&nbsp; &nbsp; hdr.<span class="me1">ordernum</span>,
&nbsp; &nbsp; hdr.<span class="me1">orderdate</span>,
&nbsp; &nbsp; dtl.<span class="me1">item</span>,
&nbsp; &nbsp; dtl.<span class="me1">itemcost</span>,
&nbsp; &nbsp; dtl.<span class="me1">itemqty</span>,
&nbsp; &nbsp; <span class="kw1">CASE</span> <span class="kw1">WHEN</span> ship.<span class="me1">ShipID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span> <span class="kw1">THEN</span> <span class="st0">'Not Shipped'</span> 
&nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="kw1">CAST</span><span class="br0">&#40;</span>shipDate <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">12</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">END</span> <span class="br0">&#91;</span>Ship <span class="kw1">Date</span><span class="br0">&#93;</span>
<span class="kw1">FROM</span> OrderHDR hdr
<span class="sy0">JOIN</span> OrderDTL dtl <span class="kw1">ON</span> hdr.<span class="me1">ordernum</span> <span class="sy0">=</span> dtl.<span class="me1">ordernum</span>
<span class="kw1">LEFT</span> <span class="sy0">JOIN</span> Shipment ship <span class="kw1">ON</span> dtl.<span class="me1">ShipID</span> <span class="sy0">=</span> ship.<span class="me1">shipID</span>
<span class="kw1">WHERE</span> hdr.<span class="me1">ordernum</span> <span class="sy0">=</span> @ordernum
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE select_OrderDetailsByOrderNumv2 (@ordernum INT)
AS
SELECT 
	hdr.ordernum,
	hdr.orderdate,
	dtl.item,
	dtl.itemcost,
	dtl.itemqty,
	CASE WHEN ship.ShipID IS NULL THEN 'Not Shipped' 
	ELSE CAST(shipDate AS VARCHAR(12)) END [Ship Date]
FROM OrderHDR hdr
JOIN OrderDTL dtl ON hdr.ordernum = dtl.ordernum
LEFT JOIN Shipment ship ON dtl.ShipID = ship.shipID
WHERE hdr.ordernum = @ordernum
GO</pre></div></div>

</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-52.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-52.png?mtime=1358783966" width="624" height="142" /></a></div>
<p>Figure 7 – normalizing and plan generated from same procedure</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">NONCLUSTERED</span> <span class="kw1">INDEX</span> IDX_Detail_Ordernum_ASC
<span class="kw1">ON</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>OrderDTL<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>ordernum<span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="sy0">IN</span>CLUDE <span class="br0">&#40;</span><span class="br0">&#91;</span>item<span class="br0">&#93;</span>,<span class="br0">&#91;</span>shipID<span class="br0">&#93;</span>,<span class="br0">&#91;</span>itemcost<span class="br0">&#93;</span>,<span class="br0">&#91;</span>itemqty<span class="br0">&#93;</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE NONCLUSTERED INDEX IDX_Detail_Ordernum_ASC
ON [dbo].[OrderDTL] ([ordernum])
INCLUDE ([item],[shipID],[itemcost],[itemqty])
GO</pre></div></div>

</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/All/urgh_1.gif?mtime=1358786105" width="437" height="143" /></div>
<p>Figure 8 – Plan after tuning</p>
<p>We do see a slight difference in the operational cost of the order header and detail tables.  This is effectively due to the cost associated with the size.  Looking at the buffer usage, we see a slightly lower number of pages from the header table.  Given the header table is the one holding the most redundancy in the non-normalized design, this was expected.</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/All/urgh_2.gif?mtime=1358786105" width="624" height="97" /></div>
<p>Figure 9 – Review buffered page counts</p>
<p>Another example would be a common task &#8211; check if an order is shipped. To do this, in both cases we need to look at the detail table and the shipment table.</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> sel_ShipDate <span class="br0">&#40;</span>@ordernum <span class="kw1">INT</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="kw1">SELECT</span> 
&nbsp; &nbsp; <span class="nu0">1</span>
<span class="kw1">FROM</span> OrderDTL_Poor dtl
<span class="kw1">INNER</span> <span class="sy0">JOIN</span> Shipment_Poor ship <span class="kw1">ON</span> dtl.<span class="me1">shipid</span> <span class="sy0">=</span> ship.<span class="me1">shipID</span>
<span class="kw1">WHERE</span> dtl.<span class="me1">ordernum</span> <span class="sy0">=</span> @ordernum
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE sel_ShipDate (@ordernum INT)
AS
SELECT 
	1
FROM OrderDTL_Poor dtl
INNER JOIN Shipment_Poor ship ON dtl.shipid = ship.shipID
WHERE dtl.ordernum = @ordernum
GO</pre></div></div>

</p>
<p> </p>
<p>From the above procedure, the following plan is generated and resulting buffer needs in page count.</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/design_perf_21.gif?mtime=1358784827"><img alt="" src="/wp-content/uploads/blogs/All/design_perf_21.gif?mtime=1358784827" width="809" height="283" /></a></div>
<p>Looking at the normalized design and the same needs, the following procedure can be used and executed.</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> sel_ShipDatev2 <span class="br0">&#40;</span>@ordernum <span class="kw1">INT</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="kw1">SELECT</span> 
&nbsp; &nbsp; <span class="nu0">1</span>
<span class="kw1">FROM</span> OrderDTL dtl
<span class="kw1">INNER</span> <span class="sy0">JOIN</span> Shipment ship <span class="kw1">ON</span> dtl.<span class="me1">shipid</span> <span class="sy0">=</span> ship.<span class="me1">shipID</span>
<span class="kw1">WHERE</span> dtl.<span class="me1">ordernum</span> <span class="sy0">=</span> @ordernum
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE sel_ShipDatev2 (@ordernum INT)
AS
SELECT 
	1
FROM OrderDTL dtl
INNER JOIN Shipment ship ON dtl.shipid = ship.shipID
WHERE dtl.ordernum = @ordernum
GO</pre></div></div>

</p>
<p> </p>
<p>Resulting in the following plan and buffer needs as page counts.</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/design_perf_20.gif?mtime=1358784827"><img alt="" src="/wp-content/uploads/blogs/All/design_perf_20.gif?mtime=1358784827" width="716" height="298" /></a></div>
<p>As we can see, there isn’t a large difference.  So far we’ve looked at queries and plans that are similar in resource consumption, other than a slight variance in pages pulled into the buffer.  Let’s take a look at the order header table now.  The order header table takes on a severe non-normalized factor.  The first thing that is obvious is the customer data.  In the poorly designed order header table, the customer data is not unique &#8211; it’s repeated and redundancy starts to creep in.</p>
<p>With the order header table, poor design and working towards normalization, we’ll start to see a larger impact to the IO requirements, equating to more CPU and buffer usage, from querying the table.  Let’s take a typical example where a query is needed to return customers that have placed more than 3 orders, the number of orders they have placed, and only orders that have shipped will be acceptable.  To perform this query, we would read both designs slightly differently.</p>
<p>Poor design – non-normalized</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> 
&nbsp; &nbsp; hdr.<span class="me1">customerName</span>,
&nbsp; &nbsp; <span class="kw2">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span>
<span class="kw1">from</span> OrderHDR_Poor hdr
join OrderDTL_Poor dtl <span class="kw1">on</span> hdr.<span class="me1">ordernum</span> <span class="sy0">=</span> dtl.<span class="me1">ordernum</span>
join shipment_Poor ship <span class="kw1">on</span> dtl.<span class="me1">shipid</span> <span class="sy0">=</span> ship.<span class="me1">shipid</span>
<span class="kw1">where</span> dtl.<span class="me1">shipid</span> <span class="kw1">is</span> not null
<span class="kw1">group</span> <span class="kw1">by</span> hdr.<span class="me1">customerName</span>
<span class="kw1">having</span> <span class="kw2">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="sy0">&gt;</span> <span class="nu0">3</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select 
	hdr.customerName,
	count(*)
from OrderHDR_Poor hdr
join OrderDTL_Poor dtl on hdr.ordernum = dtl.ordernum
join shipment_Poor ship on dtl.shipid = ship.shipid
where dtl.shipid is not null
group by hdr.customerName
having count(*) &gt; 3</pre></div></div>

</p>
<p> </p>
<p><strong>Normalizing</strong></p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> 
&nbsp; &nbsp; cust.<span class="me1">contactName</span>,
&nbsp; &nbsp; <span class="kw2">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span>
<span class="kw1">from</span> OrderHDR hdr
join OrderDTL dtl <span class="kw1">on</span> hdr.<span class="me1">ordernum</span> <span class="sy0">=</span> dtl.<span class="me1">ordernum</span>
join shipment ship <span class="kw1">on</span> dtl.<span class="me1">shipid</span> <span class="sy0">=</span> ship.<span class="me1">shipid</span>
join Contact cust <span class="kw1">on</span> hdr.<span class="me1">customerID</span> <span class="sy0">=</span> cust.<span class="me1">contactID</span>
<span class="kw1">where</span> dtl.<span class="me1">shipid</span> <span class="kw1">is</span> not null
<span class="kw1">group</span> <span class="kw1">by</span> hdr.<span class="me1">customerID</span>,cust.<span class="me1">contactName</span>
<span class="kw1">having</span> <span class="kw2">count</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="sy0">&gt;</span> <span class="nu0">3</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select 
	cust.contactName,
	count(*)
from OrderHDR hdr
join OrderDTL dtl on hdr.ordernum = dtl.ordernum
join shipment ship on dtl.shipid = ship.shipid
join Contact cust on hdr.customerID = cust.contactID
where dtl.shipid is not null
group by hdr.customerID,cust.contactName
having count(*) &gt; 3</pre></div></div>

</p>
<p> </p>
<p>Both of these queries are easily tuned with indexing on ShipID.  Further indexing could be done but we’ll look at indexing ShipID given it has the highest cost for both queries.</p>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">NONCLUSTERED</span> <span class="kw1">INDEX</span> IDX_ShipIDPoor
<span class="kw1">ON</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>OrderDTL_Poor<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>shipID<span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="sy0">IN</span>CLUDE <span class="br0">&#40;</span><span class="br0">&#91;</span>ordernum<span class="br0">&#93;</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE NONCLUSTERED INDEX IDX_ShipIDPoor
ON [dbo].[OrderDTL_Poor] ([shipID])
INCLUDE ([ordernum])
GO</pre></div></div>

</p>
<p> </p>
<p>Plan for the non-normalized design (note the sort operation due to poor statistics</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-58.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-58.png?mtime=1358783966" width="624" height="202" /></a></div>
<p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">NONCLUSTERED</span> <span class="kw1">INDEX</span> IDX_ShipID
<span class="kw1">ON</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>OrderDTL<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>shipID<span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="sy0">IN</span>CLUDE <span class="br0">&#40;</span><span class="br0">&#91;</span>ordernum<span class="br0">&#93;</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE NONCLUSTERED INDEX IDX_ShipID
ON [dbo].[OrderDTL] ([shipID])
INCLUDE ([ordernum])
GO</pre></div></div>

</p>
<p> </p>
<p>Now a plan for the more normalized design.</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-59.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-59.png?mtime=1358783966" width="624" height="197" /></a></div>
<p>These two plans take on a very different path and overall impact to the resource utilization for the server.  The first plan on the poor design, shows a small plan that is effectively performing two index seeks.  This, in many eyes, would be seen as okay and may be skipped over in a performance troubleshooting situation.  However, the overall execution time is 3062 milliseconds.  Again, this may not seem like a major issue but if this query was used in a normal operation that caused an execution count of 300 and hour, we are looking at a potential bottleneck in performance.  Poor statistics are also in play here and selectivity.  Altering the statistics by updating would generate a different but still, not memory effective plan. </p>
<p>Looking at the second plan on the table designs that have been normalized more, the plan appears to be working better.  Equating this to harder is not accurate though.  The total execution time for the design that has been normalized more is 296 milliseconds.  Looking at the plan, we see the sort operation is not coming in given the grouping now forced to the normalized table of Contact.  Both queries could be tuned further, but this shows a good representation of a typical performance issue we can find ourselves facing from a poorly designed table structure and lack of normalization.</p>
<p>So what were the IO effects?  The cause behind the poor performance of the design with little normalization was IO.</p>
<p>For the design that implemented more normalization, we pulled the following into the buffer.</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-60.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-60.png?mtime=1358783966" width="624" height="119" /></a></div>
<p>For the design that has little to no normalization</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-61.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-61.png?mtime=1358783966" width="624" height="110" /></a></div>
<p>As we can see, the impact of these two designs and either normalizing or not, has a major impact on the overall IO needs relating to needs for the memory.</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/All/-62.png?mtime=1358783966"><img alt="" src="/wp-content/uploads/blogs/All/-62.png?mtime=1358783966" width="782" height="299" /></a></div>
<p>The normalized procedure to insert a header row takes more effort with a lookup to the contact table to ensure there isn’t a violation of the key constraint.  The resources used in the insert and the page level, all equating to more IO, cause this to still be slightly more efficient though.</p>
<p><strong>Summary</strong></p>
<p>As shown, normalization is the basis of removing redundancy in a database.  Although redundancy may not seem, at first, like a concept that could impact performance, we’ve learned today that even a small amount of redundant data in a few columns can impact a database’s  resource needs, growth and scalability.</p>
<p>When designing OLTP or OLAP databases, take into account the data that will be stored.  Manipulate the tables as you design and go through modeling practices with data that would represent the future, completed design.  This will help identify needs for normalization or de-normalization, depending on which design you are working to accomplish.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/database-design-for-performance/#comments" thr:count="4"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/database-design-for-performance/feed/atom/" thr:count="4"/>
		<thr:total>4</thr:total>
		</entry>
		<entry>
		<author>
			<name>SQLDenis</name>
					</author>
		<title type="html"><![CDATA[Displaying missing dates by utilizing a calendar table]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/displaying-missing-dates-by-utilizing/" />
		<id>/index.php/2013/01/displaying-missing-dates-by-utilizing/</id>
		<updated>2013-01-17T23:59:00Z</updated>
		<published>2013-01-17T23:59:00Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="Database Programming" /><category scheme="/" term="Microsoft SQL Server" /><category scheme="/" term="calendar" /><category scheme="/" term="dates" /><category scheme="/" term="left join" />		<summary type="html"><![CDATA[We got a question today from a user who wanted to display counts of zero where dates were missing. For example if you had the following data

OrderDate	SomeCount
2013-01-01	2
2013-01-02	2
2013-01-03	1
2013-01-05	2
2013-01-07	1
2013-01-08	1
2013&#8230;]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/displaying-missing-dates-by-utilizing/"><![CDATA[<p>We got a question today from a user who <a href="http://forum.lessthandot.com/viewtopic.php?f=17&amp;t=18042">wanted to display counts of zero where dates were missing</a>. For example if you had the following data</p>
<pre>OrderDate	SomeCount
2013-01-01	2
2013-01-02	2
2013-01-03	1
2013-01-05	2
2013-01-07	1
2013-01-08	1
2013-01-09	2</pre>
<p>What you really wanted is the following</p>
<pre>OrderDate	SomeCount
2013-01-01	2
2013-01-02	2
2013-01-03	1
&lt;strong&gt;2013-01-04	0&lt;/strong&gt;
2013-01-05	2
&lt;strong&gt;2013-01-06	0&lt;/strong&gt;
2013-01-07	1
2013-01-08	1
2013-01-09	2</pre>
<p>As you can see we added January 4th and January 6th to the results with a count of zero.</p>
<p>Let&#8217;s get started, first we are going to created a calendar table</p>
<p>Here is a simple way to return a bunch of dates</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1">;<span class="kw1">with</span> cte <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">select</span> row_number<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">over</span><span class="br0">&#40;</span><span class="kw1">order</span> <span class="kw1">by</span> s1.<span class="me1">name</span><span class="br0">&#41;</span> <span class="kw1">as</span> <span class="kw1">Row</span>
<span class="kw1">from</span> sysobjects s1
cross join sysobjects s2<span class="br0">&#41;</span>
&nbsp;
&nbsp;
<span class="kw1">select</span> &nbsp;<span class="kw2">dateadd</span><span class="br0">&#40;</span><span class="kw1">day</span>,<span class="kw1">Row</span>,<span class="st0">'20091231'</span><span class="br0">&#41;</span> <span class="kw1">from</span> cte
<span class="kw1">where</span> <span class="kw1">Row</span> <span class="sy0">&lt;</span> <span class="nu0">5114</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">;with cte as (select row_number() over(order by s1.name) as Row
from sysobjects s1
cross join sysobjects s2)


select  dateadd(day,Row,'20091231') from cte
where Row &lt; 5114</pre></div></div>

<p>That will return dates between 2010-01-01 and 2023-12-31</p>
<p>Now let&#8217;s create the calendar table and insert the rows from the query above</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Calendar <span class="br0">&#40;</span>SomeDate <span class="kw1">date</span> not null <span class="kw1">primary</span> <span class="kw1">key</span><span class="br0">&#41;</span>
GO
&nbsp;
;<span class="kw1">with</span> cte <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">select</span> row_number<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">over</span><span class="br0">&#40;</span><span class="kw1">order</span> <span class="kw1">by</span> s1.<span class="me1">name</span><span class="br0">&#41;</span> <span class="kw1">as</span> <span class="kw1">Row</span>
<span class="kw1">from</span> sysobjects s1
cross join sysobjects s2<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> Calendar
<span class="kw1">select</span> &nbsp;<span class="kw2">dateadd</span><span class="br0">&#40;</span><span class="kw1">day</span>,<span class="kw1">Row</span>,<span class="st0">'20091231'</span><span class="br0">&#41;</span> <span class="kw1">from</span> cte
<span class="kw1">where</span> <span class="kw1">Row</span> <span class="sy0">&lt;</span> <span class="nu0">5114</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE Calendar (SomeDate date not null primary key)
GO

;with cte as (select row_number() over(order by s1.name) as Row
from sysobjects s1
cross join sysobjects s2)

INSERT Calendar
select  dateadd(day,Row,'20091231') from cte
where Row &lt; 5114</pre></div></div>

<p>You might want to adjust the range to start earlier or end later for your purpose</p>
<p>Now that the calendar table is ready, let&#8217;s create a fake order table with some dates</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="de1"><pre class="de1"><span class="kw1">create</span> <span class="kw1">table</span> SomeData <span class="br0">&#40;</span>OrderDate <span class="kw1">date</span>, SomeCol <span class="kw1">int</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-01'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-01'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-02'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-02'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-03'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-05'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-05'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-07'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-08'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-09'</span>,<span class="nu0">1</span><span class="br0">&#41;</span>
<span class="kw1">insert</span> SomeData <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'2013-01-09'</span>,<span class="nu0">1</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">create table SomeData (OrderDate date, SomeCol int)
insert SomeData values('2013-01-01',1)
insert SomeData values('2013-01-01',1)
insert SomeData values('2013-01-02',1)
insert SomeData values('2013-01-02',1)
insert SomeData values('2013-01-03',1)
insert SomeData values('2013-01-05',1)
insert SomeData values('2013-01-05',1)
insert SomeData values('2013-01-07',1)
insert SomeData values('2013-01-08',1)
insert SomeData values('2013-01-09',1)
insert SomeData values('2013-01-09',1)</pre></div></div>

<p>Querying from this table&#8230;..</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> OrderDate, <span class="kw2">count</span><span class="br0">&#40;</span>somecol<span class="br0">&#41;</span> <span class="kw1">as</span> SomeCount
<span class="kw1">from</span> SomeData
<span class="kw1">group</span> <span class="kw1">by</span> OrderDate</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select OrderDate, count(somecol) as SomeCount
from SomeData
group by OrderDate</pre></div></div>

<p>Here are the results</p>
<pre>OrderDate	SomeCount
2013-01-01	2
2013-01-02	2
2013-01-03	1
2013-01-05	2
2013-01-07	1
2013-01-08	1
2013-01-09	2</pre>
<p>As you can see January 4th and January 6th are missing. Let&#8217;s do a left join with the calendar table to display the results</p>
<p>Here is the code, I will go over it a little later</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- grab min and max dates or supply range yourself</span>
<span class="kw1">declare</span> @mindate <span class="kw1">date</span>,@maxdate <span class="kw1">date</span>
<span class="kw1">select</span> @mindate <span class="sy0">=</span><span class="kw2">min</span><span class="br0">&#40;</span>OrderDate<span class="br0">&#41;</span>,@maxdate <span class="sy0">=</span> <span class="kw2">max</span><span class="br0">&#40;</span>OrderDate<span class="br0">&#41;</span>
<span class="kw1">from</span> SomeData
&nbsp;
<span class="co1">--here is the query</span>
<span class="kw1">select</span> c.<span class="me1">SomeDate</span>,<span class="kw1">coalesce</span><span class="br0">&#40;</span>x.<span class="me1">SOmeCount</span>,<span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">as</span> TheCount
<span class="kw1">from</span> Calendar c
<span class="kw1">left</span> join <span class="br0">&#40;</span>
<span class="kw1">select</span> OrderDate, <span class="kw2">count</span><span class="br0">&#40;</span>somecol<span class="br0">&#41;</span> <span class="kw1">as</span> SOmeCount
<span class="kw1">from</span> SomeData
<span class="kw1">group</span> <span class="kw1">by</span> OrderDate<span class="br0">&#41;</span> x
<span class="kw1">on</span> c.<span class="me1">SomeDate</span> <span class="sy0">=</span> x.<span class="me1">OrderDate</span>
<span class="kw1">where</span> c.<span class="me1">SomeDate</span> between @mindate &nbsp;and @maxdate
<span class="kw1">order</span> <span class="kw1">by</span> c.<span class="me1">SomeDate</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">-- grab min and max dates or supply range yourself
declare @mindate date,@maxdate date
select @mindate =min(OrderDate),@maxdate = max(OrderDate)
from SomeData
 
--here is the query
select c.SomeDate,coalesce(x.SOmeCount,0) as TheCount
from Calendar c
left join (
select OrderDate, count(somecol) as SOmeCount
from SomeData
group by OrderDate) x
on c.SomeDate = x.OrderDate
where c.SomeDate between @mindate  and @maxdate
order by c.SomeDate</pre></div></div>

<p>Running that will give you this</p>
<pre>SomeDate	TheCount
2013-01-01	2
2013-01-02	2
2013-01-03	1
2013-01-04	0
2013-01-05	2
2013-01-06	0
2013-01-07	1
2013-01-08	1
2013-01-09	2</pre>
<p>So what are we doing in the code? Here it is again</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="de1"><pre class="de1"><span class="co1">-- grab min and max dates or supply range yourself</span>
<span class="kw1">declare</span> @mindate <span class="kw1">date</span>,@maxdate <span class="kw1">date</span>
<span class="kw1">select</span> @mindate <span class="sy0">=</span><span class="kw2">min</span><span class="br0">&#40;</span>OrderDate<span class="br0">&#41;</span>,@maxdate <span class="sy0">=</span> <span class="kw2">max</span><span class="br0">&#40;</span>OrderDate<span class="br0">&#41;</span>
<span class="kw1">from</span> SomeData
&nbsp;
<span class="co1">--here is the query</span>
<span class="kw1">select</span> c.<span class="me1">SomeDate</span>,<span class="kw1">coalesce</span><span class="br0">&#40;</span>x.<span class="me1">SOmeCount</span>,<span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">as</span> TheCount
<span class="kw1">from</span> Calendar c
<span class="kw1">left</span> join <span class="br0">&#40;</span>
<span class="kw1">select</span> OrderDate, <span class="kw2">count</span><span class="br0">&#40;</span>somecol<span class="br0">&#41;</span> <span class="kw1">as</span> SOmeCount
<span class="kw1">from</span> SomeData
<span class="kw1">group</span> <span class="kw1">by</span> OrderDate<span class="br0">&#41;</span> x
<span class="kw1">on</span> c.<span class="me1">SomeDate</span> <span class="sy0">=</span> x.<span class="me1">OrderDate</span>
<span class="kw1">where</span> c.<span class="me1">SomeDate</span> between @mindate &nbsp;and @maxdate
<span class="kw1">order</span> <span class="kw1">by</span> c.<span class="me1">SomeDate</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">-- grab min and max dates or supply range yourself
declare @mindate date,@maxdate date
select @mindate =min(OrderDate),@maxdate = max(OrderDate)
from SomeData
 
--here is the query
select c.SomeDate,coalesce(x.SOmeCount,0) as TheCount
from Calendar c
left join (
select OrderDate, count(somecol) as SOmeCount
from SomeData
group by OrderDate) x
on c.SomeDate = x.OrderDate
where c.SomeDate between @mindate  and @maxdate
order by c.SomeDate</pre></div></div>

<p>On line 2,3 and 4 we are grabbing the min and max dates and storing those in variables which we will use in the WHERE clause on line 14<br />
On line 7 we grab the date from the calendar table and also use the coalesce function to display 0 for the non existing rows which will come back as NULLS<br />
Line 9 is the LEFT JOIN<br />
Line 10 until 12 is the subquery where we are grouping the rows based on date, you also see x on line 12, that is the alias for the sub query<br />
Line 13 has the join condition between the calendar table aliased c and the subquery aliased x<br />
Line 14 is where we use the min and max date from lines 2,3 and 4<br />
Line 15 does the sorting</p>
<p>Pretty simple right?</p>
<p>Your calendar table does not have to be that simple, you can add IsWeekday, IsWeekend, IsHoliday and other flags, you can also add the names of the dates</p>
<p>You can also have these be computed columns, for example here we are adding a computed column that will have the week number</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">TABLE</span> calendar <span class="kw1">ADD</span> WeekNum <span class="kw1">AS</span> <span class="kw2">DATEPART</span><span class="br0">&#40;</span>wk,SomeDate<span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER TABLE calendar ADD WeekNum AS DATEPART(wk,SomeDate)</pre></div></div>

<p>Now you can see that the column is showing up</p>
<pre>SELECT * FROM Calendar</pre>
<pre>SomeDate	WeekNum
2010-01-01	1
2010-01-02	1
2010-01-03	2
2010-01-04	2
2010-01-05	2
.....           ...</pre>
<p>And if you add rows, you don&#8217;t have to update the column</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">INSERT</span> Calendar <span class="kw1">values</span><span class="br0">&#40;</span><span class="st0">'20240101'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">INSERT Calendar values('20240101')</pre></div></div>

<p>Select what we just inserted</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="text"><thead><tr><td colspan="2"  class="head">Text</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1">SELECT * FROM Calendar
where SomeDate = '20240101'</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT * FROM Calendar
where SomeDate = '20240101'</pre></div></div>

<p>And here is the result</p>
<pre>SomeDate	WeekNum
2024-01-01	1</pre>
<p>That is it for this post, hopefully it will help out somebody and hopefully someone will be adding a calendar table today</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/displaying-missing-dates-by-utilizing/#comments" thr:count="2"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/displaying-missing-dates-by-utilizing/feed/atom/" thr:count="2"/>
		<thr:total>2</thr:total>
		</entry>
		<entry>
		<author>
			<name>SQLDenis</name>
					</author>
		<title type="html"><![CDATA[SQL Advent 2012 Day 16: Lack of database design and normalization]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/datadesign/lack-of-database-design-and/" />
		<id>/index.php/2012/12/lack-of-database-design-and/</id>
		<updated>2012-12-16T12:55:00Z</updated>
		<published>2012-12-16T12:55:00Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="Data Modelling and Design" /><category scheme="/" term="foreign keys" /><category scheme="/" term="normal form" /><category scheme="/" term="normalization" /><category scheme="/" term="referential integrity" /><category scheme="/" term="sql advent 2012" /><category scheme="/" term="sql server 2008" /><category scheme="/" term="sql server 2008 r2" /><category scheme="/" term="sql server 2012" />		<summary type="html"><![CDATA[This is day sixteen of the SQL Advent 2012 series of blog posts. Today we are going to look at the lack of database design and normalization.

Normalize untill it hurts, denormalize until it works]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/datadesign/lack-of-database-design-and/"><![CDATA[<p>This is day sixteen of the <a href="/index.php/DataMgmt/DBProgramming/sql-advent-2012-here-is">SQL Advent 2012 series</a> of blog posts. Today we are going to look at the lack of database design and normalization. Normalization and database design is a big enough topic that there are 500 page plus books written about it. This post will barely scratch the surface, if you want to know more about this topic pick up a book about it. <a href="http://www.amazon.com/gp/product/143020866X/002-3562882-4309664?ie=UTF8&amp;tag=sql08-20&amp;linkCode=xm2&amp;camp=1789&amp;creativeASIN=143020866X">Pro SQL Server 2008 Relational Database Design and Implementation</a> is one that I recommend. I did an interview with the author here: <a href="/index.php/DataMgmt/DataDesign/interview-with-louis-davidson-author-of-">Interview With Louis Davidson Author of Pro SQL Server 2008 Relational Database Design and Implementation</a></p>
<h1>Normalize until it hurts, denormalize until it works</h1>
<p>So what is normalization? Normalization is the process of organizing the columns and tables of a relational database to minimize redundancy and dependency. Normalization usually involves dividing large tables into smaller (and less redundant) tables and defining relationships between them. The objective is to isolate data so that additions, deletions, and modifications of a field can be made in just one table and then propagated through the rest of the database via the defined relationships.</p>
<p>Let&#8217;s take a look at a simple example. Let&#8217;s say we have a book store and we want to capture the book title, the date the book was published as well as the author. We are keeping this very simple so no ISBN or publisher or any additional information.</p>
<p>You might come up with a table like this right?</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Books <span class="br0">&#40;</span>BookdId <span class="kw1">int</span>, Title <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, PublishDate <span class="kw1">datetime</span>, Author <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE Books (BookdId int, Title varchar(100), PublishDate datetime, Author varchar(100))
GO</pre></div></div>

<p>One of the problems is that if an author wrote more than one book, the author will be stored in that table more than once. What it the authot is a woman and she gets married and decided to change her name, how will you know this is the same person?</p>
<p>Let&#8217;s drop that table since we are going to recreate it</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DROP</span> <span class="kw1">TABLE</span> Books
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DROP TABLE Books
GO</pre></div></div>

<p>Now, let&#8217;s create two tables, we are going to create an Author table and a Books table. The Author table will hold the AuthotID, the last name as well as the first name. Now we can use the AuthorID and store that in the Books table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">Create</span> <span class="kw1">Table</span> Authors <span class="br0">&#40;</span>AuthorID <span class="kw1">int</span>, FirstName <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, LastName <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
GO
&nbsp;
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Books <span class="br0">&#40;</span>BookdId <span class="kw1">int</span>, Title <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, PublishDate <span class="kw1">datetime</span>, AuthorID <span class="kw1">int</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Create Table Authors (AuthorID int, FirstName varchar(100), LastName varchar(100))
GO

CREATE TABLE Books (BookdId int, Title varchar(100), PublishDate datetime, AuthorID int)
GO</pre></div></div>

<p>So what is the problem with this so called design? Ever heard of a book that had more than one author? Of course you have there are many of those, this is especially true with technical books.</p>
<p>Let&#8217;s drop those tables since we are going to recreate it.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DROP</span> <span class="kw1">TABLE</span> Books, Authors
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DROP TABLE Books, Authors
GO</pre></div></div>

<p>Now what we have to add is a third table, this table will have just two columns, the BookID and the AuthorID, now you can handle many authors per book without a problem. The AuthorID column will now be eliminated from the Books table as well.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">Create</span> <span class="kw1">Table</span> Authors <span class="br0">&#40;</span>AuthorID <span class="kw1">int</span>, FirstName <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, LastName <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
GO
&nbsp;
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Books <span class="br0">&#40;</span>BookdId <span class="kw1">int</span>, Title <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">100</span><span class="br0">&#41;</span>, PublishDate <span class="kw1">datetime</span><span class="br0">&#41;</span>
GO
&nbsp;
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> BookAuthors<span class="br0">&#40;</span>BookdId <span class="kw1">int</span>,AuthorID <span class="kw1">int</span><span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Create Table Authors (AuthorID int, FirstName varchar(100), LastName varchar(100))
GO

CREATE TABLE Books (BookdId int, Title varchar(100), PublishDate datetime)
GO

CREATE TABLE BookAuthors(BookdId int,AuthorID int)
GO</pre></div></div>

<p>What else are we missing? How about some primary keys and foreign keys. We are going to make BookID and AuthorID a primary key. Those two columns will also be a foreign key in the BookAuthors tables. Since an author can&#8217;t write the same book twice, we will also make the combination of BookID and AuthorID a primary key in the BookAuthors table</p>
<p>Here is what you will end up with</p>
<div class="image_block"><a href="/wp-content/uploads/blogs/DataMgmt/Denis/ADvent/SimpleDB.PNG?mtime=1355567856"><img alt="" src="/wp-content/uploads/blogs/DataMgmt/Denis/ADvent/SimpleDB.PNG?mtime=1355567856" width="499" height="304" /></a></div>
<p>Now, here is the code to add the primary keys and foreign keys to the table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">TABLE</span> dbo.<span class="me1">Books</span> <span class="kw1">ADD</span> <span class="kw1">CONSTRAINT</span>
&nbsp; &nbsp; PK_Books <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span> <span class="kw1">CLUSTERED</span> 
&nbsp; &nbsp; <span class="br0">&#40;</span>BookdID<span class="br0">&#41;</span> <span class="kw1">ON</span> <span class="br0">&#91;</span><span class="kw1">PRIMARY</span><span class="br0">&#93;</span>
&nbsp;
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER TABLE dbo.Books ADD CONSTRAINT
	PK_Books PRIMARY KEY CLUSTERED 
	(BookdID) ON [PRIMARY]

GO</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">TABLE</span> dbo.<span class="me1">BookAuthors</span> <span class="kw1">ADD</span> <span class="kw1">CONSTRAINT</span>
&nbsp; &nbsp; PK_BookAuthors <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span> <span class="kw1">CLUSTERED</span> 
&nbsp; &nbsp; <span class="br0">&#40;</span>BookdID,AuthorID<span class="br0">&#41;</span> &nbsp;<span class="kw1">ON</span> <span class="br0">&#91;</span><span class="kw1">PRIMARY</span><span class="br0">&#93;</span>
&nbsp;
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER TABLE dbo.BookAuthors ADD CONSTRAINT
	PK_BookAuthors PRIMARY KEY CLUSTERED 
	(BookdID,AuthorID)  ON [PRIMARY]

GO</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">TABLE</span> dbo.<span class="me1">Authors</span> <span class="kw1">ADD</span> <span class="kw1">CONSTRAINT</span>
&nbsp; &nbsp; PK_Authors <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span> <span class="kw1">CLUSTERED</span> 
&nbsp; &nbsp; <span class="br0">&#40;</span>AuthorID<span class="br0">&#41;</span> <span class="kw1">ON</span> <span class="br0">&#91;</span><span class="kw1">PRIMARY</span><span class="br0">&#93;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER TABLE dbo.Authors ADD CONSTRAINT
	PK_Authors PRIMARY KEY CLUSTERED 
	(AuthorID) ON [PRIMARY]</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>BookAuthors<span class="br0">&#93;</span> &nbsp;<span class="kw1">WITH</span> <span class="kw1">CHECK</span> <span class="kw1">ADD</span> &nbsp;<span class="kw1">CONSTRAINT</span> <span class="br0">&#91;</span>FK_BookAuthors_Authors<span class="br0">&#93;</span> <span class="kw1">FOREIGN</span> <span class="kw1">KEY</span><span class="br0">&#40;</span><span class="br0">&#91;</span>AuthorID<span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">REFERENCES</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>Authors<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>AuthorID<span class="br0">&#93;</span><span class="br0">&#41;</span>
GO
&nbsp;
<span class="kw1">ALTER</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>BookAuthors<span class="br0">&#93;</span> <span class="kw1">CHECK</span> <span class="kw1">CONSTRAINT</span> <span class="br0">&#91;</span>FK_BookAuthors_Authors<span class="br0">&#93;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER TABLE [dbo].[BookAuthors]  WITH CHECK ADD  CONSTRAINT [FK_BookAuthors_Authors] FOREIGN KEY([AuthorID])
REFERENCES [dbo].[Authors] ([AuthorID])
GO

ALTER TABLE [dbo].[BookAuthors] CHECK CONSTRAINT [FK_BookAuthors_Authors]
GO</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">ALTER</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>BookAuthors<span class="br0">&#93;</span> &nbsp;<span class="kw1">WITH</span> <span class="kw1">CHECK</span> <span class="kw1">ADD</span> &nbsp;<span class="kw1">CONSTRAINT</span> <span class="br0">&#91;</span>FK_BookAuthors_Books<span class="br0">&#93;</span> <span class="kw1">FOREIGN</span> <span class="kw1">KEY</span><span class="br0">&#40;</span><span class="br0">&#91;</span>BookdID<span class="br0">&#93;</span><span class="br0">&#41;</span>
<span class="kw1">REFERENCES</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>Books<span class="br0">&#93;</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>BookdID<span class="br0">&#93;</span><span class="br0">&#41;</span>
GO
&nbsp;
<span class="kw1">ALTER</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>BookAuthors<span class="br0">&#93;</span> <span class="kw1">CHECK</span> <span class="kw1">CONSTRAINT</span> <span class="br0">&#91;</span>FK_BookAuthors_Books<span class="br0">&#93;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">ALTER TABLE [dbo].[BookAuthors]  WITH CHECK ADD  CONSTRAINT [FK_BookAuthors_Books] FOREIGN KEY([BookdID])
REFERENCES [dbo].[Books] ([BookdID])
GO

ALTER TABLE [dbo].[BookAuthors] CHECK CONSTRAINT [FK_BookAuthors_Books]
GO</pre></div></div>

<p>That is a lot of code, this is where modeling tools come in handy. You can use the diagramming tool in SQL Server Management Studio but it is not full feature like the ones below.</p>
<p>CA <a href="http://erwin.com/products/data-modeler/standard-edition">ERwin Data Modeler</a><br />
SAP (Sybase) <a href="http://www.sybase.com/products/modelingdevelopment/powerdesigner">PowerDesigner</a><br />
Embarcadero <a href="http://www.embarcadero.com/products/er-studio">ER/Studio</a><br />
IBM <a href="http://www-01.ibm.com/software/awdtools/systemarchitect/">Rational Systems Architect</a><br />
Dell Quest <a href="http://www.quest.com/toad/http://www.quest.com/toad/">TOAD</a></p>
<p>I have used ERwin  and Visio in the past but use PowerDesigner these days.</p>
<p>Now how would you handle the name change for the author? You can introduce another table where you would have first and last name together with start and end dates, this now enables you to still have the author being one author for reporting purposes but you can now still represent the name correctly for a specific point in time. Another example of this would be the stock market, companies will change the ticker, Sun Microsystem change the ticker from SUNW to JAVA, sometimes they change the name as well, Apple dropped Computers from the name. You still want this to be the same company so you won&#8217;t just add another row otherwise how would you do historical charting?</p>
<p>This is also why I like keys that don&#8217;t have meaning, these are called surrogate keys, now when you change everything in the row it doesn&#8217;t matter. I once worked with a system where&#8230;are you ready for this&#8230;&#8230;the primary key was the social security number, this key was then also used as a foreign key in another ten tables. Of course  some people would be reluctant to give their real social security number, they made up a number. Now the person with the real number signed up and couldn&#8217;t he would call customer support, they would track down the person with the fake number and now the SSN had to be changed in over 10 tables, since we didn&#8217;t have cascade update turned on, this had to be handled manually (and of course make sure to highlight the WHERE clause otherwise you are toast)</p>
<p>Remember how we had that BookAuthors junction/lookup table? Sometimes you will actually see a comma delimited list of IDs in a varchar column. This is not the way to store more than one author for a book. This looks easier from an application point of view (however I disagree even here) but now you have to write some kind of row to column user defined function if you want to show all authors. Performance is also going to be a dud, an index can&#8217;t be used since your WHERE clause is not <a href="/index.php/DataMgmt/DBProgramming/sargable-queries">sargable</a>.</p>
<p><strong>Unnormalized database</strong><br />
This is a database which was never normalized to begin with </p>
<p><strong>Denormalized database</strong><br />
A denormalized database is a database that was normalized but some parts have been denormalized for performance or maintenance reasons</p>
<p><strong>For you to research/lookup</strong></p>
<p><strong>Keys</strong><br />
There are many types of keys, some of them are just synonyms, here are some of them:  Candidate Key, Surrogate Key, Superkey, Natural Key, Alternate Key, Compound Key</p>
<p><strong>Normal form</strong><br />
Like I said at the beginning of the post there many more things to this topic than covered here. I did not talk about normal form at all, make sure that you research what all of these mean</p>
<p>1NF	First normal form<br />
2NF	Second normal form<br />
3NF	Third normal form<br />
EKNF	Elementary Key Normal Form<br />
BCNF	Boyce–Codd normal form<br />
4NF	Fourth normal form<br />
5NF	Fifth normal form<br />
DKNF	Domain/key normal form<br />
6NF	Sixth normal form</p>
<p>That is all for day sixteen of the <a href="/index.php/DataMgmt/DBProgramming/sql-advent-2012-here-is">SQL Advent 2012 series</a>, come back tomorrow for the next one, you can also check out all the posts from last year here: <a href="/index.php/DataMgmt/DataDesign/sql-advent-2011-recap">SQL Advent 2011 Recap</a></p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/datadesign/lack-of-database-design-and/#comments" thr:count="0"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/datadesign/lack-of-database-design-and/feed/atom/" thr:count="0"/>
		<thr:total>0</thr:total>
		</entry>
	</feed>
