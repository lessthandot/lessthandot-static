<?xml version="1.0" encoding="UTF-8"?><feed
  xmlns="http://www.w3.org/2005/Atom"
  xmlns:thr="http://purl.org/syndication/thread/1.0"
  xml:lang="en-US"
  xml:base="/wp-atom.php"
   >
	<title type="text">SSIS &#8211; LessthanDot</title>
	<subtitle type="text">A Technical Community for IT Professionals</subtitle>

	<updated>2019-03-09T12:50:36Z</updated>

	<link rel="alternate" type="text/html" href="/" />
	<id>/index.php/feed/atom/</id>
	<link rel="self" type="application/atom+xml" href="/index.php/category/datamgmt/ssis/feed/atom/" />

	<generator uri="https://wordpress.org/" version="4.6.1">WordPress</generator>
	<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[The shaky bug in SSIS]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/ssis/the-shaky-bug-in-ssis/" />
		<id>/?p=3312</id>
		<updated>2015-03-24T11:52:20Z</updated>
		<published>2015-03-24T11:52:20Z</published>
		<category scheme="/" term="SSIS" /><category scheme="/" term="bug" /><category scheme="/" term="jitter" /><category scheme="/" term="shake" /><category scheme="/" term="ssis" /><category scheme="/" term="syndicated" />		<summary type="html"><![CDATA[You may or may not have noticed it after installing SQL Server 2012: the designer interface in Visual Studio 2010/2012 has had a make-over. Nothing too drastic, but at least the undo button works. However, sometimes when you drag or move tasks/components on the canvas, they start to shake. A lot. And very annoyingly as [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/ssis/the-shaky-bug-in-ssis/"><![CDATA[<p style="text-align: justify">You may or may not have noticed it after installing SQL Server 2012: the designer interface in Visual Studio 2010/2012 has had a make-over. Nothing too drastic, but at least the undo button works. However, sometimes when you drag or move tasks/components on the canvas, they start to shake. A lot. And very annoyingly as well. (Quite impossible to take a screenshot of that, so sorry). This behaviour emerged after applying CU6. There are Connect items logged about this issue:</p>
<ul>
<li><a href="https://connect.microsoft.com/SQLServer/feedback/details/790470/when-dragging-ssis-objects-on-canvas-the-objects-shake-jiggle-jitter">When dragging SSIS objects on canvas the objects shake/jiggle/jitter</a></li>
<li><a href="https://connect.microsoft.com/SQLServer/feedback/details/776664/ssis-2012-control-flow-moving-objects-is-unusable">SSIS 2012 Control Flow moving objects is unusable</a></li>
</ul>
<p style="text-align: justify">Luckily Microsoft patched this bug in CU7. You can download the hotfix <a href="https://support.microsoft.com/en-us/kb/2883424/en-us?wa=wsignin1.0">here</a>. If your environment is up-to-date with the latest patches, most likely you won&#8217;t experience this bug.</p>
<p style="text-align: justify">I patched the Visual Studio 2010 environment at the client and the issue went away. But at home I use Visual Studio 2012 and the issue was still there, even after applying the fix. Fortunately, Twitter was there with the answer:</p>
<blockquote class="twitter-tweet" lang="en"><p><a href="https://twitter.com/Ko_Ver">@Ko_Ver</a> Ok, because the CU that fixes that only updates the DLL&#8217;s for VS2010, you need to manually overwrite the assemblies in VS2012 folder</p>
<p>— Jan Van humbeek (@janvanhumbeek) <a href="https://twitter.com/janvanhumbeek/status/517569881672544256">October 2, 2014</a></p></blockquote>
<p>If you go back to the <a href="https://connect.microsoft.com/SQLServer/feedback/details/790470/when-dragging-ssis-objects-on-canvas-the-objects-shake-jiggle-jitter">first Connect item</a>, these steps are described in the work arounds and they work like a charm.</p>
<p>The issue has also been <a href="https://connect.microsoft.com/SQLServer/feedback/details/1013088/ssis-2014-control-flow-moving-objects-is-unusable">reported for SSIS 2014</a>, and while the item has been closed as fixed, there&#8217;s no explanation on how it is fixed. Maybe in an upcoming CU for SQL Server 2014? It&#8217;s possible the same work around works for SSIS 2014, but I haven&#8217;t tried it (I don&#8217;t have the bug in Visual Studio 2013) so if you do try it, it&#8217;s at your own risk.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/ssis/the-shaky-bug-in-ssis/#comments" thr:count="0"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/ssis/the-shaky-bug-in-ssis/feed/atom/" thr:count="0"/>
		<thr:total>0</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[T-SQL Tuesday #63: How do you manage security]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/ssis/t-sql-tuesday-63-how-do-you-manage-security/" />
		<id>/?p=3165</id>
		<updated>2015-02-10T08:11:04Z</updated>
		<published>2015-02-10T08:11:04Z</published>
		<category scheme="/" term="SSIS" /><category scheme="/" term="security" /><category scheme="/" term="ssis" /><category scheme="/" term="syndicated" /><category scheme="/" term="t-sql tuesday" />		<summary type="html"><![CDATA[This month’s T-SQL Tuesday is hosted by Kenneth Fisher (blog &#124; twitter) and its subject is about security. Security is one of those subjects that most DBAs have to deal with regardless of specialty. So as something we all have to work with at some point or another what are some tips you’d like to [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/ssis/t-sql-tuesday-63-how-do-you-manage-security/"><![CDATA[<p style="text-align: justify"><a href="http://sqlstudies.com/2015/02/03/tsql-tuesday-63-how-do-you-manage-security/"><img style="float: left;margin: 0px 10px 0px 10px" src="/wp-content/uploads/2014/01/TSQL2sday.png" alt="TSQL2sday" width="133" height="134" /></a>This month’s T-SQL Tuesday is hosted by Kenneth Fisher (<a href="http://sqlstudies.com/">blog </a>| <a href="https://twitter.com/sqlstudent144">twitter</a>) and its subject is about security.</p>
<p style="text-align: justify"><em>Security is one of those subjects that most DBAs have to deal with regardless of specialty. So as something we all have to work with at some point or another what are some tips you’d like to share? What’s the best security design? You’ve picked up a legacy system and the security is awful, how do you fix it? Any great tools out there you’d like to share? Hate it or love it I’m betting we all have something to say.</em></p>
<p style="text-align: justify">Now, I’m not exactly a DBA but even ETL developers have to deal with security from time to time. In this blog post, I’d like to talk about the built-in security of the SSIS packages. You see, SSIS packages can store sensitive data inside them, such as the passwords for the connection managers for example. In order to protect that information, SSIS uses <a href="https://msdn.microsoft.com/en-us/library/ms141747.aspx">protection levels</a> which is a package-level property. These are the available protection levels:</p>
<ul style="text-align: justify">
<li><strong>DontSaveSensitive</strong>, which is my personal favorite as it forces you to use either configurations or parameters.</li>
<li><strong>EncryptSensitiveWithPassword</strong>. Other people can still open the package if they don&#8217;t have the password,  but the passwords in the connection managers are lost and need to be re-entered..</li>
<li><strong>EncryptAllWithPassword</strong>, for the paranoia people.</li>
<li><strong>EncryptSensitiveWithUserKey</strong>, which is the default. And as usual, they choose the absolute worst choice as the default. This setting basically means only you can access the sensitive data. Real peachy when you are in a team with multiple developers. Other developers can still open the package (then ignore a few warnings) but they have to re-enter all the passwords in the connection managers.</li>
<li><strong>EncryptAllWithUserKey</strong>, when you are really possessive over your packages.</li>
<li><strong>ServerStorage</strong>. When you deploy a package to the server, you trust SQL Server in protecting the sensitive data. This is default when you deploy packages to the SSIS catalog with the project deployment model.</li>
</ul>
<p style="text-align: justify">Protection levels were really important before SSIS 2012, as they specified how sensitive data was protected. However, the default of EncryptSensitiveWithUserKey is a really crappy one. If you schedule a package with this protection level using SQL Server Agent, the package can still run if there is no actual sensitive data in the package, but a lot of unnecessary warnings are generated. It&#8217;s best to avoid this protection level at all costs.</p>
<p style="text-align: justify">Protecting the package with a password is a good option. However, when deploying the package with the package deployment model (or every version of SSIS before 2012), you had to enter the password when you were scheduling the package with Agent. This means though that the password is stored in MSDB, so it isn&#8217;t that secure. My advice is to use DontSaveSensitive and store sensitive information inside a SQL Server configuration table.</p>
<p style="text-align: justify">With the project deployment model however, configurations are gone. They are replaced with parameters and environments. Since parameters are configured inside the package or project, this means the sensitive data is stored inside the package again. In this case it makes sense to protect the package with a password if needed. There is no issue on the server side, since the protection level is automatically converted to ServerStorage during deployment. Keep in mind that all the packages and the project itself need to have the same protection level, otherwise you get an error when the .ispac file is built.</p>
<p style="text-align: justify">Conclusion:</p>
<ul style="text-align: justify">
<li>when using earlier version of SSIS or when using the package deployment: the DontSaveSensitive protection level in combination with a configuration table is the most secure option.</li>
<li>when using the project deployment model: use parameters and environments to replace the configurations. Protect the package with a password if you want to secure those parameters.</li>
</ul>
<p style="text-align: justify">Note:<br />
when using Windows Authentication for all sources and destinations, there is almost nothing to be secured in a package. Obviously, this is even more secure.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/ssis/t-sql-tuesday-63-how-do-you-manage-security/#comments" thr:count="2"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/ssis/t-sql-tuesday-63-how-do-you-manage-security/feed/atom/" thr:count="2"/>
		<thr:total>2</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[The mysterious permission issue]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/ssis/the-mysterious-permission-issue/" />
		<id>/?p=3150</id>
		<updated>2015-01-09T14:58:26Z</updated>
		<published>2015-01-09T14:58:26Z</published>
		<category scheme="/" term="SSIS" /><category scheme="/" term="0xC020200E" /><category scheme="/" term="cannot open data file" /><category scheme="/" term="flat file" /><category scheme="/" term="permission issue" /><category scheme="/" term="share" /><category scheme="/" term="ssis" /><category scheme="/" term="syndicated" />		<summary type="html"><![CDATA[As you might have realized, this is not the title of an Agatha Christie book, but rather about some nasty permission issue I encountered with SSIS. At a new project, someone mentioned me that a scheduled job has been failing for quite some time now (actually since they created the job, yay for testing!). So [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/ssis/the-mysterious-permission-issue/"><![CDATA[<p><a href="/wp-content/uploads/2015/01/poirot.jpg"><img style="float: left;margin: 0px 10px 0px 10px" src="/wp-content/uploads/2015/01/poirot-150x150.jpg" alt="poirot" width="100" height="100" /></a>As you might have realized, this is not the title of an Agatha Christie book, but rather about some nasty permission issue I encountered with SSIS. At a new project, someone mentioned me that a scheduled job has been failing for quite some time now (actually since they created the job, yay for testing!). So I put my detective hat on (with my fake Poirot&#8217;stache) and started investigating.</p>
<p>The SSIS catalog report <em>All Executions</em> gave me the following wonderfull error messages:</p>
<blockquote><p>Error: FF_DST Write to Flat file failed the pre-execute phase and returned error code 0xC020200E.<br />
DFT Export to Flat File:Error: Cannot open the datafile &#8220;\\myServer\c$\rootfolder\myExport\myFlatFile.txt&#8221;.</p></blockquote>
<p>There was also a little warning with a more useful message:</p>
<blockquote><p>DFT Export to Flat File:Warning: Access is denied.</p></blockquote>
<p>I immediately thought: &#8220;Haha, no proxy is used in the SQL Server Agent job step!&#8221;<br />
However, when I checked the job step there was a proxy configured. OK then, they must have forgot to assign permissions to the folder. Alas, permissions were correctly set as well. The plot thickens!</p>
<p>Just to be sure, I gave the user account used by the proxy full permission to the root folder (as someone suggested on a forum). No dice, the job still failed with the exact same error message. I googled around for a bit (like any good detective) for the error code 0xC020200E. Another suggestion I came across was adding the user <em>Network Service</em> to the folder but that was a dead end as well. FYI, the package ran flawlessly in SSDT. Of course it did.</p>
<p>Finally I stumbled upon a MSDN thread where someone suggested it might be an issue with the UNC file path. Apparently sometimes there can be an issue when the drive letter is in the path. In this case: c$. So I created a dedicated share called //myServer/myExport and gave explicit read/write permissions to the proxy account. And lo and behold, the job ran without issues!</p>
<p>The moral of this story: Windows can be a real PITA <img src="https://s.w.org/images/core/emoji/2/72x72/1f642.png" alt="🙂" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/ssis/the-mysterious-permission-issue/#comments" thr:count="2"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/ssis/the-mysterious-permission-issue/feed/atom/" thr:count="2"/>
		<thr:total>2</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[Overview of Published Articles – 2014Q4]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/dbprogramming/mssqlserver/overview-of-published-articles-2014q4/" />
		<id>/?p=3145</id>
		<updated>2015-01-07T20:39:46Z</updated>
		<published>2015-01-07T20:39:46Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="Microsoft SQL Server" /><category scheme="/" term="SSAS" /><category scheme="/" term="SSIS" /><category scheme="/" term="SSRS" /><category scheme="/" term="mssqltips" /><category scheme="/" term="sql server" /><category scheme="/" term="ssas" /><category scheme="/" term="ssis" /><category scheme="/" term="ssrs" /><category scheme="/" term="syndicated" />		<summary type="html"><![CDATA[Here is an overview of the articles I published in the last quarter of 2014. INTENSE SCHOOL MCSE Prep: Overview of T-SQL Windowing Functions Part 1 MCSE Prep: Overview of T-SQL Windowing Functions Part 2 The third and final part of this series will probably be published this month, so keep an eye on the site [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/dbprogramming/mssqlserver/overview-of-published-articles-2014q4/"><![CDATA[<p><span style="color: #2f2f2f">Here is an overview of the articles I published in the last quarter of 2014.</span></p>
<p><strong style="color: #2f2f2f">INTENSE SCHOOL</strong></p>
<ul>
<li><a href="http://resources.intenseschool.com/mcse-prep-overview-of-t-sql-windowing-functions-part-1/">MCSE Prep: Overview of T-SQL Windowing Functions Part 1</a></li>
<li><a href="http://resources.intenseschool.com/mcse-prep-overview-of-t-sql-windowing-functions-part-2/">MCSE Prep: Overview of T-SQL Windowing Functions Part 2</a></li>
</ul>
<p>The third and final part of this series will probably be published this month, so keep an eye on the site for more window functions awesomeness <img src="https://s.w.org/images/core/emoji/2/72x72/1f642.png" alt="🙂" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<p><strong style="color: #2f2f2f">MSSQLTIPS</strong></p>
<ul>
<li><a href="http://www.mssqltips.com/sqlservertip/3374/format-durations-in-sql-server-analysis-services/">Format Durations in SQL Server Analysis Services</a></li>
<li><a href="http://www.mssqltips.com/sqlservertip/3395/creating-a-box-plot-graph-in-sql-server-reporting-services/">Creating a box plot graph in SQL Server Reporting Services</a></li>
<li><a href="http://www.mssqltips.com/sqlservertip/3417/sql-server-reporting-services-add-calculated-series-to-a-graph/">SQL Server Reporting Services Add Calculated Series to a Graph</a></li>
<li><a href="http://www.mssqltips.com/sqlservertip/3432/add-a-linear-trendline-to-a-graph-in-sql-server-reporting-services/">Add a linear trendline to a graph in SQL Server Reporting Services</a></li>
</ul>
<p>Yes, I had quite some SSRS inspiration the past months. Regarding the first tip about formatting durations: I wrote about potential issues with NULL values in the blog post <a href="/index.php/webdev/business-intelligence/formatting-durations-in-ssas-caveat/">Formatting Durations in SSAS: Caveat</a>.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/dbprogramming/mssqlserver/overview-of-published-articles-2014q4/#comments" thr:count="0"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/dbprogramming/mssqlserver/overview-of-published-articles-2014q4/feed/atom/" thr:count="0"/>
		<thr:total>0</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[PASS BI VC recording is available now]]></title>
		<link rel="alternate" type="text/html" href="/index.php/uncategorized/pass-bi-vc-recording-is-available-now/" />
		<id>/?p=3115</id>
		<updated>2014-12-05T12:18:57Z</updated>
		<published>2014-12-05T12:18:57Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="SSIS" /><category scheme="/" term="Uncategorized" /><category scheme="/" term="business intelligence" /><category scheme="/" term="data warehouse" /><category scheme="/" term="etl" /><category scheme="/" term="pass" /><category scheme="/" term="sql server" /><category scheme="/" term="ssis" /><category scheme="/" term="virtual chapter" />		<summary type="html"><![CDATA[The recording of the webinar I did for the PASS BI virtual chapter is live! (Quick reminder: it was the same session as on the SQLServerDays: How to (not) torment your fellow SSIS developer?) I&#8217;m quite pleased with the recording, although I sound like a drunk German scientist sometimes. The slides can be downloaded here. Let [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/uncategorized/pass-bi-vc-recording-is-available-now/"><![CDATA[<p>The recording of the <a href="/index.php/datamgmt/ssis/pass-bi-vc-how-to-not-torment-your-fellow-ssis-developer/">webinar </a>I did for the PASS BI virtual chapter is live!<br />
(Quick reminder: it was the same session as on the SQLServerDays: <a style="color: #c04623" href="/index.php/uncategorized/speaking-at-sql-server-days-2014/">How to (not) torment your fellow SSIS developer?</a>)</p>
<p>I&#8217;m quite pleased with the recording, although I sound like a drunk German scientist sometimes.</p>
<p><iframe width="500" height="281" src="https://www.youtube.com/embed/-N7gxmAdceM?feature=oembed" frameborder="0" allowfullscreen></iframe></p>
<p>The slides can be downloaded <a href="http://www.slideshare.net/KoenVerbeeck/sql-server-days-2014-how-to-not-torment-your">here</a>.</p>
<p>Let me know in the comments if you like it or not!</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/uncategorized/pass-bi-vc-recording-is-available-now/#comments" thr:count="0"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/uncategorized/pass-bi-vc-recording-is-available-now/feed/atom/" thr:count="0"/>
		<thr:total>0</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[PASS BI VC: How to (not) torment your fellow SSIS developer?]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/ssis/pass-bi-vc-how-to-not-torment-your-fellow-ssis-developer/" />
		<id>/?p=3058</id>
		<updated>2014-11-12T11:52:09Z</updated>
		<published>2014-11-12T11:52:09Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="SSIS" /><category scheme="/" term="bi" /><category scheme="/" term="pass" /><category scheme="/" term="sql server" /><category scheme="/" term="ssis" /><category scheme="/" term="syndicated" /><category scheme="/" term="webinar" />		<summary type="html"><![CDATA[On November 17th 2PM CET I will redo my SQL Server Days presentation How to (not) torment your fellow SSIS developer? for the PASS BI virtual chapter. This is great news for the people who couldn&#8217;t attend my session at the SQL Server Days and who still want to see it (I hope those people [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/ssis/pass-bi-vc-how-to-not-torment-your-fellow-ssis-developer/"><![CDATA[<p style="text-align: justify">On November 17th 2PM CET I will redo my SQL Server Days presentation <a href="/index.php/uncategorized/speaking-at-sql-server-days-2014/">How to (not) torment your fellow SSIS developer?</a> for the <a href="http://bi.sqlpass.org/">PASS BI virtual chapter</a>. This is great news for the people who couldn&#8217;t attend my session at the SQL Server Days and who still want to see it (I hope those people actually exist).</p>
<p style="text-align: justify">What is even better is that the PASS BI virtual chapter afterwards always uploads the webinars to Youtube, so there won&#8217;t be any excuse for not watching my session <img src="https://s.w.org/images/core/emoji/2/72x72/1f642.png" alt="🙂" class="wp-smiley" style="height: 1em; max-height: 1em;" /><br />
Check out other amazing BI sessions from the SQL community on<a href="https://www.youtube.com/user/passbivc"> their Youtube channel</a>!</p>
<p style="text-align: justify">You can register for the webinar <a href="https://attendee.gotowebinar.com/register/8118983337165731074">here</a>.</p>
<p><a href="https://www.youtube.com/user/passbivc"><img class="alignnone wp-image-3059 size-medium" src="/wp-content/uploads/2014/11/passbivc-300x150.jpg" alt="passbivc" width="300" height="150" srcset="/wp-content/uploads/2014/11/passbivc-300x150.jpg 300w, /wp-content/uploads/2014/11/passbivc.jpg 400w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/ssis/pass-bi-vc-how-to-not-torment-your-fellow-ssis-developer/#comments" thr:count="6"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/ssis/pass-bi-vc-how-to-not-torment-your-fellow-ssis-developer/feed/atom/" thr:count="6"/>
		<thr:total>6</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[Overview of Published Articles – 2014Q3]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/dbprogramming/mssqlserver/overview-of-published-articles-2014q3/" />
		<id>/?p=3024</id>
		<updated>2014-10-24T08:53:46Z</updated>
		<published>2014-10-24T08:53:46Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="Microsoft SQL Server" /><category scheme="/" term="SSAS" /><category scheme="/" term="SSIS" /><category scheme="/" term="SSRS" /><category scheme="/" term="articles" /><category scheme="/" term="business intelligence" /><category scheme="/" term="sql server" /><category scheme="/" term="ssas" /><category scheme="/" term="ssis" /><category scheme="/" term="ssrs" /><category scheme="/" term="tips" />		<summary type="html"><![CDATA[Here is an overview of the articles I published in the third quarter of 2014. INTENSE SCHOOL MCSE Prep (SQL) – Using Parameters in Reporting Services Reports (Part 2) Book Review: SQL Server 2012 Integration Services Design Patterns MSSQLTIPS Adding Custom Reports to SQL Server Management Studio More Text Analysis with the SSIS Term Lookup [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/dbprogramming/mssqlserver/overview-of-published-articles-2014q3/"><![CDATA[<p>Here is an overview of the articles I published in the third quarter of 2014.</p>
<p><strong>INTENSE SCHOOL</strong></p>
<ul>
<li><a href="http://resources.intenseschool.com/mcse-prep-sql-using-parameters-in-reporting-services-reports-part-2/">MCSE Prep (SQL) – Using Parameters in Reporting Services Reports (Part 2)</a></li>
<li><a href="http://resources.intenseschool.com/book-review-sql-server-2012-integration-services-design-patterns/">Book Review: SQL Server 2012 Integration Services Design Patterns</a></li>
</ul>
<p><strong>MSSQLTIPS</strong></p>
<ul>
<li><a href="http://www.mssqltips.com/sqlservertip/3291/adding-custom-reports-to-sql-server-management-studio/">Adding Custom Reports to SQL Server Management Studio</a></li>
<li><a href="http://www.mssqltips.com/sqlservertip/3315/more-text-analysis-with-the-ssis-term-lookup-component/">More Text Analysis with the SSIS Term Lookup Component</a></li>
<li><a href="http://www.mssqltips.com/sqlservertip/3356/custom-ssms-report-to-show-sql-server-tables-per-filegroup/">Custom SSMS report to show SQL Server tables per filegroup</a></li>
</ul>
<p>I have two more tips in the pipeline, one about formatting durations in SSAS and one about creating box plots in SSRS, so keep an eye on the <a href="http://www.mssqltips.com/">MSSQLTips</a> website.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/dbprogramming/mssqlserver/overview-of-published-articles-2014q3/#comments" thr:count="1"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/dbprogramming/mssqlserver/overview-of-published-articles-2014q3/feed/atom/" thr:count="1"/>
		<thr:total>1</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[SQL Server Days 2014 &#8211; Slide deck]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/ssis/sql-server-days-2014-slide-deck/" />
		<id>/?p=3004</id>
		<updated>2014-10-06T09:39:27Z</updated>
		<published>2014-10-06T07:45:53Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="SSIS" /><category scheme="/" term="bi" /><category scheme="/" term="integration services" /><category scheme="/" term="slides" /><category scheme="/" term="sql server" /><category scheme="/" term="sql server days" /><category scheme="/" term="ssis" />		<summary type="html"><![CDATA[SQL Server Days 2014 is over, but it has been one great event. A very big thanks to the organizers! My session went pretty well, somewhere around 60 attendees I would guess and they didn&#8217;t seem too bored. I saw some other great sessions as well, such as Buck Woody (twitter) on Big Data (and [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/ssis/sql-server-days-2014-slide-deck/"><![CDATA[<p>SQL Server Days 2014 is over, but it has been one great event. A very big thanks to the organizers! My session went pretty well, somewhere around 60 attendees I would guess and they didn&#8217;t seem too bored. I saw some other great sessions as well, such as Buck Woody (<a href="https://twitter.com/buckwoody">twitter</a>) on Big Data (and a fantastic keynote) and a demo session on Azure ML. I also attended Grants (<a href="https://twitter.com/GFritchey">twitter </a>| <a href="http://www.scarydba.com/">blog</a>) precon on execution plans and I definitely learned a lot.</p>
<p>It was great to meet up with the #sqlfamily and I can&#8217;t wait for next years edition.</p>
<p>I have uploaded my slides to <a href="http://www.slideshare.net/KoenVerbeeck/sql-server-days-2014-how-to-not-torment-your">Slideshare</a>, in case you&#8217;re interested.</p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/ssis/sql-server-days-2014-slide-deck/#comments" thr:count="2"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/ssis/sql-server-days-2014-slide-deck/feed/atom/" thr:count="2"/>
		<thr:total>2</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[The Magic Alt Button]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/dbprogramming/mssqlserver/the-magic-alt-button/" />
		<id>/?p=2967</id>
		<updated>2014-09-23T13:40:06Z</updated>
		<published>2014-09-23T13:39:54Z</published>
		<category scheme="/" term="Microsoft SQL Server" /><category scheme="/" term="SSIS" /><category scheme="/" term="block" /><category scheme="/" term="selecting text" /><category scheme="/" term="sql" /><category scheme="/" term="sql server" /><category scheme="/" term="ssis" /><category scheme="/" term="syndicated" /><category scheme="/" term="tsql" />		<summary type="html"><![CDATA[Lately I have been using more and more the awesomeness of the Alt-button in SQL Server Management Studio (SSMS). What do I mean with this? While holding the Alt-button on your keyboard, you can select a block of text instead of lines of text. Note that this is not an exclusive feature, you can do [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/dbprogramming/mssqlserver/the-magic-alt-button/"><![CDATA[<p style="text-align: justify">Lately I have been using more and more the awesomeness of the Alt-button in SQL Server Management Studio (SSMS). What do I mean with this? While holding the Alt-button on your keyboard, you can select a block of text instead of lines of text.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/blockselected.jpg"><img class="alignnone wp-image-2976" src="/wp-content/uploads/2014/09/blockselected-243x300.jpg" alt="blockselected" width="308" height="381" srcset="/wp-content/uploads/2014/09/blockselected-243x300.jpg 243w, /wp-content/uploads/2014/09/blockselected.jpg 571w" sizes="(max-width: 308px) 100vw, 308px" /></a></p>
<p style="text-align: justify">Note that this is not an exclusive feature, you can do this in some other applications as well (like Word and Notepad++). An alternative is holding Alt+Shift and moving the cursor with the arrow keys. This can be useful for example when working on a laptop without a mouse present and you don’t really trust yourself holding Alt, the select button and moving the touchpad at the same time. This alternative doesn’t work in every application though. In Word this keyboard shortcut is used to move the current paragraph.</p>
<p style="text-align: justify">Anyway, what makes selecting blocks of code so magic and awesome? Because I can for example create a SQL update statement for a dimension using a staging table super quickly. Allow me to illustrate.</p>
<p style="text-align: justify">Suppose I want to create an update statement to update the Employee dimension of the AdventureWorks database. The source data is located in a staging table with almost the exact schema of the target table. Typically this staging table is populated with update data coming from an incremental load SSIS package. Using a staging table and an update statement in an Execute SQL Task allows us to get rid of the OLE DB Command, which issues updates row by row in SSIS. Which we do not want. Anyway, I digress. Let’s assume the staging table has the following schema:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="de1"><pre class="de1"><span class="kw1">USE</span> <span class="br0">&#91;</span>AdventureWorksDW2012<span class="br0">&#93;</span>
GO
&nbsp;
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>Upd_DimEmployee<span class="br0">&#93;</span><span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span>EmployeeKey<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">int</span><span class="br0">&#93;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>SalesTerritoryKey<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">int</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>FirstName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>LastName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>MiddleName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>NameStyle<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">bit</span><span class="br0">&#93;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>Title<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>HireDate<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">date</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>BirthDate<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">date</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>LoginID<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">256</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>EmailAddress<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>Phone<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">25</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>MaritalStatus<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>EmergencyContactName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>EmergencyContactPhone<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">25</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>SalariedFlag<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">bit</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>Gender<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>PayFrequency<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">tinyint</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>BaseRate<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">money</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>VacationHours<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">smallint</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>SickLeaveHours<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">smallint</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>CurrentFlag<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">bit</span><span class="br0">&#93;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>SalesPersonFlag<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">bit</span><span class="br0">&#93;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>DepartmentName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>StartDate<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">date</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>EndDate<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">date</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>Status<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>EmployeePhoto<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varbinary</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="kw2">max</span><span class="br0">&#41;</span> <span class="sy0">NULL</span><span class="br0">&#41;</span>;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">USE [AdventureWorksDW2012]
GO

CREATE TABLE [dbo].[Upd_DimEmployee](
	[EmployeeKey] [int] NOT NULL,
	[SalesTerritoryKey] [int] NULL,
	[FirstName] [nvarchar](50) NOT NULL,
	[LastName] [nvarchar](50) NOT NULL,
	[MiddleName] [nvarchar](50) NULL,
	[NameStyle] [bit] NOT NULL,
	[Title] [nvarchar](50) NULL,
	[HireDate] [date] NULL,
	[BirthDate] [date] NULL,
	[LoginID] [nvarchar](256) NULL,
	[EmailAddress] [nvarchar](50) NULL,
	[Phone] [nvarchar](25) NULL,
	[MaritalStatus] [nchar](1) NULL,
	[EmergencyContactName] [nvarchar](50) NULL,
	[EmergencyContactPhone] [nvarchar](25) NULL,
	[SalariedFlag] [bit] NULL,
	[Gender] [nchar](1) NULL,
	[PayFrequency] [tinyint] NULL,
	[BaseRate] [money] NULL,
	[VacationHours] [smallint] NULL,
	[SickLeaveHours] [smallint] NULL,
	[CurrentFlag] [bit] NOT NULL,
	[SalesPersonFlag] [bit] NOT NULL,
	[DepartmentName] [nvarchar](50) NULL,
	[StartDate] [date] NULL,
	[EndDate] [date] NULL,
	[Status] [nvarchar](50) NULL,
	[EmployeePhoto] [varbinary](max) NULL);</pre></div></div>

<p style="text-align: justify">This update table has all the updateable columns of the Employee dimension and the surrogate key, but not the business key (since it won’t change anyway). The surrogate key does not have the IDENTITY property, as it will be retrieved from the Employee dimension with a Lookup component in the SSIS package.</p>
<p style="text-align: justify">OK, now let’s create the update statement. We start with the list of updateable columns from the dimension, the UPDATE clause and the FROM and JOIN clauses.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_01.jpg"><img class="alignnone size-medium wp-image-2977" src="/wp-content/uploads/2014/09/update_statement_01-268x300.jpg" alt="update_statement_01" width="268" height="300" srcset="/wp-content/uploads/2014/09/update_statement_01-268x300.jpg 268w, /wp-content/uploads/2014/09/update_statement_01.jpg 581w" sizes="(max-width: 268px) 100vw, 268px" /></a></p>
<p style="text-align: justify">Thanks to the surrogate key <em>EmployeeKey</em> we can easily join the Employee dimension and its staging table. First select a line after the columns while holding the Alt button.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_02.jpg"><img class="alignnone size-medium wp-image-2978" src="/wp-content/uploads/2014/09/update_statement_02-273x300.jpg" alt="update_statement_02" width="273" height="300" srcset="/wp-content/uploads/2014/09/update_statement_02-273x300.jpg 273w, /wp-content/uploads/2014/09/update_statement_02.jpg 589w" sizes="(max-width: 273px) 100vw, 273px" /></a></p>
<p style="text-align: justify">This is easy with the mouse and you don’t even need a cursor position to start from. You can select literally every block you want. If you want to do this with the keyboard only, you need to tab to the position you want and then start selecting.</p>
<p style="text-align: justify">And now comes the awesome part. With the single line still selected, you can start typing at all the lines at once.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_03.jpg"><img class="alignnone size-medium wp-image-2979" src="/wp-content/uploads/2014/09/update_statement_03-300x237.jpg" alt="update_statement_03" width="300" height="237" srcset="/wp-content/uploads/2014/09/update_statement_03-300x237.jpg 300w, /wp-content/uploads/2014/09/update_statement_03.jpg 827w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p style="text-align: justify">Great isn’t it? Now select all of the columns with the Alt button and copy them.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_04.jpg"><img class="alignnone size-medium wp-image-2980" src="/wp-content/uploads/2014/09/update_statement_04-276x300.jpg" alt="update_statement_04" width="276" height="300" srcset="/wp-content/uploads/2014/09/update_statement_04-276x300.jpg 276w, /wp-content/uploads/2014/09/update_statement_04.jpg 590w" sizes="(max-width: 276px) 100vw, 276px" /></a></p>
<p style="text-align: justify">Move your cursor to the first line, right after “= u.” and simply paste the columns.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_05.jpg"><img class="alignnone size-medium wp-image-2981" src="/wp-content/uploads/2014/09/update_statement_05-268x300.jpg" alt="update_statement_05" width="268" height="300" srcset="/wp-content/uploads/2014/09/update_statement_05-268x300.jpg 268w, /wp-content/uploads/2014/09/update_statement_05.jpg 571w" sizes="(max-width: 268px) 100vw, 268px" /></a></p>
<p style="text-align: justify">That was created pretty fast, right? A lot faster than typing everything, even with Intellisense. Of course, we want an efficient update statement, so we’ll add a WHERE clause with the same techniques that will check if anything has changed at all.</p>
<p style="text-align: justify">Add the WHERE clause and paste the list of columns again.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_06.jpg"><img class="alignnone size-medium wp-image-2982" src="/wp-content/uploads/2014/09/update_statement_06-286x300.jpg" alt="update_statement_06" width="286" height="300" srcset="/wp-content/uploads/2014/09/update_statement_06-286x300.jpg 286w, /wp-content/uploads/2014/09/update_statement_06.jpg 584w" sizes="(max-width: 286px) 100vw, 286px" /></a></p>
<p style="text-align: justify">Move the column list to the right and add the keyword OR and the table alias before every line (except the first) with the <em>type-on-every-line</em> trick.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_07.jpg"><img class="alignnone size-medium wp-image-2973" src="/wp-content/uploads/2014/09/update_statement_07-280x300.jpg" alt="update_statement_07" width="280" height="300" srcset="/wp-content/uploads/2014/09/update_statement_07-280x300.jpg 280w, /wp-content/uploads/2014/09/update_statement_07.jpg 573w" sizes="(max-width: 280px) 100vw, 280px" /></a></p>
<p style="text-align: justify">Now select a line after the columns and add inequality operator and the other table alias.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_08.jpg"><img class="alignnone size-medium wp-image-2974" src="/wp-content/uploads/2014/09/update_statement_08-273x300.jpg" alt="update_statement_08" width="273" height="300" srcset="/wp-content/uploads/2014/09/update_statement_08-273x300.jpg 273w, /wp-content/uploads/2014/09/update_statement_08.jpg 565w" sizes="(max-width: 273px) 100vw, 273px" /></a></p>
<p style="text-align: justify">Simply paste the column list again at the end.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/09/update_statement_09.jpg"><img class="alignnone size-medium wp-image-2975" src="/wp-content/uploads/2014/09/update_statement_09-296x300.jpg" alt="update_statement_09" width="296" height="300" srcset="/wp-content/uploads/2014/09/update_statement_09-296x300.jpg 296w, /wp-content/uploads/2014/09/update_statement_09.jpg 640w" sizes="(max-width: 296px) 100vw, 296px" /></a></p>
<p style="text-align: justify">Don’t forget the semicolon at the end! To really top it off, we should include ISNULL functions everywhere to account for NULL values, but I’ll leave that as an exercise for the reader <img src="https://s.w.org/images/core/emoji/2/72x72/1f609.png" alt="😉" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/dbprogramming/mssqlserver/the-magic-alt-button/#comments" thr:count="11"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/dbprogramming/mssqlserver/the-magic-alt-button/feed/atom/" thr:count="11"/>
		<thr:total>11</thr:total>
		</entry>
		<entry>
		<author>
			<name>Koen Verbeeck</name>
					</author>
		<title type="html"><![CDATA[Stupid me #4 – The login is from an untrusted domain]]></title>
		<link rel="alternate" type="text/html" href="/index.php/datamgmt/ssis/stupid-me-4-the-login-is-from-an-untrusted-domain/" />
		<id>/?p=2911</id>
		<updated>2016-07-12T07:56:14Z</updated>
		<published>2014-08-21T12:37:37Z</published>
		<category scheme="/" term="Business Intelligence" /><category scheme="/" term="SSIS" /><category scheme="/" term="sql server" /><category scheme="/" term="ssis" /><category scheme="/" term="syndicated" />		<summary type="html"><![CDATA[After quite a while it has finally returned: another Stupid Me™®©! A reminder: Every time I do something “stupid”, which happens from time to time, I’ll do a little blog post on what happened and how I solved it. The reason for this is twofold: I’ll have a solution online I can consult if it [&#8230;]]]></summary>
		<content type="html" xml:base="/index.php/datamgmt/ssis/stupid-me-4-the-login-is-from-an-untrusted-domain/"><![CDATA[<p style="text-align: justify">After quite a while it has finally returned: another Stupid Me™®©! A reminder:</p>
<p style="text-align: justify"><em>Every time I do something “stupid”, which happens from time to time, I’ll do a little blog post on what happened and how I solved it. The reason for this is twofold: I’ll have a solution online I can consult if it happens again and other people can benefit from my mistakes as well. Because remember the ancient Chinese proverb</em>: <em>“It’s only stupid if you don’t turn it into a learning experience”. </em><em>Okay, I might have made that last one up…</em></p>
<p style="text-align: justify"><strong>The problem</strong></p>
<p style="text-align: justify">At a client, the test environment has the same daily SQL Server Agent job that runs the ETL just like in production.  On a rainy morning, the job suddenly returned the following error:</p>
<p style="text-align: justify"><em>Login Failed. The login is from an untrusted domain and cannot be used with Windows authentication.</em></p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/08/error.png"><img class="alignnone size-full wp-image-2913" src="/wp-content/uploads/2014/08/error.png" alt="error" width="297" height="120" /></a></p>
<p style="text-align: justify">Important to know is that each environment – Development, Test and Production – has its own Active Directory domain for security reasons. I immediately thought of an issue within Active Directory, but the AD admin assured me nothing had changed. The login itself – a regular domain account used as an execution account – was active and its password had not expired.</p>
<p style="text-align: justify">So where did this error come from?</p>
<p style="text-align: justify"><strong>The solution</strong></p>
<p style="text-align: justify">Several packages of the same SSIS project had the same issues, but packages from another project did not. Time to investigate further, so I checked the versions of that particular project in the SSIS catalog.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/08/versions.png"><img class="alignnone size-full wp-image-2916" src="/wp-content/uploads/2014/08/versions.png" alt="versions" width="286" height="327" srcset="/wp-content/uploads/2014/08/versions.png 286w, /wp-content/uploads/2014/08/versions-262x300.png 262w" sizes="(max-width: 286px) 100vw, 286px" /></a></p>
<p style="text-align: justify">Turned out I did a deployment of that project the day before the SQL Agent job started failing. The plot thickens. It means there was some change in the project that caused this strange error. But what?</p>
<p style="text-align: justify">I looked into the connection manager that was failing to connect. Connection managers in the project are project connection managers and they are configured using two parameters: one to set the database and one to set the server. Configuring project connection managers is easy: this can be done through any package in the project. Simply go to the properties of the connection manager and configure the expressions. These expressions will immediately apply in every package.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/08/expression.png"><img class="alignnone size-full wp-image-2914" src="/wp-content/uploads/2014/08/expression.png" alt="expression" width="568" height="501" srcset="/wp-content/uploads/2014/08/expression.png 568w, /wp-content/uploads/2014/08/expression-300x264.png 300w" sizes="(max-width: 568px) 100vw, 568px" /></a></p>
<p style="text-align: justify">When the package is deployed to the SSIS catalog of another environment, the parameters there will have the corresponding values of that environment.</p>
<p style="text-align: justify">I took a look at the version control history of the project connection manager. And apparently I did make a change to the connection manager.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/08/history.png"><img class="alignnone size-full wp-image-2915" src="/wp-content/uploads/2014/08/history.png" alt="history" width="484" height="123" srcset="/wp-content/uploads/2014/08/history.png 484w, /wp-content/uploads/2014/08/history-300x76.png 300w" sizes="(max-width: 484px) 100vw, 484px" /></a></p>
<p style="text-align: justify">However, I did not recall making any change to the projection manager. And then it hit me. I generated all of the packages using BIML. In the BIML script, I also generate the connection managers as they are needed during compile time (as far as I know BIML doesn’t realize they are actually already there in the project). I didn’t include the expressions in the BIML script as I do not actually generate them. When the BIML script is finished, it asks you if you want to overwrite existing items. I simply deselect the checkboxes for the connection managers and everything is fine in the world.</p>
<p style="text-align: justify"><a href="/wp-content/uploads/2014/08/bimloverwrite.png"><img class="alignnone size-full wp-image-2917" src="/wp-content/uploads/2014/08/bimloverwrite.png" alt="bimloverwrite" width="652" height="139" srcset="/wp-content/uploads/2014/08/bimloverwrite.png 652w, /wp-content/uploads/2014/08/bimloverwrite-300x63.png 300w" sizes="(max-width: 652px) 100vw, 652px" /></a></p>
<p style="text-align: justify">Except when you forget to deselect the checkbox. In that case, the connection manager is overwritten and the expressions are gone. Which means that when you deploy the project to another server, the package tries to connect to the development server (which is on another domain). Hence the error. Whoops.</p>
<p style="text-align: justify"><strong>Conclusion</strong></p>
<p style="text-align: justify">The obvious solution is to not forget to deselect the checkboxes for the connection managers, but a more durable solution is to expand my BIML script to include the expressions, just to make sure. Debugging this issue was made easy because of the automatic versioning in the SSIS catalog, but also because the SSIS projects in Visual Studio are checked into version control, making it straight forward to find any changes.</p>
<p style="text-align: justify">Related posts:</p>
<ul>
<li style="text-align: justify"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/stupid-me-1-locking-myself/">Stupid me #1 – Locking myself out of SQL Server</a></li>
<li style="text-align: justify"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/stupid-me-2/">Stupid me #2 – Where is my SSIS package executed?</a></li>
<li style="text-align: justify"><a href="/index.php/datamgmt/ssis/stupid-me-3-building-the/">Stupid me #3 – Building the script component</a></li>
</ul>
]]></content>
			<link rel="replies" type="text/html" href="/index.php/datamgmt/ssis/stupid-me-4-the-login-is-from-an-untrusted-domain/#comments" thr:count="3"/>
		<link rel="replies" type="application/atom+xml" href="/index.php/datamgmt/ssis/stupid-me-4-the-login-is-from-an-untrusted-domain/feed/atom/" thr:count="3"/>
		<thr:total>3</thr:total>
		</entry>
	</feed>
