<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Split string in SQL Server 2005+  CLR vs. T-SQL</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Split string in SQL Server 2005+  CLR vs. T-SQL" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="I&#8217;m editing in a link to Adam Machanic&#8217;s blog on this. In the comments on this topic here you will see there are imperfections found in my methods. Reading Adam&#8217;s blog shows this in more detail. http://sqlblog.com/blogs/adam_machanic/archive/2009/04/26/faster-more-scalable-sqlclr-string-splitting.aspx Thanks Adam! I wrote this short CLR split function awhile back based on a few other articles I [&hellip;]" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Split string in SQL Server 2005+  CLR vs. T-SQL Comments Feed" href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='What makes a successful SQL Server Reporting Services implementation?' href='/index.php/datamgmt/datadesign/what-makes-a-good-sql-server-reporting-s/' />
<link rel='next' title='An Invisible Project is a Failed Project' href='/index.php/itprofessionals/projectmanagement/an-invisible-project-is-a-failed-project/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/" />
<link rel='shortlink' href='/?p=394' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fsplit-string-in-sql-server-2005-clr-vs-t%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fsplit-string-in-sql-server-2005-clr-vs-t%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/itprofessionals/projectmanagement/an-invisible-project-is-a-failed-project/" rel="next">An Invisible Project is a Failed Project</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/datamgmt/datadesign/what-makes-a-good-sql-server-reporting-s/" rel="prev">What makes a successful SQL Server Reporting Services implementation?</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/" class="post-title">Split string in SQL Server 2005+  CLR vs. T-SQL</a></h1>
					<div class="post-byline">by <a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)" rel="author">Ted Krueger (onpnt)</a> on April 21, 2009 in category <a href="/index.php/category/datamgmt/dbprogramming/" rel="category tag">Database Programming</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 48,552 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&text=RT @LessThanDot Blog - Split string in SQL Server 2005+  CLR vs. T-SQL by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&title=Split string in SQL Server 2005+  CLR vs. T-SQL&source=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&title=Split string in SQL Server 2005+  CLR vs. T-SQL" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&quote=Split string in SQL Server 2005+  CLR vs. T-SQL" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&title=Split string in SQL Server 2005+  CLR vs. T-SQL" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>I&#8217;m editing in a link to Adam Machanic&#8217;s blog on this.  In the comments on this topic here you will see there are  imperfections found in my methods.  Reading Adam&#8217;s blog shows this in more detail.<br />
http://sqlblog.com/blogs/adam_machanic/archive/2009/04/26/faster-more-scalable-sqlclr-string-splitting.aspx </p>
<p>Thanks Adam!</p>
<p>I wrote this short CLR split function awhile back based on a few other articles I read when 2005 was released.  I decided to play with it today and see if I could put it with the SQL split solutions.  </p>
<p>Let&#8217;s get the basics out of the way on SQL CLR.  SQL CLR is only good once it&#8217;s in memory.  The CLR function split basically won over the T-SQL split functions after it was cached.  This is a critical variable to consider when thinking CLR vs. T-SQL options on coding.  If you are doing heavy manipulation of data and heavy math, CLR will typically help you, but you should be very careful with CLR and memory management.  You can run your server resources out and literally stop functionality.  I highly recommend reading MrDenny&#8217;s blog on CLR <a href="http://itknowledgeexchange.techtarget.com/sql-server/sql-clr-the-what-when-why-and-how/">here</a>.  Denny touches on important topics on when to use CLR and why you shouldn&#8217;t.  After that, look into how SQL Server 32bit, 32bit with AWE and 64bit versions handle memory.  Each handles memory differently.  AWE enalbed instances will probably be the one that will cause you more headaches then the rest.  I had severe memory issues a few months ago on a production database server that forced restarts nightly until I fixed the problem.  I analyzed the problem and it came to be several factors that caused it and SQL CLR memory was one of those factors.  Here is my chance to thank mrdenny and ptheriault again for the assisatnce on that strange problem.</p>
<p>I went out and google&#8217;d &#8220;fast split function t-sql&#8221;.  Found a few and tested them against the CLR split method.  I found a dozen or so split functions that looked good.  I still went with a numbers table one after testing them out next to each other.  Here is one of the functions I used.  If you have a better one, post it in the comments and I can edit the post.  </p>
<pre>ALTER FUNCTION [dbo].[Split] ( 
@List varchar(7998), --The delimited list 
@Del char(1) = ',' --The delimiter 
) 
RETURNS @T TABLE (Item varchar(7998)) 
AS 
BEGIN 
DECLARE @WrappedList varchar(8000), @MaxItems int 
SELECT @WrappedList = @Del + @List + @Del, @MaxItems = LEN(@List) 

INSERT INTO @T (Item) 
SELECT SUBSTRING(@WrappedList, Number + 1, CHARINDEX(@Del, @WrappedList, Number + 1) - Number - 1) 
FROM dbo.Numbers n 
WHERE n.Number &lt;= LEN(@WrappedList) - 1 
AND SUBSTRING(@WrappedList, n.Number, 1) = @Del 

RETURN 
END</pre>
<p>Here is my CLR split</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="de1"><pre class="de1"><span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Data</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Collections</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Data.SqlClient</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Data.SqlTypes</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">Microsoft.SqlServer.Server</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">public</span> <span class="kw1">partial</span> <span class="kw4">class</span> UserDefinedFunctions
<span class="br0">&#123;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span>SqlFunction<span class="br0">&#40;</span>Name <span class="sy0">=</span> <span class="st0">&quot;CLR_Split&quot;</span>,
&nbsp; &nbsp; FillRowMethodName <span class="sy0">=</span> <span class="st0">&quot;FillRow&quot;</span>, 
&nbsp; &nbsp; TableDefinition <span class="sy0">=</span> <span class="st0">&quot;id nvarchar(10)&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw1">static</span> IEnumerable SqlArray<span class="br0">&#40;</span>SqlString str, SqlChars delimiter<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">&#40;</span>delimiter<span class="sy0">.</span><span class="me1">Length</span> <span class="sy0">==</span> <span class="nu0">0</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> <span class="kw3">new</span> <span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="br0">&#123;</span> str<span class="sy0">.</span><span class="kw1">Value</span> <span class="br0">&#125;</span><span class="sy0">;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">return</span> str<span class="sy0">.</span><span class="kw1">Value</span><span class="sy0">.</span><span class="me1">Split</span><span class="br0">&#40;</span>delimiter<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> FillRow<span class="br0">&#40;</span><span class="kw4">object</span> row, <span class="kw1">out</span> SqlString str<span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="br0">&#123;</span>
&nbsp; &nbsp; &nbsp; &nbsp; str <span class="sy0">=</span> <span class="kw3">new</span> SqlString<span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">string</span><span class="br0">&#41;</span>row<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp; &nbsp; <span class="br0">&#125;</span>
<span class="br0">&#125;</span><span class="sy0">;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">using System;
using System.Data;
using System.Collections;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using Microsoft.SqlServer.Server;

public partial class UserDefinedFunctions
{
    [SqlFunction(Name = "CLR_Split",
    FillRowMethodName = "FillRow", 
    TableDefinition = "id nvarchar(10)")]

    public static IEnumerable SqlArray(SqlString str, SqlChars delimiter)
    {
        if (delimiter.Length == 0)
            return new string[1] { str.Value };
        return str.Value.Split(delimiter[0]);
    }

    public static void FillRow(object row, out SqlString str)
    {
        str = new SqlString((string)row);
    }
};</pre></div></div>

<p>I loaded a text file with a huge amount of delimited data to really get a gauge on time this would take.  The string is basically, &#8220;data%data%data%data%data&#8221; and on.  Around 600 indexes.  I restarted my local instance of SQL Server 2005 that I did these on to ensure you can see CLR before cache and after.  </p>
<p>So on a fresh restart you can see by checking type MEMORYCLERK_SQLCLR from dm_os_memory_clerks that we are clear</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/clr_clerk_1.gif" alt="" title="" width="1439" height="63" /></div>
<p>After execution of the CLR function you can see the differences</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/clr_clerk_2.gif" alt="" title="" width="1187" height="39" /></div>
<p>Call these functions as</p>
<pre>Declare @bigdamnvar varchar(max)
Set @bigdamnvar = (Select * From OpenRowSet ('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)};DBQ=C:', 'SELECT * from Data.txt'))
Select * From dbo.CLR_Split(@bigdamnvar, '%')</pre>
<p>Below you can see first execution and then how quickly performance picks up on the second cached plan</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/split_clr.gif" alt="" title="" width="496" height="368" /></div>
<p>and</p>
<pre>Declare @bigdamnvar varchar(max)
Set @bigdamnvar = (Select * From OpenRowSet ('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)};DBQ=C:', 'SELECT * from Data.txt'))
Select * From dbo.[Split](@bigdamnvar, '%')</pre>
<p>I executed this a few times to get it in cache as well.  The odd increase was the server working on something else.  I validated that so ignore it.</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/split_tsql.gif" alt="" title="" width="769" height="372" /></div>
<p>You may notice the bytes recieved from the server are different and SQL CLR is much heavier.  That is something to keep in mind.  SQL will always be light compared to SQL CLR.  That is my experience in using the two side by side.</p>
<p>The differences are small but if the task you intend to perform is something cached typically, keep CLR in mind.  Mostly  when it come to complicated tasks that may be left to other languages you have available.</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/concat-function-in-sql-server/'>Concat function in SQL Server Denali CTP3</a><p>SQL Server Denali CTP3 brings a couple of new functions, one of these is the&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/sql-server-collation-conflicts/'>SQL Server collation conflicts</a><p>Collations control how strings are sorted and compared. Sorting is not usually a problem because&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Ted Krueger is a SQL Server MVP and Author that has been working in development and database administration and the owner of a successful consulting business, DataMetrics Consulting.  Specialties range from High Availability and Disaster / Recovery setup and testing methods down to custom assembly development for SQL Server Reporting Services.  Ted blogs and is also one of the founders of LessThanDot.com technology community.  Some of the articles focused on are Backup / Recovery, Security, SSIS and working on SQL Server and using all of the SQL Server features available to create stable and scalable database services.  <br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/onpnt" title="onpnt at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=https://www.facebook.com/onpntfirearms" title="onpnt at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/pub/ted-krueger/2/183/b66" title="onpnt at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://www.datametricsconsulting.com/" title="onpnt at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="/index.php/author/onpnt/feed/" title="Blog RSS feed for onpnt" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 48,552 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/onpnt/">Read More Posts by Ted Krueger (onpnt)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&text=RT @LessThanDot Blog - Split string in SQL Server 2005+  CLR vs. T-SQL by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&title=Split string in SQL Server 2005+  CLR vs. T-SQL&source=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&title=Split string in SQL Server 2005+  CLR vs. T-SQL" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&quote=Split string in SQL Server 2005+  CLR vs. T-SQL" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/&title=Split string in SQL Server 2005+  CLR vs. T-SQL" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		27 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-SQLDenis even thread-even depth-1" id="comment-1214">
				<div id="div-comment-1214" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1214">
			April 22, 2009 at 1:30 pm</a>		</div>

		<p>I prefer the numbers table way, seems purer</p>
<p>Any reason you haven&#8217;t used varchar(max) instead?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1214#respond' onclick='return addComment.moveForm( "div-comment-1214", "1214", "respond", "394" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1215">
				<div id="div-comment-1215" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1215">
			April 22, 2009 at 2:38 pm</a>		</div>

		<p>I didn&#8217;t write the split function above (SQL version). It was here <a href="http://mo.notono.us/2005/08/sql-fast-string-split-function-using.html" rel="nofollow">http://mo.notono.us/2005/08/sql-fast-string-split-function-using.html</a> (I think, it was a link from another blog)<br />
I went out and grabbed a bunch that were posted on the web. Apologies to the author. I forgot to put the references</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1215#respond' onclick='return addComment.moveForm( "div-comment-1215", "1215", "respond", "394" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1216">
				<div id="div-comment-1216" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/8945a8723d6fb0079749ff0ed21c7c8b?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/8945a8723d6fb0079749ff0ed21c7c8b?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.sqlclr.net/' rel='external nofollow' class='url'>Jonathan Kehayias</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1216">
			April 22, 2009 at 7:09 pm</a>		</div>

		<p>The testing that you used here is inherently flawed for your comparisions.  You are using a single value to perform your testing versus doing this test against a table of data which is where the performance degredation of SQLCLR really begins to show for string splitting like this.  Take this out to a large scale operation, and TSQL will have the advantage because of the cost of switching in and out of SQLCLR.</p>
<p>If you&#8217;d like I can provide previous statistics from benchmarking methods very similar to yours where Jeff Moden and I squared of in a SQLCLR versus TSQL challenge to debunk the myth that SQLCLR is better for simple problems like this one.  That is not to say that SQLCLR can&#8217;t beat TSQL for complex operations like regular expression matches/replacements, and complex mathematics, but most common string operations can be done faster with TSQL when working against a dataset versus a single row.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1216#respond' onclick='return addComment.moveForm( "div-comment-1216", "1216", "respond", "394" )' aria-label='Reply to Jonathan Kehayias'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis odd alt thread-odd thread-alt depth-1" id="comment-1217">
				<div id="div-comment-1217" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1217">
			April 22, 2009 at 7:37 pm</a>		</div>

		<p>Jonathan, feel free to post statistics or provide a link where you have it, it would be interesting to see what your results are</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1217#respond' onclick='return addComment.moveForm( "div-comment-1217", "1217", "respond", "394" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros even thread-even depth-1" id="comment-1219">
				<div id="div-comment-1219" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1219">
			April 22, 2009 at 8:01 pm</a>		</div>

		<p>Jonathan,</p>
<p>Perhaps I don&#8217;t understand something.  Are you suggesting that a column in a table that contains delimited text will perform better using T-SQL than SQL-CLR?  If that&#8217;s the case, I would argue that normalizing the data for persistent storage (and eliminating the need to split it) would perform better.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1219#respond' onclick='return addComment.moveForm( "div-comment-1219", "1219", "respond", "394" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1220">
				<div id="div-comment-1220" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1220">
			April 22, 2009 at 8:18 pm</a>		</div>

		<p>Hi Jonathan, Thanks for the comments. I would like to see the benchmarks as well if you can dig them up. I don&#8217;t think something like s split function is really viable on a large scale table unless the design of the tables or data is just forcing that but of course I see what you are saying. Given that scenario if not configured correctly this type of test could and probably would cause more issues that just slow performance on the statement being executed. I&#8217;m just not sure given a split function it is really that common to run on much more than parameters or string values required for processing tasks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1220#respond' onclick='return addComment.moveForm( "div-comment-1220", "1220", "respond", "394" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1221">
				<div id="div-comment-1221" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e5ce733d885be2216b2f928a751627e3?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e5ce733d885be2216b2f928a751627e3?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.simple-talk.com/' rel='external nofollow' class='url'>Phil Factor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1221">
			April 25, 2009 at 6:56 am</a>		</div>

		<p>CLR-based routines are better for splitting small strings and TSQL solutions are better for large strings. Your tally-based solution is a poor performer compared to a well-written WHILE-loop solution when the strings you are splitting are fairly long. On powerful machines with plenty of CPU, the difference between CLR and TSQL solutions are less pronounced. <br />
Basically, TSQL-based solutions scale in a linear way with the size of the string it is splitting, whereas the CLR-based solutions scale in a second-order polynomial curve. <br />
To test all this out, you will need to create a test harness that executes all the candidate solutions with a wide variety of strings. It needs to repeat the tests on a number of servers, as these will give you striking differences in results. <br />
Sorry, friend. More work to do!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1221#respond' onclick='return addComment.moveForm( "div-comment-1221", "1221", "respond", "394" )' aria-label='Reply to Phil Factor'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1222">
				<div id="div-comment-1222" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1222">
			April 25, 2009 at 11:14 am</a>		</div>

		<p>I&#8217;m not sure I agree when it comes to the length of string I used and the means in which the write up was played towards.  You can say every word you just stated about any testing scenario no matter what the comparison is or the technology is.  Our job is to write what we learn, play with and try out in a set base and then work off of that while allowing peers to also.  Testing in situations like you said isn&#8217;t in scope.  If we had that at our disposal then maybe, but I’m far from a testing farm 😉  That will be for the person that reads this and tries it out objectively in their environment and configuration.  All results will differ obviously.  This was done on a laptop messing around and was nothing more than that as the blog stated.  The results were favored in CLR slightly and as mentioned in a higher level on how CLR differs, there are condition variables to take into account.</p>
<p>There is no more work for me to do other than decide if this would benefit my own environment and production coding after testing there.  The &#8220;more work to do&#8221; is for the readers to take it and test it on their own servers.  I also do not think a 3045 character string is small and think it was a good median to test on.</p>
<p>So it seems I agree but given a common landscape disagree with your choice of deciding this was a poor test 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1222#respond' onclick='return addComment.moveForm( "div-comment-1222", "1222", "respond", "394" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1223">
				<div id="div-comment-1223" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2d6e491fa773660aff4414c84be25579?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2d6e491fa773660aff4414c84be25579?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://sqlblog.com/' rel='external nofollow' class='url'>Adam Machanic</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1223">
			April 25, 2009 at 4:46 pm</a>		</div>

		<p>I&#8217;m going to have to agree with others; your testing method is inherently flawed.  Your two functions should have identical inputs and outputs or you&#8217;re not doing an &#8220;apples-to-apples&#8221; comparison.  That means that bytes received from the server should be identical.  Your functions are not outputting the same thing, or perhaps not in the same format.  Did you autodeploy the CLR function?  If so, it&#8217;s spitting out NVARCHAR, not VARCHAR, which explains the discrepancy.</p>
<p>As for Phil&#8217;s statement that &#8220;[a] tally-based solution is a poor performer compared to a well-written WHILE-loop solution when the strings you are splitting are fairly long&#8221;, that&#8217;s not really correct either.  The fastest general solutions involve a numbers table and &#8220;chunking&#8221; of the string, since string operations on VARCHAR(MAX) are slower than string operations on VARCHAR(N).  </p>
<p>Here&#8217;s the best T-SQL method I&#8217;ve come up with:</p>
<p><a href="http://sqlblog.com/blogs/adam_machanic/archive/2006/07/12/splitting-a-string-of-unlimited-length.aspx" rel="nofollow">http://sqlblog.com/blogs/adam_machanic/archive/2006/07/12/splitting-a-string-of-unlimited-length.aspx</a></p>
<p>It will be slightly slower on small strings than the method you&#8217;ve posted here, but will scale better.  </p>
<p>I&#8217;ll post my own CLR method on my blog soon.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1223#respond' onclick='return addComment.moveForm( "div-comment-1223", "1223", "respond", "394" )' aria-label='Reply to Adam Machanic'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1224">
				<div id="div-comment-1224" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1224">
			April 25, 2009 at 5:12 pm</a>		</div>

		<p>Hi Adam.  That wasn&#8217;t the best choice on my part with the differences in types.  After the feedback I&#8217;ve started working on a much cleaner and better formed test and SQLCLR function.  Denis actually pointed out my flaw to me on teh side and I didn&#8217;t catch it at first. </p>
<p>Thanks for everyones feedback.  I&#8217;m looking forward to hearing what you all think on the next one 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1224#respond' onclick='return addComment.moveForm( "div-comment-1224", "1224", "respond", "394" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1225">
				<div id="div-comment-1225" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2d6e491fa773660aff4414c84be25579?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2d6e491fa773660aff4414c84be25579?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://sqlblog.com/' rel='external nofollow' class='url'>Adam Machanic</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1225">
			April 26, 2009 at 6:46 pm</a>		</div>

		<p>Posted:</p>
<p><a href="http://sqlblog.com/blogs/adam_machanic/archive/2009/04/26/faster-more-scalable-sqlclr-string-splitting.aspx" rel="nofollow">http://sqlblog.com/blogs/adam_machanic/archive/2009/04/26/faster-more-scalable-sqlclr-string-splitting.aspx</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1225#respond' onclick='return addComment.moveForm( "div-comment-1225", "1225", "respond", "394" )' aria-label='Reply to Adam Machanic'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1226">
				<div id="div-comment-1226" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c358a8edbaf5de680bdb55262a2a0a8f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c358a8edbaf5de680bdb55262a2a0a8f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Paul White</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1226">
			April 27, 2009 at 6:27 am</a>		</div>

		<p>Hey everyone,</p>
<p>Recent intensive testing on SQLServerCentral.com with Jeff Moden, Phil Factor and many others has shown CLR TVFs to outperform all comers so far, on text ranging from the very small to the complete text of Moby Dick.  This is for tables of strings to split, *not* single values.</p>
<p>The two exceptions so far, where T-SQL wins is where all lines of a 10,000 row table with huge strings are *identical* (the QO splits one and uses a table spool for the remaining rows &#8211; very clever) &#8230; and the second is where the text of Moby Dick is loaded into a single (N)VARCHAR(MAX) variable (Phil&#8217;s solution).</p>
<p>The best performing CLR TVF on huge sets so far uses RegEx splitting, with char-array splitting and simple String.Split() close behind.</p>
<p>See <a href="http://www.sqlservercentral.com/Forums/Topic695508-338-1.aspx?Update=1" rel="nofollow">http://www.sqlservercentral.com/Forums/Topic695508-338-1.aspx?Update=1</a> for the full details.</p>
<p>Cheers,</p>
<p>Paul</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1226#respond' onclick='return addComment.moveForm( "div-comment-1226", "1226", "respond", "394" )' aria-label='Reply to Paul White'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1227">
				<div id="div-comment-1227" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e5ce733d885be2216b2f928a751627e3?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e5ce733d885be2216b2f928a751627e3?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.simple-talk.com/' rel='external nofollow' class='url'>Phil Factor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1227">
			April 27, 2009 at 7:10 am</a>		</div>

		<p>Oops. I didn&#8217;t mean to sound as if I was being rude. I was just trying to give a feel for the complexity of any meaningful comparisons between splitting methods. There are a number of variables that seem to affect the result, and I was just trying to say that it needed a lot of testing to come to a clear conclusion.</p>
<p>Adam gives a very interesting illustration, and seems to have found a way around the problems with the CLR solution.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1227#respond' onclick='return addComment.moveForm( "div-comment-1227", "1227", "respond", "394" )' aria-label='Reply to Phil Factor'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1228">
				<div id="div-comment-1228" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1228">
			April 27, 2009 at 7:21 am</a>		</div>

		<p>I don&#8217;t think you were rude at all Phil. I think that goes for the others as well.</p>
<p>This entire topic has become extremely good and I&#8217;m glad all of you took the time to get the content on this blog and then take so much time to spawn off it.  I have little doubt there are going to be a high number of our peers that will learn a valuable lesson from this and all the other conversations linked back. 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1228#respond' onclick='return addComment.moveForm( "div-comment-1228", "1228", "respond", "394" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1229">
				<div id="div-comment-1229" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c358a8edbaf5de680bdb55262a2a0a8f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c358a8edbaf5de680bdb55262a2a0a8f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Paul White</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1229">
			April 27, 2009 at 7:50 am</a>		</div>

		<p>Update &#8211; I encourage everyone to check out Adam&#8217;s solution.  I had missed the scalability he has added by splitting the string bit-by-bit in the IEnumerator, rather than up front.  This should make all the difference when very long strings are involved.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1229#respond' onclick='return addComment.moveForm( "div-comment-1229", "1229", "respond", "394" )' aria-label='Reply to Paul White'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1230">
				<div id="div-comment-1230" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1230">
			April 27, 2009 at 8:12 am</a>		</div>

		<p>After Adam let me know it was posted I edited this blog and addded the link to his so everyone goes there before really reading into my post or just to understand the issues more and see the better solution</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1230#respond' onclick='return addComment.moveForm( "div-comment-1230", "1230", "respond", "394" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-emtucifor even thread-even depth-1" id="comment-1231">
				<div id="div-comment-1231" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1231">
			April 27, 2009 at 2:52 pm</a>		</div>

		<p>The Split function you listed can be optimized. Aside from removing the unnecessary variable declaration, this handling of the delimiter start and end (instead of adding the delimiter ahead of time) yields a slight performance improvement:</p>
<p>ALTER FUNCTION [dbo].[Split] (<br />
   @List VARCHAR(8000),<br />
   @Del CHAR(1) = &#8216;,&#8217;<br />
)<br />
RETURNS @T TABLE (Item VARCHAR(8000))<br />
AS<br />
BEGIN<br />
   INSERT INTO @T (Item)<br />
   SELECT SUBSTRING(@List, Number, CHARINDEX(@Del, @List + @Del, Number) &#8211; Number)<br />
   FROM dbo.Numbers n<br />
   WHERE<br />
      n.Number &lt;= LEN(@List) + 1<br />
      AND SUBSTRING(@Del + @List, n.Number, 1) = @Del</p>
<p>   RETURN<br />
END</p>
<p>I&#8217;ll go read Adam&#8217;s posted article now.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1231#respond' onclick='return addComment.moveForm( "div-comment-1231", "1231", "respond", "394" )' aria-label='Reply to Erik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola odd alt thread-odd thread-alt depth-1" id="comment-1232">
				<div id="div-comment-1232" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1232">
			September 2, 2009 at 8:40 am</a>		</div>

		<p>Could you compare results with the next one using CTE.<br />
My test shows this one is much faster.</p>
<p>Alter Function fnSplitWithCTE(<br />
&nbsp;@List varchar(8000),<br />
&nbsp;@Delimiter char(1),<br />
&nbsp;@ShowEmpty bit<br />
)<br />
Returns @ret Table (<br />
&nbsp;pos int Primary Key,<br />
&nbsp;value varchar(8000)<br />
)<br />
as Begin<br />
&nbsp;&nbsp;&nbsp;Declare @len int<br />
&nbsp;&nbsp;&nbsp;Set @len=len(@List)+1</p>
<p>&nbsp;&nbsp;&nbsp;;With a as<br />
&nbsp;&nbsp;&nbsp;( <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select 1 as nStart, <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isNull(NullIf(charindex(@Delimiter,@List,1),0),@len) as nEnd,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtrim(ltrim(substring(@List,1,isNull(NullIf(charindex(@Delimiter,@List,1),0),@len)-1))) as value<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Union All<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Select nEnd+1, <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isNull(NullIf(charindex(@Delimiter,@List,nEnd+1),0),@len),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtrim(ltrim(substring(@List,nEnd+1,isNull(NullIf(charindex(@Delimiter,@List,nEnd+1),0),@len)-nEnd-1)))<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From a<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Where nEnd&lt;@len<br />
&nbsp;&nbsp;&nbsp;)<br />
&nbsp;&nbsp;&nbsp;Insert Into @ret<br />
&nbsp;&nbsp;&nbsp;Select Row_Number() over (order by nStart),<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NullIf(value,&#8221;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;from a<br />
&nbsp;&nbsp;&nbsp;&nbsp;Where (@ShowEmpty=1 or Len(value)&gt;0)<br />
&nbsp;&nbsp;&nbsp;&nbsp;Return<br />
End</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1232#respond' onclick='return addComment.moveForm( "div-comment-1232", "1232", "respond", "394" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor even thread-even depth-1" id="comment-1233">
				<div id="div-comment-1233" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1233">
			September 2, 2009 at 8:48 am</a>		</div>

		<p>More than happy to do that.  I will later and post results.  In the 24 hours of pass sessions now 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1233#respond' onclick='return addComment.moveForm( "div-comment-1233", "1233", "respond", "394" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1234">
				<div id="div-comment-1234" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/43bca078403ac6b86a370552809e219f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/43bca078403ac6b86a370552809e219f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.sommarskog.se/' rel='external nofollow' class='url'>Erland Sommarskog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1234">
			September 5, 2009 at 8:21 am</a>		</div>

		<p>I see many comments about this and that being faster in that and that context. What all that leads to is that if you need the absolutely best solution in some real application, you need to run your own benchmark. </p>
<p>If you want to read performance data about string-splitting until you are blue in the face, I can offer <a href="http://www.sommarskog.se/arrays-in-sql-perftest.html" rel="nofollow">http://www.sommarskog.se/arrays-in-sql-perftest.html</a>. </p>
<p>I like to comment on Phil Factor who said: &#8220;CLR-based routines are better for splitting small strings and TSQL solutions are better for large strings.&#8221; I found nothing in my tests that indicates this. Au contrîare, when the string exceeds a certain size &#8211; around 600 KB on x64, 840 on x86 &#8211; execution times takes an incontiguous jump, and from there the slope is steeper. See my article above for details.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1234#respond' onclick='return addComment.moveForm( "div-comment-1234", "1234", "respond", "394" )' aria-label='Reply to Erland Sommarskog'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1236">
				<div id="div-comment-1236" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jeff Moden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1236">
			September 13, 2009 at 8:10 pm</a>		</div>

		<p>@Paul White</p>
<p>I&#8217;ve got to revisit that rather long thread&#8230; except for the CLR test which did beat the Tally table on the longer (ie. Varchar(MAX)), Tally splits on VARCHAR(8000) came very close to the CLR.  The problem I have with the tests that where done is just as you say&#8230; most of the tests were done with equal space values.  Heh&#8230; except for Phil&#8217;s Moby Dick split.</p>
<p>What Phil didn&#8217;t tell everyone is that he an I did a race on splitting the text of Moby Dick on another site.  On his machine, the While Loop he uses won.  On my machine, the Tally table won.  We didn&#8217;t test using a CTE.</p>
<p>That&#8217;s kind of brings us to what Adam said&#8230; you need to test against the actual data you&#8217;re going to be splitting and you need to do it on the machine that will be doing all the heavy lifting.</p>
<p>Shifting gears, I will say that the Tally table has a comparative performance problem when splitting VARCHAR(MAX) even if it contains less than 8000 characters because of it&#8217;s very nature to be &#8220;out of row&#8221;.  But, only a very well written very short CLR will beat the Tally table on VARCHAR(8000).  Even then, the Tally table comes so close that it&#8217;s not worth the trip to the world of CLR&#8217;s for me.</p>
<p>Also, anyone who uses a user defined function to split a whole table of CSV&#8217;s is making a mistake.  The ONLY exception to that rule is Erland&#8217;s TVF splitter.</p>
<p>VTW, Erland&#8230; nice article.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1236#respond' onclick='return addComment.moveForm( "div-comment-1236", "1236", "respond", "394" )' aria-label='Reply to Jeff Moden'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1235">
				<div id="div-comment-1235" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/96e0a0edfcfb91465b8ee36cbdda1fb3?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/96e0a0edfcfb91465b8ee36cbdda1fb3?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://praveenbattula.blogspot.com/' rel='external nofollow' class='url'>praveen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1235">
			June 4, 2010 at 12:42 pm</a>		</div>

		<p>Here is my version of the T-SQL UDF function.<br />
<a href="http://praveenbattula.blogspot.com/2010/06/best-split-udf-function-with-delimeter.html" rel="nofollow">http://praveenbattula.blogspot.com/2010/06/best-split-udf-function-with-delimeter.html</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1235#respond' onclick='return addComment.moveForm( "div-comment-1235", "1235", "respond", "394" )' aria-label='Reply to praveen'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-even depth-1" id="comment-1237">
				<div id="div-comment-1237" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1237">
			August 9, 2010 at 8:39 am</a>		</div>

		<p>Great round up by Aaron Bertrand here<br />
<a href="http://sqlblog.com/blogs/aaron_bertrand/archive/2010/07/07/splitting-a-list-of-integers-another-roundup.aspx">http://sqlblog.com/blogs/aaron_bertrand/archive/2010/07/07/splitting-a-list-of-integers-another-roundup.aspx</a></p>
<p>CLR is a winner in his tests when we&#8217;re dealing with big lists.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1237#respond' onclick='return addComment.moveForm( "div-comment-1237", "1237", "respond", "394" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1218">
				<div id="div-comment-1218" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5c09f722d9f6b66b71a987f162bbf418?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5c09f722d9f6b66b71a987f162bbf418?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.pawlowski.cz/' rel='external nofollow' class='url'>Pavel Pawlowski</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1218">
			January 1, 2012 at 2:48 pm</a>		</div>

		<p>I was also playing with the strings splitting a while ago and found that the CLR is the fastest when used in wit small and even very large strings.</p>
<p>It is only important to write the CLR in right way so CLR memory isn&#8217;t wasted and App Domains are not recycled etc.</p>
<p>I found, that the fastest method is simply iterate the characters in the string using a foreach loop and use an intermediate buffer.</p>
<p>An article is here: <a href="http://www.pawlowski.cz/2010/10/fastest-csv-strings-splitting-using-clr-t-sql-vs-clr-revisited/" rel="nofollow">http://www.pawlowski.cz/2010/10/fastest-csv-strings-splitting-using-clr-t-sql-vs-clr-revisited/</a></p>
<p>The function mentioned on the site uses a parameter for defining maximum internal buffer lengths (maximum length of single delimited string) but it&#8217;s very easy to update it to version which automatically adjusts the buffer if it&#8217;s length isn&#8217;t enough.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1218#respond' onclick='return addComment.moveForm( "div-comment-1218", "1218", "respond", "394" )' aria-label='Reply to Pavel Pawlowski'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback even thread-even depth-1" id="comment-609942">
				<div id="div-comment-609942" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.developsearch.com/index.php/archives/19266.html' rel='external nofollow' class='url'>SQLSERVER2008中CTE的Split与CLR的性能比较 &#124; DevelopSearch</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-609942">
			April 18, 2014 at 11:32 pm</a>		</div>

		<p>[&#8230;] 您还可以参考：Split string in SQL Server 2005+ CLR vs. T-SQLAuthor:Petter Liu [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=609942#respond' onclick='return addComment.moveForm( "div-comment-609942", "609942", "respond", "394" )' aria-label='Reply to SQLSERVER2008中CTE的Split与CLR的性能比较 &#124; DevelopSearch'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-1376382">
				<div id="div-comment-1376382" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://staging-blog.idera.com/sql-server/performance-and-monitoring/comparing-simple-efficiencies-t-sql-udf-vs-sqclr-udf-for-splitting-strings/' rel='external nofollow' class='url'>Comparing Simple Efficiencies: T-SQL UDF vs SQCLR UDF for Splitting Strings</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-1376382">
			July 14, 2014 at 7:45 am</a>		</div>

		<p>[&#8230;] Adam Machanic. Faster, More Scalable String Splitting. MSDN. Using CLR Integration in SQL Server 2005 MSDN. Regular Expressions Make Pattern Matching And Data Extraction Easier Simple-Talk. CLR Assembly RegEx Functions for SQL Server by Example SQLSkills White Paper. SQL Server DBA Guide to the SQLCLR StackOverflow Forum Question. Are CLR stored procedures preferred over TSQL stored procedures in SQL 2005+ ? StackOverflow Forum Question. Microsoft SQL Equivalent of MySQL REGEXP Ted Kreuger. Split String in SQL Server 2005+ CLR vs T-SQL [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=1376382#respond' onclick='return addComment.moveForm( "div-comment-1376382", "1376382", "respond", "394" )' aria-label='Reply to Comparing Simple Efficiencies: T-SQL UDF vs SQCLR UDF for Splitting Strings'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-5554461">
				<div id="div-comment-5554461" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/db42f912020d532cfa92214e3e8569d6?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/db42f912020d532cfa92214e3e8569d6?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Paul DeBrino</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#comment-5554461">
			March 9, 2017 at 9:33 pm</a>		</div>

		<p>While working on an interface between Pitney Bowes shipping system APIs and legacy data stored in Microsoft SQL Server, I needed a simple way to parse a delimited string. I knew how to accomplish this in Visual Basic but, after searching the internet, did not find a clean and simple approach using SQL stored procedures. I decided to write my own user-defined function which performed the duty with little effort. You are welcome to incorporate the solution into your own projects.</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</p>
<p>/*<br />
Short Description:<br />
A user-defined parsing function that enables SQL Server that also performs similarly to the VB &#8220;Split&#8221; function.</p>
<p>Parameters:<br />
1. String  : Value to parse, based on the specified delimiter. Limit 2000 characters (you may alter size limit as needed).<br />
2. String  : Delimiter value.  Single character value.<br />
3. Integer : Section To Return.  0 returns all sections as a table, otherwise specify the parsed section number you wish returned as nvarchar.<br />
4. String  : Section Data to Find.  Pass a zero-length string when not applicable. Section To Return defaults to 0 when using this feature.</p>
<p>Returns:<br />
Table with one row per each parsed section:<br />
    String : SectionData<br />
    Identity : ID (useful when Section To Return parameter is 0 and you want to know the section number for each parsed value)</p>
<p>General Usage:<br />
select * from splitstring_V2(&#8216;ABC-123-DEF-789-Z&#8217;, &#8216;-&#8216;, 0, &#8221;)<br />
&gt;&gt; results in 5 rows &#8212; 1 per each section parsed &#8212; Use cursor or other method to process results.</p>
<p>select * from splitstring_V2(&#8216;ABC-123-DEF-789-Z&#8217;, &#8216;-&#8216;, 0, &#8216;DEF&#8217;)<br />
&gt;&gt; results in 1 row: DEF, 3</p>
<p>select * from splitstring_V2(&#8216;ABC-123-DEF-789-Z&#8217;, &#8216;-&#8216;, 4, &#8221;)<br />
&gt;&gt; results in 1 row: 789, 4</p>
<p>select * from splitstring_V2(&#8216;ABC-123-DEF-789-S01&#8217;, &#8216;-S&#8217;, 0, &#8221;)<br />
&gt;&gt; results in 2 rows: ABC-123-DEF-789, 1  and  S01, 2 &#8212; Use cursor or other method to process results.</p>
<p>select * from splitstring_V2(&#8216;ABC-123-DEF-789-S01&#8217;, &#8216;-S&#8217;, 0, &#8221;) where sectionnumber=2<br />
&gt;&gt; results in 1 row: S01, 2</p>
<p>Usage to load result into a variable:<br />
select yourvariable = sectiondata from generic_use..splitstring(&#8216;ABC-123-DEF-789-Z&#8217;, &#8216;-&#8216;, 1, &#8221;)</p>
<p>Author: Paul DeBrino .:. InfinityRD.com .:. (C) Oct 2007<br />
Please retain the author, copyright and notes, if you adopt this user-defined function.</p>
<p>Long Description: While working on an interface between Pitney Bowes shipping system APIs and legacy data stored in Microsoft SQL Server, I needed a simple way to parse a delimited string. I knew how to accomplish this in Visual Basic but, after searching the internet, did not find a clean and simple approach using SQL stored procedures. I decided to write my own user-defined function which performed the duty with little effort. You are welcome to incorporate the solution into your own projects.<br />
*/</p>
<p>ALTER FUNCTION [dbo].[SplitString_V2]<br />
(<br />
    @p_StringToParse as nvarchar(2000),<br />
    @p_Delimiter as varchar(5),<br />
    @p_SectionToReturn as int,<br />
    @p_SectionDataToSearchFor as varchar(2000)<br />
)<br />
RETURNS @v_Results TABLE<br />
(<br />
    SectionData nvarchar(2000),<br />
    SectionNumber int<br />
)<br />
AS<br />
BEGIN</p>
<p>    declare @v_Index int, @v_Section int, @v_Slice nvarchar(2000), @v_SectionDataToSearchForFound bit<br />
    set @v_Index = 1<br />
    set @v_Section = 1<br />
    set @v_SectionDataToSearchForFound = 0</p>
<p>    &#8212; Monitor for incorrect use of parameters: SectionToReturn must be 0 when specifying SectionDataToSearchFor:<br />
    If ((isnull(@p_SectionDataToSearchFor,&#8221;) &gt; &#8221;) and (@p_SectionToReturn  0))<br />
        Set @p_SectionToReturn = 0</p>
<p>    If @p_StringToParse is null RETURN</p>
<p>	WHILE @v_Index !=0<br />
	BEGIN<br />
		&#8212; GET THE INDEX OF THE FIRST OCCURENCE OF THE DELIMITER:<br />
		SELECT @v_Index = CHARINDEX(@p_Delimiter,@p_StringToParse)</p>
<p>		&#8212; CAPTURE THE SECTION TO THE LEFT OF DELIMITER INTO THE SLICE VARIABLE:<br />
		IF @v_Index !=0<br />
			SELECT @v_Slice = LEFT(@p_StringToParse, @v_Index &#8211; 1)<br />
		ELSE<br />
			SELECT @v_Slice = @p_StringToParse</p>
<p>		&#8212; PLACE THE SLICE INTO THE RESULT:<br />
		IF @p_SectionToReturn = 0<br />
		BEGIN<br />
			IF ((isnull(@p_SectionDataToSearchFor,&#8221;) &gt; &#8221;) AND (@p_SectionDataToSearchFor = @v_Slice))<br />
			BEGIN<br />
				SET @v_SectionDataToSearchForFound = 1<br />
				INSERT INTO @v_Results(SectionData, SectionNumber) VALUES(@v_Slice, @v_Section)<br />
				BREAK<br />
			END<br />
			ELSE IF (isnull(@p_SectionDataToSearchFor,&#8221;) = &#8221;)<br />
				INSERT INTO @v_Results(SectionData, SectionNumber) VALUES(@v_Slice, @v_Section)<br />
		END<br />
		ELSE IF @v_Section = @p_SectionToReturn<br />
			BEGIN<br />
				INSERT INTO @v_Results(SectionData, SectionNumber) VALUES(@v_Slice, @v_Section)<br />
				BREAK<br />
		END</p>
<p>		&#8212; REMOVE THE CURRENT SECTION FROM THE STRING TO PARSE:<br />
		SELECT @p_StringToParse = RIGHT(@p_StringToParse, LEN(@p_StringToParse) &#8211; @v_Index)</p>
<p>		&#8212; BREAK IF NOTHING LEFT TO PARSE:<br />
		IF LEN(@p_StringToParse) = 0<br />
		BREAK</p>
<p>		SET @v_Section = @v_Section + 1<br />
	END</p>
<p>	IF ((isnull(@p_SectionDataToSearchFor,&#8221;) &gt; &#8221;) AND (@v_SectionDataToSearchForFound = 0))<br />
		Delete from @v_Results</p>
<p>	RETURN</p>
<p>END</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/?replytocom=5554461#respond' onclick='return addComment.moveForm( "div-comment-5554461", "5554461", "respond", "394" )' aria-label='Reply to Paul DeBrino'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/dbprogramming/split-string-in-sql-server-2005-clr-vs-t/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='394' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="1bb91f73e9d31ea2830a5e73ce3ed328"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765818"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
