<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   SQL Server Proper Case Function</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   SQL Server Proper Case Function" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="SQL Server (T-SQL specifically) is not usually the best place to write a function for modifying the case of your data. String functions are generally slow and often a bit cumbersome to implement.  That being said, it's not uncommon to have data in your&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; SQL Server Proper Case Function Comments Feed" href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Table sizes' href='/index.php/datamgmt/dbadmin/table-sizes/' />
<link rel='next' title='Calculating number of workdays between 2 dates' href='/index.php/datamgmt/dbprogramming/calculating-number-of-workdays-between-2/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/" />
<link rel='shortlink' href='/?p=710' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fsql-server-proper-case-function%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fsql-server-proper-case-function%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbprogramming/calculating-number-of-workdays-between-2/" rel="next">Calculating number of workdays between 2 dates</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/datamgmt/dbadmin/table-sizes/" rel="prev">Table sizes</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/" class="post-title">SQL Server Proper Case Function</a></h1>
					<div class="post-byline">by <a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)" rel="author">George Mastros (gmmastros)</a> on February 24, 2010 in category <a href="/index.php/category/datamgmt/dbprogramming/" rel="category tag">Database Programming</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 26,175 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&text=RT @LessThanDot Blog - SQL Server Proper Case Function by @gmmastros" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&title=SQL Server Proper Case Function&source=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&title=SQL Server Proper Case Function" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&quote=SQL Server Proper Case Function" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&title=SQL Server Proper Case Function" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>SQL Server (T-SQL specifically) is not usually the best place to write a function for modifying the case of your data. String functions are generally slow and often a bit cumbersome to implement.  That being said, it&#8217;s not uncommon to have data in your tables that needs to be &#8220;cleaned up a bit&#8221;.  In situations like this, it is acceptable to write and use a function like this.</p>
<p>With SQL, it is easy to convert strings to upper case or lower case, but what about making it mixed case/title case.  This functionality is useful in many different situations.  There are many examples on the internet that show how this can be done.  Some work better than others, and perform better than others.  The simplest versions of this will loop through a string, character by character, and capitalize anything following a space.  Unfortunately, this is not always adequate.</p>
<p>I have developed a method that actively seeks out any character that is not a letter.  Under certain circumstances, this is more appropriate because it satisfies more situations. This method also reduces the number of loops that need to be executed by using the PatIndex function and looking for non-alpha characters followed by lower case alpha characters.</p>
<p><strong>General theory:</strong></p>
<p>Like I stated earlier, this code actively seeks out data from within the string that needs to be changed.  The first thing we do is convert the string to lower case except for the first character, which is converted to upper case.  For example, suppose you have this:  THIS IS-ALL &#8220;Caps&#8221;</p>
<p>At the beginning of the function, we convert to lower case except for the first character, so it becomes:</p>
<p>This is-all &#8220;caps&#8221;</p>
<p>Next, we actively seek out positions where one character is non-alphabetic followed by a lower case alphabetic character.   In this case, we would return character position 5 (space followed by lower case i).  We then use the stuff function to convert this to upper case.  This would result in:</p>
<p>This Is-all &#8220;caps&#8221;</p>
<p>We then repeat this process until there are no more occurrences of non-alpha followed by lower case alpha characters.</p>
<p>This code uses several functions, some that you may not be familiar with.  Upper converts characters to upper case.  Lower converts characters to lower case.  SubString allows you to retrieve data from the middle of string.  The less common functions here are PatIndex and Stuff.</p>
<p>PatIndex searches through a string and returns the position where a search pattern is found.  In our case, we want to find a &#8220;non-alpha character followed by a lower case alpha character&#8221;.  By default, searches are not case sensitive.  This is actually controlled by the collation of your database.  You can get case sensitive searches by using a binary collation.  For this function, I use:</p>
<p>PatIndex(&#8216;%[^a-zA-Z][a-z]%&#8217;, @Data COLLATE Latin1_General_Bin)</p>
<p>The other function I use here is stuff.  Stuff can be used to insert text in to the middle of a string.  It can also be used similar to a Replace function.  With replace, you essentially replace all occurrences of one string with another.  Stuff is different in that you can replace data based on its position within a string without regard to what is at that position.   For example:</p>
<p>Select Stuff(&#8216;lower case&#8217;, 7, 1, &#8216;C&#8217;)</p>
<p>Notice how the 7th character (the lower case c) is replaced with an upper case C.</p>
<pre>Create Function dbo.Proper(@Data VarChar(8000))
Returns VarChar(8000)
As
Begin
  Declare @Position Int

  Select @Data = Stuff(Lower(@Data), 1, 1, Upper(Left(@Data, 1))),
         @Position = PatIndex('%[^a-zA-Z][a-z]%', @Data COLLATE Latin1_General_Bin)

  While @Position &gt; 0
    Select @Data = Stuff(@Data, @Position, 2, Upper(SubString(@Data, @Position, 2))),
           @Position = PatIndex('%[^a-zA-Z][a-z]%', @Data COLLATE Latin1_General_Bin)

  Return @Data
End</pre>
<p>In my opinion, there are several things that make this function better.  It will correctly capitalize all words and it minimizes the number of loops.  In fact, it will loop just once for each word that needs to be capitalized.</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/replace-your-case-when-then-else-syntax/'>Replace Your Case When Then Else Syntax With the Sign Function In SQL Server</a><p>If you want to show a 1 when there is a value for something in&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/concat-function-in-sql-server/'>Concat function in SQL Server Denali CTP3</a><p>SQL Server Denali CTP3 brings a couple of new functions, one of these is the&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>George has been developing software professionally for 19 years, first for the department of defense, and then for various other companies.  In 1998, George started his software company, Orbit Software, specializing in School Bus Transportation software.  His specialty is refining SQL Server queries to deliver optimal performance.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/gmmastros" title="gmmastros at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="/index.php/author/gmmastros/feed/" title="Blog RSS feed for gmmastros" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 26,175 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/gmmastros/">Read More Posts by George Mastros (gmmastros)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&text=RT @LessThanDot Blog - SQL Server Proper Case Function by @gmmastros" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&title=SQL Server Proper Case Function&source=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&title=SQL Server Proper Case Function" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&quote=SQL Server Proper Case Function" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/&title=SQL Server Proper Case Function" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		24 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-remou even thread-even depth-1" id="comment-2490">
				<div id="div-comment-2490" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">remou</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2490">
			February 24, 2010 at 8:53 am</a>		</div>

		<p>In British English, there are exceptions, &#8216;of&#8217; and &#8216;and&#8217;, for example, are not capitalized, and names get complicated (MacHenry, Machinery).</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2490#respond' onclick='return addComment.moveForm( "div-comment-2490", "2490", "respond", "710" )' aria-label='Reply to remou'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2491">
				<div id="div-comment-2491" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/244502d474a26d025df27523e5c57c54?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/244502d474a26d025df27523e5c57c54?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Brad Schulz</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2491">
			February 24, 2010 at 10:13 am</a>		</div>

		<p>Great stuff, George.</p>
<p>The one thing that I might add to your PATINDEX is the checking for an apostrophe&#8230; perhaps.</p>
<p>For example, take the word &#8220;can&#8217;t&#8221;&#8230; we wouldn&#8217;t want it to come out as &#8220;Can&#8217;T&#8221;.  However, if this function is truly used for properizing names, then we would certainly want it to convert &#8220;o&#8217;bryan&#8221; to &#8220;O&#8217;Bryan&#8221;&#8230; but then again we don&#8217;t want to end up with &#8220;Joe&#8217;S Fish Sauce Shop&#8221; either.</p>
<p>That darn apostrophe is a pain, isn&#8217;t it?</p>
<p>&#8211;Brad</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2491#respond' onclick='return addComment.moveForm( "div-comment-2491", "2491", "respond", "710" )' aria-label='Reply to Brad Schulz'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor even thread-even depth-1" id="comment-2492">
				<div id="div-comment-2492" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2492">
			February 24, 2010 at 11:25 am</a>		</div>

		<p>Thanks Brad.  I hadn&#8217;t thought of that.  We could (potentially) look for the apostrophe as the 2nd character in a string and capitalize the 3rd character (assuming the 3rd character is an alpha).  This would add some complication, but should be possible.</p>
<p>Remou&#8217;s situation is a bit more problematic.  We would almost have to have a hard coded list of names, which I really don&#8217;t like.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2492#respond' onclick='return addComment.moveForm( "div-comment-2492", "2492", "respond", "710" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis odd alt thread-odd thread-alt depth-1" id="comment-2494">
				<div id="div-comment-2494" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2494">
			February 24, 2010 at 12:51 pm</a>		</div>

		<p>Nice one George, I can see this being beneficial to a lot of people</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2494#respond' onclick='return addComment.moveForm( "div-comment-2494", "2494", "respond", "710" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2495">
				<div id="div-comment-2495" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/282a036d71f94151b01794844b19f6e7?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/282a036d71f94151b01794844b19f6e7?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.linkedin.com/in/jonmcrawford' rel='external nofollow' class='url'>jonmcrawford</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2495">
			February 25, 2010 at 8:05 am</a>		</div>

		<p>Or, if you have a Tally (Numbers) table handy, you can get rid of the loop:<br />
<a href="http://www.sqlservercentral.com/Forums/Topic530630-8-2.aspx" rel="nofollow">http://www.sqlservercentral.com/Forums/Topic530630-8-2.aspx</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2495#respond' onclick='return addComment.moveForm( "div-comment-2495", "2495", "respond", "710" )' aria-label='Reply to jonmcrawford'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2496">
				<div id="div-comment-2496" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a764dae4c785a856087b504acaacbbbc?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a764dae4c785a856087b504acaacbbbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">David Dye</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2496">
			February 26, 2010 at 5:34 am</a>		</div>

		<p>Awesome work!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2496#respond' onclick='return addComment.moveForm( "div-comment-2496", "2496", "respond", "710" )' aria-label='Reply to David Dye'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola even thread-even depth-1" id="comment-2497">
				<div id="div-comment-2497" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2497">
			February 28, 2010 at 6:32 am</a>		</div>

		<p>As we had discussion about most efficient fnSplitString function, what about idea of using that one, capitalize every row and concatenate again? I&#8217;m curious how efficient it would be. Another option is to use the same algorithm as in fnSplitString to decide where every word starts. I assume that after every punctuation mark there will be space, and at the moment I can&#8217;t find any exception apart from open brackets &#8211; but that does not mean there are no more exceptions.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2497#respond' onclick='return addComment.moveForm( "div-comment-2497", "2497", "respond", "710" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-2504">
				<div id="div-comment-2504" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2504">
			July 7, 2010 at 11:11 pm</a>		</div>

		<p>I&#8217;m guessing CLR function will beat this algorithm.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2504#respond' onclick='return addComment.moveForm( "div-comment-2504", "2504", "respond", "710" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2498">
				<div id="div-comment-2498" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jeff Moden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2498">
			September 25, 2010 at 7:42 pm</a>		</div>

		<p>Naomi is correct&#8230; SQLCLR will beat this algorithm&#8230; unless you have a DBA or Company that won&#8217;t allow it. 😉</p>
<p>I&#8217;m not sure why this article got such low marks.  You just have to appreciate the technical prowess behind using COLLATE to make this problem so much easier and performant than other folks attempts at the same thing.  I haven&#8217;t tested it, yet, but I believe it&#8217;ll probably beat even a Tally Table solution just because it&#8217;s such a bloody tight and effecient loop.</p>
<p>Nicely done, George.  Like I said&#8230; not sure why others didn&#8217;t appreciate this function just for its shear genius but I gave this a +5.  Thanks for sharing it.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2498#respond' onclick='return addComment.moveForm( "div-comment-2498", "2498", "respond", "710" )' aria-label='Reply to Jeff Moden'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2499">
				<div id="div-comment-2499" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jeff Moden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2499">
			September 25, 2010 at 9:13 pm</a>		</div>

		<p>Heh&#8230; did I mention I hated moderated forums especially ones that won&#8217;t let you edit your own bloody post until after it&#8217;s met approval?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2499#respond' onclick='return addComment.moveForm( "div-comment-2499", "2499", "respond", "710" )' aria-label='Reply to Jeff Moden'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2500">
				<div id="div-comment-2500" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jeff Moden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2500">
			September 26, 2010 at 6:33 pm</a>		</div>

		<p>Verified&#8230; it beats the Tally Table and smokes at least 1 &#8220;expert&#8221; idea of how to do this same thing in XML.  Sometimes memory-only RBAR isn&#8217;t RBAR at all &#8230;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2500#respond' onclick='return addComment.moveForm( "div-comment-2500", "2500", "respond", "710" )' aria-label='Reply to Jeff Moden'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-2503">
				<div id="div-comment-2503" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2503">
			September 27, 2010 at 6:11 am</a>		</div>

		<p>Jeff, thanks for performance testing this.</p>
<p>Please note that I did not make any claims that this method would be faster than any other.  I merely mention that this method reduces the number of loops.  Of course, it&#8217;s implied that reducing the loops will shorten the time, but I make no claims about that either.</p>
<p>I&#8217;m glad you liked this blog post and I appreciate your comments.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2503#respond' onclick='return addComment.moveForm( "div-comment-2503", "2503", "respond", "710" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2487">
				<div id="div-comment-2487" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jeff Moden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2487">
			December 1, 2010 at 8:13 pm</a>		</div>

		<p>Sorry for the late reply, George.</p>
<p>I know you didn&#8217;t make any claims as to performance.  I did and mostly because While Loops are typical low performers.  I just wanted folks to know that your good code didn&#8217;t fit in that category especially since this is a very commonly requested function.</p>
<p>I also suspect that a lot of people rated this article as &#8220;average&#8221; because they didn&#8217;t actually test the performance of the code.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2487#respond' onclick='return addComment.moveForm( "div-comment-2487", "2487", "respond", "710" )' aria-label='Reply to Jeff Moden'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2488">
				<div id="div-comment-2488" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/47b6bbf1e10c1ef59b540635c3feffb9?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/47b6bbf1e10c1ef59b540635c3feffb9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://sarahcarter69.blogspot.com/' rel='external nofollow' class='url'>Carrie</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2488">
			December 2, 2010 at 7:46 am</a>		</div>

		<p>I study IT at the high school and I just had my first SQL course. This was like a tutorial one, and what I see here, scares me a little. But I will print it and I&#8217;m sure that in the future will be very useful. When I wil start to..&#8221;speak the language&#8221; . 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2488#respond' onclick='return addComment.moveForm( "div-comment-2488", "2488", "respond", "710" )' aria-label='Reply to Carrie'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor even thread-even depth-1" id="comment-2489">
				<div id="div-comment-2489" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2489">
			December 2, 2010 at 8:11 am</a>		</div>

		<p>@Carrie,</p>
<p>As a beginner, you should realize that the functionality presented in this blog is not &#8216;normal&#8217;.  From a database perspective, this functionality should never be necessary because databases are, at a fundamental level, meant to store and retrieve data.</p>
<p>Unfortunately, database programmers are often required to clean up data, which is where this type of functionality becomes useful.  From a database purist perspective, the database should not be modifying your data, it should simply be storing it.</p>
<p>I wish you well in your studies.  My best advice to you is to realize that your learning will never be done.  I&#8217;ve been using Microsoft SQL Server for 10 years and I still find new things to learn.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2489#respond' onclick='return addComment.moveForm( "div-comment-2489", "2489", "respond", "710" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2493">
				<div id="div-comment-2493" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/ba4ef29e5bb37fecfcd6a26d159c4530?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/ba4ef29e5bb37fecfcd6a26d159c4530?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">pratyaharam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2493">
			December 3, 2010 at 11:03 am</a>		</div>

		<p>I tried many methods and attempted many different approaches and I could not beat George&#8217;s. So Hats off to you George 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2493#respond' onclick='return addComment.moveForm( "div-comment-2493", "2493", "respond", "710" )' aria-label='Reply to pratyaharam'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2501">
				<div id="div-comment-2501" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f18faf198045720cf7b2ae4c645630d9?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f18faf198045720cf7b2ae4c645630d9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://sarahcarter69.blogspot.com/' rel='external nofollow' class='url'>Carrie</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2501">
			January 19, 2011 at 3:08 am</a>		</div>

		<p>Thank you very much George for your support and for encouraging me. I&#8217;m sure that I&#8217;ll always have something new to learn. It&#8217;s a little harder at the beginning but it&#8217;s so interesting and useful! It worths the effort. So I&#8217;ll try to do my best! Thank you again!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2501#respond' onclick='return addComment.moveForm( "div-comment-2501", "2501", "respond", "710" )' aria-label='Reply to Carrie'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2506">
				<div id="div-comment-2506" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f58723b752991665a7d132f3c6df9779?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f58723b752991665a7d132f3c6df9779?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Viviane Rosa</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2506">
			January 31, 2011 at 1:33 pm</a>		</div>

		<p>Thank you very much, for my case i use a data warehouse so performance is not a issue, i just wanted something simple and i&#8217;ve got it. About Joe&#8217;s or O&#8217;Bryan, it is minimum, it is really good to transform capital texts which are hard to read.</p>
<p>How they say here in New Zealand, Cher.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2506#respond' onclick='return addComment.moveForm( "div-comment-2506", "2506", "respond", "710" )' aria-label='Reply to Viviane Rosa'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2485">
				<div id="div-comment-2485" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e78b3a5a48d48ece1290dfbb3fb4793e?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e78b3a5a48d48ece1290dfbb3fb4793e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.hornypharaoh.com/' rel='external nofollow' class='url'>Sandra</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2485">
			March 16, 2011 at 9:19 am</a>		</div>

		<p>You really are an SQL guru! Thank you so much for all this. Your tutorial helped me a lot!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2485#respond' onclick='return addComment.moveForm( "div-comment-2485", "2485", "respond", "710" )' aria-label='Reply to Sandra'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-2486">
				<div id="div-comment-2486" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2486">
			October 7, 2011 at 1:30 pm</a>		</div>

		<p>I wish Denali has Proper function because using scalar function will slow down the performance.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2486#respond' onclick='return addComment.moveForm( "div-comment-2486", "2486", "respond", "710" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-even depth-1" id="comment-2505">
				<div id="div-comment-2505" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2505">
			December 22, 2011 at 2:21 pm</a>		</div>

		<p>Wondering if you ever adjusted this function to handle cases with O&#8217; and MacDonald /McNut ?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2505#respond' onclick='return addComment.moveForm( "div-comment-2505", "2505", "respond", "710" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2502">
				<div id="div-comment-2502" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1ee7a4e8710738d531220f5ffe6916b4?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1ee7a4e8710738d531220f5ffe6916b4?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Philippe De Ridder</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-2502">
			June 20, 2013 at 12:48 pm</a>		</div>

		<p>Very efficient&#8230; if you don&#8217;t have special international characters: BÖLL becomes BÖLl while it should be Böll 🙁<br />
I have tried to use another case-sensitive collation like SQL_Latin1_General_CP1_CS_AS (SQL_Latin1_General_CP1_CI_AI is my default), but the performance is terrible beyond 20 rows.<br />
Any idea how to tackle this ?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=2502#respond' onclick='return addComment.moveForm( "div-comment-2502", "2502", "respond", "710" )' aria-label='Reply to Philippe De Ridder'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-613637">
				<div id="div-comment-613637" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jeff Moden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-613637">
			April 19, 2014 at 11:11 am</a>		</div>

		<p>Hi George,</p>
<p>I was doing some research for something else and I came across this fine article of yours once again.  I know I&#8217;ve already commented on it but I just wanted to say thanks again.</p>
<p>I also wanted people to know that sometimes the way UDFs are tested make all the difference in the world.  If you&#8217;re testing an iTVF (Inline Table Valued Function), then there&#8217;s no problem with using SET STATISTICS IO, TIME ON.  If you&#8217;re testing an sF (Scalar Function) or an mTVF (Multi-statement Table Valued Function), the simple act of turning SET STATISTICS to ON changes things a whole lot and makes the functions look like they perform a lot worse than they really do.  I&#8217;m not suggesting for a minute that sF&#8217;s and mTVF&#8217;s are ok in every case but, in the words of a much wiser man, &#8220;If you measure it, you change it&#8221;. </p>
<p>With that in mind, here&#8217;s an article on how to properly test sF&#8217;s and mTVF&#8217;s and it includes a method (if you can write it as a single query) to create an &#8220;iSF&#8221; (Inline Scalar Function) that some folks might not be aware of.</p>
<p><a href="http://www.sqlservercentral.com/articles/T-SQL/91724/" title="How to Make Scalar UDFs Run Faster (SQL Spackle)"> </p>
<p>Thanks again for all that you do, George.  You&#8217;re truly one of the &#8220;good guys&#8221; in this business.</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=613637#respond' onclick='return addComment.moveForm( "div-comment-613637", "613637", "respond", "710" )' aria-label='Reply to Jeff Moden'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-613643">
				<div id="div-comment-613643" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c57695082083e0656b1e712ec260755c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jeff Moden</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#comment-613643">
			April 19, 2014 at 11:13 am</a>		</div>

		<p>Heh&#8230; sorry.  I&#8217;m not used to the tags on this forum.  Here&#8217;s the link I was referring to above&#8230;</p>
<p><a href="http://www.sqlservercentral.com/articles/T-SQL/91724/" rel="nofollow">http://www.sqlservercentral.com/articles/T-SQL/91724/</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/?replytocom=613643#respond' onclick='return addComment.moveForm( "div-comment-613643", "613643", "respond", "710" )' aria-label='Reply to Jeff Moden'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/dbprogramming/sql-server-proper-case-function/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='710' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="55b37c5c270e5d84c793e486d798c01d"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765983"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
