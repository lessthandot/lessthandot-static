<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="In order to figure out if you need more memory for a SQL Server you can start by taking a look at Buffer cache hit ratio and Page life expectancy. Buffer cache hit ratio Here is what Books On Line has to say about Buffer cache hit ratio Buffer cache hit ratio Percentage of pages [&hellip;]" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters Comments Feed" href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Goals for 2010 (and Beyond!)' href='/index.php/itprofessionals/ethicsit/goals-for-2010-and-beyond/' />
<link rel='next' title='Backup and copy warm-standby (log shipped) databases in SQL Server' href='/index.php/datamgmt/datadesign/backup-and-copy-warm-standby-log-shipped/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/" />
<link rel='shortlink' href='/?p=686' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fuse-sys-dm_os_performance_counters-to-ge%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fuse-sys-dm_os_performance_counters-to-ge%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/datadesign/backup-and-copy-warm-standby-log-shipped/" rel="next">Backup and copy warm-standby (log shipped) databases in SQL Server</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/itprofessionals/ethicsit/goals-for-2010-and-beyond/" rel="prev">Goals for 2010 (and Beyond!)</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/" class="post-title">Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters</a></h1>
					<div class="post-byline">by <a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis" rel="author">SQLDenis</a> on January 22, 2010 in category <a href="/index.php/category/datamgmt/dbadmin/" rel="category tag">Database Administration</a> <a href="/index.php/category/datamgmt/dbprogramming/" rel="category tag">Database Programming</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a> <a href="/index.php/category/datamgmt/dbadmin/mssqlserveradmin/" rel="category tag">Microsoft SQL Server Admin</a>. Article views: 178,719 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&text=RT @LessThanDot Blog - Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and P... by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&title=Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters&source=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&title=Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&quote=Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&title=Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>In order to figure out if you need more memory for a SQL Server you can start by taking a look at Buffer cache hit ratio and Page life expectancy.</p>
<h2>Buffer cache hit ratio</h2>
<p>Here is what Books On Line has to say about Buffer cache hit ratio<br />
<em>Buffer cache hit ratio<br />
Percentage of pages found in the buffer cache without having to read from disk. The ratio is the total number of cache hits divided by the total number of cache lookups over the last few thousand page accesses. After a long period of time, the ratio moves very little. Because reading from the cache is much less expensive than reading from disk, you want this ratio to be high. Generally, you can increase the buffer cache hit ratio by increasing the amount of memory available to SQL Server.<br />
</em></p>
<p>Basically what this means is what is the percentage that SQL Server had the data in cache and did not have to read the data from disk. Ideally you want this number to be as close to 100 as possible.</p>
<p>In order to calculate the Buffer cache hit ratio we need to query the sys.dm_os_performance_counters dynamic management view. There are 2 counters we need in order to do our calculation, one counter is Buffer cache hit ratio and the other counter is Buffer cache hit ratio base. We divide <em>Buffer cache hit ratio</em> base by <em>Buffer cache hit ratio</em> and it will give us the Buffer cache hit ratio.<br />
Here is the query that will do that, this query will only work on SQL Server 2005 and up.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="br0">&#40;</span>a.<span class="me1">cntr_value</span> <span class="sy0">*</span> <span class="nu0">1.0</span> <span class="sy0">/</span> b.<span class="me1">cntr_value</span><span class="br0">&#41;</span> <span class="sy0">*</span> <span class="nu0">100.0</span> <span class="kw1">as</span> BufferCacheHitRatio
<span class="kw1">FROM</span> sys.<span class="me1">dm_os_performance_counters</span> &nbsp;a
<span class="sy0">JOIN</span> &nbsp;<span class="br0">&#40;</span><span class="kw1">SELECT</span> cntr_value,<span class="kw2">OBJECT_NAME</span> 
&nbsp; &nbsp; <span class="kw1">FROM</span> sys.<span class="me1">dm_os_performance_counters</span> &nbsp;
&nbsp; &nbsp; <span class="kw1">WHERE</span> counter_name <span class="sy0">=</span> <span class="st0">'Buffer cache hit ratio base'</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">AND</span> <span class="kw2">OBJECT_NAME</span> <span class="sy0">=</span> <span class="st0">'SQLServer:Buffer Manager'</span><span class="br0">&#41;</span> b <span class="kw1">ON</span> &nbsp;a.<span class="kw2">OBJECT_NAME</span> <span class="sy0">=</span> b.<span class="kw2">OBJECT_NAME</span>
<span class="kw1">WHERE</span> a.<span class="me1">counter_name</span> <span class="sy0">=</span> <span class="st0">'Buffer cache hit ratio'</span>
<span class="sy0">AND</span> a.<span class="kw2">OBJECT_NAME</span> <span class="sy0">=</span> <span class="st0">'SQLServer:Buffer Manager'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT (a.cntr_value * 1.0 / b.cntr_value) * 100.0 as BufferCacheHitRatio
FROM sys.dm_os_performance_counters  a
JOIN  (SELECT cntr_value,OBJECT_NAME 
	FROM sys.dm_os_performance_counters  
  	WHERE counter_name = 'Buffer cache hit ratio base'
        AND OBJECT_NAME = 'SQLServer:Buffer Manager') b ON  a.OBJECT_NAME = b.OBJECT_NAME
WHERE a.counter_name = 'Buffer cache hit ratio'
AND a.OBJECT_NAME = 'SQLServer:Buffer Manager'</pre></div></div>

<h2 id="PLE">Page life expectancy</h2>
<p>Now let&#8217;s look at Page life expectancy.<br />
Page life expectancy is the number of seconds a page will stay in the buffer pool, ideally it should be above 300 seconds. If it is less than 300 seconds this could indicate memory pressure, a cache flush or missing indexes.</p>
<p>Here is how to get the Page life expectancy</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="sy0">*</span>
<span class="kw1">FROM</span> sys.<span class="me1">dm_os_performance_counters</span> &nbsp;
<span class="kw1">WHERE</span> counter_name <span class="sy0">=</span> <span class="st0">'Page life expectancy'</span>
<span class="sy0">AND</span> <span class="kw2">OBJECT_NAME</span> <span class="sy0">=</span> <span class="st0">'SQLServer:Buffer Manager'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT *
FROM sys.dm_os_performance_counters  
WHERE counter_name = 'Page life expectancy'
AND OBJECT_NAME = 'SQLServer:Buffer Manager'</pre></div></div>

<p>What I currently get for the queries is a Page life expectancy of 470333 and the Buffer cache hit ratio is 100.<strong> What I would like you to do is run these 2 queries on your systems and leave me the results in a comment so that we can compare</strong></p>
<p>Also take a look at how to capture this info if you prefer to run perfmon (or if you are still running SQL Server 2000) by reading this excellent article by Brent Ozar here: <a href="http://www.brentozar.com/archive/2006/12/dba-101-using-perfmon-for-sql-performance-tuning/">SQL Server Perfmon (Performance Monitor) Best Practices</a></p>
<p>*** <strong>Remember, if you have a SQL related question try our <a href="http://forum.lessthandot.com/viewforum.php?f=17">Microsoft SQL Server Programming</a> forum or our <a href="http://forum.lessthandot.com/viewforum.php?f=22">Microsoft SQL Server Admin</a> forum</strong><ins></ins></p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/the-sql-server-memory-leak-confusion/'>The SQL Server Memory Leak Confusion</a><p>Not too many moons ago when I started out with SQL Server I was convinced&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbadmin/sql-server-database-owner-unknown/'>SQL Server Database owner ~~UNKNOWN~~</a><p>Today I was checking an older server and decided to run sp_helpdb. On a bunch&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2><img class="bioPic" src="http://www.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d.png" alt="User bio image"/>Denis has been working with SQL Server since version 6.5. Although he worked as an ASP/JSP/ColdFusion developer before the dot com bust, he has been working exclusively as a database developer/architect since 2002. In addition to English, Denis is also fluent in Croatian and Dutch, but he can curse in many other languages and dialects (just ask the SQL optimizer) He lives in Princeton, NJ with his wife and three kids.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/denisgobo" title="SQLDenis at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/denis.gobo" title="SQLDenis at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/in/denisgobo" title="SQLDenis at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://denisgobo.blogspot.com/" title="SQLDenis at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="http://www.flickr.com/photos/denisgobo//" title="SQLDenis at Flickr" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_flickr.png" alt="Flickr" /></a><a href="/index.php/author/SQLDenis/feed/" title="Blog RSS feed for SQLDenis" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 178,719 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/SQLDenis/">Read More Posts by SQLDenis</a>
						</div>
					</div>
					<div>
						<label>Tags:</label> <a href="/index.php/tag/dmv/" rel="tag">dmv</a>, <a href="/index.php/tag/performance/" rel="tag">performance</a>, <a href="/index.php/tag/sql-server-2000/" rel="tag">sql server 2000</a>, <a href="/index.php/tag/sql-server-2005/" rel="tag">sql server 2005</a>, <a href="/index.php/tag/sql-server-2008/" rel="tag">sql server 2008</a> 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&text=RT @LessThanDot Blog - Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and P... by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&title=Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters&source=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&title=Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&quote=Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/&title=Use sys.dm_os_performance_counters to get your Buffer cache hit ratio and Page life expectancy counters" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		14 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-onpnt even thread-even depth-1" id="comment-2393">
				<div id="div-comment-2393" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2393">
			January 22, 2010 at 8:26 am</a>		</div>

		<p>Nice Denis!  Detailed and to the point on the two topics and what to check into as a starting point.</p>
<p>Others can get an idea of difference between SQL Server configurations and setups from a few runs on my own instances<br />
OLTP <br />
1.557336 and 99.535<br />
2.26879 and 99.859<br />
3.91764 and 99.863 &#8212; this server obviously has the lowest work going on<br />
4.19682 and 99.854 &#8212; largest db server I have. around 1K tran per sec and TB total DBs</p>
<p>
OLAP <br />
1.91764 and 99.863 <br />
2.23959 and 97.878 &#8212; 14 users running reports at this time<br />
3.20147 and 95.877 &#8212; caught it while processing a cube</p>
<p>Job Server <br />
1.3307429 and 100.000 &#8212; this is due to handling the job functions correctly and managing resources right. This is also the entire reason you should have a job server to prevent poor paging on the main prod servers</p>
<p>Dedicated Mirror &#8212; this one is expected to be lower on page<br />
1.20367 and 99.82</p>
<p>DR Log Shipped Warm &#8212; this will always be the lowest page life due to log copy events<br />
1.16421 and 99.865</p>
<p>
And others have also posted  <a href="http://forum.lessthandot.com/viewtopic.php?f=22&amp;t=9542">here</a></p>
<p>It would be nice to see other readers of this post their own results sense installation to installation is so unique in many cases</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2393#respond' onclick='return addComment.moveForm( "div-comment-2393", "2393", "respond", "686" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-2394">
				<div id="div-comment-2394" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2394">
			January 22, 2010 at 8:28 am</a>		</div>

		<p>Show me your numbers man..I don&#8217;t expect anything less than 99.5% Buffer cache hit ratio from you  🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2394#respond' onclick='return addComment.moveForm( "div-comment-2394", "2394", "respond", "686" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt even thread-even depth-1" id="comment-2395">
				<div id="div-comment-2395" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2395">
			January 22, 2010 at 8:32 am</a>		</div>

		<p>>>99.5% Buffer cache hit ratio </p>
<p>You won&#8217;t get that from me on a typical OLTP instance but there are times it isn&#8217;t a bad thing when it drops into the 95 to 97 range 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2395#respond' onclick='return addComment.moveForm( "div-comment-2395", "2395", "respond", "686" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcuse odd alt thread-odd thread-alt depth-1" id="comment-2396">
				<div id="div-comment-2396" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5e8bfdc77e52098a1ab2ddd1cd2a176f?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5e8bfdc77e52098a1ab2ddd1cd2a176f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Alex Ullrich</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2396">
			January 22, 2010 at 9:50 am</a>		</div>

		<p>Ted, I think that your breakdown there (with a bit more discussion on the differences observed between install types / reasons) would make a pretty good follow-up post of its&#8217; own.  </p>
<p>Of course you would need to add some pictures though 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2396#respond' onclick='return addComment.moveForm( "div-comment-2396", "2396", "respond", "686" )' aria-label='Reply to Alex Ullrich'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2389">
				<div id="div-comment-2389" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a1ab6753cdf483be6e60b9d91844bd35?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a1ab6753cdf483be6e60b9d91844bd35?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Rousseau Arulsamy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2389">
			March 23, 2010 at 3:34 am</a>		</div>

		<p>Hi,</p>
<p>This is very helpful. Here we are only getting the counters related to the SQL instance.I have a new requirement, i need to retrive some system related/custom counters and should display in my application. As my application is fully configurable module i would like to do the same like the previous approach so that i no need to touch my application for this.</p>
<p>Is there any way to get system related/custom counter details other then SQL Server counters from system views?</p>
<p>Please guide me on this.</p>
<p>Regards,<br />
Rousseau Arulsamy</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2389#respond' onclick='return addComment.moveForm( "div-comment-2389", "2389", "respond", "686" )' aria-label='Reply to Rousseau Arulsamy'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-thirster42 odd alt thread-odd thread-alt depth-1" id="comment-2391">
				<div id="div-comment-2391" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/026f3abfbd6ac89b6dbabbd4cef2e83d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/026f3abfbd6ac89b6dbabbd4cef2e83d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">David Forck (thirster42)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2391">
			October 19, 2011 at 7:07 am</a>		</div>

		<p>From some of the more recent stuff I&#8217;ve been reading there&#8217;s been a move away from relying on buffer cache hit ratio.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2391#respond' onclick='return addComment.moveForm( "div-comment-2391", "2391", "respond", "686" )' aria-label='Reply to David Forck (thirster42)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-2390">
				<div id="div-comment-2390" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/b79ab798ac0451da9992824023ea538a?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/b79ab798ac0451da9992824023ea538a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Crazy Adam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2390">
			February 13, 2013 at 7:26 am</a>		</div>

		<p>Loved the article. I wanted to share a variation on each query:</p>
<p>SELECT base.cntr_value * 1.0 / rat.cntr_value * 100.0 AS [Buffer Cache Hit Ratio]<br />
, base.cntr_value AS [Buffer cache hit ratio base]<br />
, rat.cntr_value AS [Buffer cache hit ratio]<br />
FROM sys.dm_os_performance_counters base CROSS JOIN sys.dm_os_performance_counters rat<br />
WHERE base.counter_name = &#8216;Buffer cache hit ratio base&#8217;<br />
AND rat.counter_name = &#8216;Buffer cache hit ratio&#8217;<br />
GO</p>
<p>SELECT counter_name<br />
, cntr_value AS [PLE in sec]<br />
, cntr_value / 60 AS [PLE in min]<br />
FROM sys.dm_os_performance_counters  <br />
WHERE counter_name = &#8216;Page life expectancy&#8217;<br />
AND OBJECT_NAME LIKE &#8216;%:Buffer Manager%&#8217;<br />
GO</p>
<p>The changes are pretty intuitive.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2390#respond' onclick='return addComment.moveForm( "div-comment-2390", "2390", "respond", "686" )' aria-label='Reply to Crazy Adam'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2392">
				<div id="div-comment-2392" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/6f52fcd3b9bbc41c224a55d83fe4c8eb?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/6f52fcd3b9bbc41c224a55d83fe4c8eb?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">mdh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2392">
			July 18, 2013 at 1:11 am</a>		</div>

		<p>Thanks for your article</p>
<p>On an OLTP App PLE is 8200 s and Buffer cache hit ratio is 100 with 620 free page</p>
<p>I think it&#8217;s not bad.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2392#respond' onclick='return addComment.moveForm( "div-comment-2392", "2392", "respond", "686" )' aria-label='Reply to mdh'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1187594">
				<div id="div-comment-1187594" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5bf91838b150bf6ee2dfa99abb300700?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5bf91838b150bf6ee2dfa99abb300700?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Robert Carnegie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-1187594">
			June 18, 2014 at 6:01 am</a>		</div>

		<p>A paper on &#8220;SQL Server 2005 Waits and Queues&#8221; indicates that this can be considered a database design issue.  In particular, if your server&#8217;s role is OLTP &#8211; many small data transactions representing the ongoing running of your business &#8211; the working data should be mostly in cache.  If it isn&#8217;t, that implies that some process that reads a lot of data has taken up a lot of the cache space.  This doesn&#8217;t tell you what the process was, but it may be something that should be redesigned, for instance by adding an index for a query to use instead of a table scan.  Or it may be an occasional hazard that you have to live with, such as running the CEO&#8217;s daily report.</p>
<p>Evidently the cache hit ratio reflects the latest activity on the server but not a cumulative figure since the last restart &#8211; I hope I&#8217;ve got that right.  Bad performance is said to be if the ratio goes below 90% for more than a minute for an OLTP system.  Or, if your users are complaining.  </p>
<p>My impression is that your verbal statement of &#8220;divide Buffer cache hit ratio base by Buffer cache hit ratio&#8221; is back-to-front while your script is correct (thanks for saving me from writing it &#8211; not that I couldn&#8217;t), but this may be an English language issue between us.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=1187594#respond' onclick='return addComment.moveForm( "div-comment-1187594", "1187594", "respond", "686" )' aria-label='Reply to Robert Carnegie'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-2322383">
				<div id="div-comment-2322383" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0697eb79b751dc711dc813ae2fc086e1?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0697eb79b751dc711dc813ae2fc086e1?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">jeff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-2322383">
			October 28, 2014 at 2:13 pm</a>		</div>

		<p>I do the following to get breakdown by database etc </p>
<blockquote><p>
select cast(A.cntr_value * 1.0 /B.cntr_value * 100 as numeric(10,2)) as CHR, A.cntr_value, B.cntr_value, A.counter_name, B.counter_name, A.instance_name, A.object_name FROM sys.dm_os_performance_counters A<br />
join sys.dm_os_performance_counters B<br />
on A.instance_name = B.instance_name AND A.counter_name = &#8216;Cache Hit Ratio&#8217; and B.counter_name = &#8216;Cache Hit Ratio Base&#8217;<br />
and a.object_name = b.object_name<br />
&#8211;order by a.instance_name<br />
order by CHR DESC
</p></blockquote>
<p>Cheers</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=2322383#respond' onclick='return addComment.moveForm( "div-comment-2322383", "2322383", "respond", "686" )' aria-label='Reply to jeff'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback even thread-even depth-1" id="comment-3408953">
				<div id="div-comment-3408953" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://dluat.com/what-does-a-buffer-cache-hit-ratio-of-9990-mean/' rel='external nofollow' class='url'>What does a &quot;Buffer cache hit ratio&quot; of 9990 mean? | DL-UAT</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-3408953">
			January 7, 2015 at 10:57 pm</a>		</div>

		<p>[&#8230;] the below query (from Less Than Dot), which should give you the % you&#8217;re looking [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=3408953#respond' onclick='return addComment.moveForm( "div-comment-3408953", "3408953", "respond", "686" )' aria-label='Reply to What does a &quot;Buffer cache hit ratio&quot; of 9990 mean? | DL-UAT'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-3931607">
				<div id="div-comment-3931607" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/849786de471a8c4a18d3e2d9627bc6d7?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/849786de471a8c4a18d3e2d9627bc6d7?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Lucian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-3931607">
			March 10, 2015 at 10:22 am</a>		</div>

		<p>An interesting debate here:<br />
<a href="https://www.simple-talk.com/sql/database-administration/great-sql-server-debates-buffer-cache-hit-ratio/" rel="nofollow">https://www.simple-talk.com/sql/database-administration/great-sql-server-debates-buffer-cache-hit-ratio/</a></p>
<p>Seems these counters does not provide enough in isolation</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=3931607#respond' onclick='return addComment.moveForm( "div-comment-3931607", "3931607", "respond", "686" )' aria-label='Reply to Lucian'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback even thread-even depth-1" id="comment-4752495">
				<div id="div-comment-4752495" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://fault.itsprite.com/what-daily-checklist-items-are-there-for-coldfusion-iis7-sql-server-administrators/' rel='external nofollow' class='url'>What daily checklist items are there for coldfusion, iis7, sql server administrators? &#8211; segmentfault</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-4752495">
			November 8, 2015 at 11:36 am</a>		</div>

		<p>[&#8230;] buffer cache hit ratio and page life expectancy [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=4752495#respond' onclick='return addComment.moveForm( "div-comment-4752495", "4752495", "respond", "686" )' aria-label='Reply to What daily checklist items are there for coldfusion, iis7, sql server administrators? &#8211; segmentfault'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-5216239">
				<div id="div-comment-5216239" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/570125e28a4511c1fcc505b6914561bb?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/570125e28a4511c1fcc505b6914561bb?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">pravin</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#comment-5216239">
			August 29, 2016 at 12:49 pm</a>		</div>

		<p>Buffer cache hit ratio is 100 % &amp; PLE is 49339	65792; what this suggests?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/?replytocom=5216239#respond' onclick='return addComment.moveForm( "div-comment-5216239", "5216239", "respond", "686" )' aria-label='Reply to pravin'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/dbprogramming/use-sys-dm_os_performance_counters-to-ge/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='686' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="109a0ca3bc27f3e96597370d5c8cf03d"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765634"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
