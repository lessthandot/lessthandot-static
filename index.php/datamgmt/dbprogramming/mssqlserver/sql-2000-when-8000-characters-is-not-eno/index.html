<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   SQL Server: When 8000 Characters Is Not Enough</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   SQL Server: When 8000 Characters Is Not Enough" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="MS SQL Server 2000 has a limitation of 8000 characters in a varchar variable. The historical reason for this limitation, I believe, is related to the 8k size of data pages, where in-row data can't exceed something like 8060 bytes (actual numbers vary a&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; SQL Server: When 8000 Characters Is Not Enough Comments Feed" href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Simple advice for choosing an ESB' href='/index.php/architect/enterprisearchitecture/simple-advice-for-choosing-an-esb/' />
<link rel='next' title='SQL Server 2008 sp1 Download' href='/index.php/datamgmt/dbadmin/mssqlserveradmin/sql-server-2008-sp1-download/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/" />
<link rel='shortlink' href='/?p=375' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fmssqlserver%2Fsql-2000-when-8000-characters-is-not-eno%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fmssqlserver%2Fsql-2000-when-8000-characters-is-not-eno%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbadmin/mssqlserveradmin/sql-server-2008-sp1-download/" rel="next">SQL Server 2008 sp1 Download</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/architect/enterprisearchitecture/simple-advice-for-choosing-an-esb/" rel="prev">Simple advice for choosing an ESB</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/" class="post-title">SQL Server: When 8000 Characters Is Not Enough</a></h1>
					<div class="post-byline">by <a href="/index.php/author/emtucifor/" title="Posts by Erik" rel="author">Erik</a> on April 6, 2009 in category <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 62,640 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&text=RT @LessThanDot Blog - SQL Server: When 8000 Characters Is Not Enough by emtucifor" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&title=SQL Server: When 8000 Characters Is Not Enough&source=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&title=SQL Server: When 8000 Characters Is Not Enough" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&quote=SQL Server: When 8000 Characters Is Not Enough" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&title=SQL Server: When 8000 Characters Is Not Enough" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>MS SQL Server 2000 has a limitation of 8000 characters in a varchar variable. The historical reason for this limitation, I believe, is related to the 8k size of data pages, where in-row data can&#8217;t exceed something like 8060 bytes (actual numbers vary a little).</p>
<p>But what if you need to work with data that is longer than 8000 characters? When storing data in a table, you can use the text datatype which is stored out-of-row (though there are options about storing strings shorter than 8k characters in-row and then moving them out-of-row if they grow). But you can&#8217;t use the text datatype as a variable. Look:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @longdata <span class="kw1">text</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @longdata text</pre></div></div>

<blockquote><p><span class="MT_red">Msg 2739, Level 16, State 1, Line 1<br />
The text, ntext, and image data types are invalid for local variables.</span></p></blockquote>
<p>But while that seems definitive, it is not the whole story, because you <strong>can </strong>use the text data type as a parameter in a stored procedure:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> DisplayText @longdata <span class="kw1">text</span>
<span class="kw1">AS</span>
<span class="kw1">SELECT</span> @longdata</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE DisplayText @longdata text
AS
SELECT @longdata</pre></div></div>

<p>This works fine, but there are limitations on what can be done with that @longdata variable just like there are with text columns, such as the inability to use the Len() function (use DataLength instead).</p>
<p>If you truly must have variables with more than 8000 characters in a stored procedure, but they can&#8217;t be passed in as parameters, then you are now in the unfortunate position of having to use tables and text pointers. You&#8217;ll need the functions TEXTPTR, WRITETEXT, UPDATETEXT, and READTEXT. With these, you can work with pieces of the long data types (no longer than 8000 characters at a time in a variable).</p>
<p>Here&#8217;s an example of putting more than 8000 characters into a column in an SP:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Table <span class="br0">&#40;</span>
&nbsp; &nbsp;id <span class="kw1">int</span> <span class="kw1">identity</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">primary</span> <span class="kw1">key</span> <span class="kw1">clustered</span>,
&nbsp; &nbsp;longdata <span class="kw1">text</span>
<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> #Table <span class="br0">&#40;</span>longdata<span class="br0">&#41;</span> <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'data to be added to-&gt;'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Table <span class="br0">&#40;</span>longdata<span class="br0">&#41;</span> <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'more data-&gt;'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">DECLARE</span>
&nbsp; &nbsp;@id <span class="kw1">int</span>,
&nbsp; &nbsp;@chunknum <span class="kw1">int</span>,
&nbsp; &nbsp;@ptr <span class="kw1">varbinary</span><span class="br0">&#40;</span><span class="nu0">16</span><span class="br0">&#41;</span>,
&nbsp; &nbsp;@textchunk <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
<span class="kw1">SET</span> @id <span class="sy0">=</span> <span class="nu0">0</span>
<span class="kw1">WHILE</span> <span class="nu0">1</span> <span class="sy0">=</span> <span class="nu0">1</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">SELECT</span> <span class="kw1">TOP</span> <span class="nu0">1</span> @id <span class="sy0">=</span> id, @ptr <span class="sy0">=</span> <span class="kw2">TextPtr</span><span class="br0">&#40;</span>longdata<span class="br0">&#41;</span> <span class="kw1">FROM</span> #Table <span class="kw1">WHERE</span> id <span class="sy0">&gt;</span> @id <span class="kw1">ORDER</span> <span class="kw1">BY</span> id
&nbsp; &nbsp;<span class="kw1">IF</span> <span class="kw2">@@RowCount</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">BREAK</span>
&nbsp; &nbsp;<span class="kw1">SET</span> @chunknum <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp; &nbsp;<span class="kw1">WHILE</span> @chunknum <span class="sy0">&lt;=</span> <span class="nu0">5</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @textchunk <span class="sy0">=</span> <span class="kw2">Replicate</span><span class="br0">&#40;</span><span class="kw1">Char</span><span class="br0">&#40;</span><span class="nu0">96</span> <span class="sy0">+</span> @chunknum<span class="br0">&#41;</span>, <span class="nu0">8000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">UPDATETEXT</span> #Table.<span class="me1">longdata</span> @ptr <span class="sy0">NULL</span> <span class="sy0">NULL</span> @textchunk
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @chunknum <span class="sy0">=</span> @chunknum <span class="sy0">+</span> <span class="nu0">1</span>
&nbsp; &nbsp;<span class="kw1">END</span>
<span class="kw1">END</span>
&nbsp;
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> #Table
<span class="kw1">DROP</span> <span class="kw1">TABLE</span> #Table</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #Table (
   id int identity(1,1) primary key clustered,
   longdata text
)

INSERT #Table (longdata) VALUES ('data to be added to-&gt;')
INSERT #Table (longdata) VALUES ('more data-&gt;')

DECLARE
   @id int,
   @chunknum int,
   @ptr varbinary(16),
   @textchunk varchar(8000)
SET @id = 0
WHILE 1 = 1 BEGIN
   SELECT TOP 1 @id = id, @ptr = TextPtr(longdata) FROM #Table WHERE id &gt; @id ORDER BY id
   IF @@RowCount = 0 BREAK
   SET @chunknum = 1
   WHILE @chunknum &lt;= 5 BEGIN
      SET @textchunk = Replicate(Char(96 + @chunknum), 8000)
      UPDATETEXT #Table.longdata @ptr NULL NULL @textchunk
      SET @chunknum = @chunknum + 1
   END
END

SELECT * FROM #Table
DROP TABLE #Table</pre></div></div>

<p>You can see that you have to loop over each row, and then loop over each chunk of data you want to read from or write to the column.</p>
<p>Now you know the basics of handling more than 8000 characters in SQL 2000. But there are a few subtle things you should know:</p>
<p>• The 8000-character limitation does not apply to literal strings, just variables and rowsets. This means that with the DisplayText stored procedure above you can put in more than 8000 characters like so:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXEC</span> DisplayText <span class="st0">'&lt;more than 8000 characters here&gt;'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXEC DisplayText '&lt;more than 8000 characters here&gt;'</pre></div></div>

<p>This does not mean you can somehow exceed 8000 characters with a commonly-tried but mistaken method such as</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> <span class="kw1">Left</span><span class="br0">&#40;</span>longdata, <span class="nu0">8000</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="kw2">Substring</span><span class="br0">&#40;</span>longdata, <span class="nu0">8001</span>, <span class="nu0">8000</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="kw2">Substring</span><span class="br0">&#40;</span>longdata, <span class="nu0">16001</span>, <span class="nu0">8000</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT Left(longdata, 8000) + Substring(longdata, 8001, 8000) + Substring(longdata, 16001, 8000)</pre></div></div>

<p>Sure, this may actually temporarily create a longer string (I don&#8217;t know for sure) but the final value in the rowset will not exceed 8000 characters.</p>
<p>You can concatenate strings when submitting dynamic SQL statements:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span>
&nbsp; &nbsp;@SQL1 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp;@SQL2 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp;@SQL3 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp;@SQL4 <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">SET</span> @SQl1 <span class="sy0">=</span> <span class="st0">'8000 characters here'</span>
<span class="kw1">SET</span> @SQl2 <span class="sy0">=</span> <span class="st0">'8000 characters here'</span>
<span class="kw1">SET</span> @SQl3 <span class="sy0">=</span> <span class="st0">'8000 characters here'</span>
<span class="kw1">SET</span> @SQl4 <span class="sy0">=</span> <span class="st0">'8000 characters here'</span>
&nbsp;
<span class="kw1">EXEC</span> <span class="br0">&#40;</span>@SQL1 <span class="sy0">+</span> @SQL2 <span class="sy0">+</span> @SQL3 <span class="sy0">+</span> @SQL4<span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE
   @SQL1 varchar(8000),
   @SQL2 varchar(8000),
   @SQL3 varchar(8000),
   @SQL4 varchar(8000)

SET @SQl1 = '8000 characters here'
SET @SQl2 = '8000 characters here'
SET @SQl3 = '8000 characters here'
SET @SQl4 = '8000 characters here'

EXEC (@SQL1 + @SQL2 + @SQL3 + @SQL4)</pre></div></div>

<p>While I can&#8217;t really recommend this method, if you are desperate and this is the only way to get the job done, it&#8217;s a possibility. I&#8217;ve personally only used it in two narrow situations: creating pre-processed SQL objects where the dynamic SQL is executed rarely only when something changes, and the code it creates is static until the next change. One creates history-keeping triggers, and the other builds a standard set of pivoted views in response to changes of the metadata definitions of some web objects. Both required this method to be able to handle the number of columns possible. </p>
<p>• SQL 2005 has a new &#8216;max&#8217; keyword for the length of the (n)var/char data types that allows variables to be as big as the (n)text datatype can be. You can do anything to them that you could with regular varchar types, but behind the scenes they function like the text data type with values less than 8000 characters in-row and values greater than 8000 characters stored in out-of-row pages.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @longdata <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="kw2">max</span><span class="br0">&#41;</span>
<span class="kw1">SET</span> @longdata <span class="sy0">=</span> <span class="st0">'&lt;more than 8000 characters here&gt;'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @longdata varchar(max)
SET @longdata = '&lt;more than 8000 characters here&gt;'</pre></div></div>

<p>Max here simply means that the data type can go up to the maximum storage size allowed, which is 2^31-1 bytes (minus 2 more bytes for presumably a length value). Note that you can&#8217;t specify varchar(16000) or some value over 8000. You only get between 1 and 8000, or the special identifier <em>max</em>.</p>
<p>As a practical example of using a text datatype to defeat the 8000-character limitation in MS SQL Server 2000, here is a SendMail stored procedure that will use the CDO.Message object to send email with a body longer than 8000 characters. Note: put in your mail server name or make it a parameter or perhaps make it read from a table!</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> SendMail
&nbsp; &nbsp;@<span class="kw1">From</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">1000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp;@<span class="kw1">To</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">1000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp;@Subject <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">1000</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">'No Subject'</span>,
&nbsp; &nbsp;@TextBody <span class="kw1">text</span> <span class="sy0">=</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp;@HtmlBody <span class="kw1">text</span> <span class="sy0">=</span> <span class="sy0">NULL</span>
<span class="kw1">AS</span>
<span class="co1">-- Written by Erik E</span>
<span class="co1">-- Sends an email using the CDO.Message object and the SP_OA procedures.</span>
<span class="co1">-- Notably, accepts text input for emails longer than 8000 characters.</span>
<span class="kw1">DECLARE</span>
&nbsp; &nbsp;@CDOMessage <span class="kw1">int</span>,
&nbsp; &nbsp;@ReturnCode <span class="kw1">int</span>
&nbsp;
<span class="kw1">SET</span> @ReturnCode <span class="sy0">=</span> <span class="nu0">0</span> 
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OACREATE</span> <span class="st0">'CDO.Message'</span>, @CDOMessage <span class="kw1">OUT</span>
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'CDO.Message'</span>, <span class="sy0">NULL</span>, <span class="sy0">NULL</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OASETPROPERTY</span> @CDOMessage, <span class="st0">'From'</span>, @<span class="kw1">From</span>
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'From'</span>, <span class="st0">'CDO.Message'</span>, @<span class="kw1">From</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OASETPROPERTY</span> @CDOMessage, <span class="st0">'To'</span>, @<span class="kw1">To</span>
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'To'</span>, <span class="st0">'CDO.Message'</span>, @<span class="kw1">To</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OASETPROPERTY</span> @CDOMessage, <span class="st0">'Subject'</span>, @Subject
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'Subject'</span>, <span class="st0">'CDO.Message'</span>, @Subject<span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
<span class="kw1">IF</span> @TextBody <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OASETPROPERTY</span> @CDOMessage, <span class="st0">'TextBody'</span>, @TextBody
&nbsp; &nbsp;<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'TextBody'</span>, <span class="st0">'CDO.Message'</span>, <span class="kw1">Convert</span><span class="br0">&#40;</span><span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>, @TextBody<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
<span class="kw1">END</span>
&nbsp;
<span class="kw1">IF</span> @HtmlBody <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OASETPROPERTY</span> @CDOMessage, <span class="st0">'HtmlBody'</span>, @HtmlBody
&nbsp; &nbsp;<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'HtmlBody'</span>, <span class="st0">'CDO.Message'</span>, <span class="kw1">Convert</span><span class="br0">&#40;</span><span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>, @HtmlBody<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
<span class="kw1">END</span>
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OASETPROPERTY</span> @CDOMessage, <span class="st0">'Configuration.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/sendusing&quot;).Value'</span>, <span class="st0">'2'</span>
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'Configuration.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/sendusing&quot;).Value'</span>, <span class="st0">'CDO.Message'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OASETPROPERTY</span> @CDOMessage, <span class="st0">'Configuration.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;).Value'</span>, <span class="st0">'YourMailServerName'</span>
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'Configuration.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/smtpserver&quot;).Value'</span>, <span class="st0">'CDO.Message'</span>, <span class="st0">'YourMailServerName'</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OASETPROPERTY</span> @CDOMessage, <span class="st0">'Configuration.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;).Value'</span>, <span class="st0">'25'</span>
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'Configuration.Fields(&quot;http://schemas.microsoft.com/cdo/configuration/smtpserverport&quot;).Value'</span>, <span class="st0">'CDO.Message'</span>, <span class="st0">'25'</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OAMETHOD</span> @CDOMessage, <span class="st0">'Configuration.Fields.Update'</span>
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'Configuration.Fields.Update'</span>, <span class="st0">'CDO.Message'</span>, <span class="sy0">NULL</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
<span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OAMETHOD</span> @CDOMessage, <span class="st0">'Send'</span>
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'Send'</span>, <span class="st0">'CDO.Message'</span>, <span class="sy0">NULL</span><span class="br0">&#41;</span> <span class="kw1">GOTO</span> Err <span class="kw1">END</span>
&nbsp;
Err:
<span class="kw1">SET</span> @ReturnCode <span class="sy0">=</span> <span class="nu0">0</span>
<span class="kw1">IF</span> @CDOMessage <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">EXEC</span> @ReturnCode <span class="sy0">=</span> <span class="kw3">SP_OADESTROY</span> @CDOMessage
<span class="kw1">IF</span> @ReturnCode <span class="sy0">&lt;&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span> <span class="kw1">PRINT</span> dbo.<span class="me1">ObjectErrorFunc</span><span class="br0">&#40;</span>@CDOMessage, @ReturnCode, <span class="st0">'CDO.Message'</span>, <span class="sy0">NULL</span>, <span class="sy0">NULL</span><span class="br0">&#41;</span> <span class="kw1">END</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE SendMail
   @From varchar(1000),
   @To varchar(1000),
   @Subject varchar(1000) = 'No Subject',
   @TextBody text = NULL,
   @HtmlBody text = NULL
AS
-- Written by Erik E
-- Sends an email using the CDO.Message object and the SP_OA procedures.
-- Notably, accepts text input for emails longer than 8000 characters.
DECLARE
   @CDOMessage int,
   @ReturnCode int

SET @ReturnCode = 0 

EXEC @ReturnCode = SP_OACREATE 'CDO.Message', @CDOMessage OUT
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'CDO.Message', NULL, NULL) GOTO Err END

EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, 'From', @From
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'From', 'CDO.Message', @From) GOTO Err END

EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, 'To', @To
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'To', 'CDO.Message', @To) GOTO Err END

EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, 'Subject', @Subject
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'Subject', 'CDO.Message', @Subject) GOTO Err END

IF @TextBody IS NOT NULL BEGIN
   EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, 'TextBody', @TextBody
   IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'TextBody', 'CDO.Message', Convert(varchar(8000), @TextBody)) GOTO Err END
END

IF @HtmlBody IS NOT NULL BEGIN
   EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, 'HtmlBody', @HtmlBody
   IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'HtmlBody', 'CDO.Message', Convert(varchar(8000), @HtmlBody)) GOTO Err END
END

EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, 'Configuration.Fields("http://schemas.microsoft.com/cdo/configuration/sendusing").Value', '2'
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'Configuration.Fields("http://schemas.microsoft.com/cdo/configuration/sendusing").Value', 'CDO.Message', '2') GOTO Err END

EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, 'Configuration.Fields("http://schemas.microsoft.com/cdo/configuration/smtpserver").Value', 'YourMailServerName'
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'Configuration.Fields("http://schemas.microsoft.com/cdo/configuration/smtpserver").Value', 'CDO.Message', 'YourMailServerName') GOTO Err END

EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, 'Configuration.Fields("http://schemas.microsoft.com/cdo/configuration/smtpserverport").Value', '25'
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'Configuration.Fields("http://schemas.microsoft.com/cdo/configuration/smtpserverport").Value', 'CDO.Message', '25') GOTO Err END

EXEC @ReturnCode = SP_OAMETHOD @CDOMessage, 'Configuration.Fields.Update'
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'Configuration.Fields.Update', 'CDO.Message', NULL) GOTO Err END

EXEC @ReturnCode = SP_OAMETHOD @CDOMessage, 'Send'
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'Send', 'CDO.Message', NULL) GOTO Err END

Err:
SET @ReturnCode = 0
IF @CDOMessage &lt;&gt; 0 EXEC @ReturnCode = SP_OADESTROY @CDOMessage
IF @ReturnCode &lt;&gt; 0 BEGIN PRINT dbo.ObjectErrorFunc(@CDOMessage, @ReturnCode, 'CDO.Message', NULL, NULL) END</pre></div></div>

<p>The error handling here after each SP_OA SP call uses a custom function I wrote. I found it to be invaluable when debugging problems with OLE calls to various objects from SQL Server. You may either tear out this error handling, call the sp_OAGetErrorInfo procedure yourself, or use mine, which is below (plus a couple of dependent functions that you may want to rewrite/modify/reimplement/stop using).</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">FUNCTION</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>ObjectErrorFunc<span class="br0">&#93;</span> <span class="br0">&#40;</span>
&nbsp; &nbsp;@<span class="kw1">Object</span> <span class="kw1">int</span>,
&nbsp; &nbsp;@ReturnCode <span class="kw1">int</span>,
&nbsp; &nbsp;@Context <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">1000</span><span class="br0">&#41;</span>, <span class="co1">-- Property or Method</span>
&nbsp; &nbsp;@ObjectType <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>, <span class="co1">-- Object Name, when known</span>
&nbsp; &nbsp;@<span class="kw1">Value</span> <span class="kw1">sql_variant</span> <span class="co1">-- Parameter value, if known</span>
<span class="br0">&#41;</span>
<span class="kw1">RETURNS</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="co1">-- Written by Erik E</span>
<span class="co1">-- Makes (more) sense out of error codes when using the OLE sp_OA procedures.</span>
<span class="co1">-- Sometimes the message returned by sp_OAGetErrorInfo is cryptic, so this</span>
<span class="co1">-- &nbsp; &nbsp;function is a place where researched information on errors can be saved</span>
<span class="co1">-- &nbsp; &nbsp;for future reference.</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">DECLARE</span>
&nbsp; &nbsp; &nbsp; @ErrorMessage <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; &nbsp; @ErrorCode <span class="kw1">binary</span><span class="br0">&#40;</span><span class="nu0">4</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; &nbsp; @Source <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; &nbsp; @Description <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>
&nbsp;
&nbsp; &nbsp;<span class="kw1">SET</span> @ErrorCode <span class="sy0">=</span> <span class="kw1">convert</span><span class="br0">&#40;</span><span class="kw1">binary</span><span class="br0">&#40;</span><span class="nu0">4</span><span class="br0">&#41;</span>, @ReturnCode<span class="br0">&#41;</span>
&nbsp;
&nbsp; &nbsp;<span class="kw1">EXEC</span> <span class="kw3">sp_OAGetErrorInfo</span>
&nbsp; &nbsp; &nbsp; @<span class="kw1">Object</span>,
&nbsp; &nbsp; &nbsp; @Source <span class="kw1">OUTPUT</span>,
&nbsp; &nbsp; &nbsp; @Description <span class="kw1">OUTPUT</span>
&nbsp;
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @Context <span class="sy0">=</span> <span class="kw1">Coalesce</span><span class="br0">&#40;</span><span class="kw1">NullIf</span><span class="br0">&#40;</span>@Context, <span class="st0">''</span><span class="br0">&#41;</span>, @Source, <span class="st0">'OLE Unknown Source'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;@ErrorMessage <span class="sy0">=</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IsNull<span class="br0">&#40;</span>@Source, <span class="st0">'OLE Unknown Source'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">+</span> <span class="st0">' Error '</span> <span class="sy0">+</span> IsNull<span class="br0">&#40;</span><span class="st0">'0x'</span> <span class="sy0">+</span> dbo.<span class="me1">BinaryToHex</span><span class="br0">&#40;</span>@ErrorCode<span class="br0">&#41;</span>, <span class="st0">'0x???????'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="sy0">+</span> <span class="st0">' - '</span> <span class="sy0">+</span> <span class="kw1">Coalesce</span><span class="br0">&#40;</span>Descr, <span class="kw2">LTrim</span><span class="br0">&#40;</span>@Description<span class="br0">&#41;</span>, <span class="st0">'Unknown Error'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">FROM</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span> Error <span class="sy0">=</span> @ErrorCode
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#41;</span> E <span class="kw1">LEFT</span> <span class="sy0">JOIN</span> <span class="br0">&#40;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SELECT</span> Error <span class="sy0">=</span> <span class="kw1">convert</span><span class="br0">&#40;</span><span class="kw1">binary</span><span class="br0">&#40;</span><span class="nu0">4</span><span class="br0">&#41;</span>, 0x80004005<span class="br0">&#41;</span>, Descr <span class="sy0">=</span> <span class="kw1">convert</span><span class="br0">&#40;</span><span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>, <span class="st0">'Invalid OLE object handle: The specified handle value ('</span> <span class="sy0">+</span> <span class="kw1">convert</span><span class="br0">&#40;</span><span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>, @<span class="kw1">Object</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">') does not refer to a valid OLE object.'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80010108, <span class="st0">'The object invoked has disconnected from its clients: The previously valid referenced object has closed or stopped running since the last reference.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80020003, <span class="st0">'Invalid property or method: property or method '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">''</span><span class="st0">' was not found'</span> <span class="sy0">+</span> IsNull<span class="br0">&#40;</span><span class="st0">' on OLE object of type '</span><span class="st0">''</span> <span class="sy0">+</span> @ObjectType <span class="sy0">+</span> <span class="st0">'.'</span><span class="st0">''</span>, <span class="st0">'.'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80020005, <span class="st0">'Type mismatch: data type of a Transact-SQL local variable used to store a return value of property or method '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">''</span><span class="st0">' did not match the Visual Basic data type of the property or method return value. Or, the return value of property or method '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">''</span><span class="st0">' was requested, but it does not return a value.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80020006, <span class="st0">'Unknown name: property or method '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">''</span><span class="st0">' was not found for the specified object'</span> <span class="sy0">+</span> IsNull<span class="br0">&#40;</span><span class="st0">' '</span><span class="st0">''</span> <span class="sy0">+</span> @ObjectType <span class="sy0">+</span> <span class="st0">'.'</span><span class="st0">''</span>, <span class="sy0">+</span> <span class="st0">'.'</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80020008, <span class="st0">'Bad variable type: data type of a Transact-SQL value passed as a method parameter was NULL or did not match the Microsoft® Visual Basic® method parameter data type.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x8002000B, <span class="st0">''</span><span class="st0">'Subscript out of range'</span><span class="st0">' on property or method '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> IsNull<span class="br0">&#40;</span><span class="st0">''</span><span class="st0">' of object type '</span><span class="st0">''</span> <span class="sy0">+</span> @ObjectType, <span class="st0">''</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'.'</span><span class="st0">''</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x8002000E, <span class="st0">'Invalid number of parameters on property or method '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> IsNull<span class="br0">&#40;</span><span class="st0">''</span><span class="st0">' of object type '</span><span class="st0">''</span> <span class="sy0">+</span> @ObjectType, <span class="st0">''</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'.'</span><span class="st0">''</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80020011, <span class="st0">''</span><span class="st0">'Does not support a collection'</span><span class="st0">' on property or method '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> IsNull<span class="br0">&#40;</span><span class="st0">''</span><span class="st0">' of object type '</span><span class="st0">''</span> <span class="sy0">+</span> @ObjectType, <span class="st0">''</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'.'</span><span class="st0">''</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80040220, <span class="st0">'The &quot;SendUsing&quot; configuration value is invalid.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80080005, <span class="st0">'Server execution failed: OLE object '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">''</span><span class="st0">' is registered as a local OLE server (.exe file) but the .exe file could not be found or started.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80040154, <span class="st0">'Class '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">''</span><span class="st0">' not registered.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x800401F3, <span class="st0">'Invalid class string: OLE object ProgID/CLSID '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">''</span><span class="st0">' is not registered on Server '</span><span class="st0">''</span> <span class="sy0">+</span> <span class="kw2">@@ServerName</span> <span class="sy0">+</span> <span class="st0">''</span><span class="st0">'. OLE automation servers need to be registered before they can be instantiated using sp_OACreate. This can be done using regsvr32.exe for inprocess (.dll) servers, or the /REGSERVER command-line switch for local (.exe) servers.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x8004275B, <span class="st0">'sp_OACreate - data type ('</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">') or value '</span> <span class="sy0">+</span> IsNull<span class="br0">&#40;</span><span class="st0">'('</span> <span class="sy0">+</span> <span class="kw1">Convert</span><span class="br0">&#40;</span><span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>, @<span class="kw1">Value</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">')'</span>, <span class="st0">''</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">' of parameter '</span><span class="st0">'context'</span><span class="st0">' is invalid. Valid context parameter values are 1, 4, and 5.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80042727, <span class="st0">'sp_OASetProperty - improper usage: parameters are ObjPointer int IN, PropertyName varchar IN, @setval &lt;any&gt; IN [, additional indexing IN params].'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80042731, <span class="st0">'Output values of type Object require output parameters of type int.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80042732, <span class="st0">'Output values of type Object are not allowed in result sets. Use a variable for parameter '</span><span class="st0">'returnvalue'</span><span class="st0">' with the OUTPUT keyword in order to return a handle to an object.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x80042742, <span class="st0">'Traversal string: &nbsp;Bad whitespace: Error parsing method or property specification string '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">'.'</span><span class="st0">''</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> 0x8007007E, <span class="st0">'Module could not be found: OLE object '</span><span class="st0">''</span> <span class="sy0">+</span> @Context <span class="sy0">+</span> <span class="st0">''</span><span class="st0">' is registered as an in-process OLE server (.dll file), but the .dll file could not be found or loaded.'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#41;</span> &nbsp;X <span class="kw1">ON</span> E.<span class="me1">Error</span> <span class="sy0">=</span> X.<span class="me1">Error</span>
&nbsp; &nbsp;<span class="kw1">RETURN</span> @ErrorMessage
<span class="kw1">END</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE FUNCTION [dbo].[ObjectErrorFunc] (
   @Object int,
   @ReturnCode int,
   @Context varchar(1000), -- Property or Method
   @ObjectType varchar(8000), -- Object Name, when known
   @Value sql_variant -- Parameter value, if known
)
RETURNS varchar(8000)
AS
-- Written by Erik E
-- Makes (more) sense out of error codes when using the OLE sp_OA procedures.
-- Sometimes the message returned by sp_OAGetErrorInfo is cryptic, so this
--    function is a place where researched information on errors can be saved
--    for future reference.
BEGIN
   DECLARE
      @ErrorMessage varchar(8000),
      @ErrorCode binary(4),
      @Source varchar(8000),
      @Description varchar(8000)

   SET @ErrorCode = convert(binary(4), @ReturnCode)

   EXEC sp_OAGetErrorInfo
      @Object,
      @Source OUTPUT,
      @Description OUTPUT

      SET @Context = Coalesce(NullIf(@Context, ''), @Source, 'OLE Unknown Source')
      SELECT
         @ErrorMessage = 
            IsNull(@Source, 'OLE Unknown Source')
            + ' Error ' + IsNull('0x' + dbo.BinaryToHex(@ErrorCode), '0x???????')
            + ' - ' + Coalesce(Descr, LTrim(@Description), 'Unknown Error')
      FROM
         (
            SELECT Error = @ErrorCode
         ) E LEFT JOIN (
            SELECT Error = convert(binary(4), 0x80004005), Descr = convert(varchar(8000), 'Invalid OLE object handle: The specified handle value (' + convert(varchar(8000), @Object) + ') does not refer to a valid OLE object.')
            UNION ALL SELECT 0x80010108, 'The object invoked has disconnected from its clients: The previously valid referenced object has closed or stopped running since the last reference.'
            UNION ALL SELECT 0x80020003, 'Invalid property or method: property or method ''' + @Context + ''' was not found' + IsNull(' on OLE object of type ''' + @ObjectType + '.''', '.')
            UNION ALL SELECT 0x80020005, 'Type mismatch: data type of a Transact-SQL local variable used to store a return value of property or method ''' + @Context + ''' did not match the Visual Basic data type of the property or method return value. Or, the return value of property or method ''' + @Context + ''' was requested, but it does not return a value.'
            UNION ALL SELECT 0x80020006, 'Unknown name: property or method ''' + @Context + ''' was not found for the specified object' + IsNull(' ''' + @ObjectType + '.''', + '.')
             UNION ALL SELECT 0x80020008, 'Bad variable type: data type of a Transact-SQL value passed as a method parameter was NULL or did not match the Microsoft® Visual Basic® method parameter data type.'
            UNION ALL SELECT 0x8002000B, '''Subscript out of range'' on property or method ''' + @Context + IsNull(''' of object type ''' + @ObjectType, '') + '.'''
            UNION ALL SELECT 0x8002000E, 'Invalid number of parameters on property or method ''' + @Context + IsNull(''' of object type ''' + @ObjectType, '') + '.'''
            UNION ALL SELECT 0x80020011, '''Does not support a collection'' on property or method ''' + @Context + IsNull(''' of object type ''' + @ObjectType, '') + '.'''
            UNION ALL SELECT 0x80040220, 'The "SendUsing" configuration value is invalid.'
            UNION ALL SELECT 0x80080005, 'Server execution failed: OLE object ''' + @Context + ''' is registered as a local OLE server (.exe file) but the .exe file could not be found or started.'
            UNION ALL SELECT 0x80040154, 'Class ''' + @Context + ''' not registered.'
            UNION ALL SELECT 0x800401F3, 'Invalid class string: OLE object ProgID/CLSID ''' + @Context + ''' is not registered on Server ''' + @@ServerName + '''. OLE automation servers need to be registered before they can be instantiated using sp_OACreate. This can be done using regsvr32.exe for inprocess (.dll) servers, or the /REGSERVER command-line switch for local (.exe) servers.'
            UNION ALL SELECT 0x8004275B, 'sp_OACreate - data type (' + @Context + ') or value ' + IsNull('(' + Convert(varchar(8000), @Value) + ')', '') + ' of parameter ''context'' is invalid. Valid context parameter values are 1, 4, and 5.'
            UNION ALL SELECT 0x80042727, 'sp_OASetProperty - improper usage: parameters are ObjPointer int IN, PropertyName varchar IN, @setval &lt;any&gt; IN [, additional indexing IN params].'
            UNION ALL SELECT 0x80042731, 'Output values of type Object require output parameters of type int.'
            UNION ALL SELECT 0x80042732, 'Output values of type Object are not allowed in result sets. Use a variable for parameter ''returnvalue'' with the OUTPUT keyword in order to return a handle to an object.'
            UNION ALL SELECT 0x80042742, 'Traversal string:  Bad whitespace: Error parsing method or property specification string ''' + @Context + '.'''
            UNION ALL SELECT 0x8007007E, 'Module could not be found: OLE object ''' + @Context + ''' is registered as an in-process OLE server (.dll file), but the .dll file could not be found or loaded.'
         )  X ON E.Error = X.Error
   RETURN @ErrorMessage
END</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">FUNCTION</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>NumberToHex<span class="br0">&#93;</span> <span class="br0">&#40;</span>@Number <span class="kw1">sql_variant</span><span class="br0">&#41;</span>
<span class="kw1">RETURNS</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">72</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="co1">-- Written by Erik E</span>
<span class="co1">-- Converts a value to its hex string representation</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">DECLARE</span>
&nbsp; &nbsp; &nbsp; @Hex <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">72</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; &nbsp; @Pos <span class="kw1">int</span>,
&nbsp; &nbsp; &nbsp; @Num <span class="kw1">decimal</span><span class="br0">&#40;</span><span class="nu0">38</span>, <span class="nu0">0</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; &nbsp; @HexChar <span class="kw1">tinyint</span>
&nbsp; &nbsp;<span class="kw1">SET</span> @Pos <span class="sy0">=</span> DataLength<span class="br0">&#40;</span>@Number<span class="br0">&#41;</span> <span class="sy0">*</span> <span class="nu0">2</span>
&nbsp; &nbsp;<span class="kw1">SET</span> @Num <span class="sy0">=</span> <span class="kw1">convert</span><span class="br0">&#40;</span><span class="kw1">decimal</span><span class="br0">&#40;</span><span class="nu0">38</span>,<span class="nu0">0</span><span class="br0">&#41;</span>, @Number<span class="br0">&#41;</span>
&nbsp; &nbsp;<span class="kw1">WHILE</span> @Pos <span class="sy0">&gt;</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @HexChar <span class="sy0">=</span> @Num <span class="sy0">-</span> <span class="br0">&#40;</span><span class="kw2">Floor</span><span class="br0">&#40;</span>@Num <span class="sy0">/</span> <span class="kw1">Convert</span><span class="br0">&#40;</span><span class="kw1">decimal</span><span class="br0">&#40;</span><span class="nu0">38</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="nu0">16</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">*</span> <span class="kw1">Convert</span><span class="br0">&#40;</span><span class="kw1">decimal</span><span class="br0">&#40;</span><span class="nu0">38</span>, <span class="nu0">0</span><span class="br0">&#41;</span>, <span class="nu0">16</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="nu0">48</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @Hex <span class="sy0">=</span> <span class="kw1">Char</span><span class="br0">&#40;</span>@HexChar <span class="sy0">+</span> <span class="kw1">CASE</span> <span class="kw1">WHEN</span> @HexChar <span class="sy0">&gt;=</span> <span class="nu0">58</span> <span class="kw1">THEN</span> <span class="nu0">7</span> <span class="kw1">ELSE</span> <span class="nu0">0</span> <span class="kw1">END</span><span class="br0">&#41;</span> <span class="sy0">+</span> IsNull<span class="br0">&#40;</span>@Hex, <span class="st0">''</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @Num <span class="sy0">=</span> <span class="kw2">Floor</span><span class="br0">&#40;</span>@Num <span class="sy0">/</span> <span class="nu0">16</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @Pos <span class="sy0">=</span> @Pos <span class="sy0">-</span> <span class="nu0">1</span>
&nbsp; &nbsp;<span class="kw1">END</span>
&nbsp; &nbsp;<span class="kw1">RETURN</span> @Hex
<span class="kw1">END</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE FUNCTION [dbo].[NumberToHex] (@Number sql_variant)
RETURNS varchar(72)
AS
-- Written by Erik E
-- Converts a value to its hex string representation
BEGIN
   DECLARE
      @Hex varchar(72),
      @Pos int,
      @Num decimal(38, 0),
      @HexChar tinyint
   SET @Pos = DataLength(@Number) * 2
   SET @Num = convert(decimal(38,0), @Number)
   WHILE @Pos &gt; 0 BEGIN
      SET @HexChar = @Num - (Floor(@Num / Convert(decimal(38, 0), 16)) * Convert(decimal(38, 0), 16)) + 48
      SET @Hex = Char(@HexChar + CASE WHEN @HexChar &gt;= 58 THEN 7 ELSE 0 END) + IsNull(@Hex, '')
      SET @Num = Floor(@Num / 16)
      SET @Pos = @Pos - 1
   END
   RETURN @Hex
END</pre></div></div>


<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">FUNCTION</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>BinaryToHex<span class="br0">&#93;</span> <span class="br0">&#40;</span>@Number <span class="kw1">varbinary</span><span class="br0">&#40;</span><span class="nu0">32</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">RETURNS</span> <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">72</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="co1">-- Written by Erik E</span>
<span class="co1">-- Converts varbinary to its hex string representation</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">RETURN</span> dbo.<span class="me1">NumberToHex</span><span class="br0">&#40;</span><span class="kw1">Convert</span><span class="br0">&#40;</span><span class="kw1">int</span>, @Number<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">END</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE FUNCTION [dbo].[BinaryToHex] (@Number varbinary(32))
RETURNS varchar(72)
AS
-- Written by Erik E
-- Converts varbinary to its hex string representation
BEGIN
   RETURN dbo.NumberToHex(Convert(int, @Number))
END</pre></div></div>

<p>Here&#8217;s a sample execution of SendMail for you:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXEC</span> SendMail <span class="st0">'emtucifor@example.com'</span>, <span class="st0">'emtucifor@example.com'</span>, <span class="st0">'This is a test email'</span>, @HTMLBody <span class="sy0">=</span> <span class="st0">'&lt;8000 characters here&gt;'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXEC SendMail 'emtucifor@example.com', 'emtucifor@example.com', 'This is a test email', @HTMLBody = '&lt;8000 characters here&gt;'</pre></div></div>

<p>If you are sending email to someone who uses Outlook, it helps to provide both TextBody and HTMLBody, because the TextBody is used in the pop-up preview window of the content, so if the person is present when the email arrives, the preview will work correctly.</p>
<p>I hope that you benefit from this brief but intended-to-be-thorough write-up on exceeding the 8000-character limitation in SQL 2000.</p>
<p>Erik</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-server-stored-procedure-with-nvarcha/'>SQL Server Stored Procedure with nvarchar parameter</a><p>Most seasoned sql server programmers know this already, but for you beginners.... When you create&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-server-fibonacci-sequence/'>SQL Server Fibonacci Sequence</a><p>This probably falls under the category of 'Why bother'. However, there has been some recent&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Erik has been working in IT since 1993 and starting in 2004 has specialized in MS SQL Server query writing, database design, and reporting services. He also professionally does web site design/developing and writes C# applications (mostly for projects involving his databases and web sites).

His career in the industry truly started when he first began using computers in the late 70s. In 1984 he began programming on the IBM PCJr, and performed game testing on King's Quest I. These early experiences gave him the taste and drive to continue an incremental and self-taught path all the way to his current position.

Erik is also interested in taekwondo, go (ranks 4k on KGS), sci-fi books, mathematics, philosophy, religion, and rollerblading. He and his family live on the West Coast of the US.<br style="clear: left" /></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 62,640 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/emtucifor/">Read More Posts by Erik</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&text=RT @LessThanDot Blog - SQL Server: When 8000 Characters Is Not Enough by emtucifor" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&title=SQL Server: When 8000 Characters Is Not Enough&source=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&title=SQL Server: When 8000 Characters Is Not Enough" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&quote=SQL Server: When 8000 Characters Is Not Enough" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/&title=SQL Server: When 8000 Characters Is Not Enough" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		14 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-gmmastros even thread-even depth-1" id="comment-1142">
				<div id="div-comment-1142" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1142">
			April 6, 2009 at 5:55 pm</a>		</div>

		<p>Very nice, indeed!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1142#respond' onclick='return addComment.moveForm( "div-comment-1142", "1142", "respond", "375" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis odd alt thread-odd thread-alt depth-1" id="comment-1143">
				<div id="div-comment-1143" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1143">
			April 6, 2009 at 6:52 pm</a>		</div>

		<p>This is excellent, thanks a lot</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1143#respond' onclick='return addComment.moveForm( "div-comment-1143", "1143", "respond", "375" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kaht even thread-even depth-1" id="comment-1144">
				<div id="div-comment-1144" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e8cf1f89d93accfa6f422a6e718ad2f9?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e8cf1f89d93accfa6f422a6e718ad2f9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">kaht</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1144">
			April 7, 2009 at 9:02 am</a>		</div>

		<p>Thanks for the detailed explanation!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1144#respond' onclick='return addComment.moveForm( "div-comment-1144", "1144", "respond", "375" )' aria-label='Reply to kaht'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-kermit odd alt thread-odd thread-alt depth-1" id="comment-1145">
				<div id="div-comment-1145" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/fe367f8ca2e1d303ac247c423bd25f5e?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/fe367f8ca2e1d303ac247c423bd25f5e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Tahir Khalid</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1145">
			April 7, 2009 at 9:07 am</a>		</div>

		<p>Excellent, I have come across this very issue in our Sage CRM application where particular queries are exceeding the 8000 character limit resulting in an internal web app implosion.</p>
<p>Some useful info here!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1145#respond' onclick='return addComment.moveForm( "div-comment-1145", "1145", "respond", "375" )' aria-label='Reply to Tahir Khalid'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1137">
				<div id="div-comment-1137" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/24ecec671a0cb389f43e9b1babef9c02?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/24ecec671a0cb389f43e9b1babef9c02?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.soehnel-software.de/' rel='external nofollow' class='url'>SoehnelS</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1137">
			June 24, 2009 at 5:58 am</a>		</div>

		<p>Thanks!</p>
<p>I read the thread at <a href="http://forum.lessthandot.com/" rel="nofollow">http://forum.lessthandot.com/</a><br />
and find this is the best article I read for a long time!</p>
<p>(Sorry for my badly english&#8230;)</p>
<p>Greetings from Germany!<br />
Sven</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1137#respond' onclick='return addComment.moveForm( "div-comment-1137", "1137", "respond", "375" )' aria-label='Reply to SoehnelS'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1138">
				<div id="div-comment-1138" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/717ed2beac495b74fd6a91c3a7052101?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/717ed2beac495b74fd6a91c3a7052101?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Tatoba</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1138">
			October 7, 2009 at 8:42 am</a>		</div>

		<p>Thanks lot best information</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1138#respond' onclick='return addComment.moveForm( "div-comment-1138", "1138", "respond", "375" )' aria-label='Reply to Tatoba'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1146">
				<div id="div-comment-1146" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c2b4a729095dd1131592269818cd0600?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c2b4a729095dd1131592269818cd0600?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Mauricio Zavala G.</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1146">
			October 15, 2009 at 2:37 pm</a>		</div>

		<p>
Thanx for the detail.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1146#respond' onclick='return addComment.moveForm( "div-comment-1146", "1146", "respond", "375" )' aria-label='Reply to Mauricio Zavala G.'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1141">
				<div id="div-comment-1141" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4ec3ccfb5b36bf80da232820ef0e2b13?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4ec3ccfb5b36bf80da232820ef0e2b13?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">nexpron</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1141">
			November 12, 2010 at 5:50 am</a>		</div>

		<p>Most of this article is very nice. But last sql command is not clear. <br />
EXEC SendMail &#8217;emtucifor@example.com&#8217;, &#8217;emtucifor@example.com&#8217;, &#8216;This is a test email&#8217;, @HTMLBody = &#8216;&lt;8000 characters here>&#8217;<br />
My question is: how we call this stored procedure? Of course, we can fill @HTMLBody parameter by hand, but what about situation then we get data from temporal table? For example:<br />
CREATE TABLE #Tabler (id INT IDENTITY(1,1),longdata TEXT)<br />
INSERT #Tabler (longdata) VALUES (&#8216;dane: wi&#281;cej ni&#380; pojemno&#347;&#263; varchar(8000)rt&#8217;)<br />
EXEC SendMail &#8217;emtucifor@example.com&#8217;, &#8217;emtucifor@example.com&#8217;, &#8216;This is a test email&#8217;, /* there first row from #Tabler *?/<br />
DROP TABLE #Tabler </p>
<p>I remember that we can&#8217;t create local variable type TEXT.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1141#respond' onclick='return addComment.moveForm( "div-comment-1141", "1141", "respond", "375" )' aria-label='Reply to nexpron'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-emtucifor bypostauthor even thread-even depth-1" id="comment-1136">
				<div id="div-comment-1136" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1136">
			December 5, 2010 at 9:20 pm</a>		</div>

		<p>nexpron, you would probably want to rewrite the SendMail stored procedure to accept a pointer to a text column, which could then be used to set the HTML Body attribute.</p>
<p>Sorry I missed your comment earlier.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1136#respond' onclick='return addComment.moveForm( "div-comment-1136", "1136", "respond", "375" )' aria-label='Reply to Erik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1134">
				<div id="div-comment-1134" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/da5f8e86be5e9ff9112543b6d8357375?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/da5f8e86be5e9ff9112543b6d8357375?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1134">
			May 9, 2012 at 2:07 pm</a>		</div>

		<p>I&#8217;ve got the same issue as nexpron above.  Not sure how to set the HTML Body attribute in SendMail using the text pointer passed into the stored proc as you suggest.  I tried the following but it won&#8217;t compile:</p>
<p>EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, &#8216;HtmlBody&#8217;,  READTEXT dbo.TextTable.longdata @ptrval 0 1</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1134#respond' onclick='return addComment.moveForm( "div-comment-1134", "1134", "respond", "375" )' aria-label='Reply to Chris'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-emtucifor bypostauthor even thread-even depth-1" id="comment-1135">
				<div id="div-comment-1135" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1135">
			May 9, 2012 at 4:36 pm</a>		</div>

		<p>Hi Chris,</p>
<p>Thanks for commenting.</p>
<p>Since the time of writing this article, I&#8217;ve come to realize that directly using COM objects in SQL Server via the SP_OA procedures is problematic. There can be serious memory leaks, plus there are issues surrounding in-process DLLs running (I think they could take down the SQL server if they had a severe enough error).</p>
<p>About your specific question, I can see what you mean. I had truly never desired before to get deep into manipulating long text strings, and I didn&#8217;t understand until now that READTEXT is not a function and does not return a value, thus can&#8217;t be used in an expression. It is a statement that generates a *rowset* consisting of a single column and row. You could put READTEXT in a stored procedure, &#8216;then INSERT Table EXEC YourSP&#8217;, then read from the table, but this would be silly indirection when you could just read your original table to begin with. So, forget readtext and just use the Substring function to get any 8000-character chunk of your text column (the position parameter can be greater than 8000). But, you&#8217;re still stuck with how to get the entire value into the object&#8217;s property.</p>
<p>If you absolutely must persist with SP_OA and can&#8217;t use one of my ideas below, then I can only think to use dynamic SQL to accomplish the property setting. You would declare 10-20 variables and stuff each of them with a piece of a single statement that sets the property, something like:</p>
<p>DECLARE @SQL1 nvarchar(4000), @SQL2 nvarchar(4000) &#8230;;</p>
<p>SET @SQL1 = Replace(Substring(BodyColumn, 1, 3500) &#8221;&#8221;&#8221;, &#8221;&#8221;)<br />
FROM YourTable WHERE EmailID = @EmailIDParameter;<br />
&#8212; need room for single quotes to turn into double quotes</p>
<p>SET @SQL2 = Replace(Substring(BodyColumn, 3501, 3500) &#8221;&#8221;&#8221;, &#8221;&#8221;)<br />
FROM YourTable WHERE EmailID = @EmailIDParameter;</p>
<p>&#8230;</p>
<p>EXEC sp_executesql N&#8217;EXEC @ReturnCode = SP_OASETPROPERTY @CDOMessage, &#8221;HtmlBody&#8221;, &#8221;&#8217; + @SQL1 + @SQL2 + @SQL3 + &#8230; + @SQL19 + @SQL20 + &#8221;&#8221;, N&#8217;@CDOMessage int, @ReturnCode int OUTPUT&#8217;, @CDOMessage, @ReturnCode OUTPUT;</p>
<p>However, this is really, really painful. Instead, I recommend that you put your email contents into a table, then use any programming language you desire to poll the database every few seconds and look for a new email with a query like the following:</p>
<p>BEGIN TRAN;<br />
SELECT TOP 1 @EmailID = EmailID<br />
FROM dbo.PendingEmail WITH (UPDLOCK, HOLDLOCK, READPAST)<br />
WHERE E.Status = &#8216;Ready&#8217;;</p>
<p>UPDATE dbo.PendingEmail<br />
SET E.Status = &#8216;In Process&#8217;<br />
WHERE E.EmailID = @EmailID;</p>
<p>SELECT * FROM dbo.PendingEmail<br />
WHERE E.EmailID = @EmailID;<br />
COMMIT TRAN;</p>
<p>(Bote: this is script that will work with SQL 2000. For SQL 2005 you can switch to varchar(max) and be done already, but if you were to use this method in SQL 2005 you could just update with an OUTPUT clause all in one statement.)</p>
<p>The recordset will ahve all the email properties and can be easily used to do the COM object manipulation and email sending. Some versions of classic ADO may need to use GetChunk to pull in those text column values, but it can be done.</p>
<p>As for other alternates, you might consider looking into the built in DBMail, or the older mail function in SQL Server (can&#8217;t remember its name now). Also, some research into SQL Server Service Broker could be useful to you, as an alternate means of posting messages to a service that it needs to handle some new email.</p>
<p>VBScript can even be run as a job inside of SQL Server.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1135#respond' onclick='return addComment.moveForm( "div-comment-1135", "1135", "respond", "375" )' aria-label='Reply to Erik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1139">
				<div id="div-comment-1139" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1c0a3b2f486df66d5b5d4828d871fb5c?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1c0a3b2f486df66d5b5d4828d871fb5c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Joshua Magsino</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1139">
			January 16, 2013 at 8:06 pm</a>		</div>

		<p>I dont know if you will read this but, dude, thanks for the info! i need this especially that my query is at 16000+ characters and i need to create a dynamic query for it! thanks a bunch!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1139#respond' onclick='return addComment.moveForm( "div-comment-1139", "1139", "respond", "375" )' aria-label='Reply to Joshua Magsino'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1140">
				<div id="div-comment-1140" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1c0a3b2f486df66d5b5d4828d871fb5c?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1c0a3b2f486df66d5b5d4828d871fb5c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Joshua Magsino</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1140">
			January 16, 2013 at 8:13 pm</a>		</div>

		<p>Just a follow up question, why do you not recommend using this type of query?</p>
<p>    DECLARE<br />
       @SQL1 varchar(8000),<br />
       @SQL2 varchar(8000),<br />
       @SQL3 varchar(8000),<br />
       @SQL4 varchar(8000)</p>
<p>    SET @SQl1 = &#8216;8000 characters here&#8217;<br />
    SET @SQl2 = &#8216;8000 characters here&#8217;<br />
    SET @SQl3 = &#8216;8000 characters here&#8217;<br />
    SET @SQl4 = &#8216;8000 characters here&#8217;</p>
<p>    EXEC (@SQL1 + @SQL2 + @SQL3 + @SQL4)</p>
<p>
could i do something similar using sp_executesql</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1140#respond' onclick='return addComment.moveForm( "div-comment-1140", "1140", "respond", "375" )' aria-label='Reply to Joshua Magsino'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-emtucifor bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1147">
				<div id="div-comment-1147" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#comment-1147">
			January 27, 2013 at 3:40 pm</a>		</div>

		<p>Joshua,</p>
<p>I recommend against it because it&#8217;s very difficult to maintain. And filling these strings is quite problematic if they are coming from a query.</p>
<p>Let&#8217;s say you are writing an instead-of trigger to run against a table with 100 columns. You only get 80 characters per column&#8211;including all the rest of the script&#8211;to fit it in 8000 characters. That is *not* going to happen, especially if there is any complexity to the query. Now, I&#8217;ve written scripts that dealt with this by repeating the SQL-generation multiple times (taking each next chunk each time) but oh, how so unmaintainable and error-prone that is.</p>
<p>I&#8217;m glad to have varchar(max) in SQL 2005, and hope to never go back.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/?replytocom=1147#respond' onclick='return addComment.moveForm( "div-comment-1147", "1147", "respond", "375" )' aria-label='Reply to Erik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-2000-when-8000-characters-is-not-eno/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='375' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="9bf31c7ff062936a96d3c8bd1f8f2ff3"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552766788"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
