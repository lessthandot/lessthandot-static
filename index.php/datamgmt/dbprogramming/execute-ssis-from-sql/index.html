<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Run SSIS Package from Stored Procedure</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Run SSIS Package from Stored Procedure" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="There are a few methods to execute a SQL Server Integration Services (SSIS) package from T-SQL.  Very often the use of xp_cmdshell is the first choice to accomplish this task.  Xp_cmdshell has primarily been a system administration extended stored procedure.  Many types of extended stored procedures such as this one are meant for tasks that are either manual or very refined and controlled tasks.  This is all due to the requirements of the levels of sysadmin roles - or CONTROL SERVER to be exact.  Further on this topic, xp_cmdshell is disabled by default because it has been a known attack method.  Having the ability to execute xp_cmdshell exposes operating system level access.  In worst case scenarios, the SQL Server Service account is also a domain account with either Domain Admin rights or rights to other resources on the domain that are sensitive or open to damaging effects to the business.  To expose xp_cmdshell then opens one of the highest security risks relating to SQL Server." />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Run SSIS Package from Stored Procedure Comments Feed" href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='What am I thankful for?' href='/index.php/itprofessionals/professionaldevelopment/sql-thank-you/' />
<link rel='next' title='Exploring Reactive Extensions &#8211; Adding a Dash of Linq' href='/index.php/desktopdev/mstech/exploring-reactive-extensions-adding-a-d/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/" />
<link rel='shortlink' href='/?p=960' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fexecute-ssis-from-sql%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbprogramming%2Fexecute-ssis-from-sql%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/desktopdev/mstech/exploring-reactive-extensions-adding-a-d/" rel="next">Exploring Reactive Extensions &#8211; Adding a Dash of Linq</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/itprofessionals/professionaldevelopment/sql-thank-you/" rel="prev">What am I thankful for?</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/" class="post-title">Run SSIS Package from Stored Procedure</a></h1>
					<div class="post-byline">by <a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)" rel="author">Ted Krueger (onpnt)</a> on November 29, 2010 in category <a href="/index.php/category/datamgmt/dbadmin/" rel="category tag">Database Administration</a> <a href="/index.php/category/datamgmt/dbprogramming/" rel="category tag">Database Programming</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a> <a href="/index.php/category/datamgmt/dbadmin/mssqlserveradmin/" rel="category tag">Microsoft SQL Server Admin</a>. Article views: 34,405 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&text=RT @LessThanDot Blog - Run SSIS Package from Stored Procedure by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&title=Run SSIS Package from Stored Procedure&source=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&title=Run SSIS Package from Stored Procedure" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&quote=Run SSIS Package from Stored Procedure" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&title=Run SSIS Package from Stored Procedure" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>There are a few methods to execute a SQL Server Integration Services (SSIS) package from T-SQL.  Very often the use of xp_cmdshell is the first choice to accomplish this task.  Xp_cmdshell has primarily been a system administration extended stored procedure.  Many types of extended stored procedures such as this one are meant for tasks that are either manual or very refined and controlled tasks.  This is all due to the requirements of the levels of sysadmin roles &#8211; or CONTROL SERVER to be exact.  Further on this topic, xp_cmdshell is disabled by default because it has been a known attack method.  Having the ability to execute xp_cmdshell exposes operating system level access.  In worst case scenarios, the SQL Server Service account is also a domain account with either Domain Admin rights or rights to other resources on the domain that are sensitive or open to damaging effects to the business.  To expose xp_cmdshell then opens one of the highest security risks relating to SQL Server. </p>
<p>SSIS execution has many options.  DTEXEC is a very common command line method to executing any DTSX file (SSIS Package) and has a vast amount of control with the ability of switches to set conditional values given the executing circumstances.  DTEXEC can be manually executed from an OS level perspective.  This leads to xp_cmdshell and a number one method of execution solution.  However, the security risks apply once xp_cmdshell is enabled to accomplish this.  Securing this method can be accomplished with steps to either secure the calling account to limited domain access.  Another problem often arises in the needs of the SSIS processing itself.  SSIS packages are often developed for the primary use of importing, transforming and inserting data from a wide range of sources that are not SQL Server.  These sources may include files such as csv or txt, Excel and other Office Application files, Database servers like Oracle, DB2 or MySQL, Flat File or Desktop Database Applications: MS Access, FoxPro, Dbase.</p>
<p>Using the calling account with heightened security rights fixes the problem of access.  Pushing the security away from the calling method and into the SSIS Package itself is often a secure and internal controlling method.  The reasoning for this is the internal settings we can use to encrypt and otherwise promote other resources of securing sensitive data.  Using the SQL Server Agent we can also utilize a built in structure to directly call SSIS packages.  This requires the need to allow the Agent Service account the access we require.  This is typically a much more controlled account that is only allowed access to areas that are designated to accomplish jobs defined by business needs or system processing needs.  Going further, controlling the execution by use of proxy accounts can restrict access only to executing the SSIS packages and thus passing the proxy account to be authenticated to either directory services, executables outside SQL Server or database access.</p>
<p>To show this alternative and possibly more secure solution to executing an SSIS package from a stored procedure, the outlined process below can be used as a guideline.  The process consists of a data flow task that will consume the results of a stored procedure and pump them into a table.  The database being utilized will be AdventureWorks and the version of SQL Server is 2008 R2.  </p>
<p>The diagram below shows the flow of the starting point being the agent execution, step execution containing the SSIS package and then ending on the success and normal logging of the agent services.</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_2.gif" alt="" title="" width="432" height="454" /></div>
<p>The SSIS package flow itself will follow the following chart</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_3.gif" alt="" title="" width="402" height="332" /></div>
<p><strong>Setting up a proxy for SSIS</strong></p>
<p>In preparation for setting the procedure to call the agent job, we need to create a proxy account.  Setting up a proxy account to be used for calling a step a SQL Server Agent job starts with the creation of credentials in SQL Server.<br />
A credential can be created with SSMS or T-SQL.  With T-SQL, the CREATE CREDENTIAL statement is used.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> CREDENTIAL EmpImportUser <span class="kw1">WITH</span> <span class="kw1">IDENTITY</span> <span class="sy0">=</span><span class="st0">'EmpImportUser'</span>
,SECRET <span class="sy0">=</span> <span class="st0">'EmployeeImportAccount'</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE CREDENTIAL EmpImportUser WITH IDENTITY ='EmpImportUser'
,SECRET = 'EmployeeImportAccount'
GO</pre></div></div>

<p>In SSMS, right click the Credentials tree under Security and select New Credential. </p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_4.gif" alt="" title="" width="309" height="193" /></div>
<p>The minimum requirement for the creation of a credential is the name and Windows identity that it will map to and store the password.</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_5.gif" alt="" title="" width="628" height="254" /></div>
<p>The Credential is then utilized in the creation of the proxy account so the step in the job can be executed under the context of the credential with the stored password.  </p>
<p>Adding a proxy can be accomplished with SSMS and T-SQL as well.  With T-SQL, the sp_add_proxy procedure is executed with mapping to the credential.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXEC</span> msdb.<span class="me1">dbo</span>.<span class="me1">sp_add_proxy</span> @proxy_name<span class="sy0">=</span>N<span class="st0">'ImportUser'</span>,@credential_name<span class="sy0">=</span>N<span class="st0">'ImportUser'</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; @enabled<span class="sy0">=</span><span class="nu0">1</span>
GO
&nbsp;
<span class="kw1">EXEC</span> msdb.<span class="me1">dbo</span>.<span class="me1">sp_grant_proxy_to_subsystem</span> @proxy_name<span class="sy0">=</span>N<span class="st0">'ImportUser'</span>, @subsystem_id<span class="sy0">=</span><span class="nu0">11</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXEC msdb.dbo.sp_add_proxy @proxy_name=N'ImportUser',@credential_name=N'ImportUser', 
		@enabled=1
GO

EXEC msdb.dbo.sp_grant_proxy_to_subsystem @proxy_name=N'ImportUser', @subsystem_id=11
GO</pre></div></div>

<p>With SSMS, right click the Proxies tree under the SQL Server Agent section</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_6.gif" alt="" title="" width="317" height="170" /></div>
<p>Ensure that the subsystem for this proxy is mapped to SSIS.  </p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_7.gif" alt="" title="" width="628" height="449" /></div>
<p>Now complete the security setup by creating the login for machinenameImportUser with mappings to the AdventureWorks database.  Later, we will grant the necessary permissions to the database and tables.  The ImportUser login also needs to be mapped to MSDB and added to the db_ssisoperator role to allow the acount to execute SSIS packages.</p>
<p><strong>SSIS Package Creation</strong></p>
<p>Recall from the SSIS diagram in the beginning of this article that the package that will be used consists of an Execute SQL Task to ensure the table is dropped and recreated, the Data Flow Task consisting of a source and destination.  Once the SQL Task is successful, the precedence moves to a single Data Flow task and so on.  In order to make this flexible in changing the value and retaining the security we require a SQL Server Table configuration to be used in the SSIS package.  A variable will be created named ID and will hold the value of the EmployeeID that we request.  This will be used later when we show the creation of the procedure to call this process itself.  This variable will be held in the configuration so we can access the value and update it by means of T-SQL UPDATE statements.  This method allows the updating of the ID in the agent job by means of an UPDATE statement and securing down to the table level itself.</p>
<p>Another variable will act as the SqlCommand of the source in the data flow task.  This will allow the dynamic setting of the parameter in the SqlCommand value of the source.  Without the SqlCommand being formed at run-time, the statement would not be able to maintain a changing parameter for EmployeeID.  This would then make the execution of the procedure limiting and unusable when parameters are required.</p>
<p>The Execute SQL Task will be a direct input of the following statement</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="de1"><pre class="de1"><span class="kw1">IF</span> <span class="kw2">OBJECT_ID</span><span class="br0">&#40;</span><span class="st0">'dbo.EmpManagers'</span><span class="br0">&#41;</span> <span class="kw1">IS</span> <span class="sy0">NULL</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp; <span class="kw1">CREATE</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>EmpManagers<span class="br0">&#93;</span><span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span>RecursionLevel<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">int</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>EmployeeID<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">int</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>FirstName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>LastName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>ManagerID<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">int</span><span class="br0">&#93;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>ManagerFirstName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>ManagerLastName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">nvarchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span><span class="br0">&#41;</span>
<span class="kw1">END</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">IF OBJECT_ID('dbo.EmpManagers') IS NULL
BEGIN
	CREATE TABLE [dbo].[EmpManagers](
	[RecursionLevel] [int] NULL,
	[EmployeeID] [int] NULL,
	[FirstName] [nvarchar](50) NULL,
	[LastName] [nvarchar](50) NULL,
	[ManagerID] [int] NULL,
	[ManagerFirstName] [nvarchar](50) NULL,
	[ManagerLastName] [nvarchar](50) NULL)
END</pre></div></div>

<p>This statement checks if the table exists.  If the table does not, it will be created.  So this required CREATE TABLE rights to our user as well.  If the create failed for any reason, a failed precedence would be used to handle the event along with event handlers.  </p>
<p>Once the Execute SQL Task is successful, the flow moves to the Data Flow Task.  Initially, the ADO.NET Source takes a SqlCommand of<br />
EXEC dbo.uspGetEmployeeManagers @EmployeeID=4</p>
<p>This will allow the mappings to be performed before we add the expression to build the execute procedure statement at run-time.</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_8.gif" alt="" title="" width="387" height="278" /></div>
<p>The ADO.NET Destination now can point directly to the table, &#8220;dbo&#8221;.&#8221;EmpManagers&#8221;.<br />
Once the Execute SQL Task and Data Flow Task are completed, move to create the variables for EmployeeID and SqlCmd.<br />
EmployeeID will be named ID and a data type of Int32 matching the INT parameter data type in the procedure uspGetExployeeManagers.  The SqlCmd variable will be a string data type and hold the following expression:<br />
&#8220;EXEC dbo.uspGetEmployeeManagers @EmployeeID=&#8221; +  (DT_WSTR, 10) @[User::ID]<br />
If the variable has the value 4 preset, this expression evaluated will result in:<br />
EXEC dbo.uspGetEmployeeManagers @EmployeeID=5</p>
<p><strong>Package Configuration</strong></p>
<p>Package configurations assist SSIS in becoming reusable and dynamic.  They also are used to secure sensitive data such as passwords, data sources and user accounts.  For our use, the ID variable will be held in a SQL Server Table Configuration.  Many configuration types exist.  XML File for example can be used to hold configurations in an XML formatted file.  This however will mean we need added security to that file itself.  In this process we are attempting to secure this calling method as far as we can.  Taking the file aspect out of the equation helps us do this.  </p>
<p>To see how to create a configuration file follow the steps outlined here.</p>
<p>Below shows a select of the table after completing the creation of the SQL Server Table Configuration.</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_9.gif" alt="" title="" width="628" height="151" /></div>
<p><strong>The SQL Agent Job</strong></p>
<p>SQL Agent Jobs can be created with T-SQL and SSMS.  SSMS is a good control to use for agent jobs as you do not gain much in configurations with using the T-SQL procedures themselves.  The use of the procedures is good when SSMS is not an option or has failed.</p>
<p>To create the job to call the SSIS package, right click the Jobs node in the SQL Agent tree and select, New Job.</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_10.gif" alt="" title="" width="372" height="118" /></div>
<p>The name of our job will be CallSSIS and will consist of one step.  The step will be a SQL Server Integration Services type and connect to the instance that the package created earlier was deployed to.  Recall the proxy account that was created earlier was named, ImportUser.  This proxy account should be selected as the Run as account.</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_11.gif" alt="" title="" width="400" height="195" /></div>
<p>Once this is completed, save the job.  Executing the job at this point is a good idea to ensure no problems exist.  This allows for troubleshooting internal problems either to the security of the proxy account or the SSIS package itself.  Adding the procedure to call the job at this point without testing the job would add a level to the process that would increase the difficulty of troubleshooting any problems.</p>
<p><strong>The controlling procedure</strong></p>
<p>Now that all of the pieces have been created the procedure that will perform the actual execution of the SSIS package by means of starting the SQL Agent job itself can be created.</p>
<p>To start a job from T-SQL the system procedure sp_start_job is used.  Sp_start_job takes several parameters as we can see below</p>
<blockquote><p>Execute sp_start_job<br />
     {   [@job_name =] &#8216;job_name&#8217;<br />
       | [@job_id =] job_id }<br />
     [ , [@error_flag =] error_flag]<br />
     [ , [@server_name =] &#8216;server_name&#8217;]<br />
     [ , [@step_name =] &#8216;step_name&#8217;]<br />
     [ , [@output_flag =] output_flag]</p></blockquote>
<p>To successfully call sp_start_job, we are only required the job name or job id.  The remaining parameters can be left NULL.  So to call the CallSSIS job the execute statement would be:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">Exec</span> msdb.<span class="me1">dbo</span>.<span class="kw3">sp_start_job</span> @job_name <span class="sy0">=</span> N<span class="st0">'CallSSIS'</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Exec msdb.dbo.sp_start_job @job_name = N'CallSSIS'</pre></div></div>

<p>Note that the parameters are in Unicode and should be converted as such.</p>
<p>With any statement, error handling should be used.  In this example, adding the TRY…CATCH and utilizing RAISERROR can be used to handle exceptions in the execution of sp_start_job.</p>
<p>The complete stored procedure, CallUpEmpCheck, would be as follows</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>CallUpEmpCheck<span class="br0">&#93;</span> 
<span class="br0">&#40;</span>@ID <span class="kw1">INT</span> <span class="sy0">=</span> <span class="sy0">NULL</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
&nbsp; &nbsp; <span class="kw1">IF</span> @ID <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> &nbsp;
&nbsp; &nbsp; &nbsp;<span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">UPDATE</span> dbo.<span class="br0">&#91;</span>SSIS Configurations<span class="br0">&#93;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> ConfiguredValue <span class="sy0">=</span> @ID
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> PackagePath <span class="sy0">=</span> <span class="st0">'Package.Variables[User::ID].Properties[Value]'</span>;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Exec</span> msdb.<span class="me1">dbo</span>.<span class="kw3">sp_start_job</span> @job_name <span class="sy0">=</span> N<span class="st0">'CallSSIS'</span>;
&nbsp; &nbsp; &nbsp;<span class="kw1">END</span>
&nbsp; &nbsp; <span class="kw1">ELSE</span>
&nbsp; &nbsp; &nbsp;<span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">RAISERROR</span><span class="br0">&#40;</span><span class="st0">'Send right to catch!'</span>,<span class="nu0">16</span>,<span class="nu0">1</span><span class="br0">&#41;</span>;
&nbsp; &nbsp; &nbsp;<span class="kw1">END</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE [dbo].[CallUpEmpCheck] 
(@ID INT = NULL)
AS
    IF @ID IS NOT NULL  
	 BEGIN
		UPDATE dbo.[SSIS Configurations]
		SET ConfiguredValue = @ID
		WHERE PackagePath = 'Package.Variables[User::ID].Properties[Value]';
		Exec msdb.dbo.sp_start_job @job_name = N'CallSSIS';
	 END
	ELSE
	 BEGIN
	    RAISERROR('Send right to catch!',16,1);
	 END</pre></div></div>

<p>Once the procedure is created we are ready to execute and test the process completely through.  Note that the UPDATE statement has been added to the procedure to ensure the EmplyeeID that we pass is updated in the configuration table.</p>
<p><strong>Security</strong></p>
<p>Earlier the ImportUser login was created and added to the operator role for SSIS in order to execute SSIS packages.  In order to work with the tables in this process further right must be granted.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1"><span class="kw1">GRANT</span> <span class="kw1">UPDATE</span> <span class="kw1">ON</span> dbo.<span class="br0">&#91;</span>SSIS Configurations<span class="br0">&#93;</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>ONPNT_XPSImportUser<span class="br0">&#93;</span>
<span class="kw1">GRANT</span> <span class="kw1">INSERT</span> <span class="kw1">ON</span> dbo.<span class="me1">EmpManagers</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>ONPNT_XPSImportUser<span class="br0">&#93;</span>
<span class="kw1">GRANT</span> <span class="kw1">SELECT</span> <span class="kw1">ON</span> dbo.<span class="me1">EmpManagers</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>ONPNT_XPSImportUser<span class="br0">&#93;</span>
<span class="kw1">GRANT</span> <span class="kw1">CREATE</span> <span class="kw1">TABLE</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>ONPNT_XPSImportUser<span class="br0">&#93;</span>
<span class="kw1">GRANT</span> <span class="kw1">EXECUTE</span> <span class="kw1">ON</span> dbo.<span class="me1">uspGetEmployeeManagers</span> <span class="kw1">TO</span> <span class="br0">&#91;</span>ONPNT_XPSImportUser<span class="br0">&#93;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">GRANT UPDATE ON dbo.[SSIS Configurations] TO [ONPNT_XPSImportUser]
GRANT INSERT ON dbo.EmpManagers TO [ONPNT_XPSImportUser]
GRANT SELECT ON dbo.EmpManagers TO [ONPNT_XPSImportUser]
GRANT CREATE TABLE TO [ONPNT_XPSImportUser]
GRANT EXECUTE ON dbo.uspGetEmployeeManagers TO [ONPNT_XPSImportUser]</pre></div></div>

<p>This may seem like a lot of security for this user and in the context of AdventureWorks, CREATE TABLE is a higher level setting.  When we put this into perspective to the SQL Server and even the context of AdventureWorks, the security is restricted to the configuration table, which is only damaging on execution of the SSIS package.  Then the SELECT rights due to the SSIS processing in the data flow task and the INSERT.  These are limited to the EmpManagers table which is related (in our demo) to the one user run processing.  The user at that point is owner of that table and process.  So we secured to a point much more controlled than the alternatives of SQL Server level rights by moving down to table rights and procedure execution rights.</p>
<p><strong>Execution of the work</strong></p>
<p>Executing this setup is the final test. Use the following execute procedure statement to start the process</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXEC</span> dbo.<span class="br0">&#91;</span>CallUpEmpCheck<span class="br0">&#93;</span> @ID <span class="sy0">=</span> <span class="nu0">5</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXEC dbo.[CallUpEmpCheck] @ID = 5</pre></div></div>

</p>
<p>The resulting message in the query window will be:</p>
<blockquote><p>(1 row(s) affected)<br />
Job &#8216;CallSSIS&#8217; started successfully.</p></blockquote>
<p>The first message is from the update to the configuration table and the second message is returned from the sp_start_job execution.</p>
<p>Validating the data has been inserted into the EmpManagers table:</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/callssisfromproc_12.gif" alt="" title="" width="622" height="260" /></div>
<p><strong>The downfall</strong></p>
<p>There is an obvious problem with this method.  Error handling the call itself to SSIS is difficult.  The options to handle this are to verify the logging from the SSIS execution, the SQL Agent job logs them or push event handlers in the SSIS package itself to have a much more dominant role in the handling of a failed execution.  As long as we capture the starting point of execution (the procedure), the middle tier of the process (the AW procedure) and the final stage of the insertion of the data, we accomplish the task.  </p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/ssis-configuration-editor/'>SQL Server Integration Services tools to have – Configuration File Editor</a><p>In a previous post, SQL Server Integration Services tools to have – Expression Editor &amp;&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/list-all-stored-procedures-that/'>List all stored procedures that run at startup in SQL Server</a><p>You know that you can mark a proc to run at startup in SQL Server.&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Ted Krueger is a SQL Server MVP and Author that has been working in development and database administration and the owner of a successful consulting business, DataMetrics Consulting.  Specialties range from High Availability and Disaster / Recovery setup and testing methods down to custom assembly development for SQL Server Reporting Services.  Ted blogs and is also one of the founders of LessThanDot.com technology community.  Some of the articles focused on are Backup / Recovery, Security, SSIS and working on SQL Server and using all of the SQL Server features available to create stable and scalable database services.  <br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/onpnt" title="onpnt at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=https://www.facebook.com/onpntfirearms" title="onpnt at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/pub/ted-krueger/2/183/b66" title="onpnt at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://www.datametricsconsulting.com/" title="onpnt at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="/index.php/author/onpnt/feed/" title="Blog RSS feed for onpnt" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 34,405 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/onpnt/">Read More Posts by Ted Krueger (onpnt)</a>
						</div>
					</div>
					<div>
						<label>Tags:</label> <a href="/index.php/tag/sql-server-2008/" rel="tag">sql server 2008</a>, <a href="/index.php/tag/sql-server-integration-services/" rel="tag">sql server integration services</a>, <a href="/index.php/tag/ssis-2/" rel="tag">ssis</a> 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&text=RT @LessThanDot Blog - Run SSIS Package from Stored Procedure by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&title=Run SSIS Package from Stored Procedure&source=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&title=Run SSIS Package from Stored Procedure" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&quote=Run SSIS Package from Stored Procedure" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/&title=Run SSIS Package from Stored Procedure" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		5 Comments	</h4>
			<ol class="comments-list">
					<li class="comment even thread-even depth-1" id="comment-3396">
				<div id="div-comment-3396" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/05eb1a75467975d114393531e800d20c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/05eb1a75467975d114393531e800d20c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">ArthurZ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/#comment-3396">
			November 29, 2010 at 8:23 am</a>		</div>

		<p>An excellent post, it must help many visiting the MSDN SSIS Forum to cope with this endeavor more easily, thank you.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/?replytocom=3396#respond' onclick='return addComment.moveForm( "div-comment-3396", "3396", "respond", "960" )' aria-label='Reply to ArthurZ'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-3397">
				<div id="div-comment-3397" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/#comment-3397">
			November 29, 2010 at 8:52 am</a>		</div>

		<p>Thanks, Arthur!  🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/?replytocom=3397#respond' onclick='return addComment.moveForm( "div-comment-3397", "3397", "respond", "960" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-3399">
				<div id="div-comment-3399" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e16aa62ffde37f3ca96dce956bc96238?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e16aa62ffde37f3ca96dce956bc96238?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Michael</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/#comment-3399">
			December 2, 2010 at 10:02 pm</a>		</div>

		<p>I wish there was an easy way to start a SQL Agent job and wait for it complete along with the information about if it was successful or errored out.</p>
<p>That is the main reason we still use xp_cmdshell</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/?replytocom=3399#respond' onclick='return addComment.moveForm( "div-comment-3399", "3399", "respond", "960" )' aria-label='Reply to Michael'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-3400">
				<div id="div-comment-3400" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4d823d62ca8202c0c036c192a2b7fc19?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4d823d62ca8202c0c036c192a2b7fc19?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/#comment-3400">
			July 7, 2011 at 11:06 am</a>		</div>

		<p>Hello Ted,</p>
<p>I have a doubt&#8230; as far as I know, if I execute the sp start_job will only start the job, but will not wait until the finish of the execution . Do you know a &#8220;work around&#8221; to force the sp to wait until the end of the process?</p>
<p>Thanks in advance.</p>
<p>Regards</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/?replytocom=3400#respond' onclick='return addComment.moveForm( "div-comment-3400", "3400", "respond", "960" )' aria-label='Reply to Chris'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-3398">
				<div id="div-comment-3398" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/d9e262684ee2fad088c049f8ed438e01?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/d9e262684ee2fad088c049f8ed438e01?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">dave</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/#comment-3398">
			May 21, 2012 at 1:09 am</a>		</div>

		<p>Hi Ted, Chris</p>
<p>Chris I need to do the same as you. That is I need to kick off a job, monitor status and returns sucess/faliure all within a storepd proc. Any help would be greatly appreciated.</p>
<p>dave</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/?replytocom=3398#respond' onclick='return addComment.moveForm( "div-comment-3398", "3398", "respond", "960" )' aria-label='Reply to dave'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/dbprogramming/execute-ssis-from-sql/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='960' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="d840cc5d906c3e9c84374c8919d2074e"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765779"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
