<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   SQL Server &#8211; Set based random numbers</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   SQL Server &#8211; Set based random numbers" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="It's not often that we (as programmers) need random numbers, especially from a database.  When you are testing your queries for performance, it's best to use a large table to do it.  Sometimes you just don't have access to a large table to test with, so&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; SQL Server &#8211; Set based random numbers Comments Feed" href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Sharing ASP.net Session State Between Web Applications With SQL Server &#8211; Part I' href='/index.php/webdev/serverprogramming/aspnet/sharing-asp-net-session-state-between-we/' />
<link rel='next' title='Sharing ASP.net Session State Between Applications with SQL Server &#8211; Part II' href='/index.php/webdev/serverprogramming/aspnet/sharing-asp-net-session-state-between-ap/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/" />
<link rel='shortlink' href='/?p=298' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fsql-server-set-based-random-numbers%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fsql-server-set-based-random-numbers%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/webdev/serverprogramming/aspnet/sharing-asp-net-session-state-between-ap/" rel="next">Sharing ASP.net Session State Between Applications with SQL Server &#8211; Part II</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/webdev/serverprogramming/aspnet/sharing-asp-net-session-state-between-we/" rel="prev">Sharing ASP.net Session State Between Web Applications With SQL Server &#8211; Part I</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/" class="post-title">SQL Server &#8211; Set based random numbers</a></h1>
					<div class="post-byline">by <a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)" rel="author">George Mastros (gmmastros)</a> on January 24, 2009 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a> <a href="/index.php/category/datamgmt/dbprogramming/" rel="category tag">Database Programming</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 62,301 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&text=RT @LessThanDot Blog - SQL Server &amp;#8211; Set based random numbers by @gmmastros" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&title=SQL Server &amp;#8211; Set based random numbers&source=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&title=SQL Server &amp;#8211; Set based random numbers" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&quote=SQL Server &amp;#8211; Set based random numbers" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&title=SQL Server &amp;#8211; Set based random numbers" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>It&#8217;s not often that we (as programmers) need random numbers, especially from a database.  When you are testing your queries for performance, it&#8217;s best to use a large table to do it.  Sometimes you just don&#8217;t have access to a large table to test with, so you may think about creating many rows in your existing table.</p>
<p>SQL Server has a rand() function that will return a random (fractional) number between 0 and 1.<br />
For example:</p>
<pre>Select Rand()
--	0.686350654426017</pre>
<p>The problem with the rand function occurs when you use set based operations.</p>
<pre>Select Rand() As RandomNumber
From   (Select 1 As NUM Union All
        Select 2 Union All
        Select 3) As Alias</pre>
<pre>RandomNumber
----------------------
0.920057583532051
0.920057583532051
0.920057583532051</pre>
<p>Not very random, is it?  I mean, the number is random, but it&#8217;s also the same for each row.  The purpose of this blog is to demonstrate how to get a random value in set based operations.</p>
<p>There is an interesting technique that you can use to accomplish this.  There is a NewId() function in SQL Server that returns a GUID, for example: &#8216;94344EE4-5D7A-45EB-9EBC-7A596B7F90F3&#8217;. NewId does work well for set based operations, for example:</p>
<pre>Select Rand() As RandomNumber, NewId() As GUID
From   (Select 1 As NUM Union All
        Select 2 Union All
        Select 3) As Alias</pre>
<pre>RandomNumber           GUID
---------------------- ------------------------------------
0.130542187318667      D12D6274-CB93-4CDB-B848-9F0FA8B88614
0.130542187318667      C708217F-5204-4284-B76B-A55D87BEFBC0
0.130542187318667      B42D7973-B3E2-420F-8D4D-DC72442D0824</pre>
<p>Notice that the &#8216;Random Number&#8217; column is the same for each row, but the GUID column is different.  We can use this interesting fact to generate random numbers by combining this with another function available in SQL Server.  The CHECKSUM function will return an integer hash value based on its argument.  In this case, we can pass in a GUID, and checksum will return an integer.</p>
<pre>Select Rand() As RandomNumber, 
       NewId() As GUID, 
       Checksum(NewId()) As RandomInteger
From   (Select 1 As NUM Union All
        Select 2 Union All
        Select 3) As Alias</pre>
<pre>RandomNumber           GUID                                 RandomInteger
---------------------- ------------------------------------ --------------
0.152440960483059      CDEB9F5D-E8A2-4FC7-A5A4-0E0A9CCF9786     84,364,212
0.152440960483059      9ABCEC8F-6C0C-4CEF-BA16-E8F0B50FB399 -1,317,220,961
0.152440960483059      6BD23217-F3FF-4F19-AA7F-C127CA7A4763    976,389,102</pre>
<p>Before we continue, let&#8217;s take a look at the output, because there are some interesting observations that we need to consider before continuing. RandomInteger can be positive or negative because it&#8217;s limited to the range of an integer, so the values must fall between -2,147,483,648 and 2,147,483,647.  </p>
<p>Most of the time, we want a random number within a certain range of numbers.  In most languages, we simply multiply the result of the Rand() function to get this number.  Since our RandomInteger is already a whole number, we really can&#8217;t do this. However, we could use the mod operator to guarantee a range of numbers.  Mod is the remainder of a division operation, so if we mod a number by 10, we are guaranteed to get a number between -9 and +9.  Unfortunately, this is a little misleading because there are 19 possible numbers we can get for this.  So, to make sure we get a range to 10 numbers, we need to take the absolute value of the number, and then mod 10.  Like this:</p>
<pre>Select Rand() As RandomNumber, 
       NewId() As GUID, 
       Abs(Checksum(NewId())) % 10 As RandomInteger
From   (Select 1 As NUM Union All
        Select 2 Union All
        Select 3) As Alias</pre>
<pre>RandomNumber           GUID                                 RandomInteger
---------------------- ------------------------------------ -------------
0.490769895131745      8237A3F3-98C6-4B31-8F4B-8A80ECC8FBFF 1
0.490769895131745      C231EB65-FA81-4536-B909-44FEC91953D9 9
0.490769895131745      F0AD28C5-8AE4-46A1-B8AC-D8C9F90A5747 4</pre>
<p>Now, we are guaranteed to get a Random number between 0 and 9. Suppose you want to get a random number between 10 and 15.  The range of numbers is 6 (10,11,12,13,14,15).  The mod value for this needs to be 6, to get a number in the range of 0 to 5.  Then, we add 10 to the result to get a number in the range of 10 to 15.</p>
<p>If you want to generate a random number between -5 and 5, donâ€™t be tempted to remove the absolute value function, because you will get numbers that appears to be random, but are not &#8216;as random&#8217; as they should be.  </p>
<p>In my database, I have a numbers table with 1,000,000 rows.  When I run this code:</p>
<pre>Select	RandomNumber, Count(*) As NumberCount
From	(
		Select Checksum(NewId()) % 6 As RandomNumber
		From Numbers
		) As A
Group By RandomNumber
Order By RandomNumber</pre>
<pre>RandomNumber NumberCount
------------ -----------
-5           83539
-4           83443
-3           83372
-2           82931
-1           82950
0            166254
1            83207
2            83635
3            83741
4            83417
5            83511</pre>
<p>Notice that 0 has double the number of occurrences.  Instead, we should write it like this:</p>
<pre>Select	RandomNumber, Count(*) As NumberCount
From	(
		Select Abs(Checksum(NewId())) % 11 - 5 As RandomNumber
		From Numbers
		) As A
Group By RandomNumber
Order By RandomNumber</pre>
<pre>RandomNumber NumberCount
------------ -----------
-5           90889
-4           90794
-3           91365
-2           90476
-1           91104
0            90730
1            90895
2            90815
3            90762
4            91133
5            91037</pre>
<p>Notice now that the values are &#8216;more&#8217; random than the previous version (where 0 had double the number of occurrences).  Since we are talking about random numbers, we wouldn&#8217;t expect there to be the same number of occurrences for each number, but with the previous version, there were double the number of zero&#8217;s, which isn&#8217;t truly random.  This version has approximately the same number of zero&#8217;s as any other number, making it &#8216;more random&#8217;.</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/scripting-data-in-sql-server/'>Scripting data in SQL Server 2012</a><p>SQL Server 2008 has the Generate Scripts option inside the script wizard. In SQL Server&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-server-extracting-data-again/'>SQL Server Extracting Data (again)</a><p>In a recent article, I explained how to extract numbers from a string. This blog&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>George has been developing software professionally for 19 years, first for the department of defense, and then for various other companies.  In 1998, George started his software company, Orbit Software, specializing in School Bus Transportation software.  His specialty is refining SQL Server queries to deliver optimal performance.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/gmmastros" title="gmmastros at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="/index.php/author/gmmastros/feed/" title="Blog RSS feed for gmmastros" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 62,301 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/gmmastros/">Read More Posts by George Mastros (gmmastros)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&text=RT @LessThanDot Blog - SQL Server &amp;#8211; Set based random numbers by @gmmastros" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&title=SQL Server &amp;#8211; Set based random numbers&source=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&title=SQL Server &amp;#8211; Set based random numbers" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&quote=SQL Server &amp;#8211; Set based random numbers" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/&title=SQL Server &amp;#8211; Set based random numbers" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		19 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-SQLDenis even thread-even depth-1" id="comment-738">
				<div id="div-comment-738" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-738">
			January 24, 2009 at 1:53 pm</a>		</div>

		<p>Interesting, why are you doing the % 11 &#8211; 5 part?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=738#respond' onclick='return addComment.moveForm( "div-comment-738", "738", "respond", "298" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-odd thread-alt depth-1 parent" id="comment-739">
				<div id="div-comment-739" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-739">
			January 24, 2009 at 1:57 pm</a>		</div>

		<p>Because there are 11 possible numbers between -5 and 5.  Since I am taking the absolute value, you get a range between 0 and 10, subtract 5 and your range becomes -5 to 5.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=739#respond' onclick='return addComment.moveForm( "div-comment-739", "739", "respond", "298" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-5571377">
				<div id="div-comment-5571377" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e3dc1048a4544fa269b7c129cea7a167?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e3dc1048a4544fa269b7c129cea7a167?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://koolzers.net/' rel='external nofollow' class='url'>Igor</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-5571377">
			March 21, 2017 at 1:05 pm</a>		</div>

		<p>Because SQLDenis does not know the sequence of math operations ðŸ™‚</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=5571377#respond' onclick='return addComment.moveForm( "div-comment-5571377", "5571377", "respond", "298" )' aria-label='Reply to Igor'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-740">
				<div id="div-comment-740" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/446ef649682b154e3f80ceb742fe030d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/446ef649682b154e3f80ceb742fe030d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.webdigi.co.uk/' rel='external nofollow' class='url'>Web</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-740">
			January 26, 2009 at 1:11 pm</a>		</div>

		<p>great tip.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=740#respond' onclick='return addComment.moveForm( "div-comment-740", "740", "respond", "298" )' aria-label='Reply to Web'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-737">
				<div id="div-comment-737" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/cf49e9312610d33ba94da14c3a5a9b40?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/cf49e9312610d33ba94da14c3a5a9b40?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jackie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-737">
			May 11, 2009 at 7:20 am</a>		</div>

		<p>very very helpful!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=737#respond' onclick='return addComment.moveForm( "div-comment-737", "737", "respond", "298" )' aria-label='Reply to Jackie'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-734">
				<div id="div-comment-734" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a809e27e754144c2e12e16a2e43dc6d6?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a809e27e754144c2e12e16a2e43dc6d6?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.campuscollusion.com/' rel='external nofollow' class='url'>Bud</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-734">
			November 18, 2009 at 7:13 am</a>		</div>

		<p>Great, this is exactly what i needed to server up questions in a random order.  Thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=734#respond' onclick='return addComment.moveForm( "div-comment-734", "734", "respond", "298" )' aria-label='Reply to Bud'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-odd thread-alt depth-1" id="comment-735">
				<div id="div-comment-735" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-735">
			November 18, 2009 at 9:52 am</a>		</div>

		<p>Great blog, thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=735#respond' onclick='return addComment.moveForm( "div-comment-735", "735", "respond", "298" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-742">
				<div id="div-comment-742" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2c498c8f8cb51e270788c406aa3382ce?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2c498c8f8cb51e270788c406aa3382ce?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.impactscs.com/' rel='external nofollow' class='url'>Jack Tipsword</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-742">
			March 12, 2010 at 5:48 am</a>		</div>

		<p>Using your technique I created a trigger on a table that I needed a random password for. The trigger is in SQL Server 2008. For this application I didn&#8217;t need a strong password so this solution worked very well.</p>
<p>Here is the code</p>
<p>CREATE TRIGGER [dbo].[trg_tblResponsesPW]<br />
   ON  [dbo].[tblResponses]<br />
   AFTER INSERT<br />
AS <br />
BEGIN</p>
<p>DECLARE 	<br />
		@MyCursor CURSOR,<br />
		@intID int,<br />
		@PW varchar (8)</p>
<p>	&#8212; SET NOCOUNT ON added to prevent extra result sets from<br />
	&#8212; interfering with SELECT statements.<br />
	SET NOCOUNT ON;</p>
<p>	SET @MyCursor = CURSOR FAST_FORWARD <br />
	FOR <br />
	SELECT intID FROM inserted</p>
<p>	&#8212; Loop through each record in the inserted table to get the unique ID field. In each loop update the table <br />
	&#8212; that the record was appended to with a new random password. I loop here so that when bulk inserts occur each new record get&#8217;s it&#8217;s own unique password</p>
<p>	OPEN @MyCursor <br />
	FETCH NEXT FROM @MyCursor <br />
	&#8212; Populate the variables with the values from the SQL Statement<br />
	INTO @intID</p>
<p>	WHILE @@FETCH_STATUS = 0 <br />
	BEGIN </p>
<p>		&#8212; The NewId function returns a GUID Like &#8220;D12D6274-CB93-4CDB-B848-9F0FA8B88614&#8221;. Here I pull the 6 characters<br />
		&#8212; from the right but I could pull from anywhere or pull any number of characters depending on how long I wanted<br />
		&#8212; my password to be.<br />
		SET @PW = Right(NewID(),6)</p>
<p>		UPDATE tblResponses<br />
		SET txtPW = @PW<br />
		WHERE (intID = @intID)</p>
<p>	&#8212; Now we are finished doing the work so move to the next inserted record<br />
	FETCH NEXT FROM @MyCursor <br />
	&#8212; and populate the next variable<br />
	INTO @intID</p>
<p>END </p>
<p>CLOSE @MyCursor <br />
DEALLOCATE @MyCursor 	</p>
<p>END</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=742#respond' onclick='return addComment.moveForm( "div-comment-742", "742", "respond", "298" )' aria-label='Reply to Jack Tipsword'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-736">
				<div id="div-comment-736" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7e453e874d95315c5578a6ec90887d2f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7e453e874d95315c5578a6ec90887d2f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">David Manheim</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-736">
			March 8, 2011 at 7:26 am</a>		</div>

		<p>The ABS(CHECKSUM(NewId())) is less random than is needed for some applications. There is an article that can be found online describing the differences in how &#8220;random&#8221; the different techniques are: Random Sampling in T-SQL<br />
by Brian Connolly.</p>
<p>An alternative in terms of generating the numbers so that the same is not returned multiple times, is described well in an article &#8220;Returning Random Numbers in a SELECT statement&#8221; on Jeff&#8217;s SQL Server Blog, on the Sqlteam web site.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=736#respond' onclick='return addComment.moveForm( "div-comment-736", "736", "respond", "298" )' aria-label='Reply to David Manheim'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-741">
				<div id="div-comment-741" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7b035b4c2c4f496fba692a1699306362?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7b035b4c2c4f496fba692a1699306362?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.jwt.com/' rel='external nofollow' class='url'>Phoenix</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-741">
			April 6, 2011 at 5:11 pm</a>		</div>

		<p>Thanks for posting this.  In my case, I needed to fill a map table with random IDs from other tables.  I was able to adapt your technique to achieve what I needed (identifiers munged):</p>
<p>DECLARE @count INT<br />
SET @count = (SELECT COUNT(*) FROM [ProductType])</p>
<p>INSERT INTO [ProductTypeMap]<br />
(<br />
	[ProductId],<br />
	[ProductTypeId],<br />
)<br />
SELECT<br />
	[p].[ProductId],<br />
	[t].[ProductTypeId]<br />
FROM<br />
  (<br />
    SELECT<br />
      [ProductId],<br />
      (ABS(CHECKSUM(NEWID())) % @count + 1) AS [RowNumber]<br />
    FROM<br />
      [Product]<br />
  ) AS [p]<br />
LEFT JOIN<br />
  (<br />
    SELECT<br />
      [ProductTypeId],<br />
      (ROW_NUMBER() OVER (ORDER BY [ProductTypeId])) AS [RowNumber]<br />
    FROM<br />
      [ProductType]<br />
  ) AS [p]<br />
  ON ([t].[RowNumber] = [p].[RowNumber])</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=741#respond' onclick='return addComment.moveForm( "div-comment-741", "741", "respond", "298" )' aria-label='Reply to Phoenix'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1 parent" id="comment-743">
				<div id="div-comment-743" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/269416e87ce431d0e572cd6259281b60?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/269416e87ce431d0e572cd6259281b60?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">ac_in_Philadelphia</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-743">
			July 17, 2013 at 12:16 pm</a>		</div>

		<p>This worked for me great.   I just wanted to convert the integer returned by Checksum into a value from 0 to 1 so I could have a function similar to Rand() for which I came up with:<br />
&#8212;&#8212;&#8211;<br />
create function my_rand(@in_id uniqueidentifier)<br />
returns float as<br />
begin<br />
declare @x int = checksum(@in_id) <br />
declare @v float = 2147483647<br />
return (@x + @v + 1) / (2 * @v + 1)<br />
end<br />
&#8212;&#8212;&#8211;<br />
This returns 0 for the min value of an integer and 1 for the max, with everything else in between.<br />
Then I use this as select my_rand(newid())&#8230; <br />
This blog was awesome!!!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=743#respond' onclick='return addComment.moveForm( "div-comment-743", "743", "respond", "298" )' aria-label='Reply to ac_in_Philadelphia'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-5310880">
				<div id="div-comment-5310880" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/295f0d427a1d2a81cc165af791ec74ac?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/295f0d427a1d2a81cc165af791ec74ac?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">JDF</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-5310880">
			October 17, 2016 at 10:03 am</a>		</div>

		<p>newid() cannot be called from a function.  Please let me know if there is a way to get a random number generated in a function</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=5310880#respond' onclick='return addComment.moveForm( "div-comment-5310880", "5310880", "respond", "298" )' aria-label='Reply to JDF'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1666985">
				<div id="div-comment-1666985" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/bfd50df851d0ce3f16781606d836927e?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/bfd50df851d0ce3f16781606d836927e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ramesh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-1666985">
			August 25, 2014 at 3:09 am</a>		</div>

		<p>How can i get without duplicate values in generating random numbers by using abs(checksum(newid()))%1000 + 5000</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=1666985#respond' onclick='return addComment.moveForm( "div-comment-1666985", "1666985", "respond", "298" )' aria-label='Reply to Ramesh'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-3214139">
				<div id="div-comment-3214139" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://sevennet.org/2014/12/22/how-to-how-do-i-generate-random-number-for-each-row-in-a-tsql-select/' rel='external nofollow' class='url'>How to: How do I generate random number for each row in a TSQL Select? | SevenNet</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-3214139">
			December 22, 2014 at 3:27 am</a>		</div>

		<p>[&#8230;] a look at SQL Server &#8211; Set based random numbers which has a very detailed [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=3214139#respond' onclick='return addComment.moveForm( "div-comment-3214139", "3214139", "respond", "298" )' aria-label='Reply to How to: How do I generate random number for each row in a TSQL Select? | SevenNet'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-5310886">
				<div id="div-comment-5310886" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/295f0d427a1d2a81cc165af791ec74ac?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/295f0d427a1d2a81cc165af791ec74ac?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">J Geils</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-5310886">
			October 17, 2016 at 10:05 am</a>		</div>

		<p>NEWID() cannot be in a function.  I wonder if there is a way to generate a random number using something like this from a function.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=5310886#respond' onclick='return addComment.moveForm( "div-comment-5310886", "5310886", "respond", "298" )' aria-label='Reply to J Geils'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt depth-2" id="comment-5310900">
				<div id="div-comment-5310900" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-5310900">
			October 17, 2016 at 10:21 am</a>		</div>

		<p>You can create a view that returns NewId, and then a function that returns from the view.</p>
<p>Create View vwGuid<br />
AS<br />
Select NewId() As NewId<br />
GO<br />
Create Function GetNewId()<br />
Returns UniqueIdentifier<br />
As<br />
Begin<br />
	Return (Select NewId From vwGuid)<br />
End<br />
GO<br />
Select dbo.GetNewId()</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=5310900#respond' onclick='return addComment.moveForm( "div-comment-5310900", "5310900", "respond", "298" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="pingback even thread-odd thread-alt depth-1" id="comment-5657266">
				<div id="div-comment-5657266" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.codingblog.cn/blog/61618.html' rel='external nofollow' class='url'>æˆ‘å¦‚ä½•ä¸ºæ¯ä¸€è¡Œç”Ÿæˆéšæœºæ•°åœ¨TSQLé€‰æ‹©ï¼Ÿ &#8211; CodingBlog</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-5657266">
			May 21, 2017 at 4:00 pm</a>		</div>

		<p>[&#8230;] a look at SQL Server &#8211; Set based random numbers which has a very detailed [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=5657266#respond' onclick='return addComment.moveForm( "div-comment-5657266", "5657266", "respond", "298" )' aria-label='Reply to æˆ‘å¦‚ä½•ä¸ºæ¯ä¸€è¡Œç”Ÿæˆéšæœºæ•°åœ¨TSQLé€‰æ‹©ï¼Ÿ &#8211; CodingBlog'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback odd alt thread-even depth-1" id="comment-5904841">
				<div id="div-comment-5904841" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://questionfocus.com/how-do-i-generate-random-number-for-each-row-in-a-tsql-select.html' rel='external nofollow' class='url'>How do I generate random number for each row in a TSQL Select? - QuestionFocus</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-5904841">
			November 25, 2017 at 12:09 am</a>		</div>

		<p>[&#8230;] a look at SQL Server &#8211; Set based random numbers which has a very detailed [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=5904841#respond' onclick='return addComment.moveForm( "div-comment-5904841", "5904841", "respond", "298" )' aria-label='Reply to How do I generate random number for each row in a TSQL Select? - QuestionFocus'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-6059275">
				<div id="div-comment-6059275" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7b4401367c87a331ef3c6044950e66c6?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7b4401367c87a331ef3c6044950e66c6?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ion Lesan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#comment-6059275">
			March 28, 2018 at 11:35 am</a>		</div>

		<p>I guess you could just do RAND(Checksum(NewId()))</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/?replytocom=6059275#respond' onclick='return addComment.moveForm( "div-comment-6059275", "6059275", "respond", "298" )' aria-label='Reply to Ion Lesan'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/sql-server-set-based-random-numbers/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='298' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="d7a728a67d909e714c0774e22cb806f2"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765991"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
