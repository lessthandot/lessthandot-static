<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&#8217;t, it doesn&#8217;t perform</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&#8217;t, it doesn&#8217;t perform" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="You see this kind of question all the time in newsgroups/forums, someone wants to return all the rows if nothing is passed in or just the rows that match the variable when something is passed in. Usually someone will reply with a suggestion to do someth&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&#8217;t, it doesn&#8217;t perform Comments Feed" href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='LessThanDot Sponsors SQL Saturday in Chicago' href='/index.php/itprofessionals/ethicsit/give-me-more-ltd/' />
<link rel='next' title='The Measurement of Success – SQL Saturday Chicago' href='/index.php/itprofessionals/ethicsit/my-singing-not-so-good/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/" />
<link rel='shortlink' href='/?p=711' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fdo-you-use-column-param-or-param-is-null%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fdo-you-use-column-param-or-param-is-null%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/itprofessionals/ethicsit/my-singing-not-so-good/" rel="next">The Measurement of Success – SQL Saturday Chicago</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/itprofessionals/ethicsit/give-me-more-ltd/" rel="prev">LessThanDot Sponsors SQL Saturday in Chicago</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/" class="post-title">Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&#8217;t, it doesn&#8217;t perform</a></h1>
					<div class="post-byline">by <a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis" rel="author">SQLDenis</a> on April 15, 2010 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a> <a href="/index.php/category/datamgmt/dbprogramming/" rel="category tag">Database Programming</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 72,440 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&text=RT @LessThanDot Blog - Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217... by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&title=Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217;t, it doesn&amp;#8217;t perform&source=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&title=Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217;t, it doesn&amp;#8217;t perform" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&quote=Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217;t, it doesn&amp;#8217;t perform" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&title=Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217;t, it doesn&amp;#8217;t perform" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>You see this kind of question all the time in newsgroups/forums, someone wants to return all the rows if nothing is passed in or just the rows that match the variable when something is passed in. Usually someone will reply with a suggestion to do something like this</p>
<p>WHERE (SomeColumn=@col OR @col IS NULL)</p>
<p>The problem with that approach is that it doesn&#8217;t perform well, let&#8217;s take a look, first create this table</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="de1"><pre class="de1"><span class="kw1">USE</span> tempdb
GO
&nbsp;
&nbsp;
&nbsp;
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> Test<span class="br0">&#40;</span>SomeCol1 <span class="kw1">INT</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>, Somecol2 <span class="kw1">INT</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> Test
<span class="kw1">SELECT</span> number,low <span class="kw1">FROM</span> master..<span class="me1">spt_values</span>
<span class="kw1">WHERE</span> TYPE <span class="sy0">=</span> <span class="st0">'p'</span>
&nbsp;
&nbsp;
<span class="kw1">CREATE</span> <span class="kw1">INDEX</span> ix_test <span class="kw1">ON</span> Test<span class="br0">&#40;</span>Somecol2<span class="br0">&#41;</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">USE tempdb
GO



CREATE TABLE Test(SomeCol1 INT NOT NULL, Somecol2 INT NOT NULL)

INSERT Test
SELECT number,low FROM master..spt_values
WHERE TYPE = 'p'


CREATE INDEX ix_test ON Test(Somecol2)
GO</pre></div></div>

<p>Here is the query that uses the method described before, I am using AND 1=1 so that this query will match the one I will show later</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @col <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @col <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">SELECT</span> SomeCol2 
<span class="kw1">FROM</span> Test
<span class="kw1">WHERE</span> <span class="nu0">1</span> <span class="sy0">=</span><span class="nu0">1</span>
<span class="sy0">AND</span> &nbsp;<span class="br0">&#40;</span>SomeCol2<span class="sy0">=</span>@col <span class="sy0">OR</span> @col <span class="kw1">IS</span> <span class="sy0">NULL</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @col INT
SELECT @col = 1

SELECT SomeCol2 
FROM Test
WHERE 1 =1
AND  (SomeCol2=@col OR @col IS NULL)</pre></div></div>

<p>Here is the query using dynamic SQL</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="de1"><pre class="de1">GO
&nbsp;
<span class="kw1">DECLARE</span> @col <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @col <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">DECLARE</span> @<span class="kw1">SQL</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> <span class="st0">'SELECT SomeCol2 </span>
<span class="st0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM Test</span>
<span class="st0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE 1 =1'</span>
&nbsp;
<span class="kw1">IF</span> @col <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> 
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> @<span class="kw1">SQL</span> <span class="sy0">+</span> <span class="st0">' AND SomeCol2=@InnerParamcol '</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; 
&nbsp; &nbsp; 
<span class="kw1">EXEC</span> <span class="kw3">sp_executesql</span> @<span class="kw1">SQL</span>,N<span class="st0">'@InnerParamcol INT'</span>,@col</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">GO

DECLARE @col INT
SELECT @col = 1

DECLARE @SQL NVARCHAR(4000)
    SET @SQL = 'SELECT SomeCol2 
				FROM Test
				WHERE 1 =1'

IF @col IS NOT NULL 
    SET @SQL = @SQL + ' AND SomeCol2=@InnerParamcol '
    
    
    
EXEC sp_executesql @SQL,N'@InnerParamcol INT',@col</pre></div></div>

<p>Now let&#8217;s run these queries and take a look at the reads</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SET</span> <span class="kw1">STATISTICS</span> IO <span class="kw1">ON</span>
GO
&nbsp;
<span class="kw1">DECLARE</span> @col <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @col <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">SELECT</span> SomeCol2 
<span class="kw1">FROM</span> Test
<span class="kw1">WHERE</span> <span class="nu0">1</span> <span class="sy0">=</span><span class="nu0">1</span>
<span class="sy0">AND</span> &nbsp;<span class="br0">&#40;</span>SomeCol2<span class="sy0">=</span>@col <span class="sy0">OR</span> @col <span class="kw1">IS</span> <span class="sy0">NULL</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
&nbsp;
&nbsp;
GO
&nbsp;
<span class="kw1">DECLARE</span> @col <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @col <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">DECLARE</span> @<span class="kw1">SQL</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> <span class="st0">'SELECT SomeCol2 </span>
<span class="st0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FROM Test</span>
<span class="st0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE 1 =1'</span>
&nbsp;
<span class="kw1">IF</span> @col <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span> 
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> @<span class="kw1">SQL</span> <span class="sy0">+</span> <span class="st0">' AND SomeCol2=@InnerParamcol '</span>
&nbsp; &nbsp; 
&nbsp; &nbsp; 
&nbsp; &nbsp; 
<span class="kw1">EXEC</span> <span class="kw3">sp_executesql</span> @<span class="kw1">SQL</span>,N<span class="st0">'@InnerParamcol INT'</span>,@col
&nbsp;
<span class="kw1">SET</span> <span class="kw1">STATISTICS</span> IO <span class="kw1">OFF</span>
GO</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SET STATISTICS IO ON
GO

DECLARE @col INT
SELECT @col = 1

SELECT SomeCol2 
FROM Test
WHERE 1 =1
AND  (SomeCol2=@col OR @col IS NULL)




GO

DECLARE @col INT
SELECT @col = 1

DECLARE @SQL NVARCHAR(4000)
    SET @SQL = 'SELECT SomeCol2 
				FROM Test
				WHERE 1 =1'

IF @col IS NOT NULL 
    SET @SQL = @SQL + ' AND SomeCol2=@InnerParamcol '
    
    
    
EXEC sp_executesql @SQL,N'@InnerParamcol INT',@col

SET STATISTICS IO OFF
GO</pre></div></div>

<p><em>(8 row(s) affected)<br />
Table &#8216;Test&#8217;. Scan count 1, logical reads 6, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.</p>
<p>(8 row(s) affected)<br />
Table &#8216;Test&#8217;. Scan count 1, logical reads 2, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.</em></p>
<p>As you can see the dynamic SQL query only uses 2 reads where the other solution uses 6 reads.</p>
<p>Here is an image of the execution plan for both queries.</p>
<p><img src="/wp-content/uploads/blogs/DataMgmt/Plan.PNG" alt="" title="" width="607" height="312" /></p>
<p>The execution plan show that the dynamic SQL is using a seek where the other query is using a scan</p>
<p>As you can see, there is a place for dynamic SQL and if you use it correctly you will also get plan reuse, take a look at the post <a href="/index.php/DataMgmt/DataDesign/changing-exec-to-sp_executesql-doesn-t-p">Changing exec to sp_executesql doesn&#8217;t provide any benefit if you are not using parameters correctly</a> to find out how to use dynamic SQL correctly</p>
<p><strong>[EDIT]</strong></p>
<p>Someone on twitter suggested to try this query</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @col <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @col <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">SELECT</span> SomeCol2
<span class="kw1">FROM</span> Test
<span class="kw1">WHERE</span> <span class="nu0">1</span> <span class="sy0">=</span><span class="nu0">1</span>
<span class="sy0">AND</span> &nbsp;SomeCol2 <span class="sy0">=</span> isnull<span class="br0">&#40;</span>@col,SomeCol2<span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @col INT
SELECT @col = 1
 
SELECT SomeCol2
FROM Test
WHERE 1 =1
AND  SomeCol2 = isnull(@col,SomeCol2)</pre></div></div>

<p>That query also does an index scan.</p>
<p>Here is the execution plan in text for both of the queries that cause the scan</p>
<p>  |&#8211;Index Scan(OBJECT:([tempdb].[dbo].[Test].[ix_test]),<br />
 WHERE:([tempdb].[dbo].[Test].[Somecol2]=isnull([@col],[tempdb].[dbo].[Test].[Somecol2])))</p>
<p>  |&#8211;Index Scan(OBJECT:([tempdb].[dbo].[Test].[ix_test]),<br />
  WHERE:([tempdb].[dbo].[Test].[Somecol2]=[@col] OR [@col] IS NULL))</p>
<p>There was also a comment about recompiles, when you use sp_executesql you should not get recompiles when changing the value that you are passing in. I ran this query</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre></td><td class="de1"><pre class="de1">&nbsp;
<span class="kw1">DECLARE</span> @col <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @col <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
<span class="kw1">DECLARE</span> @<span class="kw1">SQL</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> <span class="st0">'SELECT SomeCol2</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FROM Test</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WHERE 1 =1'</span>
&nbsp;
<span class="kw1">IF</span> @col <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> @<span class="kw1">SQL</span> <span class="sy0">+</span> <span class="st0">' AND SomeCol2=@InnerParamcol '</span>
&nbsp; &nbsp;<span class="kw1">EXEC</span> <span class="kw3">SP_EXECUTESQL</span> @<span class="kw1">SQL</span>,N<span class="st0">'@InnerParamcol INT'</span>,@col 
&nbsp; &nbsp;Go
&nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; <span class="kw1">DECLARE</span> @col <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @col <span class="sy0">=</span> <span class="nu0">2</span>
&nbsp;
<span class="kw1">DECLARE</span> @<span class="kw1">SQL</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> <span class="st0">'SELECT SomeCol2</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FROM Test</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WHERE 1 =1'</span>
&nbsp;
<span class="kw1">IF</span> @col <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> @<span class="kw1">SQL</span> <span class="sy0">+</span> <span class="st0">' AND SomeCol2=@InnerParamcol '</span>
&nbsp; &nbsp;
&nbsp; &nbsp;<span class="kw1">EXEC</span> <span class="kw3">SP_EXECUTESQL</span> @<span class="kw1">SQL</span>,N<span class="st0">'@InnerParamcol INT'</span>,@col 
&nbsp; &nbsp;Go
&nbsp; &nbsp;
&nbsp; &nbsp;
&nbsp; &nbsp;<span class="kw1">DECLARE</span> @col <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @col <span class="sy0">=</span> <span class="nu0">3</span>
&nbsp;
<span class="kw1">DECLARE</span> @<span class="kw1">SQL</span> <span class="kw1">NVARCHAR</span><span class="br0">&#40;</span><span class="nu0">4000</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> <span class="st0">'SELECT SomeCol2</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FROM Test</span>
<span class="st0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WHERE 1 =1'</span>
&nbsp;
<span class="kw1">IF</span> @col <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
&nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">SQL</span> <span class="sy0">=</span> @<span class="kw1">SQL</span> <span class="sy0">+</span> <span class="st0">' AND SomeCol2=@InnerParamcol '</span>
&nbsp; &nbsp;
&nbsp; &nbsp;<span class="kw1">EXEC</span> <span class="kw3">SP_EXECUTESQL</span> @<span class="kw1">SQL</span>,N<span class="st0">'@InnerParamcol INT'</span>,@col 
&nbsp; &nbsp;Go
&nbsp; &nbsp;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse"> 
DECLARE @col INT
SELECT @col = 1
 
DECLARE @SQL NVARCHAR(4000)
    SET @SQL = 'SELECT SomeCol2
                FROM Test
                WHERE 1 =1'
 
IF @col IS NOT NULL
    SET @SQL = @SQL + ' AND SomeCol2=@InnerParamcol '
   EXEC SP_EXECUTESQL @SQL,N'@InnerParamcol INT',@col 
   Go
   
      
      
      DECLARE @col INT
SELECT @col = 2
 
DECLARE @SQL NVARCHAR(4000)
    SET @SQL = 'SELECT SomeCol2
                FROM Test
                WHERE 1 =1'
 
IF @col IS NOT NULL
    SET @SQL = @SQL + ' AND SomeCol2=@InnerParamcol '
   
   EXEC SP_EXECUTESQL @SQL,N'@InnerParamcol INT',@col 
   Go
   
   
   DECLARE @col INT
SELECT @col = 3
 
DECLARE @SQL NVARCHAR(4000)
    SET @SQL = 'SELECT SomeCol2
                FROM Test
                WHERE 1 =1'
 
IF @col IS NOT NULL
    SET @SQL = @SQL + ' AND SomeCol2=@InnerParamcol '
   
   EXEC SP_EXECUTESQL @SQL,N'@InnerParamcol INT',@col 
   Go
   </pre></div></div>

<p>And then I ran a trace checking for SQL:StmtRecompile</p>
<p><img src="/wp-content/uploads/blogs/DataMgmt/Profiler.PNG" alt="" title="" width="388" height="193" /></p>
<p>Here is the output from that trace</p>
<p><img src="/wp-content/uploads/blogs/DataMgmt/trace.PNG" alt="" title="" width="501" height="578" /></p>
<p><strong>[/EDIT]</strong></p>
<p>*** <strong>Remember, if you have a SQL related question, try our <a href="http://forum.lessthandot.com/viewforum.php?f=17">Microsoft SQL Server Programming</a> forum or our <a href="http://forum.lessthandot.com/viewforum.php?f=22">Microsoft SQL Server Admin</a> forum</strong><ins></ins></p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/changing-exec-to-sp_executesql-doesn-t-p/'>Changing exec to sp_executesql doesn't provide any benefit if you are not using parameters correctly</a><p>Changing exec to sp_executesql doesn't provide any benefit if you are not using parameters correctly&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/avoid-conversions-in-execution-plans-by/'>Avoid Conversions In Execution Plans By Using sp_executesql Instead of Exec</a><p>Yesterday in the Changing exec to sp_executesql doesn't provide any benefit if you are not&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2><img class="bioPic" src="http://www.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d.png" alt="User bio image"/>Denis has been working with SQL Server since version 6.5. Although he worked as an ASP/JSP/ColdFusion developer before the dot com bust, he has been working exclusively as a database developer/architect since 2002. In addition to English, Denis is also fluent in Croatian and Dutch, but he can curse in many other languages and dialects (just ask the SQL optimizer) He lives in Princeton, NJ with his wife and three kids.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/denisgobo" title="SQLDenis at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/denis.gobo" title="SQLDenis at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/in/denisgobo" title="SQLDenis at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://denisgobo.blogspot.com/" title="SQLDenis at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="http://www.flickr.com/photos/denisgobo//" title="SQLDenis at Flickr" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_flickr.png" alt="Flickr" /></a><a href="/index.php/author/SQLDenis/feed/" title="Blog RSS feed for SQLDenis" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 72,440 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/SQLDenis/">Read More Posts by SQLDenis</a>
						</div>
					</div>
					<div>
						<label>Tags:</label> <a href="/index.php/tag/performance/" rel="tag">performance</a>, <a href="/index.php/tag/pitfalls/" rel="tag">pitfalls</a>, <a href="/index.php/tag/sql-server-2000/" rel="tag">sql server 2000</a>, <a href="/index.php/tag/sql-server-2005/" rel="tag">sql server 2005</a>, <a href="/index.php/tag/sql-server-2008/" rel="tag">sql server 2008</a>, <a href="/index.php/tag/tip/" rel="tag">tip</a> 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&text=RT @LessThanDot Blog - Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217... by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&title=Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217;t, it doesn&amp;#8217;t perform&source=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&title=Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217;t, it doesn&amp;#8217;t perform" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&quote=Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217;t, it doesn&amp;#8217;t perform" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/&title=Do you use  Column=@Param OR @Param IS NULL in your WHERE clause? Don&amp;#8217;t, it doesn&amp;#8217;t perform" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		27 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-onpnt even thread-even depth-1" id="comment-2511">
				<div id="div-comment-2511" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2511">
			April 15, 2010 at 7:22 am</a>		</div>

		<p>This is excellent advice!  Personally can&#8217;t stand it when I see the OR&#8230;OR&#8230;.OR in statements.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2511#respond' onclick='return addComment.moveForm( "div-comment-2511", "2511", "respond", "711" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-2512">
				<div id="div-comment-2512" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2512">
			April 15, 2010 at 8:06 am</a>		</div>

		<p>Yes, also it is explained in here <a href="http://sqlinthewild.co.za/index.php/2009/03/19/catch-all-queries/">Catch All Queries</a></p>
<p>and in here<br />
<a href="http://www.sommarskog.se/dyn-search-2008.html">Dynamic Search query</a> &#8211; great article by Elrand Sommarskog</p>
<p>Great suggestion you can find in this MSDN thread<br />
<a href="http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/2a4d2538-524d-429d-a793-2c48ac763490/#b8c7d30a-42e9-4a51-979e-09da3938782c">How to optimize SQL for integer parameters</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2512#respond' onclick='return addComment.moveForm( "div-comment-2512", "2512", "respond", "711" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-ca8msm even thread-even depth-1 parent" id="comment-2513">
				<div id="div-comment-2513" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/ee635ec2753adf271fb8799287d3c04e?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/ee635ec2753adf271fb8799287d3c04e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">ca8msm</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2513">
			April 15, 2010 at 12:27 pm</a>		</div>

		<p>So what is the recommended alternative approach (without using dynamic sql)?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2513#respond' onclick='return addComment.moveForm( "div-comment-2513", "2513", "respond", "711" )' aria-label='Reply to ca8msm'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-naomi odd alt depth-2" id="comment-58754">
				<div id="div-comment-58754" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-58754">
			January 22, 2014 at 2:54 pm</a>		</div>

		<p>In SQL Server 2008 R2 and up add OPTION (RECOMPILE) to the query.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=58754#respond' onclick='return addComment.moveForm( "div-comment-58754", "58754", "respond", "711" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-odd thread-alt depth-1" id="comment-2514">
				<div id="div-comment-2514" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2514">
			April 15, 2010 at 12:32 pm</a>		</div>

		<p>The dynamic SQL with using sp_executesql and parameters (to prevent SQL injection) seems the cleanest/easiest to me</p>
<p>Otherwise you need to have a bunch of IF conditions, if you have 2 parameters it is pretty easy, if you have 8 or so it becomes a big pain in the neck</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2514#respond' onclick='return addComment.moveForm( "div-comment-2514", "2514", "respond", "711" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-chopstik odd alt thread-even depth-1" id="comment-2515">
				<div id="div-comment-2515" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/71ca157c955aa40109e67ef1e8c4aabd?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/71ca157c955aa40109e67ef1e8c4aabd?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">chopstik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2515">
			April 15, 2010 at 7:52 pm</a>		</div>

		<p>Thanks, Denis.  I&#8217;ve seen some examples of this and may have to point it out&#8230;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2515#respond' onclick='return addComment.moveForm( "div-comment-2515", "2515", "respond", "711" )' aria-label='Reply to chopstik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-thirster42 even thread-odd thread-alt depth-1" id="comment-2516">
				<div id="div-comment-2516" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/026f3abfbd6ac89b6dbabbd4cef2e83d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/026f3abfbd6ac89b6dbabbd4cef2e83d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">David Forck (thirster42)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2516">
			April 16, 2010 at 7:46 am</a>		</div>

		<p>can you provide an example of the dynamic query if you have, lets say 6, parameters?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2516#respond' onclick='return addComment.moveForm( "div-comment-2516", "2516", "respond", "711" )' aria-label='Reply to David Forck (thirster42)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-even depth-1" id="comment-2517">
				<div id="div-comment-2517" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2517">
			April 16, 2010 at 8:10 am</a>		</div>

		<p>Here is an example with 2 parameters, 6 would be the same, just add if conditions and the parameters at the end</p>
<p>
DECLARE @col INT<br />
SELECT @col = 1</p>
<p>DECLARE @col2 INT<br />
SELECT @col2 = 1</p>
<p>DECLARE @SQL NVARCHAR(4000)<br />
    SET @SQL = &#8216;SELECT SomeCol2<br />
                FROM Test<br />
                WHERE 1 =1&#8242;</p>
<p>IF @col IS NOT NULL<br />
    SET @SQL = @SQL + &#8216; AND SomeCol2=@InnerParamcol &#8216;</p>
<p> IF @col2 IS NOT NULL<br />
    SET @SQL = @SQL + &#8216; AND SomeCol1=@InnerParamcol2 &#8216; </p>
<p>EXEC SP_EXECUTESQL @SQL,N&#8217;@InnerParamcol INT,@InnerParamcol2 INT&#8217;,@col,@Col2</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-</p>
<p>You can also dump the parameters in a variable like this</p>
<p>DECLARE @col INT<br />
SELECT @col = 1</p>
<p>DECLARE @col2 INT<br />
SELECT @col2 = 1</p>
<p>DECLARE @SQL NVARCHAR(4000)<br />
    SET @SQL = &#8216;SELECT SomeCol2<br />
                FROM Test<br />
                WHERE 1 =1&#8242;</p>
<p>IF @col IS NOT NULL<br />
    SET @SQL = @SQL + &#8216; AND SomeCol2=@InnerParamcol &#8216;</p>
<p> IF @col2 IS NOT NULL<br />
    SET @SQL = @SQL + &#8216; AND SomeCol1=@InnerParamcol2 &#8216; </p>
<p> &#8211;param definition     <br />
 DECLARE @ParamDefinition NVARCHAR(500)<br />
 SELECT  @ParamDefinition = N&#8217;@InnerParamcol INT,@InnerParamcol2 INT&#8217;</p>
<p>EXEC SP_EXECUTESQL @SQL,@ParamDefinition,@col,@Col2</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2517#respond' onclick='return addComment.moveForm( "div-comment-2517", "2517", "respond", "711" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-2518">
				<div id="div-comment-2518" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/db590682519269cb307782dbc084f8c9?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/db590682519269cb307782dbc084f8c9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ivan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2518">
			April 17, 2010 at 5:20 pm</a>		</div>

		<p>With the static approach you should add OPTION(RECOMPILE) at the end. This will equalize the speed to the dynamic approach.</p>
<p>Note:<br />
This works for SQL Server 2008 RTM and SQL Server 2008 SP1 CU5 and on; it does not work for SQL Server 2008 SP1, nor does it do anything on SQL 2005!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2518#respond' onclick='return addComment.moveForm( "div-comment-2518", "2518", "respond", "711" )' aria-label='Reply to Ivan'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-2519">
				<div id="div-comment-2519" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1c0b60e2829f422a88e4fafa90a30c73?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1c0b60e2829f422a88e4fafa90a30c73?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Juliana</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2519">
			April 17, 2010 at 9:06 pm</a>		</div>

		<p>my question is about concurrency with dymanic queries, since procedures with dynamic queric inside are recompiled. Besides the reads are lesser the users are locked by other and the procedures take a long time. So, what aproach is better in this case?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2519#respond' onclick='return addComment.moveForm( "div-comment-2519", "2519", "respond", "711" )' aria-label='Reply to Juliana'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-odd thread-alt depth-1" id="comment-2520">
				<div id="div-comment-2520" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2520">
			April 18, 2010 at 5:29 am</a>		</div>

		<p>Juliana, Recompiles don&#8217;t happen when using sp_executesql </p>
<p>start up profiler and check for  SQL:StmtRecompile</p>
<p>I modified my blog post, see the added stuff</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2520#respond' onclick='return addComment.moveForm( "div-comment-2520", "2520", "respond", "711" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola odd alt thread-even depth-1" id="comment-2521">
				<div id="div-comment-2521" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2521">
			April 19, 2010 at 4:46 am</a>		</div>

		<p>As usual &#8211; it depends&#8230;  </p>
<p>I can show you bunch of situations when (= or is null) will have exactly the same execution plan as execution of dynamic queries.</p>
<p>It depends on mandatory search conditions (if any) and their combinations. And also depends if you already have some of highly selective condition (covered by index) inside query. </p>
<p>Dynamic queries have no advantage for columns not covered by indexes (in fact they have a small disadvantage as they need more execution plans)</p>
<p>As you already know SQL server will ignore index if it is not selective enough or if it is more costly to use it than to perform scan (full or range). </p>
<p>Making dynamic query for gender (as an extreme case) is pointless &#8211; except you have filtered indexes for males and females. The same is valid for all fields with low number of different values &#8211; you don&#8217;t need dynamic query as it will not perform any better. </p>
<p>The problems with SQL Server are &#8211; you have to know your data and you have to know there&#8217;s no universal solution. I&#8217;m using both approaches &#8211; dynamic and Equal/IsNull &#8211; and very often mix of them. </p>
<p>Using WITH RECOMPILE option could be good solution for static one &#8211; but only and only if you don&#8217;t use that query very often.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2521#respond' onclick='return addComment.moveForm( "div-comment-2521", "2521", "respond", "711" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-odd thread-alt depth-1" id="comment-2522">
				<div id="div-comment-2522" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2522">
			April 19, 2010 at 4:52 am</a>		</div>

		<p>niikola, yes of course  🙂</p>
<p>That is why I showed an example where an index seek would happen, if you have a multi column index and you search on the last column in that index then no, it doesn&#8217;t matter since you will always get a scan</p>
<p>
And BTW I did see an index once on a bit column, it was on gender  🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2522#respond' onclick='return addComment.moveForm( "div-comment-2522", "2522", "respond", "711" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola odd alt thread-even depth-1" id="comment-2523">
				<div id="div-comment-2523" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2523">
			April 19, 2010 at 4:57 am</a>		</div>

		<p>That&#8217;s why I like filtered indexes so much &#8211; primary because of gender column 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2523#respond' onclick='return addComment.moveForm( "div-comment-2523", "2523", "respond", "711" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-2524">
				<div id="div-comment-2524" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/114ab62c5e8f9c0fff85a30ea2f9bd17?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/114ab62c5e8f9c0fff85a30ea2f9bd17?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jeff</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2524">
			April 19, 2010 at 7:29 am</a>		</div>

		<p>Have you considered changing your proc to have 2 different select statements, one for each case, rather than use Dynamic SQL?  </p>
<p>ie. instead of:<br />
  SELECT SomeCol2 <br />
  FROM Test<br />
  WHERE 1 =1<br />
  AND  (SomeCol2=@col OR @col IS NULL)</p>
<p>use:<br />
  if @Col is null<br />
     select SomeCol2 from Test where 1=1<br />
  else<br />
     select SomeCol2 from Test where 1=1 and SomeCol2=@col </p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2524#respond' onclick='return addComment.moveForm( "div-comment-2524", "2524", "respond", "711" )' aria-label='Reply to Jeff'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-even depth-1" id="comment-2525">
				<div id="div-comment-2525" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2525">
			April 19, 2010 at 7:47 am</a>		</div>

		<p>Jeff, yes for 1 parameter.variable I would do it like that. How would you do it for 2 or even 6 parameters? It becomes a pain and then if you want to add a column in the SELECT statement you have to add it in a lot of places. with dynamic SQL and 2 params, it would look like this</p>
<p>DECLARE @col INT<br />
SELECT @col = 1</p>
<p>DECLARE @col2 INT<br />
SELECT @col2 = 1</p>
<p>DECLARE @SQL NVARCHAR(4000)<br />
SET @SQL = &#8216;SELECT SomeCol2<br />
FROM Test<br />
WHERE 1 =1&#8242;</p>
<p>IF @col IS NOT NULL<br />
SET @SQL = @SQL + &#8216; AND SomeCol2=@InnerParamcol &#8216;</p>
<p>IF @col2 IS NOT NULL<br />
SET @SQL = @SQL + &#8216; AND SomeCol1=@InnerParamcol2 &#8216; </p>
<p>EXEC SP_EXECUTESQL @SQL,N&#8217;@InnerParamcol INT,@InnerParamcol2 INT&#8217;,@col,@Col2</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2525#respond' onclick='return addComment.moveForm( "div-comment-2525", "2525", "respond", "711" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-2526">
				<div id="div-comment-2526" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/362229514442cace1ca36b649ca049d7?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/362229514442cace1ca36b649ca049d7?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Terry</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2526">
			April 19, 2010 at 8:07 am</a>		</div>

		<p>The twittered suggestion:</p>
<p><code>&lt;br /&gt;
   1. DECLARE @col INT&lt;br /&gt;
   2. SELECT @col = 1&lt;br /&gt;
   3.  &lt;br /&gt;
   4. SELECT SomeCol2&lt;br /&gt;
   5. FROM Test&lt;br /&gt;
   6. WHERE 1 =1&lt;br /&gt;
   7. AND  SomeCol2 = isnull(@col,SomeCol2)&lt;/p&gt;
&lt;p&gt;</code></p>
<p>Does have a hidden gotcha in it.  This works fine if SomeCol2 does not have any NULLS in it.  If it has a NULL though, then this will not return those rows even if you want it to.</p>
<p>A question for others though.  How would you be able to write dynamic queries that work within SQL functions?</p>
<p>Have a good day.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2526#respond' onclick='return addComment.moveForm( "div-comment-2526", "2526", "respond", "711" )' aria-label='Reply to Terry'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor odd alt thread-even depth-1" id="comment-2527">
				<div id="div-comment-2527" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2527">
			April 19, 2010 at 8:26 am</a>		</div>

		<p>Terry, you could do dynamic SQL in functions with a loopback query but I would not recommend it since it opens up a connection for every time the function is called</p>
<p>Here is an example, so basically you open up another connection to the SQL box and then do your dynamic SQL but I am not sure that you can even use sp_executesql like that</p>
<p>
CREATE FUNCTION fnBla(@id int)<br />
RETURNS int<br />
AS<br />
BEGIN<br />
DECLARE @SQL varchar(500)<br />
SELECT @SQL = &#8216;osql -S&#8217; +@@servername +&#8217; -E -q &#8220;exec tempdb..prLog &#8221;fnBla&#8221;&#8221;&#8216;<br />
EXEC master..xp_cmdshell @SQL<br />
RETURN @id<br />
END</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2527#respond' onclick='return addComment.moveForm( "div-comment-2527", "2527", "respond", "711" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-odd thread-alt depth-1" id="comment-2529">
				<div id="div-comment-2529" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2529">
			April 25, 2010 at 12:56 am</a>		</div>

		<p>See also this thread <a href="http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/e80f2bae-76ee-4a41-ad32-57f18e0fd8e1">MSDN Thread</a> on the same topic.</p>
<p>Here is another blog on this topic <a href="http://www.sqlservercentral.com/articles/Dynamic+SQL/70109/">Dynamic SQL</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2529#respond' onclick='return addComment.moveForm( "div-comment-2529", "2529", "respond", "711" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-2528">
				<div id="div-comment-2528" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/217e49b9910813d6849d52d209d0b4cf?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/217e49b9910813d6849d52d209d0b4cf?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Andy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2528">
			June 1, 2010 at 8:39 pm</a>		</div>

		<p>When you parameter is Null, but the param value is still passed to the SP_EXECUTESQL, it says tehre are too many arguments specified. </p>
<p>In the dynamicly built sql with parameter , how can the value list also be dynamically built?</p>
<p>For exameple if I have multiple parameter built in the following way. <br />
IF @CC IS NOT NULL AND NOT @CC = 3<br />
BEGIN<br />
SET @SQL = @SQL + &#8216;AND <br />
	&#8212; Look for parameter value 1 on ReportLink table<br />
	( @CC1 = 1 AND (ReportLink.OrderingProvider IS NULL OR ReportLink.OrderingProvider =1 ))<br />
	&#8212; Look for parameter value 2 on ReportLink table<br />
	OR( @CC1 = 2 AND ReportLink.OrderingProvider = 0)&#8217;<br />
SET @PARAMS = @PARAMS + &#8216;,&#8217; + N&#8217;@CC1 INT&#8217;<br />
SET @VALUES = @VALUES + &#8216;,&#8217; + N&#8217;@CC&#8217;<br />
END</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2528#respond' onclick='return addComment.moveForm( "div-comment-2528", "2528", "respond", "711" )' aria-label='Reply to Andy'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-odd thread-alt depth-1" id="comment-2530">
				<div id="div-comment-2530" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2530">
			June 7, 2010 at 7:05 am</a>		</div>

		<p>How about</p>
<p>where Field = case when @Param IS NULL then Field else @Param end</p>
<p>in terms of performance (it will not work for Field IS NULL).</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2530#respond' onclick='return addComment.moveForm( "div-comment-2530", "2530", "respond", "711" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-emtucifor odd alt thread-even depth-1" id="comment-2508">
				<div id="div-comment-2508" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2508">
			October 18, 2010 at 10:19 am</a>		</div>

		<p>Ooohhhh&#8230; I just thought up an interesting possibility for how to handle this:</p>
<p>SELECT *<br />
FROM SomeTable<br />
WHERE<br />
   SomeCol BETWEEN Coalesce(@somecol, &#8216;a&#8217;) AND Coalesce(@somecol, &#8216;zzzzzzzz&#8217;)<br />
   AND AnotherCol BETWEEN Coalesce(@anothercol, 0) AND Coalesce(@anothercol, 2147483647)</p>
<p>What do you think?</p>
<p>I just realized this is only viable for columns that have an index and that index is used. Otherwise it probably will force a scan&#8230;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2508#respond' onclick='return addComment.moveForm( "div-comment-2508", "2508", "respond", "711" )' aria-label='Reply to Erik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-odd thread-alt depth-1" id="comment-2509">
				<div id="div-comment-2509" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2509">
			November 5, 2010 at 12:29 pm</a>		</div>

		<p>For integer columns it&#8217;s good (and recommended approach &#8211; see, for example, <a href="http://social.msdn.microsoft.com/Forums/en/databasedesign/thread/2c991301-5b80-454a-80d8-090a5a475643">Relevant MSDN forum&#8217;s thread</a></p>
<p>but I don&#8217;t think you can do a-z for characters. What if you store ** or something else there?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2509#respond' onclick='return addComment.moveForm( "div-comment-2509", "2509", "respond", "711" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-2507">
				<div id="div-comment-2507" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/244502d474a26d025df27523e5c57c54?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/244502d474a26d025df27523e5c57c54?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://bradsruminations.blogspot.com/' rel='external nofollow' class='url'>Brad Schulz</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2507">
			June 9, 2011 at 1:34 pm</a>		</div>

		<p>Just a followup&#8230;</p>
<p>Ivan already mentioned this in his comment over a year ago in April2010, but I&#8217;m surprised nobody remarked on it, because it is important:</p>
<p>Starting with SQL2008 SP1 CU5 (10.0.2746) or SQL2008R2 CU1 (10.50.1702), this kind of query IS optimizable, provided you have an OPTION (RECOMPILE) in the query.</p>
<p>So, for example, in using NorthWind&#8230;</p>
<p>DECLARE @customerid nchar(5)<br />
       ,@orderdate datetime<br />
       ,@employeeid int<br />
       ,@orderid int<br />
SET @customerid=N&#8217;CENTC&#8217;</p>
<p>SELECT OrderID,OrderDate,CustomerID,EmployeeID<br />
FROM Orders<br />
WHERE (CustomerID=@customerid or @customerid IS NULL)<br />
  AND (OrderID=@orderid or @orderid IS NULL)<br />
  AND (EmployeeID=@employeeid or @employeeid IS NULL)<br />
  AND (OrderDate=@orderdate or @orderdate IS NULL)<br />
OPTION (RECOMPILE)</p>
<p>If you execute this (in the appropriate SQL2008 Version) and show the Actual Execution Plan, you will see that it DOES use the CustomerID nonclustered index to directly SEEK for the CustomerID in question&#8230; the other predicates on OrderID, EmployeeID, and OrderDate are thrown out the window by the Query Optimizer.</p>
<p>If you execute the same query in SQL2005, it will SCAN the index and perform a filter on the other predicates.</p>
<p>&#8211;Brad</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2507#respond' onclick='return addComment.moveForm( "div-comment-2507", "2507", "respond", "711" )' aria-label='Reply to Brad Schulz'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-2510">
				<div id="div-comment-2510" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/76ac06034dfa008b346366bf15bf8d5c?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/76ac06034dfa008b346366bf15bf8d5c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Rishabh K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-2510">
			March 15, 2012 at 6:59 am</a>		</div>

		<p>I think optimizer going for index scan is due to the fact that it doesn&#8217;t know about the parameters at the query compilation so it is guessing(may be 30 % in this case).<br />
Option Recompile will work here and using dynamic sql is like using force optimization ON.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=2510#respond' onclick='return addComment.moveForm( "div-comment-2510", "2510", "respond", "711" )' aria-label='Reply to Rishabh K'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-52965">
				<div id="div-comment-52965" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/fc310fd393b7901fc3c4889921979d1b?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/fc310fd393b7901fc3c4889921979d1b?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Matt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-52965">
			January 21, 2014 at 7:12 pm</a>		</div>

		<p>I know this is old, but found this via the google.</p>
<p>Is there any difference to use a CASE statement instead of ISNULL?  ie:</p>
<p>Declare @col1 int;<br />
set @col1 = NULL;</p>
<p>select *<br />
from myTable<br />
where<br />
    fixedTestField is not null<br />
    and dynamicTestField =<br />
      case<br />
         when @col1 is not null then @col1<br />
         else dynamicTestField<br />
      end</p>
<p>from my simple test, both ISNULL and the CASE use clustered index scans.  the column in my dynamicTestField happens to be a Foreign Key, so I thought i&#8217;d see here what y&#8217;all thought.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=52965#respond' onclick='return addComment.moveForm( "div-comment-52965", "52965", "respond", "711" )' aria-label='Reply to Matt'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-odd thread-alt depth-1" id="comment-58741">
				<div id="div-comment-58741" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#comment-58741">
			January 22, 2014 at 2:51 pm</a>		</div>

		<p>Matt,</p>
<p>This will not work correctly if the DynamicTestField allows NULL.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/?replytocom=58741#respond' onclick='return addComment.moveForm( "div-comment-58741", "58741", "respond", "711" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/do-you-use-column-param-or-param-is-null/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='711' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="a5cdd4aa0048b187f7182f1b9ce7a6a7"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765628"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
