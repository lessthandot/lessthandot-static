<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Grid class that allows sorting by clicking on headers</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Grid class that allows sorting by clicking on headers" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Unlike the ASP.NET GridView Class, the Visual Foxpro native grid class does not provide a means for automatic sorting by clicking on the column header. Although there are several workarounds for this deficiency available (such as http://www.rcs-solution&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Grid class that allows sorting by clicking on headers Comments Feed" href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Using ASP to retrieve a recordset and return value from a stored procedure at the same time' href='/index.php/webdev/serverprogramming/classicasp/using-asp-to-retrieve-a-recordset-and-re/' />
<link rel='next' title='Recover a database without the ldf file' href='/index.php/datamgmt/dbprogramming/recover-a-database-without-the-ldf-file/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/" />
<link rel='shortlink' href='/?p=536' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fgrid-class-that-allows-sorting-by-clicki%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fgrid-class-that-allows-sorting-by-clicki%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbprogramming/recover-a-database-without-the-ldf-file/" rel="next">Recover a database without the ldf file</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/webdev/serverprogramming/classicasp/using-asp-to-retrieve-a-recordset-and-re/" rel="prev">Using ASP to retrieve a recordset and return value from a stored procedure at the same time</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/" class="post-title">Grid class that allows sorting by clicking on headers</a></h1>
					<div class="post-byline">by <a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky" rel="author">Naomi Nosonovsky</a> on August 10, 2009 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a>. Article views: 28,925 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&text=RT @LessThanDot Blog - Grid class that allows sorting by clicking on headers by naomi" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&title=Grid class that allows sorting by clicking on headers&source=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&title=Grid class that allows sorting by clicking on headers" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&quote=Grid class that allows sorting by clicking on headers" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&title=Grid class that allows sorting by clicking on headers" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>Unlike the ASP.NET GridView Class, the Visual Foxpro native grid class does not provide a means for automatic sorting by clicking on the column header. Although there are several workarounds for this deficiency available (such as http://www.rcs-solutions.com/downloads.aspx), here is my solution using my grdSorting class which allows automatic sorting by clicking on the column headers. Attached also is the library containing this class and two bmp files for displaying Up and Down arrows.<span id="more-536"></span></p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="text"><thead><tr><td colspan="2"  class="head">Text</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
</pre></td><td class="de1"><pre class="de1">**************************************************
*-- Class: &nbsp; &nbsp; &nbsp; &nbsp;grdSorting 
*-- ParentClass: &nbsp;grid
*-- BaseClass: &nbsp; &nbsp;grid
*-- Time Stamp: &nbsp; 08/10/09 06:57:11 PM
*
DEFINE CLASS grdSorting AS grid
&nbsp;
&nbsp;
&nbsp; &nbsp; Optimize = .T.
&nbsp; &nbsp; *-- This property tells, if we want to add visual representation of the sorting
&nbsp; &nbsp; lshowsortingarrows = .T.
&nbsp; &nbsp; *-- This property tells, if the grid's recordsource should be at the top after sorting
&nbsp; &nbsp; lgotopaftersorting = .T.
&nbsp; &nbsp; *-- This property tells wheither we need to update toolbar buttons or not
&nbsp; &nbsp; lupdatetoolbar = .T.
&nbsp; &nbsp; *-- This property saves the header of the last sorted column
&nbsp; &nbsp; olastsorted = &quot;null&quot;
&nbsp; &nbsp; *-- If this property is set to true (default), then the indexes are created for every column in the grid
&nbsp; &nbsp; lcreateindexes = .T.
&nbsp; &nbsp; *-- Holds grid's column controlsources and sizes
&nbsp; &nbsp; cgridscript = &quot;&quot;
&nbsp; &nbsp; *-- Original width of the grid
&nbsp; &nbsp; noriginalwidth = 0
&nbsp; &nbsp; *-- Current record number
&nbsp; &nbsp; nrecno = 1
&nbsp; &nbsp; *-- Defines the sort order for the grid
&nbsp; &nbsp; lascending = .F.
&nbsp; &nbsp; *-- Active Tag Name
&nbsp; &nbsp; ctagname = &quot;&quot;
&nbsp; &nbsp; *-- If this property is set to false, then the Initialize code is not called
&nbsp; &nbsp; lsortheaders = .T.
&nbsp; &nbsp; *-- XML Metadata for customizable properties
&nbsp; &nbsp; _memberdata = [&lt;VFPData&gt;&lt;memberdata name=&quot;lsortheaders&quot; display=&quot;lSortHeaders&quot;/&gt;&lt;memberdata name=&quot;cgridscript&quot; display=&quot;cGridScript&quot;/&gt;&lt;memberdata name=&quot;headerclick&quot; display=&quot;HeaderClick&quot;/&gt;&lt;memberdata name=&quot;gettagname&quot; display=&quot;GetTagName&quot;/&gt;&lt;memberdata name=&quot;createtag&quot; display=&quot;CreateTag&quot;/&gt;&lt;memberdata name=&quot;clearheaderpictures&quot; display=&quot;ClearHeaderPictures&quot;/&gt;&lt;memberdata name=&quot;setorder&quot; display=&quot;SetOrder&quot;/&gt;&lt;/VFPData&gt;]
&nbsp; &nbsp; Name = &quot;grid_&quot;
&nbsp;
&nbsp; &nbsp; *-- If this property is set, use DynamicBackColor to set highlight
&nbsp; &nbsp; lmanualhighlight = .F.
&nbsp;
&nbsp; &nbsp; *-- If this property is set to true, then grid's properties are saved
&nbsp; &nbsp; lsavegridproperties = .F.
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- This method is invoked when any grid's column header is clicked
&nbsp; &nbsp; PROCEDURE headerclick
&nbsp; &nbsp; &nbsp; &nbsp; local loCalledBy &amp;&amp; as Object
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *ShowCursor(0)
&nbsp; &nbsp; &nbsp; &nbsp; aevents[aCurEvent,0]
&nbsp; &nbsp; &nbsp; &nbsp; loCalledBy = aCurEvent[1] &amp;&amp; should be a Header object
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; if vartype(m.loCalledBy)= &quot;O&quot; and not empty(m.loCalledBy.parent.cOriginalControlSource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; local lcOrder, lcRecSource, llDirection
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcRecSource = this.recordsource
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; llDirection = this.lAscending
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcOrder = order(m.lcRecSource) &amp;&amp; Saves current tag
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.SetOrder(m.loCalledBy.parent.cOriginalControlSource, m.loCalledBy.CurrentTag, m.loCalledBy)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if this.lShowSortingArrows
&nbsp; &nbsp; &nbsp; &nbsp; * Check, if we changed the order
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if not order(m.lcRecSource)== m.lcOrder or m.llDirection &lt;&gt; this.lAscending
&nbsp; &nbsp; &nbsp; &nbsp; ** Clear the picture of the previously sorted column
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loCalledBy.CurrentTag = this.cTagName
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.ClearHeaderPictures()
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.SetHeaderPicture(m.loCalledBy)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *=SetCursorPos(MROW(),MCOL())
&nbsp; &nbsp; &nbsp; &nbsp; *Mouse at Mrow(), Mcol()
&nbsp; &nbsp; &nbsp; &nbsp; *ShowCursor(1)
&nbsp; &nbsp; &nbsp; &nbsp; *his.mousepointer = 0 &amp;&amp; Attempt to restore Mouse Pointer
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- This method removes pictures from all the headers
&nbsp; &nbsp; PROCEDURE clearheaderpictures
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Method: &nbsp; &nbsp; ClearHeaderPictures()
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------- Maintenance Section ----------------------
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Change Log:
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 01/24/2005 - NN
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; MODIFIED
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; if vartype(m.this.oLastSorted) = &quot;O&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.oLastSorted.ResetToDefault('picture')
&nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- This method sets picture for the Header object which is passed by reference
&nbsp; &nbsp; PROCEDURE setheaderpicture
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Method: &nbsp; &nbsp; Setheaderpicture()
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------- Maintenance Section ----------------------
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Change Log:
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 01/25/2005 - NN
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; MODIFIED
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; lparameters toHeader, tcPicture
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; if vartype(m.toHeader) &lt;&gt; &quot;O&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return .f.
&nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; if toHeader.alignment = 0 &amp;&amp; Default
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; toHeader.caption = padr(alltrim(m.toHeader.caption),200) &amp;&amp; we want to show picture at the right
&nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; toHeader.picture = iif(not empty(m.tcPicture), m.tcPicture, ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; iif(this.lAscending, &quot;UpArrow.bmp&quot;,&quot;DownArrow.bmp&quot;))
&nbsp; &nbsp; &nbsp; &nbsp; this.oLastSorted = m.toHeader
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; this.ClearWaitCursor()
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- Indexes a column on the fly
&nbsp; &nbsp; *---------------------- Location Section ------------------------
* &nbsp; Method: &nbsp; &nbsp; Createtag()
*----------------------- Usage Section --------------------------
*) &nbsp;Description: Creates index for the passed header's column's controlsource on the fly
*) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The code is taken from Vlad Grynchyshyn (with NN's minor modifications)
&nbsp;
* &nbsp; Scope: &nbsp; &nbsp; &nbsp;Public
* &nbsp; Parameters:
*$ &nbsp;Usage:
*$
* &nbsp; Returns:
*--------------------- Maintenance Section ----------------------
* &nbsp; Change Log:
* &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 02/07/2005 - NN
* &nbsp; &nbsp; &nbsp; MODIFIED
*----------------------------------------------------------------
* assuming alias for sorting is in the current workarea
LPARAMETERS toHeader
LOCAL lc__SortExpr, lnLimitation, llError, llNonStructural, lnSelect, lcOrder, loException AS EXCEPTION
&nbsp;
lnSelect = SELECT()
lcOrder = ORDER()
llError = .F.
&nbsp;
WITH toHeader
&nbsp;
* calculate the expression for sorting
*-- CHANGE - WGB - November 11, 2008 - 10:13:17 - the original length was 240,
* &nbsp; but it generates &quot;Invalid Key Length&quot; error, so we decrease it to 200
* ------------------------------------------------------------------------
&nbsp; &nbsp; lnLimitation = IIF(SET(&quot;Collate&quot;)==&quot;MACHINE&quot;,200,120)
&nbsp; &nbsp; lc__SortExpr = .PARENT.cOriginalControlSource
* make basic checking for control source type
&nbsp; &nbsp; LOCAL lcType, lnValLen, llIsField, lcTag, lcField, lcCursor
&nbsp; &nbsp; lcType = TYPE(m.lc__SortExpr)
&nbsp; &nbsp; llIsField = '.' $ m.lc__SortExpr AND ;
&nbsp; &nbsp; &nbsp; &nbsp; USED(LEFT(m.lc__SortExpr,AT('.',m.lc__SortExpr)-1)) AND ;
&nbsp; &nbsp; &nbsp; &nbsp; FSIZE(SUBSTR(m.lc__SortExpr,AT('.',m.lc__SortExpr)+1),LEFT(m.lc__SortExpr,AT('.',m.lc__SortExpr)-1)) &gt; 0
&nbsp;
&nbsp; &nbsp; lcTag = &quot;&quot;
&nbsp;
&nbsp; &nbsp; IF m.llIsField
&nbsp; &nbsp; &nbsp; &nbsp; lcField = JUSTEXT(&quot;.&quot; + m.lc__SortExpr)
&nbsp; &nbsp; &nbsp; &nbsp; lcCursor = JUSTSTEM(m.lc__SortExpr)
&nbsp; &nbsp; &nbsp; &nbsp; lcTag = THIS.GetTagName (m.lcCursor, m.lcField)
&nbsp; &nbsp; ENDIF
&nbsp; &nbsp; 
&nbsp; &nbsp; TRY 
&nbsp; &nbsp; &nbsp; &nbsp;SELECT (lcCursor)
&nbsp; &nbsp; CATCH TO loException
&nbsp; &nbsp; &nbsp; &nbsp;llError = .T.
&nbsp; &nbsp; ENDTRY
&nbsp; &nbsp; 
&nbsp; &nbsp; IF EMPTY(m.lcTag) AND NOT m.llError
&nbsp; &nbsp; &nbsp; &nbsp; DO CASE
&nbsp; &nbsp; &nbsp; &nbsp; CASE m.lcType $ &quot;GOPUS&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc__SortExpr = &quot;&quot;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; CASE m.lcType == &quot;C&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF m.llIsField
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lnValLen = MIN(FSIZE(m.lcField),m.lnLimitation)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lnValLen = m.lnLimitation
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc__SortExpr = &quot;PADR(NVL(&quot; + m.lc__SortExpr + &quot;,''),&quot; + ALLTRIM(STR(m.lnValLen))+&quot;)&quot;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; CASE m.lcType == &quot;M&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc__SortExpr = &quot;PADR(&quot; + m.lc__SortExpr + &quot;,&quot; + ALLTRIM(STR(m.lnLimitation))+&quot;)&quot;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; OTHERWISE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DO CASE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CASE m.lcType $ &quot;DT&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc__SortExpr = &quot;NVL(&quot; + m.lc__SortExpr + &quot;,{})&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CASE m.lcType == &quot;L&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc__SortExpr = &quot;NVL(&quot; + m.lc__SortExpr + &quot;,.F.)&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CASE m.lcType == &quot;Y&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc__SortExpr = &quot;NVL(&quot; + m.lc__SortExpr + &quot;,$0)&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OTHERWISE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lc__SortExpr = &quot;NVL(&quot; + m.lc__SortExpr + &quot;,0)&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDCASE
&nbsp; &nbsp; &nbsp; &nbsp; ENDCASE
&nbsp;
&amp;&amp; create index tag
&nbsp; &nbsp; &nbsp; &nbsp; IF !EMPTY(m.lc__SortExpr)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .CurrentTag = &quot;T&quot; + SUBSTR(ALLTRIM(SYS(2015)), 4, 10) &amp;&amp; generate unique tag name
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LOCAL lnRestoreBuffering
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lnRestoreBuffering = CURSORGETPROP('Buffering')
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TRY
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF m.lnRestoreBuffering &gt;= 4
&amp;&amp; OOPS - cannot index cursors in 5 buffering mode.
&amp;&amp; check that it does not contain modified records
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF GETNEXTMODIFIED(0) = 0
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CURSORSETPROP('Buffering',IIF(m.lnRestoreBuffering=5,3,2))
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE
&amp;&amp; OOPS - we will not be able to index it...
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .CurrentTag = &quot;&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&amp;&amp; check how we should create index - structural or non-structural
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; llNonStructural = CURSORGETPROP('SourceType') = 3 AND (! ISEXCLUSIVE() OR ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; !(CURSORGETPROP('Database')==&quot;&quot;) OR !(SYS(2023) == JUSTPATH(DBF())) )
* it is a table for which either database is specified or file path is not in temporary folder
* or just alias is not opened in exclusive mode (file in temporary folder, but it is shared)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF !EMPTY(.CurrentTag)
&amp;&amp; disable errors
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LOCAL llError, lnOldRecNo
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lnOldRecNo = IIF(EOF(),0,RECNO())
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF m.llNonStructural
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INDEX ON ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;lc__SortExpr ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG (.CurrentTag) OF (SYS(2023) + &quot;&quot; + .CurrentTag) ADDITIVE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INDEX ON ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;lc__SortExpr ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG (.CurrentTag) ADDITIVE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
* restore record number
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF m.lnOldRecNo &lt;&gt; RECNO()
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF m.lnOldRecNo = 0
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GO BOTTOM
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF !EOF()
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SKIP
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GO (m.lnOldRecNo)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF m.lnRestoreBuffering &gt;= 4
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CURSORSETPROP('Buffering', m.lnRestoreBuffering)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CATCH TO loException
* we may want to log the exceptions
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; llError = .T.
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDTRY
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF m.llError &amp;&amp; error occurred during indexing
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .CurrentTag = &quot;&quot; &amp;&amp; indicate no tag is created
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; ELSE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .CurrentTag = &quot;&quot;
&nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; ELSE
&nbsp; &nbsp; &nbsp; &nbsp; .CurrentTag = m.lcTag
&nbsp; &nbsp; ENDIF
ENDWITH
&nbsp;
SELECT (m.lnSelect)
IF NOT EMPTY(m.lcOrder)
&nbsp; &nbsp; SET ORDER TO (m.lcOrder)
ELSE
&nbsp; &nbsp; SET ORDER TO
ENDIF
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- Returns the tag name (if exists) for the passed field name
&nbsp; &nbsp; PROCEDURE gettagname
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Method: &nbsp; &nbsp; Gettagname()
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------- Maintenance Section ----------------------
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Change Log:
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 02/10/2005 - NN
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; MODIFIED
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; lparameters tcCursor, tcField
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; local lnCount, lcIndexExpr, lnIndexes, lcTagName
&nbsp; &nbsp; &nbsp; &nbsp; local array laIndex[1]
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *lnIndexes = AIndexes(@laIndex, m.tcCursor)
&nbsp; &nbsp; &nbsp; &nbsp; lnIndexes = tagcount(&quot;&quot;, m.tcCursor)
&nbsp; &nbsp; &nbsp; &nbsp; lcTagName = &quot;&quot;
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *-- See if the field name is in the leftmost part of an index
&nbsp; &nbsp; &nbsp; &nbsp; *-- expression OR simply within an UPPER() statement.
&nbsp; &nbsp; &nbsp; &nbsp; *-- If so, SET ORDER TO the index.
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; for lnCount = 1 to m.lnIndexes
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcIndexExpr = upper(sys(14, m.lnCount, m.tcCursor))
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *--- Allow for character indexes that are simply
&nbsp; &nbsp; &nbsp; &nbsp; *--- surrounded by &quot;UPPER()&quot;. Remove &quot;UPPER()&quot;.
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if left(m.lcIndexExpr,6) = 'UPPER('
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcIndexExpr = substr(m.lcIndexExpr,7)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcIndexExpr = substr(m.lcIndexExpr,1,len(m.lcIndexExpr)-1)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if m.lcIndexExpr = upper(m.tcField)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcTagName = tag(m.lnCount, m.tcCursor)
&nbsp; &nbsp; &nbsp; &nbsp; *--- Index found...exit ---*
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lnCount = m.lnIndexes + 1
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; endfor
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; return m.lcTagName
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- This method saves column's properties as a script
&nbsp; &nbsp; PROCEDURE savegridproperties
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Method: &nbsp; &nbsp; Savegridproperties()
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------- Maintenance Section ----------------------
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Change Log:
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 03/30/2005 - WGB
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CHANGED - NN - March 31, 2005 - 09:53:29
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; if empty(this.cGridScript)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; local lcGridScript, lcReference, loColumn
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcReference = sys(1272, this)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcReference = &quot;_screen.ActiveForm.&quot; + substr(m.lcReference,at(&quot;.&quot;,m.lcReference)+1)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set textmerge on
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set textmerge to memvar lcGridScript noshow &amp;&amp; TEXTMERGE begins on the next line.
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; With &lt;&lt;m.lcReference&gt;&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for each loColumn in this.columns
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .&lt;&lt;loColumn.name&gt;&gt;.ControlSource = &quot;&lt;&lt;m.loColumn.ControlSource&gt;&gt;&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .&lt;&lt;loColumn.name&gt;&gt;.width = &lt;&lt;m.loColumn.width&gt;&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next
&nbsp; &nbsp; &nbsp; &nbsp; endwith
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set textmerge to
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set textmerge off
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.cGridScript = m.lcGridScript
&nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- This method sets columns' properties
&nbsp; &nbsp; PROCEDURE resetgridproperties
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Method: &nbsp; &nbsp; ResetGridProperties()
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------- Maintenance Section ----------------------
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Change Log:
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 03/30/2005 - WGB
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; MODIFIED &nbsp; &nbsp;05/03/2005 - NN
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; local loColumn
&nbsp; &nbsp; &nbsp; &nbsp; for each loColumn in this.columns
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loColumn.controlsource = m.loColumn.cOriginalControlSource
&nbsp; &nbsp; &nbsp; &nbsp; next
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- This method re-creates indexes used for sorting. It should be called explicitly after re-creating grid's recorsource
&nbsp; &nbsp; PROCEDURE recreateindexes
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Method: &nbsp; &nbsp; Recreateindexes()
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------- Maintenance Section ----------------------
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Change Log:
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 04/01/2005 - NN
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; MODIFIED
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; local loColumn, loControl
&nbsp; &nbsp; &nbsp; &nbsp; for each loColumn in this.columns
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for each loControl in loColumn.controls
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if upper(m.loControl.baseclass) = &quot;HEADER&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.CreateTag (m.loControl)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endfor
&nbsp; &nbsp; &nbsp; &nbsp; endfor
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- This method refreshes navigation buttons on the toolbar
&nbsp; &nbsp; PROCEDURE refreshtoolbars
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Method: &nbsp; &nbsp; Refreshtoolbars()
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------- Maintenance Section ----------------------
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Change Log:
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 07/06/2005 - NN
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; MODIFIED
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; local lcRecordSource, lcCondition
&nbsp; &nbsp; &nbsp; &nbsp; with this
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcRecordSource = .recordsource
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if vartype(thisform.oToolbar) = &quot;O&quot; and ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lower(thisform.cToolbar)='anavtoolbar' and ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type('thisform.oToolBar.cntNavButtons')='O' and ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thisform.oToolbar.cntNavButtons.visible = .t.
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thisform.lBOF = bof(m.lcRecordSource) or reccount(m.lcRecordSource) = 0
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thisform.lEOF = eof(m.lcRecordSource)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcCondition = &quot;&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go bottom in (m.lcRecordSource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if .nRecno = recno(m.lcRecordSource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcCondition = &quot;EOF&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; go top in (m.lcRecordSource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if .nRecno = recno(m.lcRecordSource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcCondition = &quot;BOF&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if between(.nRecno,1,reccount(m.lcRecordSource))
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; goto .nRecno in (m.lcRecordSource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thisform.oToolbar.cntNavButtons.refresh(m.lcCondition, m.lcRecordSource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; endwith
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- This method binds controls to grid's methods
&nbsp; &nbsp; PROCEDURE initialize
&nbsp; &nbsp; &nbsp; &nbsp; local loColumn, loControl
&nbsp; &nbsp; &nbsp; &nbsp; *Declare ShowCursor in Win32API Long
&nbsp; &nbsp; &nbsp; &nbsp; * Delegate header's click to grid's HeaderClick custom method
&nbsp; &nbsp; &nbsp; &nbsp; * and column's textbox DblClick to grid's DblClick
&nbsp; &nbsp; &nbsp; &nbsp; this.nOriginalWidth = this.Width 
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; for each loColumn in this.columns
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loColumn.addproperty(&quot;cOriginalControlSource&quot;, m.loColumn.controlsource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loColumn.addproperty(&quot;nOriginalWidth&quot;, m.loColumn.width)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for each loControl in m.loColumn.controls
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if upper(m.loControl.baseclass) = &quot;HEADER&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loControl.FontSize = 8
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bindevent(m.loControl,&quot;Click&quot;,this,&quot;HeaderClick&quot;)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loControl.addproperty(&quot;CurrentTag&quot;,&quot;&quot;) &amp;&amp; Adds CurrentTag property
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if this.lCreateIndexes &amp;&amp; Adds indexes on the fly
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.CreateTag (m.loControl)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if upper(m.loControl.baseclass) = &quot;TEXTBOX&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bindevent(m.loControl,&quot;DblClick&quot;,this,&quot;DblClick&quot;)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bindevent(m.loControl,&quot;KeyPress&quot;,this,&quot;KeyPress&quot;)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endfor
&nbsp; &nbsp; &nbsp; &nbsp; endfor
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; if this.lManualHighlight
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; local lcDynamicBackColor, lcDynamicForeColor
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcDynamicBackColor = &quot;iif(recno(this.RecordSource)=this.nRecno,this.HighlightBackColor,this.BackColor)&quot;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcDynamicForeColor = &quot;iif(recno(this.RecordSource)=this.nRecno,this.HighlightForeColor,this.ForeColor)&quot;
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.setall(&quot;DynamicBackColor&quot;, m.lcDynamicBackColor, &quot;Column&quot;)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.setall(&quot;DynamicForeColor&quot;, m.lcDynamicForeColor, &quot;Column&quot;)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.highlightstyle = 0
&nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; if this.lSaveGridProperties
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.SaveGridProperties()
&nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- Sets current orderlsortheaders If this property is set to .F. the grid doesn't run initialize method
&nbsp; &nbsp; PROCEDURE setorder
&nbsp; &nbsp; &nbsp; &nbsp; LPARAMETERS tcControlSource, tcTagName, toHeader
&nbsp; &nbsp; &nbsp; &nbsp; LOCAL lnCount, lcField, lcIndexExpr, lcCursor, lnIndexes, ;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcAscDesc, lnRecNo, loSelect, loException as Exception
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *this.MousePointer = 0 &nbsp;&amp;&amp; avoid hourglasses
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; LOCAL ARRAY laIndex[1]
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *-- Get the field, cursor name for the ControlSource cursor
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; lcField = SUBSTR(m.tcControlSource, AT(&quot;.&quot;, m.tcControlSource) + 1)
&nbsp; &nbsp; &nbsp; &nbsp; lcCursor = JUSTSTEM(m.tcControlSource)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; * Change by NN
&nbsp; &nbsp; &nbsp; &nbsp; IF NOT USED(m.lcCursor) OR RECCOUNT(m.lcCursor) = 0 &amp;&amp; empty cursor or complex expression
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETURN
&nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; thisform.LockScreen = .t.
&nbsp; &nbsp; &nbsp; &nbsp; lnRecNo = RECNO(m.lcCursor)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; TRY
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; IF PCOUNT() &lt; 2 OR EMPTY(m.tcTagName)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *--- A tag name was not passed. Try to find a
&nbsp; &nbsp; &nbsp; &nbsp; *--- tag for the current column's ControlSource
&nbsp; &nbsp; &nbsp; &nbsp; *--- Get the number of indexes for the cursor.
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp;lnIndexes = AIndexes(@laIndex, lcCursor)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lnIndexes = TAGCOUNT(m.lcCursor)
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *-- See if the field name is in the leftmost part of an index
&nbsp; &nbsp; &nbsp; &nbsp; *-- expression OR simply within an UPPER() statement.
&nbsp; &nbsp; &nbsp; &nbsp; *-- If so, SET ORDER TO the index.
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FOR lnCount = 1 TO m.lnIndexes
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcIndexExpr = UPPER(SYS(14, m.lnCount, m.lcCursor))
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *--- Allow for character indexes that are simply
&nbsp; &nbsp; &nbsp; &nbsp; *--- surrounded by &quot;UPPER()&quot;. Remove &quot;UPPER()&quot;.
&nbsp; &nbsp; &nbsp; &nbsp; *--------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF LEFT(m.lcIndexExpr,6) = 'UPPER('
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcIndexExpr = SUBSTR(lcIndexExpr,7)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcIndexExpr = SUBSTR(lcIndexExpr,1,LEN(lcIndexExpr)-1)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF lcIndexExpr = UPPER(m.lcField)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tcTagName = TAG(m.lnCount, m.lcCursor)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF VARTYPE(m.toHeader) = 'O'
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;toHeader.CurrentTag = m.tcTagName
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *--- Index found...exit ---*
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EXIT
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDFOR
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *--- Determine ASCENDING/DESCENDING
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; IF NOT EMPTY(tcTagName)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF NOT UPPER(tcTagName) == UPPER(THIS.cTagName)
&nbsp; &nbsp; &nbsp; &nbsp; *--- Default to ascending ---*
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; THIS.lAscending = .T.
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE
&nbsp; &nbsp; &nbsp; &nbsp; *--- Toggle ascending/descending ---*
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; THIS.lAscending = NOT THIS.lAscending
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *--- SET ORDER to the tag
&nbsp; &nbsp; &nbsp; &nbsp; *------------------------
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; THIS.cTagName = m.tcTagName
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lcAscDesc = IIF(THIS.lAscending, 'ASCENDING', 'DESCENDING')
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SET ORDER TO tcTagName IN (lcCursor) &amp;lcAscDesc
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *---------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; *--- Refresh the grid and restore the record pointer
&nbsp; &nbsp; &nbsp; &nbsp; *--- If done in the reverse order (GOTO, Refresh),
&nbsp; &nbsp; &nbsp; &nbsp; *--- the grid is visually on the wrong record.
&nbsp; &nbsp; &nbsp; &nbsp; *---------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; THIS.REFRESH()
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *-- CHANGE - NN - January 25, 2005 - 09:37:53
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF THIS.lGoTopAfterSorting
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GO TOP IN (m.lcCursor)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ELSE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IF RECCOUNT(m.lcCursor) &gt; 0
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GOTO m.lnRecNo IN (m.lcCursor) &amp;&amp; This causes automatic save of the record in the record-buffered table
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; *-- CHANGE - NN - January 25, 2005 - 09:38:59 - added a new property
&nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; CATCH TO loException
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * ignore errors 
&nbsp; &nbsp; &nbsp; &nbsp; ENDTRY
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; thisform.LockScreen = .f.
&nbsp; &nbsp; &nbsp; &nbsp; *this.MousePointer = 0 &amp;&amp; Make sure - no hourglasses
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; *-- Solution by Cesar Chalom to clear hourglass cursor
&nbsp; &nbsp; PROCEDURE clearwaitcursor
&nbsp; &nbsp; &nbsp; &nbsp; *!* ClearWaitCursor()
&nbsp; &nbsp; &nbsp; &nbsp; Local lcPoint As String, lnx As Integer, lny As Integer
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; lcPoint = 0h0000000000000000
&nbsp; &nbsp; &nbsp; &nbsp; ClearWaitCursor_GetCursorPos(@m.lcPoint)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; lnx = CToBin(Substr(m.lcPoint, 1, 4), &quot;4rs&quot;)
&nbsp; &nbsp; &nbsp; &nbsp; lny = CToBin(Substr(m.lcPoint, 5, 4), &quot;4rs&quot;)
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; ClearWaitCursor_SetCursorPos(m.lnx, m.lny)
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; PROCEDURE Init
&nbsp; &nbsp; &nbsp; &nbsp; *DECLARE integer SetCursorPos in WIN32API integer, integer
&nbsp; &nbsp; &nbsp; &nbsp; Declare Integer GetCursorPos In win32api As ClearWaitCursor_GetCursorPos String &nbsp;@lpPoint
&nbsp; &nbsp; &nbsp; &nbsp; Declare Integer SetCursorPos In win32api As ClearWaitCursor_SetCursorPos Integer nX, Integer nY
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; RETURN DODEFAULT() AND IIF(this.lSortHeaders, this.Initialize(),.T.) 
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; PROCEDURE Resize
&nbsp; &nbsp; &nbsp; &nbsp; IF THIS.nOriginalWidth &gt; 0 &amp;&amp; The grid's Init has been run already
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LOCAL lnRatio, loColumn
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lnRatio = THIS.WIDTH / THIS.nOriginalWidth
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FOR EACH loColumn IN THIS.COLUMNS
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loColumn.WIDTH = loColumn.nOriginalWidth * m.lnRatio
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NEXT
&nbsp; &nbsp; &nbsp; &nbsp; ENDIF
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; PROCEDURE AfterRowColChange
&nbsp; &nbsp; &nbsp; &nbsp; lparameters nColIndex
&nbsp; &nbsp; &nbsp; &nbsp; with this
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .nRecno = recno(this.recordsource)
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if .lManualHighlight
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if inlist(.rowcolchange, 1, 3) &amp;&amp; Row change
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .refresh()
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .RefreshToolbars()
&nbsp; &nbsp; &nbsp; &nbsp; endwith
&nbsp; &nbsp; &nbsp; &nbsp; dodefault(m.nColIndex)
&nbsp; &nbsp; &nbsp; &nbsp; thisform.lockscreen = .f.
&nbsp; &nbsp; &nbsp; &nbsp; this.ClearWaitCursor()
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; PROCEDURE Destroy
&nbsp; &nbsp; &nbsp; &nbsp; this.oLastSorted = null
&nbsp; &nbsp; &nbsp; &nbsp; return dodefault()
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
&nbsp; &nbsp; PROCEDURE BeforeRowColChange
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Method: &nbsp; &nbsp; Beforerowcolchange() 
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; Change Log:
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; 03/11/2005 - NN 
&nbsp; &nbsp; &nbsp; &nbsp; * &nbsp; &nbsp; &nbsp; MODIFIED
&nbsp; &nbsp; &nbsp; &nbsp; *----------------------------------------------------------------
&nbsp; &nbsp; &nbsp; &nbsp; lparameters nColIndex
&nbsp; &nbsp; &nbsp; &nbsp; if this.lManualHighlight
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; thisform.lockscreen = .t.
&nbsp; &nbsp; &nbsp; &nbsp; endif
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; dodefault(m.nColIndex)
&nbsp; &nbsp; ENDPROC
&nbsp;
&nbsp;
ENDDEFINE
*
*-- EndDefine: grdsorting
**************************************************</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">**************************************************
*-- Class:        grdSorting 
*-- ParentClass:  grid
*-- BaseClass:    grid
*-- Time Stamp:   08/10/09 06:57:11 PM
*
DEFINE CLASS grdSorting AS grid


	Optimize = .T.
	*-- This property tells, if we want to add visual representation of the sorting
	lshowsortingarrows = .T.
	*-- This property tells, if the grid's recordsource should be at the top after sorting
	lgotopaftersorting = .T.
	*-- This property tells wheither we need to update toolbar buttons or not
	lupdatetoolbar = .T.
	*-- This property saves the header of the last sorted column
	olastsorted = "null"
	*-- If this property is set to true (default), then the indexes are created for every column in the grid
	lcreateindexes = .T.
	*-- Holds grid's column controlsources and sizes
	cgridscript = ""
	*-- Original width of the grid
	noriginalwidth = 0
	*-- Current record number
	nrecno = 1
	*-- Defines the sort order for the grid
	lascending = .F.
	*-- Active Tag Name
	ctagname = ""
	*-- If this property is set to false, then the Initialize code is not called
	lsortheaders = .T.
	*-- XML Metadata for customizable properties
	_memberdata = [&lt;VFPData&gt;&lt;memberdata name="lsortheaders" display="lSortHeaders"/&gt;&lt;memberdata name="cgridscript" display="cGridScript"/&gt;&lt;memberdata name="headerclick" display="HeaderClick"/&gt;&lt;memberdata name="gettagname" display="GetTagName"/&gt;&lt;memberdata name="createtag" display="CreateTag"/&gt;&lt;memberdata name="clearheaderpictures" display="ClearHeaderPictures"/&gt;&lt;memberdata name="setorder" display="SetOrder"/&gt;&lt;/VFPData&gt;]
	Name = "grid_"

	*-- If this property is set, use DynamicBackColor to set highlight
	lmanualhighlight = .F.

	*-- If this property is set to true, then grid's properties are saved
	lsavegridproperties = .F.


	*-- This method is invoked when any grid's column header is clicked
	PROCEDURE headerclick
		local loCalledBy &amp;&amp; as Object

		*ShowCursor(0)
		aevents[aCurEvent,0]
		loCalledBy = aCurEvent[1] &amp;&amp; should be a Header object

		if vartype(m.loCalledBy)= "O" and not empty(m.loCalledBy.parent.cOriginalControlSource)
			local lcOrder, lcRecSource, llDirection
			lcRecSource = this.recordsource
			llDirection = this.lAscending

			lcOrder = order(m.lcRecSource) &amp;&amp; Saves current tag
			this.SetOrder(m.loCalledBy.parent.cOriginalControlSource, m.loCalledBy.CurrentTag, m.loCalledBy)
			if this.lShowSortingArrows
		* Check, if we changed the order
				if not order(m.lcRecSource)== m.lcOrder or m.llDirection &lt;&gt; this.lAscending
		** Clear the picture of the previously sorted column
					loCalledBy.CurrentTag = this.cTagName
					this.ClearHeaderPictures()
					this.SetHeaderPicture(m.loCalledBy)
				endif
			endif
		ENDIF

		*=SetCursorPos(MROW(),MCOL())
		*Mouse at Mrow(), Mcol()
		*ShowCursor(1)
		*his.mousepointer = 0 &amp;&amp; Attempt to restore Mouse Pointer
	ENDPROC


	*-- This method removes pictures from all the headers
	PROCEDURE clearheaderpictures
		*   Method: 	ClearHeaderPictures()
		*--------------------- Maintenance Section ----------------------
		*   Change Log:
		*       CREATED 	01/24/2005 - NN
		*		MODIFIED
		*----------------------------------------------------------------
		if vartype(m.this.oLastSorted) = "O"
			this.oLastSorted.ResetToDefault('picture')
		endif
	ENDPROC


	*-- This method sets picture for the Header object which is passed by reference
	PROCEDURE setheaderpicture
		*   Method: 	Setheaderpicture()
		*--------------------- Maintenance Section ----------------------
		*   Change Log:
		*       CREATED 	01/25/2005 - NN
		*		MODIFIED
		*----------------------------------------------------------------
		lparameters toHeader, tcPicture

		if vartype(m.toHeader) &lt;&gt; "O"
			return .f.
		endif
		if toHeader.alignment = 0 &amp;&amp; Default
			toHeader.caption = padr(alltrim(m.toHeader.caption),200) &amp;&amp; we want to show picture at the right
		ENDIF

		toHeader.picture = iif(not empty(m.tcPicture), m.tcPicture, ;
			iif(this.lAscending, "UpArrow.bmp","DownArrow.bmp"))
		this.oLastSorted = m.toHeader

		this.ClearWaitCursor()
	ENDPROC


	*-- Indexes a column on the fly
	*---------------------- Location Section ------------------------
*   Method: 	Createtag()
*----------------------- Usage Section --------------------------
*)  Description: Creates index for the passed header's column's controlsource on the fly
*)               The code is taken from Vlad Grynchyshyn (with NN's minor modifications)

*   Scope:      Public
*   Parameters:
*$  Usage:
*$
*   Returns:
*--------------------- Maintenance Section ----------------------
*   Change Log:
*       CREATED 	02/07/2005 - NN
*		MODIFIED
*----------------------------------------------------------------
* assuming alias for sorting is in the current workarea
LPARAMETERS toHeader
LOCAL lc__SortExpr, lnLimitation, llError, llNonStructural, lnSelect, lcOrder, loException AS EXCEPTION

lnSelect = SELECT()
lcOrder = ORDER()
llError = .F.

WITH toHeader

* calculate the expression for sorting
*-- CHANGE - WGB - November 11, 2008 - 10:13:17 - the original length was 240,
*   but it generates "Invalid Key Length" error, so we decrease it to 200
* ------------------------------------------------------------------------
	lnLimitation = IIF(SET("Collate")=="MACHINE",200,120)
	lc__SortExpr = .PARENT.cOriginalControlSource
* make basic checking for control source type
	LOCAL lcType, lnValLen, llIsField, lcTag, lcField, lcCursor
	lcType = TYPE(m.lc__SortExpr)
	llIsField = '.' $ m.lc__SortExpr AND ;
		USED(LEFT(m.lc__SortExpr,AT('.',m.lc__SortExpr)-1)) AND ;
		FSIZE(SUBSTR(m.lc__SortExpr,AT('.',m.lc__SortExpr)+1),LEFT(m.lc__SortExpr,AT('.',m.lc__SortExpr)-1)) &gt; 0

	lcTag = ""

	IF m.llIsField
		lcField = JUSTEXT("." + m.lc__SortExpr)
		lcCursor = JUSTSTEM(m.lc__SortExpr)
		lcTag = THIS.GetTagName (m.lcCursor, m.lcField)
	ENDIF
	
	TRY 
	   SELECT (lcCursor)
	CATCH TO loException
	   llError = .T.
	ENDTRY
	
	IF EMPTY(m.lcTag) AND NOT m.llError
		DO CASE
		CASE m.lcType $ "GOPUS"
			lc__SortExpr = ""

		CASE m.lcType == "C"
			IF m.llIsField
				lnValLen = MIN(FSIZE(m.lcField),m.lnLimitation)
			ELSE
				lnValLen = m.lnLimitation
			ENDIF
			lc__SortExpr = "PADR(NVL(" + m.lc__SortExpr + ",'')," + ALLTRIM(STR(m.lnValLen))+")"

		CASE m.lcType == "M"
			lc__SortExpr = "PADR(" + m.lc__SortExpr + "," + ALLTRIM(STR(m.lnLimitation))+")"

		OTHERWISE
			DO CASE
			CASE m.lcType $ "DT"
				lc__SortExpr = "NVL(" + m.lc__SortExpr + ",{})"
			CASE m.lcType == "L"
				lc__SortExpr = "NVL(" + m.lc__SortExpr + ",.F.)"
			CASE m.lcType == "Y"
				lc__SortExpr = "NVL(" + m.lc__SortExpr + ",$0)"
			OTHERWISE
				lc__SortExpr = "NVL(" + m.lc__SortExpr + ",0)"
			ENDCASE
		ENDCASE

&amp;&amp; create index tag
		IF !EMPTY(m.lc__SortExpr)
			.CurrentTag = "T" + SUBSTR(ALLTRIM(SYS(2015)), 4, 10) &amp;&amp; generate unique tag name

			LOCAL lnRestoreBuffering
			lnRestoreBuffering = CURSORGETPROP('Buffering')

			TRY
				IF m.lnRestoreBuffering &gt;= 4
&amp;&amp; OOPS - cannot index cursors in 5 buffering mode.
&amp;&amp; check that it does not contain modified records
					IF GETNEXTMODIFIED(0) = 0
						CURSORSETPROP('Buffering',IIF(m.lnRestoreBuffering=5,3,2))
					ELSE
&amp;&amp; OOPS - we will not be able to index it...
						.CurrentTag = ""
					ENDIF
				ENDIF

&amp;&amp; check how we should create index - structural or non-structural
				llNonStructural = CURSORGETPROP('SourceType') = 3 AND (! ISEXCLUSIVE() OR ;
					!(CURSORGETPROP('Database')=="") OR !(SYS(2023) == JUSTPATH(DBF())) )
* it is a table for which either database is specified or file path is not in temporary folder
* or just alias is not opened in exclusive mode (file in temporary folder, but it is shared)

				IF !EMPTY(.CurrentTag)
&amp;&amp; disable errors
					LOCAL llError, lnOldRecNo
					lnOldRecNo = IIF(EOF(),0,RECNO())

					IF m.llNonStructural
						INDEX ON ;
							&amp;lc__SortExpr ;
							TAG (.CurrentTag) OF (SYS(2023) + "" + .CurrentTag) ADDITIVE
					ELSE
						INDEX ON ;
							&amp;lc__SortExpr ;
							TAG (.CurrentTag) ADDITIVE
					ENDIF

* restore record number
					IF m.lnOldRecNo &lt;&gt; RECNO()
						IF m.lnOldRecNo = 0
							GO BOTTOM
							IF !EOF()
								SKIP
							ENDIF
						ELSE
							GO (m.lnOldRecNo)
						ENDIF
					ENDIF

					IF m.lnRestoreBuffering &gt;= 4
						CURSORSETPROP('Buffering', m.lnRestoreBuffering)
					ENDIF
				ENDIF
			CATCH TO loException
* we may want to log the exceptions
				llError = .T.
			ENDTRY

			IF m.llError &amp;&amp; error occurred during indexing
				.CurrentTag = "" &amp;&amp; indicate no tag is created
			ENDIF

		ELSE
			.CurrentTag = ""
		ENDIF

	ELSE
		.CurrentTag = m.lcTag
	ENDIF
ENDWITH

SELECT (m.lnSelect)
IF NOT EMPTY(m.lcOrder)
	SET ORDER TO (m.lcOrder)
ELSE
	SET ORDER TO
ENDIF


	*-- Returns the tag name (if exists) for the passed field name
	PROCEDURE gettagname
		*   Method: 	Gettagname()
		*--------------------- Maintenance Section ----------------------
		*   Change Log:
		*       CREATED 	02/10/2005 - NN
		*		MODIFIED
		*----------------------------------------------------------------
		lparameters tcCursor, tcField

		local lnCount, lcIndexExpr, lnIndexes, lcTagName
		local array laIndex[1]

		*lnIndexes = AIndexes(@laIndex, m.tcCursor)
		lnIndexes = tagcount("", m.tcCursor)
		lcTagName = ""
		*----------------------------------------------------------------
		*-- See if the field name is in the leftmost part of an index
		*-- expression OR simply within an UPPER() statement.
		*-- If so, SET ORDER TO the index.
		*----------------------------------------------------------------
		for lnCount = 1 to m.lnIndexes
			lcIndexExpr = upper(sys(14, m.lnCount, m.tcCursor))

		*--------------------------------------------------
		*--- Allow for character indexes that are simply
		*--- surrounded by "UPPER()". Remove "UPPER()".
		*--------------------------------------------------
			if left(m.lcIndexExpr,6) = 'UPPER('
				lcIndexExpr = substr(m.lcIndexExpr,7)
				lcIndexExpr = substr(m.lcIndexExpr,1,len(m.lcIndexExpr)-1)
			endif

			if m.lcIndexExpr = upper(m.tcField)
				lcTagName = tag(m.lnCount, m.tcCursor)
		*--- Index found...exit ---*
				lnCount = m.lnIndexes + 1
			endif
		endfor

		return m.lcTagName
	ENDPROC


	*-- This method saves column's properties as a script
	PROCEDURE savegridproperties
		*   Method: 	Savegridproperties()
		*--------------------- Maintenance Section ----------------------
		*   Change Log:
		*       CREATED 	03/30/2005 - WGB
		*		CHANGED - NN - March 31, 2005 - 09:53:29
		*----------------------------------------------------------------
		if empty(this.cGridScript)
			local lcGridScript, lcReference, loColumn

			lcReference = sys(1272, this)
			lcReference = "_screen.ActiveForm." + substr(m.lcReference,at(".",m.lcReference)+1)

			set textmerge on
			set textmerge to memvar lcGridScript noshow &amp;&amp; TEXTMERGE begins on the next line.

		With &lt;&lt;m.lcReference&gt;&gt;
			for each loColumn in this.columns

		        .&lt;&lt;loColumn.name&gt;&gt;.ControlSource = "&lt;&lt;m.loColumn.ControlSource&gt;&gt;"
		        .&lt;&lt;loColumn.name&gt;&gt;.width = &lt;&lt;m.loColumn.width&gt;&gt;
			next
		endwith
			set textmerge to
			set textmerge off

			this.cGridScript = m.lcGridScript
		endif
	ENDPROC


	*-- This method sets columns' properties
	PROCEDURE resetgridproperties
		*   Method: 	ResetGridProperties()
		*--------------------- Maintenance Section ----------------------
		*   Change Log:
		*       CREATED 	03/30/2005 - WGB
		*		MODIFIED    05/03/2005 - NN
		*----------------------------------------------------------------
		local loColumn
		for each loColumn in this.columns
			loColumn.controlsource = m.loColumn.cOriginalControlSource
		next
	ENDPROC


	*-- This method re-creates indexes used for sorting. It should be called explicitly after re-creating grid's recorsource
	PROCEDURE recreateindexes
		*   Method: 	Recreateindexes()
		*--------------------- Maintenance Section ----------------------
		*   Change Log:
		*       CREATED 	04/01/2005 - NN
		*		MODIFIED
		*----------------------------------------------------------------
		local loColumn, loControl
		for each loColumn in this.columns
			for each loControl in loColumn.controls
				if upper(m.loControl.baseclass) = "HEADER"
					this.CreateTag (m.loControl)
				endif
			endfor
		endfor
	ENDPROC


	*-- This method refreshes navigation buttons on the toolbar
	PROCEDURE refreshtoolbars
		*   Method: 	Refreshtoolbars()
		*--------------------- Maintenance Section ----------------------
		*   Change Log:
		*       CREATED 	07/06/2005 - NN
		*		MODIFIED
		*----------------------------------------------------------------
		local lcRecordSource, lcCondition
		with this
			lcRecordSource = .recordsource
			if vartype(thisform.oToolbar) = "O" and ;
					lower(thisform.cToolbar)='anavtoolbar' and ;
					type('thisform.oToolBar.cntNavButtons')='O' and ;
					thisform.oToolbar.cntNavButtons.visible = .t.
				thisform.lBOF = bof(m.lcRecordSource) or reccount(m.lcRecordSource) = 0
				thisform.lEOF = eof(m.lcRecordSource)

				lcCondition = ""
				go bottom in (m.lcRecordSource)
				if .nRecno = recno(m.lcRecordSource)
					lcCondition = "EOF"
				else
					go top in (m.lcRecordSource)
					if .nRecno = recno(m.lcRecordSource)
						lcCondition = "BOF"
					endif
				endif
				if between(.nRecno,1,reccount(m.lcRecordSource))
					goto .nRecno in (m.lcRecordSource)
				endif
				thisform.oToolbar.cntNavButtons.refresh(m.lcCondition, m.lcRecordSource)
			endif
		endwith
	ENDPROC


	*-- This method binds controls to grid's methods
	PROCEDURE initialize
		local loColumn, loControl
		*Declare ShowCursor in Win32API Long
		* Delegate header's click to grid's HeaderClick custom method
		* and column's textbox DblClick to grid's DblClick
		this.nOriginalWidth = this.Width 

		for each loColumn in this.columns
			loColumn.addproperty("cOriginalControlSource", m.loColumn.controlsource)
			loColumn.addproperty("nOriginalWidth", m.loColumn.width)

			for each loControl in m.loColumn.controls
				if upper(m.loControl.baseclass) = "HEADER"
					loControl.FontSize = 8
					bindevent(m.loControl,"Click",this,"HeaderClick")
					loControl.addproperty("CurrentTag","") &amp;&amp; Adds CurrentTag property
					if this.lCreateIndexes &amp;&amp; Adds indexes on the fly
						this.CreateTag (m.loControl)
					endif
				else
					if upper(m.loControl.baseclass) = "TEXTBOX"
						bindevent(m.loControl,"DblClick",this,"DblClick")
						bindevent(m.loControl,"KeyPress",this,"KeyPress")
					endif
				endif
			endfor
		endfor

		if this.lManualHighlight
			local lcDynamicBackColor, lcDynamicForeColor

			lcDynamicBackColor = "iif(recno(this.RecordSource)=this.nRecno,this.HighlightBackColor,this.BackColor)"
			lcDynamicForeColor = "iif(recno(this.RecordSource)=this.nRecno,this.HighlightForeColor,this.ForeColor)"

			this.setall("DynamicBackColor", m.lcDynamicBackColor, "Column")
			this.setall("DynamicForeColor", m.lcDynamicForeColor, "Column")
			this.highlightstyle = 0
		endif

		if this.lSaveGridProperties
			this.SaveGridProperties()
		endif
	ENDPROC


	*-- Sets current orderlsortheaders If this property is set to .F. the grid doesn't run initialize method
	PROCEDURE setorder
		LPARAMETERS tcControlSource, tcTagName, toHeader
		LOCAL lnCount, lcField, lcIndexExpr, lcCursor, lnIndexes, ;
			lcAscDesc, lnRecNo, loSelect, loException as Exception

		*this.MousePointer = 0 	&amp;&amp; avoid hourglasses

		LOCAL ARRAY laIndex[1]

		*----------------------------------------------------------
		*-- Get the field, cursor name for the ControlSource cursor
		*----------------------------------------------------------
		lcField = SUBSTR(m.tcControlSource, AT(".", m.tcControlSource) + 1)
		lcCursor = JUSTSTEM(m.tcControlSource)

		* Change by NN
		IF NOT USED(m.lcCursor) OR RECCOUNT(m.lcCursor) = 0 &amp;&amp; empty cursor or complex expression
			RETURN
		ENDIF

		thisform.LockScreen = .t.
		lnRecNo = RECNO(m.lcCursor)

		TRY

		IF PCOUNT() &lt; 2 OR EMPTY(m.tcTagName)

		*----------------------------------------------
		*--- A tag name was not passed. Try to find a
		*--- tag for the current column's ControlSource
		*--- Get the number of indexes for the cursor.
		*----------------------------------------------
		*  lnIndexes = AIndexes(@laIndex, lcCursor)
		   lnIndexes = TAGCOUNT(m.lcCursor)
		*----------------------------------------------------------------
		*-- See if the field name is in the leftmost part of an index
		*-- expression OR simply within an UPPER() statement.
		*-- If so, SET ORDER TO the index.
		*----------------------------------------------------------------
			FOR lnCount = 1 TO m.lnIndexes
				lcIndexExpr = UPPER(SYS(14, m.lnCount, m.lcCursor))

		*--------------------------------------------------
		*--- Allow for character indexes that are simply
		*--- surrounded by "UPPER()". Remove "UPPER()".
		*--------------------------------------------------
				IF LEFT(m.lcIndexExpr,6) = 'UPPER('
					lcIndexExpr = SUBSTR(lcIndexExpr,7)
					lcIndexExpr = SUBSTR(lcIndexExpr,1,LEN(lcIndexExpr)-1)
				ENDIF

				IF lcIndexExpr = UPPER(m.lcField)
					tcTagName = TAG(m.lnCount, m.lcCursor)
					IF VARTYPE(m.toHeader) = 'O'
					   toHeader.CurrentTag = m.tcTagName
					ENDIF
					   
		*--- Index found...exit ---*
					EXIT
				ENDIF
			ENDFOR

		ENDIF

		*----------------------------------
		*--- Determine ASCENDING/DESCENDING
		*----------------------------------
		IF NOT EMPTY(tcTagName)
			IF NOT UPPER(tcTagName) == UPPER(THIS.cTagName)
		*--- Default to ascending ---*
				THIS.lAscending = .T.
			ELSE
		*--- Toggle ascending/descending ---*
				THIS.lAscending = NOT THIS.lAscending
			ENDIF

		*------------------------
		*--- SET ORDER to the tag
		*------------------------
			THIS.cTagName = m.tcTagName
			lcAscDesc = IIF(THIS.lAscending, 'ASCENDING', 'DESCENDING')
			SET ORDER TO tcTagName IN (lcCursor) &amp;lcAscDesc

		*---------------------------------------------------
		*--- Refresh the grid and restore the record pointer
		*--- If done in the reverse order (GOTO, Refresh),
		*--- the grid is visually on the wrong record.
		*---------------------------------------------------
			THIS.REFRESH()

		*-- CHANGE - NN - January 25, 2005 - 09:37:53
			IF THIS.lGoTopAfterSorting
				GO TOP IN (m.lcCursor)
			ELSE
				IF RECCOUNT(m.lcCursor) &gt; 0
					GOTO m.lnRecNo IN (m.lcCursor) &amp;&amp; This causes automatic save of the record in the record-buffered table
				ENDIF
			ENDIF

		*-- CHANGE - NN - January 25, 2005 - 09:38:59 - added a new property
		ENDIF

		CATCH TO loException
		  * ignore errors 
		ENDTRY

		thisform.LockScreen = .f.
		*this.MousePointer = 0 &amp;&amp; Make sure - no hourglasses
	ENDPROC


	*-- Solution by Cesar Chalom to clear hourglass cursor
	PROCEDURE clearwaitcursor
		*!* ClearWaitCursor()
		Local lcPoint As String, lnx As Integer, lny As Integer

		lcPoint = 0h0000000000000000
		ClearWaitCursor_GetCursorPos(@m.lcPoint)

		lnx = CToBin(Substr(m.lcPoint, 1, 4), "4rs")
		lny = CToBin(Substr(m.lcPoint, 5, 4), "4rs")

		ClearWaitCursor_SetCursorPos(m.lnx, m.lny)
	ENDPROC


	PROCEDURE Init
		*DECLARE integer SetCursorPos in WIN32API integer, integer
		Declare Integer GetCursorPos In win32api As ClearWaitCursor_GetCursorPos String  @lpPoint
		Declare Integer SetCursorPos In win32api As ClearWaitCursor_SetCursorPos Integer nX, Integer nY

		RETURN DODEFAULT() AND IIF(this.lSortHeaders, this.Initialize(),.T.) 
	ENDPROC


	PROCEDURE Resize
		IF THIS.nOriginalWidth &gt; 0 &amp;&amp; The grid's Init has been run already
			LOCAL lnRatio, loColumn
			lnRatio = THIS.WIDTH / THIS.nOriginalWidth

			FOR EACH loColumn IN THIS.COLUMNS
				loColumn.WIDTH = loColumn.nOriginalWidth * m.lnRatio
			NEXT
		ENDIF
	ENDPROC


	PROCEDURE AfterRowColChange
		lparameters nColIndex
		with this
			.nRecno = recno(this.recordsource)
			if .lManualHighlight
				if inlist(.rowcolchange, 1, 3) &amp;&amp; Row change
					.refresh()
				endif
			endif
			.RefreshToolbars()
		endwith
		dodefault(m.nColIndex)
		thisform.lockscreen = .f.
		this.ClearWaitCursor()
	ENDPROC


	PROCEDURE Destroy
		this.oLastSorted = null
		return dodefault()
	ENDPROC


	PROCEDURE BeforeRowColChange
		*   Method: 	Beforerowcolchange() 
		*   Change Log:
		*       CREATED 	03/11/2005 - NN 
		*		MODIFIED
		*----------------------------------------------------------------
		lparameters nColIndex
		if this.lManualHighlight
			thisform.lockscreen = .t.
		endif

		dodefault(m.nColIndex)
	ENDPROC


ENDDEFINE
*
*-- EndDefine: grdsorting
**************************************************</pre></div></div>

<p>Attached is the file</p>
<p><a href="/wp-content/uploads/blogs/DataMgmt/grdSorting.zip" title="Grid Sorting">grdSorting class</a></p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/ssrs/ssrs-properties-tablix-sorting/'>SSRS Properties - Tablix Sorting</a><p>The purpose of this property is to sort the results of a tablix in the&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/combobox-with-multiple-selections-vfp/'>"Combobox" with multiple selections (Visual FoxPro)</a><p>The class listed below was born as a result of this discussion in UniversalThread Non-standard&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Naomi Nosonovsky, Senior Software Developer, has more than 15 years of enterprise experience in analysis, design, development and implementation of high-performance client/server data management solutions.

She is a Personality of the Year for 2008, 2009, 2010 and 2011 at www.universalthread.com in .NET, SQL Server & VFP categories.

She is also an All Star contributor/MCC Community Contributor at forums.asp.net and MSDN T-SQL forum.


 
	



    

    


<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/?sk=messages&tid=1240691655679#!/profile.php?id=10395470" title="Naomi at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/profile?viewProfile=&key=55538716&trk=tab_pro" title="Naomi at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://delicious.com/http://delicious.com/naomi_nos" title="Naomi at delicious" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_delicious.png" alt="delicious" /></a><a href="/index.php/author/naomi/feed/" title="Blog RSS feed for Naomi" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 28,925 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/naomi/">Read More Posts by Naomi Nosonovsky</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&text=RT @LessThanDot Blog - Grid class that allows sorting by clicking on headers by naomi" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&title=Grid class that allows sorting by clicking on headers&source=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&title=Grid class that allows sorting by clicking on headers" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&quote=Grid class that allows sorting by clicking on headers" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/&title=Grid class that allows sorting by clicking on headers" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		10 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-riverguy even thread-even depth-1" id="comment-1671">
				<div id="div-comment-1671" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/47a57ea35c6d10993e73dc9e17b9f95f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/47a57ea35c6d10993e73dc9e17b9f95f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">riverguy</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1671">
			August 12, 2009 at 7:43 am</a>		</div>

		<p>Nice&#8230;good to see a VFP blog.  Chrissie better get to work on the syntax highlighting for VFP 😉</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1671#respond' onclick='return addComment.moveForm( "div-comment-1671", "1671", "respond", "536" )' aria-label='Reply to riverguy'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1672">
				<div id="div-comment-1672" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1672">
			August 12, 2009 at 7:50 am</a>		</div>

		<p>Thanks. There is a program for syntax highlighting in VFP (written in VFP) It can be downloaded from <a href="http://www.universalthread.com/Report.aspx?Session=3950396F5A4171707070773D20657A79474D532F4A2B39664852672B342F644647512F686E776D504A354C724D" rel="nofollow">http://www.universalthread.com/Report.aspx?Session=3950396F5A4171707070773D20657A79474D532F4A2B39664852672B342F644647512F686E776D504A354C724D</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1672#respond' onclick='return addComment.moveForm( "div-comment-1672", "1672", "respond", "536" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1673">
				<div id="div-comment-1673" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2dfec1e4b842dd3679546b57cb21d0e6?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2dfec1e4b842dd3679546b57cb21d0e6?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Boris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1673">
			August 17, 2009 at 11:51 am</a>		</div>

		<p>Great!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1673#respond' onclick='return addComment.moveForm( "div-comment-1673", "1673", "respond", "536" )' aria-label='Reply to Boris'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1669">
				<div id="div-comment-1669" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/88fd221c449cf2c815874a8ef119429f?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/88fd221c449cf2c815874a8ef119429f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.hors-art.nl/' rel='external nofollow' class='url'>Koen</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1669">
			September 30, 2009 at 4:07 pm</a>		</div>

		<p>Great class, thanks for sharing with us!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1669#respond' onclick='return addComment.moveForm( "div-comment-1669", "1669", "respond", "536" )' aria-label='Reply to Koen'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor even thread-even depth-1" id="comment-1670">
				<div id="div-comment-1670" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1670">
			September 30, 2009 at 5:34 pm</a>		</div>

		<p>My pleasure. I plan to publish one more VFP based class I made recently (Multiselect Listbox acting like a combobox). Just need some time.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1670#respond' onclick='return addComment.moveForm( "div-comment-1670", "1670", "respond", "536" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1677">
				<div id="div-comment-1677" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4bef24c78b686359eb18e83f8be5208a?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4bef24c78b686359eb18e83f8be5208a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">young fox</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1677">
			January 13, 2010 at 7:40 pm</a>		</div>

		<p>very usefull thanks</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1677#respond' onclick='return addComment.moveForm( "div-comment-1677", "1677", "respond", "536" )' aria-label='Reply to young fox'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1676">
				<div id="div-comment-1676" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3213ef2ad0c2b2af0d644dcd6f9b98ea?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3213ef2ad0c2b2af0d644dcd6f9b98ea?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.clutions.net/' rel='external nofollow' class='url'>Francis Coppage</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1676">
			June 7, 2010 at 10:45 am</a>		</div>

		<p>I have one I did eons ago, but you&#8217;ve made it so generic.  I had to make sure everything I wanted sorted had tags and &#8220;fill in all the little boxes&#8221; every time I wanted to use it.</p>
<p>Thanks for nice piece of work!!!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1676#respond' onclick='return addComment.moveForm( "div-comment-1676", "1676", "respond", "536" )' aria-label='Reply to Francis Coppage'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1674">
				<div id="div-comment-1674" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2593bf2e698a418d7539209f460000e2?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2593bf2e698a418d7539209f460000e2?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Al Carlson</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1674">
			October 16, 2011 at 11:35 am</a>		</div>

		<p>I am still learning the many facets of FVP9. I would like to know how to incorporate your grid sort control into my applications. I do not know a lot about how to make .vcx files work and a little less about Classes. I would like to ask you how to make this work.</p>
<p>Rgards..Al</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1674#respond' onclick='return addComment.moveForm( "div-comment-1674", "1674", "respond", "536" )' aria-label='Reply to Al Carlson'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor even thread-even depth-1" id="comment-1675">
				<div id="div-comment-1675" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-1675">
			October 16, 2011 at 7:35 pm</a>		</div>

		<p>At the bottom of this blog, there is a zip file to download. Once you downloaded the file, you can put this grid class directly into the form and use in your applications as is.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=1675#respond' onclick='return addComment.moveForm( "div-comment-1675", "1675", "respond", "536" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-4092395">
				<div id="div-comment-4092395" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/dd8a3b95c34733fd3dcf9644dc7a8781?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/dd8a3b95c34733fd3dcf9644dc7a8781?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">abhiruk</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#comment-4092395">
			April 3, 2015 at 5:39 am</a>		</div>

		<p>I&#8217;m really sorry, I have tried to use this class many time but it&#8217;s not successful.could you please explain to me again.(I&#8217;m a vfp beginner)</p>
<p>Thank you in advance</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/?replytocom=4092395#respond' onclick='return addComment.moveForm( "div-comment-4092395", "4092395", "respond", "536" )' aria-label='Reply to abhiruk'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/grid-class-that-allows-sorting-by-clicki/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='536' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="8d7d8ee069cb0cbbf816bbb65d56947e"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552766017"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
