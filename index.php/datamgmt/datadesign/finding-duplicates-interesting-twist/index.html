<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Finding Duplicates &#8211; Interesting twist</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Finding Duplicates &#8211; Interesting twist" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="A recent MSDN threadpresented a very interesting problem - find duplicates based on any 4 of the 5 columns and eliminate the duplicates.Here is the data table we will be working with:CREATE TABLE tblTEST (   ID           INT    UNIQUE    N&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Finding Duplicates &#8211; Interesting twist Comments Feed" href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Book review: Quantum Man: Richard Feynman&#8217;s Life in Science' href='/index.php/itprofessionals/ethicsit/book-review-quantum-man-richard/' />
<link rel='next' title='SQL Server 2008 R2 Setup starts and then disappears' href='/index.php/datamgmt/dbadmin/sql-server-2008-r2-setup/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/" />
<link rel='shortlink' href='/?p=1203' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Ffinding-duplicates-interesting-twist%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Ffinding-duplicates-interesting-twist%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbadmin/sql-server-2008-r2-setup/" rel="next">SQL Server 2008 R2 Setup starts and then disappears</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/itprofessionals/ethicsit/book-review-quantum-man-richard/" rel="prev">Book review: Quantum Man: Richard Feynman&#8217;s Life in Science</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/" class="post-title">Finding Duplicates &#8211; Interesting twist</a></h1>
					<div class="post-byline">by <a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky" rel="author">Naomi Nosonovsky</a> on June 5, 2011 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a>. Article views: 5,688 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&text=RT @LessThanDot Blog - Finding Duplicates &amp;#8211; Interesting twist by naomi" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&title=Finding Duplicates &amp;#8211; Interesting twist&source=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&title=Finding Duplicates &amp;#8211; Interesting twist" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&quote=Finding Duplicates &amp;#8211; Interesting twist" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&title=Finding Duplicates &amp;#8211; Interesting twist" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>A recent <a href="http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/8ce895b9-11f1-494c-a63e-e25f08f93bd8">MSDN thread</a> presented a very interesting problem &#8211; find duplicates based on any 4 of the 5 columns and eliminate the duplicates.</p>
<p>Here is the data table we will be working with:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> tblTEST <span class="br0">&#40;</span> 
&nbsp; ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">INT</span> &nbsp; &nbsp;<span class="kw1">UNIQUE</span> &nbsp; &nbsp;<span class="sy0">NOT</span> <span class="sy0">NULL</span>, 
&nbsp; FirstColumn &nbsp;<span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> &nbsp; &nbsp;<span class="sy0">NOT</span> <span class="sy0">NULL</span>, 
&nbsp; SecondColumn <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> &nbsp; &nbsp;<span class="sy0">NOT</span> <span class="sy0">NULL</span>, 
&nbsp; ThirdColumn &nbsp;<span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> &nbsp; &nbsp;<span class="sy0">NOT</span> <span class="sy0">NULL</span>, 
&nbsp; FourthColumn <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> &nbsp; &nbsp;<span class="sy0">NOT</span> <span class="sy0">NULL</span>, 
&nbsp; FifthColumn &nbsp;<span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> &nbsp; &nbsp;<span class="sy0">NOT</span> <span class="sy0">NULL</span> <span class="br0">&#41;</span> 
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> tblTEST 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span>ID, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FirstColumn, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SecondColumn, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ThirdColumn, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FourthColumn, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FifthColumn<span class="br0">&#41;</span> 
<span class="kw1">VALUES</span> &nbsp; &nbsp; <span class="br0">&#40;</span><span class="nu0">1</span>,<span class="st0">'value1'</span>,<span class="st0">'value2'</span>,<span class="st0">'value3'</span>,<span class="st0">'value4'</span>,<span class="st0">'value5'</span><span class="br0">&#41;</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span><span class="nu0">2</span>,<span class="st0">'value2'</span>,<span class="st0">'value3'</span>,<span class="st0">'value4'</span>,<span class="st0">'value5'</span>,<span class="st0">'value6'</span><span class="br0">&#41;</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span><span class="nu0">3</span>,<span class="st0">'value1'</span>,<span class="st0">'value4'</span>,<span class="st0">'value5'</span>,<span class="st0">'value8'</span>,<span class="st0">'value9'</span><span class="br0">&#41;</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span><span class="nu0">4</span>,<span class="st0">'value1'</span>,<span class="st0">'value2'</span>,<span class="st0">'value7'</span>,<span class="st0">'value8'</span>,<span class="st0">'value9'</span><span class="br0">&#41;</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span><span class="nu0">5</span>,<span class="st0">'value3'</span>,<span class="st0">'value4'</span>,<span class="st0">'value5'</span>,<span class="st0">'value6'</span>,<span class="st0">'value7'</span><span class="br0">&#41;</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span><span class="nu0">6</span>,<span class="st0">'value1'</span>,<span class="st0">'value2'</span>,<span class="st0">'value9'</span>,<span class="st0">'value4'</span>,<span class="st0">'value5'</span><span class="br0">&#41;</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span><span class="nu0">7</span>,<span class="st0">'value2'</span>,<span class="st0">'value3'</span>,<span class="st0">'value4'</span>,<span class="st0">'value5'</span>,<span class="st0">'value11'</span><span class="br0">&#41;</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#40;</span><span class="nu0">8</span>,<span class="st0">'value4'</span>,<span class="st0">'value5'</span>,<span class="st0">'value3'</span>,<span class="st0">'value9'</span>,<span class="st0">'value1'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE tblTEST ( 
  ID           INT    UNIQUE    NOT NULL, 
  FirstColumn  VARCHAR(50)    NOT NULL, 
  SecondColumn VARCHAR(50)    NOT NULL, 
  ThirdColumn  VARCHAR(50)    NOT NULL, 
  FourthColumn VARCHAR(50)    NOT NULL, 
  FifthColumn  VARCHAR(50)    NOT NULL ) 

INSERT INTO tblTEST 
           (ID, 
            FirstColumn, 
            SecondColumn, 
            ThirdColumn, 
            FourthColumn, 
            FifthColumn) 
VALUES     (1,'value1','value2','value3','value4','value5'), 
           (2,'value2','value3','value4','value5','value6'), 
           (3,'value1','value4','value5','value8','value9'), 
           (4,'value1','value2','value7','value8','value9'), 
           (5,'value3','value4','value5','value6','value7'), 
           (6,'value1','value2','value9','value4','value5'), 
           (7,'value2','value3','value4','value5','value11'), 
           (8,'value4','value5','value3','value9','value1')</pre></div></div>

<p>Our test table:</p>
<div class="tables">
<table border="1" cellpadding ="5" cellspacing = "5">
<caption style="color:blue;font-weight:bold">Test Table with Duplicates</caption>
<tr>
<th>ID</th>
<th>FirstColumn</th>
<th>SecondColumn</th>
<th>ThirdColumn</th>
<th>FourthColumn</th>
<th>FifthColumn</th>
</tr>
<tr>
<td>1</td>
<td>value1</td>
<td>value2</td>
<td>value3</td>
<td>value4</td>
<td>value5</td>
</tr>
<tr>
<td>2</td>
<td>value2</td>
<td>value3</td>
<td>value4</td>
<td>value5</td>
<td>value6</td>
</tr>
<tr>
<td>3</td>
<td>value1</td>
<td>value4</td>
<td>value5</td>
<td>value8</td>
<td>value9</td>
</tr>
<tr>
<td>4</td>
<td>value1</td>
<td>value2</td>
<td>value7</td>
<td>value8</td>
<td>value9</td>
</tr>
<tr>
<td>5</td>
<td>value3</td>
<td>value4</td>
<td>value5</td>
<td>value6</td>
<td>value7</td>
</tr>
<tr>
<td>6</td>
<td>value1</td>
<td>value2</td>
<td>value9</td>
<td>value4</td>
<td>value5</td>
</tr>
<tr>
<td>7</td>
<td>value2</td>
<td>value3</td>
<td>value4</td>
<td>value5</td>
<td>value11</td>
</tr>
<tr>
<td>8</td>
<td>value4</td>
<td>value5</td>
<td>value3</td>
<td>value9</td>
<td>value1</td>
</tr>
</table>
</div>
<p>This problem is different from the typical find the duplicates problem and at first does not even seem solvable.</p>
<p>The first idea that comes to mind is to UNPIVOT values from these 5 columns into rows. This is simple enough with this code:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
</pre></td><td class="de1"><pre class="de1">;<span class="kw1">with</span> UnPvt <span class="kw1">AS</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> ID, ColValue <span class="kw1">FROM</span> tblTEST 
UNPIVOT <span class="br0">&#40;</span>ColValue <span class="kw1">FOR</span> ColName <span class="sy0">IN</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>FirstColumn<span class="br0">&#93;</span>,<span class="br0">&#91;</span>SecondColumn<span class="br0">&#93;</span>,<span class="br0">&#91;</span>ThirdColumn<span class="br0">&#93;</span>,<span class="br0">&#91;</span>FourthColumn<span class="br0">&#93;</span>, <span class="br0">&#91;</span>FifthColumn<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> unpvt<span class="br0">&#41;</span>,</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">;with UnPvt AS (SELECT ID, ColValue FROM tblTEST 
UNPIVOT (ColValue FOR ColName IN ([FirstColumn],[SecondColumn],[ThirdColumn],[FourthColumn], [FifthColumn])) unpvt),</pre></div></div>

<p>The second step is also more or less clear &#8211; find possible duplicates by counting IDs partitioned by ColValue</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1">SameVals <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> <span class="br0">&#40;</span><span class="kw1">select</span> <span class="sy0">*</span>, <span class="kw2">COUNT</span><span class="br0">&#40;</span>ID<span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span>PARTITION <span class="kw1">by</span> ColValue<span class="br0">&#41;</span> <span class="kw1">as</span> cntSame <span class="kw1">from</span> UnPvt<span class="br0">&#41;</span> X <span class="kw1">WHERE</span> cntSame <span class="sy0">&gt;=</span><span class="nu0">2</span><span class="br0">&#41;</span>,</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SameVals as (SELECT * FROM (select *, COUNT(ID) OVER (PARTITION by ColValue) as cntSame from UnPvt) X WHERE cntSame &gt;=2),</pre></div></div>

<p>Now, what can we do next? The next step was a road block for me. But then, an Eureka moment &#8211; we can use CROSS APPLY and find all records that have more than 4 values matching the current record values</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1">DupRecs <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">select</span> T.<span class="sy0">*</span>,S.<span class="me1">cntDups</span>, S.<span class="me1">ID</span> <span class="kw1">as</span> DupID
&nbsp;<span class="kw1">from</span> tblTEST T <span class="sy0">CROSS</span> APPLY <span class="br0">&#40;</span><span class="kw1">select</span> S.<span class="me1">ID</span>, <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">as</span> cntDups <span class="kw1">from</span> SameVals S
<span class="kw1">WHERE</span> T.<span class="me1">ID</span> <span class="sy0">&lt;</span> S.<span class="me1">ID</span> and S.<span class="me1">ColValue</span> <span class="sy0">IN</span> <span class="br0">&#40;</span>T.<span class="me1">FirstColumn</span>,T.<span class="me1">SecondColumn</span>,T.<span class="me1">ThirdColumn</span>,T.<span class="me1">FourthColumn</span>, T.<span class="me1">FifthColumn</span><span class="br0">&#41;</span> <span class="kw1">GROUP</span> <span class="kw1">BY</span> S.<span class="me1">ID</span><span class="br0">&#41;</span> S<span class="br0">&#41;</span>,
&nbsp;
Candidates <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">select</span> <span class="kw1">distinct</span> ID,DupID &nbsp;<span class="kw1">from</span> DupRecs <span class="kw1">where</span> cntDups <span class="sy0">&gt;=</span><span class="nu0">4</span><span class="br0">&#41;</span> </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DupRecs as (select T.*,S.cntDups, S.ID as DupID
 from tblTEST T CROSS APPLY (select S.ID, COUNT(*) as cntDups from SameVals S
WHERE T.ID &lt; S.ID and S.ColValue IN (T.FirstColumn,T.SecondColumn,T.ThirdColumn,T.FourthColumn, T.FifthColumn) GROUP BY S.ID) S),

Candidates as (select distinct ID,DupID  from DupRecs where cntDups &gt;=4) </pre></div></div>

<p>Ok, but do we want to delete all records identified in DupID column? Turned out, that it&#8217;s not even that simple. </p>
<p>Say, in our sample rows 1 &amp; 2 match. So, do we want to delete the row 2? Well, row 2 matches with the row 5. Which rows of 2/5 we delete and which to keep? That&#8217;s not easy at all.</p>
<p>So, my final select is</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">select</span> <span class="kw1">Distinct</span> DupID <span class="kw1">from</span> Candidates <span class="kw1">where</span> DupID not <span class="sy0">IN</span> <span class="br0">&#40;</span><span class="kw1">select</span> ID <span class="kw1">from</span> Candidates<span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">select Distinct DupID from Candidates where DupID not IN (select ID from Candidates)</pre></div></div>

<p>This select will only produce real duplicates.</p>
<p>Now, this is the whole solution again as one statement:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="de1"><pre class="de1">;<span class="kw1">with</span> UnPvt <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">select</span> ID, ColValue <span class="kw1">from</span> tblTEST 
UNPIVOT <span class="br0">&#40;</span>ColValue <span class="kw1">for</span> ColName <span class="sy0">IN</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>FirstColumn<span class="br0">&#93;</span>,<span class="br0">&#91;</span>SecondColumn<span class="br0">&#93;</span>,<span class="br0">&#91;</span>ThirdColumn<span class="br0">&#93;</span>,<span class="br0">&#91;</span>FourthColumn<span class="br0">&#93;</span>, <span class="br0">&#91;</span>FifthColumn<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> unpvt<span class="br0">&#41;</span>,
SameVals <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">select</span> <span class="sy0">*</span> <span class="kw1">from</span> <span class="br0">&#40;</span><span class="kw1">select</span> <span class="sy0">*</span>, <span class="kw2">COUNT</span><span class="br0">&#40;</span>ID<span class="br0">&#41;</span> <span class="kw1">over</span> <span class="br0">&#40;</span>partition <span class="kw1">by</span> ColValue<span class="br0">&#41;</span> <span class="kw1">as</span> cntSame <span class="kw1">from</span> UnPvt<span class="br0">&#41;</span> X <span class="kw1">where</span> cntSame <span class="sy0">&gt;=</span><span class="nu0">2</span><span class="br0">&#41;</span>,
DupRecs <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">select</span> T.<span class="sy0">*</span>,S.<span class="me1">cntDups</span>, S.<span class="me1">ID</span> <span class="kw1">as</span> DupID
&nbsp;<span class="kw1">from</span> tblTEST T <span class="sy0">CROSS</span> APPLY <span class="br0">&#40;</span><span class="kw1">select</span> S.<span class="me1">ID</span>, <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">as</span> cntDups <span class="kw1">from</span> SameVals S
<span class="kw1">WHERE</span> T.<span class="me1">ID</span> <span class="sy0">&lt;</span> S.<span class="me1">ID</span> and S.<span class="me1">ColValue</span> <span class="sy0">IN</span> <span class="br0">&#40;</span>T.<span class="me1">FirstColumn</span>,T.<span class="me1">SecondColumn</span>,T.<span class="me1">ThirdColumn</span>,T.<span class="me1">FourthColumn</span>, T.<span class="me1">FifthColumn</span><span class="br0">&#41;</span> <span class="kw1">GROUP</span> <span class="kw1">BY</span> S.<span class="me1">ID</span><span class="br0">&#41;</span> S<span class="br0">&#41;</span>,
&nbsp;
Candidates <span class="kw1">as</span> <span class="br0">&#40;</span><span class="kw1">select</span> <span class="kw1">distinct</span> ID,DupID &nbsp;<span class="kw1">from</span> DupRecs <span class="kw1">where</span> cntDups <span class="sy0">&gt;=</span><span class="nu0">4</span><span class="br0">&#41;</span> 
&nbsp;
<span class="kw1">select</span> <span class="kw1">Distinct</span> DupID <span class="kw1">from</span> Candidates <span class="kw1">where</span> DupID not <span class="sy0">IN</span> <span class="br0">&#40;</span><span class="kw1">select</span> ID <span class="kw1">from</span> Candidates<span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">;with UnPvt as (select ID, ColValue from tblTEST 
UNPIVOT (ColValue for ColName IN ([FirstColumn],[SecondColumn],[ThirdColumn],[FourthColumn], [FifthColumn])) unpvt),
SameVals as (select * from (select *, COUNT(ID) over (partition by ColValue) as cntSame from UnPvt) X where cntSame &gt;=2),
DupRecs as (select T.*,S.cntDups, S.ID as DupID
 from tblTEST T CROSS APPLY (select S.ID, COUNT(*) as cntDups from SameVals S
WHERE T.ID &lt; S.ID and S.ColValue IN (T.FirstColumn,T.SecondColumn,T.ThirdColumn,T.FourthColumn, T.FifthColumn) GROUP BY S.ID) S),

Candidates as (select distinct ID,DupID  from DupRecs where cntDups &gt;=4) 

select Distinct DupID from Candidates where DupID not IN (select ID from Candidates)</pre></div></div>

<p>Well, even the above solution is not quite right as now it doesn&#8217;t delete all duplicates.</p>
<p>After some more discussion in the mentioned thread and with the help of Peter Larsson, here is the solution that seems to work for the problem:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> &nbsp;@DupLoop <span class="kw1">INT</span> 
&nbsp;
<span class="kw1">SET</span> @DupLoop <span class="sy0">=</span> <span class="nu0">1</span> 
&nbsp;
<span class="kw1">WHILE</span> @DupLoop <span class="sy0">=</span> <span class="nu0">1</span> 
&nbsp; <span class="kw1">BEGIN</span> 
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="kw1">WITH</span> Dups 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">AS</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="kw1">DISTINCT</span> a.<span class="me1">ID</span> <span class="kw1">AS</span> DuplicateID 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> &nbsp; dbo.<span class="me1">tblTEST</span> <span class="kw1">AS</span> t 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="sy0">JOIN</span> dbo.<span class="me1">tblTEST</span> <span class="kw1">AS</span> a 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ON</span> a.<span class="me1">ID</span> <span class="sy0">&gt;</span> t.<span class="me1">ID</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">AND</span> a.<span class="me1">FirstColumn</span> <span class="sy0">IN</span> <span class="br0">&#40;</span>t.<span class="me1">FirstColumn</span>,t.<span class="me1">SecondColumn</span>,t.<span class="me1">ThirdColumn</span>,t.<span class="me1">FourthColumn</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;t.<span class="me1">FifthColumn</span><span class="br0">&#41;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="sy0">JOIN</span> dbo.<span class="me1">tblTEST</span> <span class="kw1">AS</span> b 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ON</span> b.<span class="me1">ID</span> <span class="sy0">=</span> a.<span class="me1">ID</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">AND</span> b.<span class="me1">SecondColumn</span> <span class="sy0">IN</span> <span class="br0">&#40;</span>t.<span class="me1">FirstColumn</span>,t.<span class="me1">SecondColumn</span>,t.<span class="me1">ThirdColumn</span>,t.<span class="me1">FourthColumn</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t.<span class="me1">FifthColumn</span><span class="br0">&#41;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="sy0">JOIN</span> dbo.<span class="me1">tblTEST</span> <span class="kw1">AS</span> c 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ON</span> c.<span class="me1">ID</span> <span class="sy0">=</span> a.<span class="me1">ID</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">AND</span> c.<span class="me1">ThirdColumn</span> <span class="sy0">IN</span> <span class="br0">&#40;</span>t.<span class="me1">FirstColumn</span>,t.<span class="me1">SecondColumn</span>,t.<span class="me1">ThirdColumn</span>,t.<span class="me1">FourthColumn</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;t.<span class="me1">FifthColumn</span><span class="br0">&#41;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="sy0">JOIN</span> dbo.<span class="me1">tblTEST</span> <span class="kw1">AS</span> d 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ON</span> d.<span class="me1">ID</span> <span class="sy0">=</span> a.<span class="me1">ID</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">AND</span> d.<span class="me1">FourthColumn</span> <span class="sy0">IN</span> <span class="br0">&#40;</span>t.<span class="me1">FirstColumn</span>,t.<span class="me1">SecondColumn</span>,t.<span class="me1">ThirdColumn</span>,t.<span class="me1">FourthColumn</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; t.<span class="me1">FifthColumn</span><span class="br0">&#41;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">LEFT</span> <span class="sy0">JOIN</span> dbo.<span class="me1">tblTEST</span> <span class="kw1">AS</span> e 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ON</span> e.<span class="me1">ID</span> <span class="sy0">=</span> a.<span class="me1">ID</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="sy0">AND</span> e.<span class="me1">FifthColumn</span> <span class="sy0">IN</span> <span class="br0">&#40;</span>t.<span class="me1">FirstColumn</span>,t.<span class="me1">SecondColumn</span>,t.<span class="me1">ThirdColumn</span>,t.<span class="me1">FourthColumn</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;t.<span class="me1">FifthColumn</span><span class="br0">&#41;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">WHERE</span> &nbsp;<span class="kw1">CASE</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHEN</span> a.<span class="me1">ID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span> <span class="kw1">THEN</span> <span class="nu0">0</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="nu0">1</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">END</span> <span class="sy0">+</span> <span class="kw1">CASE</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHEN</span> b.<span class="me1">ID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span> <span class="kw1">THEN</span> <span class="nu0">0</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="nu0">1</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">END</span> <span class="sy0">+</span> <span class="kw1">CASE</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHEN</span> c.<span class="me1">ID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span> <span class="kw1">THEN</span> <span class="nu0">0</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="nu0">1</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">END</span> <span class="sy0">+</span> <span class="kw1">CASE</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHEN</span> d.<span class="me1">ID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span> <span class="kw1">THEN</span> <span class="nu0">0</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="nu0">1</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">END</span> <span class="sy0">+</span> <span class="kw1">CASE</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHEN</span> e.<span class="me1">ID</span> <span class="kw1">IS</span> <span class="sy0">NULL</span> <span class="kw1">THEN</span> <span class="nu0">0</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="nu0">1</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">END</span> <span class="sy0">&gt;=</span> <span class="nu0">4</span><span class="br0">&#41;</span> 
&nbsp; &nbsp; <span class="kw1">DELETE</span> <span class="kw1">FROM</span> tblTEST 
&nbsp; &nbsp; <span class="kw1">WHERE</span> &nbsp; &nbsp; &nbsp; ID <span class="sy0">IN</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> &nbsp; <span class="kw1">TOP</span> <span class="br0">&#40;</span> <span class="nu0">1</span> <span class="br0">&#41;</span> DuplicateID 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> &nbsp; &nbsp; Dups 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">ORDER</span> <span class="kw1">BY</span> DuplicateID<span class="br0">&#41;</span> 
&nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; <span class="kw1">SELECT</span> @DupLoop <span class="sy0">=</span> <span class="kw2">@@ROWCOUNT</span> 
&nbsp; <span class="kw1">END</span> 
&nbsp;
<span class="kw1">SELECT</span> <span class="sy0">*</span> 
<span class="kw1">FROM</span> &nbsp; tblTest</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE  @DupLoop INT 

SET @DupLoop = 1 

WHILE @DupLoop = 1 
  BEGIN 
     
     
    WITH Dups 
         AS (SELECT DISTINCT a.ID AS DuplicateID 
             FROM   dbo.tblTEST AS t 
                    LEFT JOIN dbo.tblTEST AS a 
                      ON a.ID &gt; t.ID 
                         AND a.FirstColumn IN (t.FirstColumn,t.SecondColumn,t.ThirdColumn,t.FourthColumn,
                                               t.FifthColumn) 
                    LEFT JOIN dbo.tblTEST AS b 
                      ON b.ID = a.ID 
                         AND b.SecondColumn IN (t.FirstColumn,t.SecondColumn,t.ThirdColumn,t.FourthColumn,
                                                t.FifthColumn) 
                    LEFT JOIN dbo.tblTEST AS c 
                      ON c.ID = a.ID 
                         AND c.ThirdColumn IN (t.FirstColumn,t.SecondColumn,t.ThirdColumn,t.FourthColumn,
                                               t.FifthColumn) 
                    LEFT JOIN dbo.tblTEST AS d 
                      ON d.ID = a.ID 
                         AND d.FourthColumn IN (t.FirstColumn,t.SecondColumn,t.ThirdColumn,t.FourthColumn,
                                                t.FifthColumn) 
                    LEFT JOIN dbo.tblTEST AS e 
                      ON e.ID = a.ID 
                         AND e.FifthColumn IN (t.FirstColumn,t.SecondColumn,t.ThirdColumn,t.FourthColumn,
                                               t.FifthColumn) 
             WHERE  CASE 
                      WHEN a.ID IS NULL THEN 0 
                      ELSE 1 
                    END + CASE 
                            WHEN b.ID IS NULL THEN 0 
                            ELSE 1 
                          END + CASE 
                                  WHEN c.ID IS NULL THEN 0 
                                  ELSE 1 
                                END + CASE 
                                        WHEN d.ID IS NULL THEN 0 
                                        ELSE 1 
                                      END + CASE 
                                              WHEN e.ID IS NULL THEN 0 
                                              ELSE 1 
                                            END &gt;= 4) 
    DELETE FROM tblTEST 
    WHERE       ID IN (SELECT   TOP ( 1 ) DuplicateID 
                       FROM     Dups 
                       ORDER BY DuplicateID) 
     
    SELECT @DupLoop = @@ROWCOUNT 
  END 

SELECT * 
FROM   tblTest</pre></div></div>

<p>Well, hopefully this was interesting to read as for me trying to solve such problem. Thanks for listening!</p>
<p>*** <strong>Remember, if you have a SQL related question, try our <a href="http://forum.lessthandot.com/viewforum.php?f=17">Microsoft SQL Server Programming</a> forum or our <a href="http://forum.lessthandot.com/viewforum.php?f=22">Microsoft SQL Server Admin</a> forum</strong><ins></ins></p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/finding-exact-duplicate-indexes/'>Finding Exact Duplicate Indexes</a><p>This blog is not meant to be a comprehensive explanation of indexes. It is meant&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-advent-2011-day-16/'>SQL Advent 2011 Day 16: CROSS APPLY and OUTER APPLY</a><p>Today we are going to take a look at CROSS APPLY and OUTER APPLY. The&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Naomi Nosonovsky, Senior Software Developer, has more than 15 years of enterprise experience in analysis, design, development and implementation of high-performance client/server data management solutions.

She is a Personality of the Year for 2008, 2009, 2010 and 2011 at www.universalthread.com in .NET, SQL Server & VFP categories.

She is also an All Star contributor/MCC Community Contributor at forums.asp.net and MSDN T-SQL forum.


 
	



    

    


<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/?sk=messages&tid=1240691655679#!/profile.php?id=10395470" title="Naomi at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/profile?viewProfile=&key=55538716&trk=tab_pro" title="Naomi at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://delicious.com/http://delicious.com/naomi_nos" title="Naomi at delicious" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_delicious.png" alt="delicious" /></a><a href="/index.php/author/naomi/feed/" title="Blog RSS feed for Naomi" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 5,688 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/naomi/">Read More Posts by Naomi Nosonovsky</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&text=RT @LessThanDot Blog - Finding Duplicates &amp;#8211; Interesting twist by naomi" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&title=Finding Duplicates &amp;#8211; Interesting twist&source=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&title=Finding Duplicates &amp;#8211; Interesting twist" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&quote=Finding Duplicates &amp;#8211; Interesting twist" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/&title=Finding Duplicates &amp;#8211; Interesting twist" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		8 Comments	</h4>
			<ol class="comments-list">
					<li class="comment even thread-even depth-1" id="comment-4352">
				<div id="div-comment-4352" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/b0e9f185f474648bd6d69f0b71de4e08?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/b0e9f185f474648bd6d69f0b71de4e08?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#comment-4352">
			June 9, 2011 at 5:17 am</a>		</div>

		<p>Hello Naomi,<br />
I hope you don&#8217;t mind I&#8217;m back with my questions.  After testing it looks like we still have error in the result.  This is what I did: <br />
INSERT INTO tblTEST(ID, FirstColumn,SecondColumn,ThirdColumn,FourthColumn, FifthColumn)<br />
values<br />
(&#8216;1&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;),<br />
(&#8216;2&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Peter&#8217;),<br />
(&#8216;3&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Thomas&#8217;),<br />
(&#8216;4&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;),<br />
(&#8216;5&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Paul&#8217;,&#8217;Thomas&#8217;),<br />
(&#8216;6&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8216;7&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;),<br />
(&#8216;8&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Thomas&#8217;),<br />
(&#8216;9&#8242;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Michael&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;10&#8217;,&#8217;Alex&#8217;,&#8217;George&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;11&#8217;,&#8217;Alex&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;),<br />
(&#8217;12&#8217;,&#8217;Alex&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;13&#8217;,&#8217;Alex&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;14&#8217;,&#8217;Alex&#8217;,&#8217;Gerard&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;15&#8217;,&#8217;Alex&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;16&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;),<br />
(&#8217;17&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;18&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;19&#8217;,&#8217;George&#8217;,&#8217;Gerard&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;20&#8217;,&#8217;George&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;),<br />
(&#8217;21&#8217;,&#8217;Gerard&#8217;,&#8217;Michael&#8217;,&#8217;Paul&#8217;,&#8217;Peter&#8217;,&#8217;Thomas&#8217;)</p>
<p>And the result is rows:1, 6, 15, 20 and 21.</p>
<p>Rows with ID 20, 21 should not be in it. I&#8217;ve tried few things already and it didn&#8217;t help. I&#8217;m going to keep tying no matter what but your ideas and solutions may really cut the long way short.<br />
George </p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?replytocom=4352#respond' onclick='return addComment.moveForm( "div-comment-4352", "4352", "respond", "1203" )' aria-label='Reply to George'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola odd alt thread-odd thread-alt depth-1" id="comment-4353">
				<div id="div-comment-4353" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#comment-4353">
			June 9, 2011 at 6:21 am</a>		</div>

		<p>Very nice article, which I&#8217;m going to use as an example why normalization matters 😀</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?replytocom=4353#respond' onclick='return addComment.moveForm( "div-comment-4353", "4353", "respond", "1203" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor even thread-even depth-1" id="comment-4354">
				<div id="div-comment-4354" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#comment-4354">
			June 9, 2011 at 6:53 am</a>		</div>

		<p>George, I see the problem, but I don&#8217;t see an easy solution right away 🙁</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?replytocom=4354#respond' onclick='return addComment.moveForm( "div-comment-4354", "4354", "respond", "1203" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-4356">
				<div id="div-comment-4356" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0f36d161b8061f4bd3a6b315be452aa9?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0f36d161b8061f4bd3a6b315be452aa9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Harizone Estimada</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#comment-4356">
			June 29, 2011 at 2:27 am</a>		</div>

		<p>For finding duplicates, I used the following:</p>
<p>SELECT COUNT(idfield), field1_to_check, field2_to_check, fieldX_to_check FROM SomeTable<br />
GROUP BY field1_to_check, field2_to_check, fieldX_to_check<br />
HAVING COUNT(idfield) > 1</p>
<p>In the case above, this is the query to find the duplicate record.</p>
<p>SELECT count(ID), FirstColumn, SecondColumn, ThirdColumn, FourthColumn<br />
FROM tblTEST<br />
GROUP BY FirstColumn, SecondColumn, ThirdColumn, FourthColumn<br />
HAVING COUNT(ID)>1</p>
<p>-Harizone</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?replytocom=4356#respond' onclick='return addComment.moveForm( "div-comment-4356", "4356", "respond", "1203" )' aria-label='Reply to Harizone Estimada'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor even thread-even depth-1" id="comment-4357">
				<div id="div-comment-4357" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#comment-4357">
			June 29, 2011 at 6:22 am</a>		</div>

		<p>Harizone,</p>
<p>Unfortunately, the problem is more complex, as we want to find duplicates by any 4 out of the 5 columns and we don&#8217;t expect the exact same 4 for each record. That&#8217;s why we presented more complex solutions, but we gave up at the end &#8211; the problem seems too complicated to solve.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?replytocom=4357#respond' onclick='return addComment.moveForm( "div-comment-4357", "4357", "respond", "1203" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-4355">
				<div id="div-comment-4355" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1e2e2400f9a6b3543e7ce8d9e6c80610?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1e2e2400f9a6b3543e7ce8d9e6c80610?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Johnny Bell</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#comment-4355">
			July 4, 2012 at 4:23 pm</a>		</div>

		<p>Hi Naomi, I tend to use this:</p>
<p>SELECT MAX(FIRST) AS FIRST, MAX(SECOND) AS SECOND, MAX(THIRD) AS THIRD, MAX(FOURTH) AS FOURTH, MAX(FIFTH) AS FIFTH, MAX(ID) AS ID<br />
INTO TABLENAME_TEMP<br />
FROM TABLENAME<br />
GROUP BY FIRST+SECOND+THIRD+FOURTH+FIFTH</p>
<p>DELETE FROM TABLENAME<br />
WHERE ID NOT IN (SELECT ID FROM TABLENAME_TEMP)</p>
<p>DROP TABLE TABLENAME_TEMP</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?replytocom=4355#respond' onclick='return addComment.moveForm( "div-comment-4355", "4355", "respond", "1203" )' aria-label='Reply to Johnny Bell'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment even depth-2 parent" id="comment-5872150">
				<div id="div-comment-5872150" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/8f05e72a2f03fbad12947c6c2e75f873?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/8f05e72a2f03fbad12947c6c2e75f873?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.dFarber.com/' rel='external nofollow' class='url'>Doron</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#comment-5872150">
			October 26, 2017 at 11:25 pm</a>		</div>

		<p>Hello,</p>
<p>You may check this article with a different approach at: </p>
<p><a href="http://www.dfarber.com/computer-consulting-blog/2011/12/26/remove-duplicate-records-in-sql" rel="nofollow">http://www.dfarber.com/computer-consulting-blog/2011/12/26/remove-duplicate-records-in-sql</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?replytocom=5872150#respond' onclick='return addComment.moveForm( "div-comment-5872150", "5872150", "respond", "1203" )' aria-label='Reply to Doron'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment byuser comment-author-naomi bypostauthor odd alt depth-3" id="comment-5872538">
				<div id="div-comment-5872538" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#comment-5872538">
			October 27, 2017 at 7:31 am</a>		</div>

		<p>Hi Doron,</p>
<p>I took a quick peak at your blog, but it doesn&#8217;t seem like you&#8217;re solving that same problem I was discussing when we don&#8217;t care which column out of N is a duplicate.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/?replytocom=5872538#respond' onclick='return addComment.moveForm( "div-comment-5872538", "5872538", "respond", "1203" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/finding-duplicates-interesting-twist/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1203' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="5fd0b37cd7dbbb00f97ba6ce92bf5add"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552766011"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
