<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Extracting numbers with SQL Server</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Extracting numbers with SQL Server" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="We all have perfectly normalized tables, with perfectly scrubbed data, right?  I wish!  Sometimes we are stuck with dirty data in legacy applications.  What's worse is that we are sometimes expected to do interesting things with dirty data.  In this blo&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Extracting numbers with SQL Server Comments Feed" href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='IronPython 2.0 has been released, now runs on top of the Dynamic Language Runtime (DLR)' href='/index.php/desktopdev/mstech/ironpython-2-0-has-been-released/' />
<link rel='next' title='SQL Server 2005 Service Pack 3 has been released' href='/index.php/datamgmt/datadesign/sql-server-2005-service-pack-3-has-been/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/" />
<link rel='shortlink' href='/?p=251' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fextracting-numbers-with-sql-server%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fextracting-numbers-with-sql-server%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/datadesign/sql-server-2005-service-pack-3-has-been/" rel="next">SQL Server 2005 Service Pack 3 has been released</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/desktopdev/mstech/ironpython-2-0-has-been-released/" rel="prev">IronPython 2.0 has been released, now runs on top of the Dynamic Language Runtime (DLR)</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/" class="post-title">Extracting numbers with SQL Server</a></h1>
					<div class="post-byline">by <a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)" rel="author">George Mastros (gmmastros)</a> on December 12, 2008 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 85,603 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&text=RT @LessThanDot Blog - Extracting numbers with SQL Server by @gmmastros" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&title=Extracting numbers with SQL Server&source=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&title=Extracting numbers with SQL Server" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&quote=Extracting numbers with SQL Server" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&title=Extracting numbers with SQL Server" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>We all have perfectly normalized tables, with perfectly scrubbed data, right?  I wish!  Sometimes we are stuck with dirty data in legacy applications.  What&#8217;s worse is that we are sometimes expected to do interesting things with dirty data.  In this blog, I will show you how to extract a number from a varchar column that contains letters and numbers.</p>
<p>First, let’s take a look at what some of that data might look like:</p>
<p><span style="color:blue;">2.1 miles<br />
4 miles<br />
Approximately 6.5 miles<br />
3.9<br />
7.2miles</span></p>
<p>Suppose we wanted to extract just the numeric portion of the text.  How would we do this?  My first reaction was to use PatIndex to find the first non-numeric character.  Unfortunately, this won’t work because of the 3rd row (Approximately 6.5 miles).  Then, I thought about CharIndex, knowing there is an optional 3rd parameter that allows us to pick the starting location for the search.  Unfortunately, CharIndex doesn’t allow pattern matching, and PatIndex doesn’t accommodate starting somewhere other than the beginning.  </p>
<p>How do we do this?  Well… it get’s tricky.</p>
<p>The first thing we need to do is to find the character that is a number.  For this, we can use PatIndex:</p>
<p><strong>Select PatIndex(&#8216;%[0-9.-]%&#8217;, Data)</strong></p>
<p>Next, Let&#8217;s remove any characters from the beginning of the string, like this:</p>
<p><strong>Select SubString(Data, PatIndex(&#8216;%[0-9.-]%&#8217;, Data), 8000)</strong></p>
<p>This allows us to accommodate any characters that appear before the numbers.  The substring result forces the numbers to the beginning of the string.  Next step is to determine where the numbers end.  For that, we can use PatIndex again.</p>
<p><strong>Select PatIndex(&#8216;%[^0-9.-]%&#8217;, SubString(Data, PatIndex(&#8216;%[0-9.-]%&#8217;, Data), 8000))</strong></p>
<p>PatIndex returns an integer for the first character that matches.  We&#8217;ll want to use this in a LEFT function, there there is a potential problem. If there&#8217;s no match, PatIndex will return 0.  So, we should make sure that PatIndex will always return at least one.  We can trick the system by appending a character before running the PatIndex function.  Like this:</p>
<p><strong>Select PatIndex(&#8216;%[^0-9.-]%&#8217;, SubString(Data, PatIndex(&#8216;%[0-9.-]%&#8217;, Data), 8000) + &#8216;X&#8217;)</strong></p>
<p>By including something we know will match the pattern, we guarantee that we get a number greater than zero from the PatIndex function.</p>
<p>Next step is to get the left part of the substring, which will return just the numbers.  Like this:</p>
<p><strong>Select Left(SubString(Data, PatIndex(&#8216;%[0-9.-]%&#8217;, Data), 8000), PatIndex(&#8216;%[^0-9.-]%&#8217;, SubString(Data, PatIndex(&#8216;%[0-9.-]%&#8217;, Data), 8000) + &#8216;X&#8217;)-1)</strong></p>
<p>Now, I will admit that this is a very ugly formula to use.  However, there is a high probability that it is re-usable.  Because of this, it would make a nice little function to have in our SQL Arsenal.</p>
<pre>Create Function dbo.GetNumbers(@Data VarChar(8000))
Returns VarChar(8000)
AS
Begin	
    Return Left(
             SubString(@Data, PatIndex('%[0-9.-]%', @Data), 8000), 
             PatIndex('%[^0-9.-]%', SubString(@Data, PatIndex('%[0-9.-]%', @Data), 8000) + 'X')-1)
End</pre>
<p>Now, we can use this function wherever we need it.  As a final step, let&#8217;s test it on our sample data.  Before doing this, let&#8217;s think about other data that could potentially cause us problems.  We should test an empty string, NULL, a string without any numbers, and a string that contains multiple numbers separated by characters.<br />
Declare @Temp Table(Data VarChar(60))</p>
<pre>Insert Into @Temp Values('2.1 miles')
Insert Into @Temp Values('4 miles')
Insert Into @Temp Values('Approximately 6.5 miles')
Insert Into @Temp Values('3.9')
Insert Into @Temp Values('7.2miles')
Insert Into @Temp Values('')
Insert Into @Temp Values(NULL)
Insert Into @Temp Values('No Numbers Here')
Insert Into @Temp Values('approximately 2.5 miles, but less than 3')

Select Data, dbo.GetNumbers(Data)
From   @Temp</pre>
<p>The results are:</p>
<pre>&lt;span style="color:blue;"&gt;
Data                                     Numbers
---------------------------------------- -------
2.1 miles                                2.1
4 miles                                  4
Approximately 6.5 miles                  6.5
3.9                                      3.9
7.2miles                                 7.2
                                         
NULL                                     NULL
No Numbers Here                          
approximately 2.5 miles, but less than 3 2.5
&lt;/span&gt;</pre>
<p>I wish we could count on our data being perfect, but we really can&#8217;t.  The best we can do is to use the data we are given in a way that works.</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-server-extracting-data-again/'>SQL Server Extracting Data (again)</a><p>In a recent article, I explained how to extract numbers from a string. This blog&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-server-2008-logo/'>SQL Server 2008 Logo</a><p>Here is the new logo for SQL Server 2008. Looks pretty clean, what do you&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>George has been developing software professionally for 19 years, first for the department of defense, and then for various other companies.  In 1998, George started his software company, Orbit Software, specializing in School Bus Transportation software.  His specialty is refining SQL Server queries to deliver optimal performance.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/gmmastros" title="gmmastros at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="/index.php/author/gmmastros/feed/" title="Blog RSS feed for gmmastros" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 85,603 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/gmmastros/">Read More Posts by George Mastros (gmmastros)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&text=RT @LessThanDot Blog - Extracting numbers with SQL Server by @gmmastros" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&title=Extracting numbers with SQL Server&source=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&title=Extracting numbers with SQL Server" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&quote=Extracting numbers with SQL Server" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/&title=Extracting numbers with SQL Server" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		51 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-onpnt even thread-even depth-1" id="comment-595">
				<div id="div-comment-595" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-595">
			December 12, 2008 at 12:54 pm</a>		</div>

		<p>This is excellent and I owe you thanks again 😉</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=595#respond' onclick='return addComment.moveForm( "div-comment-595", "595", "respond", "251" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-596">
				<div id="div-comment-596" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/523bf587cb6937fda85a1824f1348dc6?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/523bf587cb6937fda85a1824f1348dc6?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='https://www.accordhr.com/' rel='external nofollow' class='url'>Stephen Moore</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-596">
			December 12, 2008 at 2:14 pm</a>		</div>

		<p>Simple way to do this in Oracle is</p>
<p>SELECT TRANSLATE(&#8216;blah123blah&#8217;, &#8216;0123456789abcdefghijklmnopqrstuvwxyz&#8217;,&#8217;0123456789&#8242;)<br />
FROM dual;</p>
<p>The translate function looks for a character by character translation.  If it only gets a match on numerics it will strip out the remaining characters.  Might need to add uppercase characters to 2nd arg, not sure.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=596#respond' onclick='return addComment.moveForm( "div-comment-596", "596", "respond", "251" )' aria-label='Reply to Stephen Moore'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt even thread-even depth-1" id="comment-597">
				<div id="div-comment-597" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-597">
			December 13, 2008 at 10:32 am</a>		</div>

		<p>how do decimal values get handled in your example? It looks like a basic pattern match function to me and not really what the author was getting at.  In your comment a basic LIKE regex pattern is the equal in T-SQL and not much to do with the actual blog</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=597#respond' onclick='return addComment.moveForm( "div-comment-597", "597", "respond", "251" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-565">
				<div id="div-comment-565" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/a6e5f61687e7296c02e0e9db6da9c46f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/a6e5f61687e7296c02e0e9db6da9c46f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">David Krueger</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-565">
			January 19, 2009 at 9:13 am</a>		</div>

		<p>This worked great, it is going to be a real life saver.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=565#respond' onclick='return addComment.moveForm( "div-comment-565", "565", "respond", "251" )' aria-label='Reply to David Krueger'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-592">
				<div id="div-comment-592" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/00f70df345ffe7a741216aedcf35360a?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/00f70df345ffe7a741216aedcf35360a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.pngpeles.com/' rel='external nofollow' class='url'>John Titi</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-592">
			February 20, 2009 at 6:13 pm</a>		</div>

		<p>This is an excellent function. I have included in mine as well as clients databases with aknowledgement for the author.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=592#respond' onclick='return addComment.moveForm( "div-comment-592", "592", "respond", "251" )' aria-label='Reply to John Titi'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-562">
				<div id="div-comment-562" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/d8850146a9f4361eb8b8069d640539f2?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/d8850146a9f4361eb8b8069d640539f2?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Rich Ellingham</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-562">
			March 18, 2009 at 9:12 am</a>		</div>

		<p>Massive thanks, I looked in numerous places for such an answer. Many thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=562#respond' onclick='return addComment.moveForm( "div-comment-562", "562", "respond", "251" )' aria-label='Reply to Rich Ellingham'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-alexcuse even thread-even depth-1" id="comment-574">
				<div id="div-comment-574" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/5e8bfdc77e52098a1ab2ddd1cd2a176f?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/5e8bfdc77e52098a1ab2ddd1cd2a176f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Alex Ullrich</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-574">
			May 19, 2009 at 1:31 pm</a>		</div>

		<p>I needed just this today 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=574#respond' onclick='return addComment.moveForm( "div-comment-574", "574", "respond", "251" )' aria-label='Reply to Alex Ullrich'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-583">
				<div id="div-comment-583" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/ea57a0458bd87f643d3a1e3821415600?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/ea57a0458bd87f643d3a1e3821415600?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jason Adams</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-583">
			May 29, 2009 at 8:24 am</a>		</div>

		<p>George,</p>
<p>I was looking for something like this the other day.  Found it via<br />
tek-tips.  Thanks again!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=583#respond' onclick='return addComment.moveForm( "div-comment-583", "583", "respond", "251" )' aria-label='Reply to Jason Adams'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-560">
				<div id="div-comment-560" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/bd208ce6af1ce3bf935ce3c6627c16ea?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/bd208ce6af1ce3bf935ce3c6627c16ea?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Nate</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-560">
			July 1, 2009 at 7:39 am</a>		</div>

		<p>THANKS! Great function for deailing with very poor database design. You have saved me a lot of time. Thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=560#respond' onclick='return addComment.moveForm( "div-comment-560", "560", "respond", "251" )' aria-label='Reply to Nate'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-573">
				<div id="div-comment-573" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f2d320ebb624e727d276da372408f1a2?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f2d320ebb624e727d276da372408f1a2?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Maureen</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-573">
			August 24, 2009 at 12:46 am</a>		</div>

		<p>How can i extract percentages only?</p>
<p>Eg: 0.35 from &#8220;Up to 0.35% pa&#8221;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=573#respond' onclick='return addComment.moveForm( "div-comment-573", "573", "respond", "251" )' aria-label='Reply to Maureen'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-590">
				<div id="div-comment-590" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/bb74db706ea3d930796153cce66365fb?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/bb74db706ea3d930796153cce66365fb?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Mark</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-590">
			September 14, 2009 at 5:09 am</a>		</div>

		<p>First off, great!  We have people who submit data via cellphone and I needed a way to get just the numbers out of the messages that they send.  I can&#8217;t rely only on this function to do all the cleaning that&#8217;s required, and I&#8217;ve written some of my own code to bulk it out, but it certainly helped!</p>
<p>I did some playing and I want to ask if this is not just as good/better than your final query above:</p>
<p>SELECT SUBSTRING(@NumTrim, PATINDEX(&#8216;%[0-9.-]%&#8217;, @NumTrim), PATINDEX(&#8216;%[^0-9.-]%&#8217;, SUBSTRING(@NumTrim, PATINDEX(&#8216;%[0-9.-]%&#8217;, @NumTrim), 8000)+&#8217;X&#8217;)-1)</p>
<p>I&#8217;ve simply removed the LEFT() expression and used the same info to feed one substring.  It works with the data I&#8217;ve fed it, but am I missing something?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=590#respond' onclick='return addComment.moveForm( "div-comment-590", "590", "respond", "251" )' aria-label='Reply to Mark'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-591">
				<div id="div-comment-591" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/25e07c08119a40b731750a6f747d53e8?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/25e07c08119a40b731750a6f747d53e8?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://sqlquest.blogspot.com/' rel='external nofollow' class='url'>sql_Quest</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-591">
			September 14, 2009 at 2:59 pm</a>		</div>

		<p>The article is excellent. Liked a lot !</p>
<p>Maureen:</p>
<p>the code works fine for extracting 0.35 from &#8220;Up to 0.35% pa&#8221; </p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=591#respond' onclick='return addComment.moveForm( "div-comment-591", "591", "respond", "251" )' aria-label='Reply to sql_Quest'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-555">
				<div id="div-comment-555" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/c105f8283ffd57a73007a15ebde0a3ac?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/c105f8283ffd57a73007a15ebde0a3ac?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.dotnetvj.com/' rel='external nofollow' class='url'>Vijaya Kadiyala</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-555">
			December 20, 2009 at 7:15 pm</a>		</div>

		<p>This article is good but one question, but for the string <br />
&#8220;approximately 2.5 miles, but less than 3&#8221; function returned only 2.5.<br />
Does it mean to find only the first occurence of the numbers?</p>
<p>Thanks &#8212; Vijaya Kadiyala<br />
<a href="http://www.DotNetVJ.com/" rel="nofollow">http://www.DotNetVJ.com</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=555#respond' onclick='return addComment.moveForm( "div-comment-555", "555", "respond", "251" )' aria-label='Reply to Vijaya Kadiyala'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-556">
				<div id="div-comment-556" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-556">
			December 21, 2009 at 6:12 am</a>		</div>

		<p>Vijaya,</p>
<p>Yes.  This is only meant to find the first occurrence of a number within a string. If you have a different requirement than this, please post a question in the forum here, and I (and others) will be glad to help.</p>
<p><a href="http://forum.lessthandot.com/viewforum.php?f=17" rel="nofollow">http://forum.lessthandot.com/viewforum.php?f=17</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=556#respond' onclick='return addComment.moveForm( "div-comment-556", "556", "respond", "251" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-558">
				<div id="div-comment-558" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/950cbddeae1ab7e4051c47b0f19081b5?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/950cbddeae1ab7e4051c47b0f19081b5?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://accessblog.net/' rel='external nofollow' class='url'>Alex Dybenko</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-558">
			February 4, 2010 at 1:56 am</a>		</div>

		<p>Thanks, great article!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=558#respond' onclick='return addComment.moveForm( "div-comment-558", "558", "respond", "251" )' aria-label='Reply to Alex Dybenko'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-559">
				<div id="div-comment-559" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/950cbddeae1ab7e4051c47b0f19081b5?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/950cbddeae1ab7e4051c47b0f19081b5?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://accessblog.net/' rel='external nofollow' class='url'>Alex Dybenko</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-559">
			February 4, 2010 at 2:07 am</a>		</div>

		<p>Here a function to create series based on this one:<br />
<a href="http://accessblog.net/2010/02/tsql-increase-series-number.html">t-sql Increase series number</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=559#respond' onclick='return addComment.moveForm( "div-comment-559", "559", "respond", "251" )' aria-label='Reply to Alex Dybenko'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-593">
				<div id="div-comment-593" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/57c0eab5c0f2ca0ac5a1e4166c453c22?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/57c0eab5c0f2ca0ac5a1e4166c453c22?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Steve J</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-593">
			March 9, 2010 at 4:39 pm</a>		</div>

		<p>Excellent article and very helpful!</p>
<p>Thanks</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=593#respond' onclick='return addComment.moveForm( "div-comment-593", "593", "respond", "251" )' aria-label='Reply to Steve J'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola odd alt thread-odd thread-alt depth-1" id="comment-588">
				<div id="div-comment-588" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-588">
			October 28, 2010 at 1:36 am</a>		</div>

		<p>CTE to extract all numbers from string:</p>
<p>
Declare @txt varchar(4000) =&#8217;ab123sdf45.6dfgh. 6fgjh7df12345.67gh9a123,456.79aa8&#8242;<br />
Declare @num varchar(10)  = &#8216;%[0-9.,]%&#8217;<br />
Declare @oth varchar(10)  = &#8216;%[^0-9.,]%&#8217;</p>
<p>Set @txt+=&#8217;X&#8217;</p>
<p>;With a as (<br />
Select 1 as i,<br />
       Substring(@txt,Patindex(@num,@txt),patindex(@oth,Substring(@txt,Patindex(@num,@txt),4000))-1) as num, <br />
       substring(@txt,Patindex(@num,@txt)+patindex(@oth,Substring(@txt,Patindex(@num,@txt),4000))-1,4000) as txt<br />
Union All<br />
Select i+1,<br />
       Substring(txt,Patindex(@num,txt),patindex(@oth,Substring(txt,Patindex(@num,txt),4000))-1), <br />
       substring(txt,Patindex(@num,txt)+patindex(@oth,Substring(txt,Patindex(@num,txt),4000))-1,4000)<br />
  from a<br />
 Where txt like &#8216;%[0-9]%&#8217;<br />
)<br />
Select i, num from a<br />
Where num like &#8216;%[0-9]%&#8217;</p>
<p></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=588#respond' onclick='return addComment.moveForm( "div-comment-588", "588", "respond", "251" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi even thread-even depth-1" id="comment-594">
				<div id="div-comment-594" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-594">
			November 15, 2010 at 7:12 am</a>		</div>

		<p>Here is another interesting approach to keep only numbers (all numbers) and remove anything else from the string &#8211; Alex Kuznetsov idea</p>
<p>from this thread <a href="http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/a9228119-9334-44fa-916f-dc7d92d2f983">Extracting numbers from string</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=594#respond' onclick='return addComment.moveForm( "div-comment-594", "594", "respond", "251" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-575">
				<div id="div-comment-575" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Srr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-575">
			January 16, 2011 at 10:37 pm</a>		</div>

		<p>Hi,</p>
<p>Thanks, great article! </p>
<p>I want extract first numeric values of the string, like:</p>
<p>Ex.<br />
Input               output<br />
&#8212;&#8212;             &#8212;&#8212;&#8212;<br />
# 1                 0<br />
6 patches           6 <br />
&#8211;                   0<br />
1 15 gm tube        1<br />
1 BOX-8             1<br />
1/2pak              1 <br />
1`5 gm              1<br />
16 packs/7e         16<br />
one box(100)        0<br />
1-28 day pak        1</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=575#respond' onclick='return addComment.moveForm( "div-comment-575", "575", "respond", "251" )' aria-label='Reply to Srr'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-576">
				<div id="div-comment-576" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Srr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-576">
			January 17, 2011 at 2:31 am</a>		</div>

		<p>input<br />
&#8212;&#8212;&#8212;-<br />
# 1 <br />
6 patches <br />
&#8211; <br />
1 15 gm tube<br />
1 BOX-8 <br />
1/2pak <br />
1`5 gm <br />
16 packs/7e <br />
one box(100) <br />
1-28 day pak </p>
<p>
output<br />
&#8212;&#8212;&#8212;<br />
0<br />
6<br />
0<br />
1<br />
1<br />
1 <br />
1<br />
16<br />
0<br />
1</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=576#respond' onclick='return addComment.moveForm( "div-comment-576", "576", "respond", "251" )' aria-label='Reply to Srr'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-577">
				<div id="div-comment-577" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-577">
			January 17, 2011 at 12:57 pm</a>		</div>

		<p>Try</p>
<p>
declare @t table(Col varchar(100))<br />
insert into @t <br />
select<br />
&#8216;# 1&#8217;<br />
union all select <br />
&#8216;6 patches&#8217;<br />
union all select <br />
&#8216;- &#8216;<br />
union all select<br />
&#8216;1 15 gm tube&#8217;<br />
union all select<br />
&#8216;1 BOX-8&#8217;<br />
union all select <br />
&#8216;1/2pak&#8217;<br />
union all select <br />
&#8216;1`5 gm&#8217; <br />
union all select<br />
&#8217;16 packs/7e&#8217;<br />
union all select <br />
&#8216;one box(100)&#8217;<br />
union all select <br />
&#8216;1-28 day pak&#8217;</p>
<p>select COL, F.Pos, F2.Number <br />
from @t <br />
cross apply (select PATINDEX (&#8216;%[^0-9]%&#8217;,Col) as Pos) F<br />
cross apply (select Case when F.Pos > 1 then cast(left(Col, Pos &#8211; 1) as int) else 0 end as [Number]) F2</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=577#respond' onclick='return addComment.moveForm( "div-comment-577", "577", "respond", "251" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor even thread-even depth-1" id="comment-578">
				<div id="div-comment-578" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-578">
			January 17, 2011 at 1:06 pm</a>		</div>

		<p>Naomi,</p>
<p>Your query fails when the string is all numbers.  For example, add &#8220;union all select &#8216;128&#8217;&#8221; to the end of your sample data.</p>
<p>Srr, you will probably have better luck if you try this:</p>
<p>Convert(Int, Left(YourColumnName, PatIndex(&#8216;%[^0-9]%&#8217;, YourColumnName + &#8216; &#8216;)-1))</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=578#respond' onclick='return addComment.moveForm( "div-comment-578", "578", "respond", "251" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-579">
				<div id="div-comment-579" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-579">
			January 17, 2011 at 1:32 pm</a>		</div>

		<p>Yes. This is also simpler than cross apply and checking Pos.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=579#respond' onclick='return addComment.moveForm( "div-comment-579", "579", "respond", "251" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-580">
				<div id="div-comment-580" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Srr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-580">
			January 17, 2011 at 9:30 pm</a>		</div>

		<p>Thanks George Mastros,</p>
<p>But i want like 14.5 values also.<br />
I want in numeric(12,2) not in int,i tried but getting error.</p>
<p>Convert(numeric(12,2), Left(col, PatIndex(&#8216;%[^0-9.]%&#8217;, col + &#8216; &#8216;)-1))<br />
from table</p>
<p>Thanks in advance,<br />
Srr</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=580#respond' onclick='return addComment.moveForm( "div-comment-580", "580", "respond", "251" )' aria-label='Reply to Srr'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-581">
				<div id="div-comment-581" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-581">
			January 18, 2011 at 7:30 am</a>		</div>

		<p>Srr,</p>
<p>You are getting an error because you CAN convert an empty string to an int, but not to a decimal.</p>
<p>Try this:<br />
Coalesce(Convert(Decimal(12,2), NullIf(Left(Col, PatIndex(&#8216;%[^0-9.]%&#8217;, Col + &#8216; &#8216;)-1), &#8221;)), 0)</p>
<p>Instead of directly converting to decimal, we use the NULLIF function to convert empty strings to nulls.  Then we convert, and finally use coalesce to convert the nulls to 0.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=581#respond' onclick='return addComment.moveForm( "div-comment-581", "581", "respond", "251" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-582">
				<div id="div-comment-582" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Srr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-582">
			January 18, 2011 at 9:51 pm</a>		</div>

		<p>Hi George Mastros,</p>
<p>It is very nice.U helped me alot,my problem solved. <br />
In my query i used like this:<br />
case charindex(&#8216;.&#8217;,col) <br />
when 1 then case isnumeric(col) when 1 then col else &#8216;0&#8217; end<br />
else Coalesce(Convert(numeric(12,2),NullIf(Left(ltrim(col),PatIndex(&#8216;%[^0-9.]%&#8217;,ltrim(col) + &#8216; &#8216;)-1), &#8221;)),0)<br />
end</p>
<p>Thanks,<br />
Srr</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=582#respond' onclick='return addComment.moveForm( "div-comment-582", "582", "respond", "251" )' aria-label='Reply to Srr'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-584">
				<div id="div-comment-584" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4b48b4750becc56e1e0092a0471ba6ab?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Srr</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-584">
			January 19, 2011 at 4:37 am</a>		</div>

		<p>Hi,<br />
I have table like below,</p>
<p>first_nm	last_nm	  Gender<br />
Raj	       s	   F <br />
Rajp	       e           M <br />
Kar	     Sh           M <br />
De	  re              M <br />
Sw        ko               F <br />
Kal	la	           F <br />
Sa	Sa                 M </p>
<p>now  i need to  update my table  each row  last_nm with another record last_nm within gender(means female-female,male-male)</p>
<p>example:<br />
first_nm  last_nm	Gender<br />
Rajp	   re              M <br />
Kar	   e	           M <br />
De         Sh              M <br />
Sw         s               F <br />
Kal	  ko 	           F<br />
Raj	  la	           F </p>
<p>Thanks,<br />
Srr</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=584#respond' onclick='return addComment.moveForm( "div-comment-584", "584", "respond", "251" )' aria-label='Reply to Srr'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-566">
				<div id="div-comment-566" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/182721b7a9068691db83485500cde4ce?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/182721b7a9068691db83485500cde4ce?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://methodCRM.com/' rel='external nofollow' class='url'>Paul</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-566">
			March 17, 2011 at 8:04 pm</a>		</div>

		<p>Awesome code.  I was looking for the most efficient way to get the next increment of invoice numbers, where there can be an alphanumeric prepender and post, where the max number is not guranteed to be the last record. This code works flawlessly.  Thank you.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=566#respond' onclick='return addComment.moveForm( "div-comment-566", "566", "respond", "251" )' aria-label='Reply to Paul'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-572">
				<div id="div-comment-572" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/38a23549fab2bd6723559410cc2a8907?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/38a23549fab2bd6723559410cc2a8907?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Anand</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-572">
			August 21, 2011 at 12:49 pm</a>		</div>

		<p>I want to re-write the query given above:</p>
<p>Select Left(SubString(Data, PatIndex(&#8216;%[0-9.-]%&#8217;, Data), 8000), PatIndex(&#8216;%[^0-9.-]%&#8217;, SubString(Data, PatIndex(&#8216;%[0-9.-]%&#8217;, Data), 8000) + &#8216;X&#8217;)-1)</p>
<p>but in Teradata syntax. Some part the about query does not work the way it should in Teradata. For example, &#8216;%[0-9.-]%&#8217; is not working in Teradata.<br />
please help</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=572#respond' onclick='return addComment.moveForm( "div-comment-572", "572", "respond", "251" )' aria-label='Reply to Anand'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-587">
				<div id="div-comment-587" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/67ab0b20dff9c24bb9cd3f103013fd67?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/67ab0b20dff9c24bb9cd3f103013fd67?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">kasinathpatil</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-587">
			October 28, 2011 at 4:36 am</a>		</div>

		<p>declare @debid bigint<br />
declare @address varchar(200) = null<br />
set @debid=(select debtor_id from account where debtor_id=34691)<br />
set @address = (Select Left(SubString(information, PatIndex(&#8216;%[0-9.-]%&#8217;, information), 8000), PatIndex(&#8216;%[^0-9.-]%&#8217;, SubString(information, PatIndex(&#8216;%[0-9.-]%&#8217;, information), 8000) + &#8216;X&#8217;)-1) <br />
from debtor_info where description = &#8216;Mailing Address&#8217; and score > 0 and debtor_id=@debid)<br />
print @address</p>
<p>
I have this address&#8211;(30 JLN SAM HUP HUT 34900 PANTAIREMIS PERAK)<br />
i need to pik pincode like -34900 from the abow data can u please send me query ,im using abow query but it reterns only first digit of the dada&#8230;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=587#respond' onclick='return addComment.moveForm( "div-comment-587", "587", "respond", "251" )' aria-label='Reply to kasinathpatil'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-odd thread-alt depth-1 parent" id="comment-589">
				<div id="div-comment-589" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-589">
			October 28, 2011 at 6:29 am</a>		</div>

		<p>@kasinathpatil,</p>
<p>The code in this blog is meant to find any number.  It appears as though you are looking for a 5 digit number, which does change this a bit.  As such, I would encourage you to try this instead.</p>
<p>&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-<br />
Declare @Information VarChar(200)</p>
<p>Set @Information = &#8217;30 JLN SAM HUP HUT 34900 PANTAIREMIS PERAK&#8217;</p>
<p>Select Case When PatIndex(&#8216;%[0-9.-][0-9.-][0-9.-][0-9.-][0-9.-]%&#8217;, @information) > 0<br />
            Then SubString(@Information, PatIndex(&#8216;%[0-9.-][0-9.-][0-9.-][0-9.-][0-9.-]%&#8217;, @information), 5)<br />
            Else &#8221; End<br />
&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;-</p>
<p>If a 5 digit number is found, it will be returned.  If there is no 5 digit number, this code will return an empty string.  </p>
<p>One word of caution, if you have a string of numbers longer than 5 digits, this code will return the first 5 digits of that number.  For example, if you have a 5 (or more) digit house number, this code will return that instead of the 5 digit number.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=589#respond' onclick='return addComment.moveForm( "div-comment-589", "589", "respond", "251" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment even depth-2" id="comment-1490061">
				<div id="div-comment-1490061" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/6d4e277f8ab89e06e2113f68f7df9097?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/6d4e277f8ab89e06e2113f68f7df9097?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Karen Rogers</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-1490061">
			July 31, 2014 at 11:35 am</a>		</div>

		<p>Simple but brilliant.  Thank you!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=1490061#respond' onclick='return addComment.moveForm( "div-comment-1490061", "1490061", "respond", "251" )' aria-label='Reply to Karen Rogers'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-557">
				<div id="div-comment-557" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/07a3bc690f35e82146f5e2f168100a4e?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/07a3bc690f35e82146f5e2f168100a4e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://tutjunction.com/' rel='external nofollow' class='url'>jasmit</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-557">
			March 6, 2012 at 3:17 am</a>		</div>

		<p>very helpful<br />
thanks</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=557#respond' onclick='return addComment.moveForm( "div-comment-557", "557", "respond", "251" )' aria-label='Reply to jasmit'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-561">
				<div id="div-comment-561" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0fd365dbe2622eef8a496380ed457acf?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0fd365dbe2622eef8a496380ed457acf?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Andres</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-561">
			July 19, 2012 at 8:22 am</a>		</div>

		<p>Nice!! That looks really cool!. I could find another options to do that but all of them involve the creation of a function, and i need to do this inside a simple query. Here is the complication i have: How can i do the same using MySql??. i can&#8217;t find a replacement for the Patindex function&#8230;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=561#respond' onclick='return addComment.moveForm( "div-comment-561", "561", "respond", "251" )' aria-label='Reply to Andres'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-585">
				<div id="div-comment-585" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/97c0f74f00e104df85ebabd5cf27cd82?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/97c0f74f00e104df85ebabd5cf27cd82?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jewel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-585">
			September 6, 2012 at 3:55 pm</a>		</div>

		<p>Thank you so much for this function.  It has been very helpful.</p>
<p>I am curious if it would be possible to modify the function to handle commas when they appear within a number -e.g. 1,340.  1,340 returns a value of 1 when I run it.</p>
<p>Any assistance would be greatly appreciated.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=585#respond' onclick='return addComment.moveForm( "div-comment-585", "585", "respond", "251" )' aria-label='Reply to Jewel'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor even thread-odd thread-alt depth-1" id="comment-586">
				<div id="div-comment-586" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-586">
			September 6, 2012 at 4:01 pm</a>		</div>

		<p>In the function I show in the code you will see 2 occurrences of &#8216;%[0-9.-]%&#8217;</p>
<p>Replace both of them with: </p>
<p>&#8216;%[0-9,.-]%&#8217; </p>
<p>** Note that I added a comma in the string.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=586#respond' onclick='return addComment.moveForm( "div-comment-586", "586", "respond", "251" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-567">
				<div id="div-comment-567" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1eef4c8704aea4960369857900383c44?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1eef4c8704aea4960369857900383c44?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Maximillian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-567">
			October 31, 2012 at 7:06 pm</a>		</div>

		<p>Hello George,<br />
I really enjoyed your solution above, but I still have a question.<br />
George what about if I&#8217;m to repeat the search of numbers within the string and each number must be assigned to a fixed column.</p>
<p>eg. &#8220;car256 bicycle1245 motor48 train453&#8221; and in this string which is already in column in my database, I&#8217;m to further select only the numbers aspect and place them in other table with different columns for car, bicycle, motor and train</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=567#respond' onclick='return addComment.moveForm( "div-comment-567", "567", "respond", "251" )' aria-label='Reply to Maximillian'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-568">
				<div id="div-comment-568" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0f35a950a9b4f0527bed997c24554514?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0f35a950a9b4f0527bed997c24554514?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">mahdi</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-568">
			November 1, 2012 at 4:26 am</a>		</div>

		<p>hello<br />
very nice<br />
thanks</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=568#respond' onclick='return addComment.moveForm( "div-comment-568", "568", "respond", "251" )' aria-label='Reply to mahdi'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-even depth-1" id="comment-569">
				<div id="div-comment-569" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-569">
			November 1, 2012 at 10:11 am</a>		</div>

		<p>Maximillian,</p>
<p>I would suggest that you find a good split function and split on the spaces.  Then you can use the extract numbers function to separate the &#8220;car&#8221; from the &#8220;256&#8221; and so on.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=569#respond' onclick='return addComment.moveForm( "div-comment-569", "569", "respond", "251" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-570">
				<div id="div-comment-570" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1eef4c8704aea4960369857900383c44?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1eef4c8704aea4960369857900383c44?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Maximillian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-570">
			November 1, 2012 at 4:48 pm</a>		</div>

		<p>George,</p>
<p>I&#8217;m really grateful for the swift response you my post. actually I want the numerical section as my data to be inserted then,the alphabets thus car, motor and so to be my condition of insert, thus WHERE column name = car, or motor depending on where it was extracted form. <br />
Please kindly gie a sample of the solution thank yoou<br />
Maximillian</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=570#respond' onclick='return addComment.moveForm( "div-comment-570", "570", "respond", "251" )' aria-label='Reply to Maximillian'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-571">
				<div id="div-comment-571" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1eef4c8704aea4960369857900383c44?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1eef4c8704aea4960369857900383c44?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Maximillian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-571">
			November 2, 2012 at 11:56 am</a>		</div>

		<p>George,<br />
how would you handle your own example if one of the data was like &#8216;Approximately 6.5 miles and 5.2 miles&#8217; all on the same line.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=571#respond' onclick='return addComment.moveForm( "div-comment-571", "571", "respond", "251" )' aria-label='Reply to Maximillian'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-563">
				<div id="div-comment-563" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/be502976a585f97bcd9e3bc4620edb32?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/be502976a585f97bcd9e3bc4620edb32?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">DeveloperDan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-563">
			March 6, 2013 at 2:29 pm</a>		</div>

		<p>Can you suggest a fix that allows the minus symbol to appear away from the number? You code fails with the text:</p>
<p>&#8216;tip-toe 3 steps&#8217;</p>
<p>(The function returns just the minus sign, not the number 3)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=563#respond' onclick='return addComment.moveForm( "div-comment-563", "563", "respond", "251" )' aria-label='Reply to DeveloperDan'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-564">
				<div id="div-comment-564" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/be502976a585f97bcd9e3bc4620edb32?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/be502976a585f97bcd9e3bc4620edb32?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">DeveloperDan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-564">
			March 7, 2013 at 8:55 am</a>		</div>

		<p>The function also fails when a dot appears then text then the number:</p>
<p>&#8216;I found a problem. This text generates a dot instead of a 3.&#8217;</p>
<p>I coded an ugly solution. Perhaps you have a clean fix?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=564#respond' onclick='return addComment.moveForm( "div-comment-564", "564", "respond", "251" )' aria-label='Reply to DeveloperDan'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback even thread-odd thread-alt depth-1" id="comment-1101099">
				<div id="div-comment-1101099" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://goldennugets.info/wordpress/?p=79' rel='external nofollow' class='url'>Strip text and extract numeric value from string using TSQL | GoldenNugets</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-1101099">
			June 9, 2014 at 7:39 pm</a>		</div>

		<p>[&#8230;] changed format of a string pattern our SQL was expecting. I came across a function written by George Mastros that addressed my SQL needs. Long story short we have a string with text then a number and some [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=1101099#respond' onclick='return addComment.moveForm( "div-comment-1101099", "1101099", "respond", "251" )' aria-label='Reply to Strip text and extract numeric value from string using TSQL | GoldenNugets'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-2854850">
				<div id="div-comment-2854850" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/066cfac23965ce4ad2380a2411d6905f?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/066cfac23965ce4ad2380a2411d6905f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">James</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-2854850">
			November 27, 2014 at 3:35 pm</a>		</div>

		<p>I love what you&#8217;ve done here&#8230; but using sql server and RegExMatch is powerful and looks a lot neater. I found the following at <a href="https://www.simple-talk.com/sql/t-sql-programming/clr-assembly-regex-functions-for-sql-server-by-example/" rel="nofollow">https://www.simple-talk.com/sql/t-sql-programming/clr-assembly-regex-functions-for-sql-server-by-example/</a> </p>
<p>The equivalent to your Patindex is:</p>
<p>Select dbo.RegExMatch(&#8216;\d+&#8217;, YourColumnName,1) as StripNumber</p>
<p>If I can follow his instructions anyone can!!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=2854850#respond' onclick='return addComment.moveForm( "div-comment-2854850", "2854850", "respond", "251" )' aria-label='Reply to James'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-5318920">
				<div id="div-comment-5318920" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/1a40c229a635f040a12afab548acee13?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/1a40c229a635f040a12afab548acee13?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Nelson Abainza</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-5318920">
			October 20, 2016 at 11:34 pm</a>		</div>

		<p>thank you so much!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=5318920#respond' onclick='return addComment.moveForm( "div-comment-5318920", "5318920", "respond", "251" )' aria-label='Reply to Nelson Abainza'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-even depth-1" id="comment-5838961">
				<div id="div-comment-5838961" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/640415e108b34582586798917a5cbfe8?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/640415e108b34582586798917a5cbfe8?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Darren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-5838961">
			September 29, 2017 at 5:54 am</a>		</div>

		<p>Hi, This works great in all cases except where I have a comma as a thousand separator. Where I have &#8216;1,000&#8217; I get &#8216;1&#8217; as the result &#8211; how can I fix this?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=5838961#respond' onclick='return addComment.moveForm( "div-comment-5838961", "5838961", "respond", "251" )' aria-label='Reply to Darren'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-5838968">
				<div id="div-comment-5838968" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/640415e108b34582586798917a5cbfe8?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/640415e108b34582586798917a5cbfe8?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Darren</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-5838968">
			September 29, 2017 at 6:12 am</a>		</div>

		<p>&#8230;Answered my own question&#8230;</p>
<p>alter Function dbo.GetNumbers(@Data VarChar(8000))<br />
Returns VarChar(8000)<br />
AS<br />
Begin<br />
declare @NoComma varchar(8000) = replace(@data,&#8217;,&#8217;,&#8221;)</p>
<p>    Return </p>
<p>			Left(<br />
             SubString(@NoComma, PatIndex(&#8216;%[0-9.-]%&#8217;, @NoComma), 8000),<br />
             PatIndex(&#8216;%[^0-9.-]%&#8217;, SubString(@NoComma, PatIndex(&#8216;%[0-9.-]%&#8217;, @NoComma), 8000) + &#8216;X&#8217;)-1)<br />
End</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=5838968#respond' onclick='return addComment.moveForm( "div-comment-5838968", "5838968", "respond", "251" )' aria-label='Reply to Darren'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback odd alt thread-even depth-1" id="comment-5921361">
				<div id="div-comment-5921361" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://questionfocus.com/how-do-i-extract-part-of-a-string-in-t-sql.html' rel='external nofollow' class='url'>How do I extract part of a string in t-sql - QuestionFocus</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-5921361">
			December 9, 2017 at 9:04 am</a>		</div>

		<p>[&#8230;] Extracting numbers with SQL Server [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=5921361#respond' onclick='return addComment.moveForm( "div-comment-5921361", "5921361", "respond", "251" )' aria-label='Reply to How do I extract part of a string in t-sql - QuestionFocus'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-6013294">
				<div id="div-comment-6013294" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/b2d7d2d13aed54c2ed7feb538b382b42?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/b2d7d2d13aed54c2ed7feb538b382b42?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Melanie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#comment-6013294">
			February 12, 2018 at 2:30 am</a>		</div>

		<p>&#8220;We all have perfectly normalized tables, with perfectly scrubbed data, right? I wish! Sometimes we are stuck with dirty data in legacy applications. What’s worse is that we are sometimes expected to do interesting things with dirty data.&#8221;<br />
..That is excatly where i am. Thank you so much sir, this is what i&#8217;ve been looking for the days.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/?replytocom=6013294#respond' onclick='return addComment.moveForm( "div-comment-6013294", "6013294", "respond", "251" )' aria-label='Reply to Melanie'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/extracting-numbers-with-sql-server/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='251' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="bac9162b47c56fc8a4d2a519803d51b3"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765992"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
