<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   How to search for all words inclusive without using Full Text search</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   How to search for all words inclusive without using Full Text search" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="I encountered this question last October in one of the forums I&#8217;m frequent. The question was: given the table with the keywords, find all records from some table which would include all these words (Implementing search with AND keyword). From the first glance the problem looks trivial, but for me the solution was not very [&hellip;]" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; How to search for all words inclusive without using Full Text search Comments Feed" href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='A couple of ways of getting the top 2 distinct values from a set in SQL Server' href='/index.php/datamgmt/datadesign/a-couple-of-ways-of-getting-the-top-2-di/' />
<link rel='next' title='Push your DBA skills over the edge by becoming a better developer' href='/index.php/datamgmt/dbprogramming/push-your-dba-skills-over-the-edge-and-b/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/" />
<link rel='shortlink' href='/?p=499' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fhow-to-search-for-all-words-inclusive-wi%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fhow-to-search-for-all-words-inclusive-wi%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbprogramming/push-your-dba-skills-over-the-edge-and-b/" rel="next">Push your DBA skills over the edge by becoming a better developer</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/datamgmt/datadesign/a-couple-of-ways-of-getting-the-top-2-di/" rel="prev">A couple of ways of getting the top 2 distinct values from a set in SQL Server</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/" class="post-title">How to search for all words inclusive without using Full Text search</a></h1>
					<div class="post-byline">by <a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky" rel="author">Naomi Nosonovsky</a> on July 8, 2009 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 33,729 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&text=RT @LessThanDot Blog - How to search for all words inclusive without using Full Text search by naomi" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&title=How to search for all words inclusive without using Full Text search&source=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&title=How to search for all words inclusive without using Full Text search" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&quote=How to search for all words inclusive without using Full Text search" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&title=How to search for all words inclusive without using Full Text search" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>I encountered this question last October in one of the forums I&#8217;m frequent. The question was: given the table with the keywords, find all records from some table which would include all these words (Implementing search with AND keyword). <span id="more-499"></span>From the first glance the problem looks trivial, but for me the solution was not very obvious and I used Borislav Borissov&#8217;s help in solving it.</p>
<p>I want to also note, that we can pass the list of keywords as a delimited list and split into table using any of the available splitting functions (you can explore this problem at <a href="http://www.sommarskog.se/arrays-in-sql.html">Arrays and Lists in SQL Server</a> blog)</p>
<p>The code bellow illustrates the problem and the solution I found.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @MyTable <span class="kw1">TABLE</span> <span class="br0">&#40;</span>Id <span class="kw1">int</span> <span class="kw1">identity</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span>, Searched <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @Keys &nbsp; &nbsp;<span class="kw1">TABLE</span> <span class="br0">&#40;</span>Word <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span>, WordId <span class="kw1">int</span> <span class="kw1">identity</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Father Daughter Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Daughter Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Daughter Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Father Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Son Daughter Father'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Other Word'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Father Daughter Brother Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Daughter Son Stepdaughter'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Son And Stepson and Daughter and Father and Grandfather'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Daughter Son Family'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Brother Father Son Orphan'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Son or Daughter or Father'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother And Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @MyTable <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Other Word One More'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @Keys <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @Keys <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Father'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @Keys <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @Keys <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Daughter'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">DECLARE</span> @nAllWords <span class="kw1">int</span>
<span class="kw1">SELECT</span> @nAllWords <span class="sy0">=</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> @Keys
&nbsp;
<span class="kw1">SELECT</span> MyTable.<span class="sy0">*</span>
<span class="kw1">FROM</span> @MyTable MyTable
<span class="kw1">INNER</span> <span class="sy0">JOIN</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> MyTable.<span class="me1">Id</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> @MyTable MyTable
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">INNER</span> <span class="sy0">JOIN</span> @Keys KeyWords <span class="kw1">ON</span> <span class="st0">' '</span> <span class="sy0">+</span> MyTable.<span class="me1">Searched</span> <span class="sy0">+</span> <span class="st0">' '</span> <span class="sy0">LIKE</span> <span class="st0">'% '</span> <span class="sy0">+</span> KeyWords.<span class="me1">Word</span> &nbsp;<span class="sy0">+</span> <span class="st0">' %'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">GROUP</span> <span class="kw1">BY</span> MyTable.<span class="me1">Id</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">HAVING</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="kw1">Distinct</span><span class="br0">&#40;</span>KeyWords.<span class="me1">Word</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">=</span> @nAllWords<span class="br0">&#41;</span> Tbl1 <span class="kw1">ON</span> MyTable.<span class="me1">Id</span> <span class="sy0">=</span> Tbl1.<span class="me1">Id</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @MyTable TABLE (Id int identity(1,1), Searched varchar(200))
DECLARE @Keys    TABLE (Word varchar(200), WordId int identity(1,1))

INSERT INTO @MyTable VALUES ('Mother Father Daughter Son')
INSERT INTO @MyTable VALUES ('Mother Daughter Son')
INSERT INTO @MyTable VALUES ('Mother Son')
INSERT INTO @MyTable VALUES ('Daughter Son')
INSERT INTO @MyTable VALUES ('Mother Father Son')
INSERT INTO @MyTable VALUES ('Son Daughter Father')
INSERT INTO @MyTable VALUES ('Mother Son')
INSERT INTO @MyTable VALUES ('Other Word')
INSERT INTO @MyTable VALUES ('Mother Father Daughter Brother Son')
INSERT INTO @MyTable VALUES ('Mother Daughter Son Stepdaughter')
INSERT INTO @MyTable VALUES ('Mother Son And Stepson and Daughter and Father and Grandfather')
INSERT INTO @MyTable VALUES ('Daughter Son Family')
INSERT INTO @MyTable VALUES ('Mother Brother Father Son Orphan')
INSERT INTO @MyTable VALUES ('Son or Daughter or Father')
INSERT INTO @MyTable VALUES ('Mother And Son')
INSERT INTO @MyTable VALUES ('Other Word One More')

INSERT INTO @Keys VALUES ('Mother')
INSERT INTO @Keys VALUES ('Father')
INSERT INTO @Keys VALUES ('Son')
INSERT INTO @Keys VALUES ('Daughter')

DECLARE @nAllWords int
SELECT @nAllWords = COUNT(*) FROM @Keys

SELECT MyTable.*
FROM @MyTable MyTable
INNER JOIN (SELECT MyTable.Id
                   FROM @MyTable MyTable
            INNER JOIN @Keys KeyWords ON ' ' + MyTable.Searched + ' ' LIKE '% ' + KeyWords.Word  + ' %'
            GROUP BY MyTable.Id
            HAVING COUNT(Distinct(KeyWords.Word)) = @nAllWords) Tbl1 ON MyTable.Id = Tbl1.Id</pre></div></div>

<p>The above is the original test case and the solution we implemented with Borislav.</p>
<p>Based on Nikola&#8217;s comments I re-worked the test case. The last suggestion performs the best. We can get further improvement if we include &#8216;% &#8216; in our Keys and WordsToExclude tables. For the explanation of the last Nikola&#8217;s query see http://msdn.microsoft.com/en-us/library/ms178543.aspx</p>
<p>See also this blog <a href="http://bradsruminations.blogspot.com/2009/08/all-any-and-some-three-stooges.html">ALL, ANY and SOME: The Three Stooges</a> </p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
</pre></td><td class="de1"><pre class="de1"><span class="kw1">USE</span> <span class="br0">&#91;</span>AllTests<span class="br0">&#93;</span>
GO
&nbsp;
<span class="coMULTI">/****** Object: &nbsp;Table [dbo].[RealTest] &nbsp; &nbsp;Script Date: 08/19/2009 19:39:24 ******/</span>
<span class="kw1">SET</span> ANSI_<span class="sy0">NULL</span>S <span class="kw1">ON</span>
GO
&nbsp;
<span class="kw1">SET</span> QUOTED_IDENTIFIER <span class="kw1">ON</span>
GO
&nbsp;
<span class="kw1">SET</span> ANSI_PADD<span class="sy0">IN</span>G <span class="kw1">ON</span>
GO
&nbsp;
<span class="kw1">IF</span> <span class="sy0">NOT</span> <span class="sy0">EXISTS</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> sys.<span class="me1">objects</span> <span class="kw1">WHERE</span> <span class="kw2">object_id</span> <span class="sy0">=</span> <span class="kw2">OBJECT_ID</span><span class="br0">&#40;</span>N<span class="st0">'[dbo].[RealTest]'</span><span class="br0">&#41;</span> <span class="sy0">AND</span> type in <span class="br0">&#40;</span>N<span class="st0">'U'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">BEGIN</span>
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>RealTest<span class="br0">&#93;</span><span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span>Id<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">int</span><span class="br0">&#93;</span> <span class="kw1">IDENTITY</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>Searched<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp;<span class="kw1">CONSTRAINT</span> <span class="br0">&#91;</span>PK_RealTest<span class="br0">&#93;</span> <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span> <span class="kw1">CLUSTERED</span> 
<span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span>Id<span class="br0">&#93;</span> <span class="kw1">ASC</span>
<span class="br0">&#41;</span><span class="kw1">WITH</span> <span class="br0">&#40;</span>PAD_<span class="sy0">IN</span>DEX &nbsp;<span class="sy0">=</span> <span class="kw1">OFF</span>, STATISTICS_N<span class="sy0">OR</span>ECOMPUTE &nbsp;<span class="sy0">=</span> <span class="kw1">OFF</span>, IGN<span class="sy0">OR</span>E_DUP_KEY <span class="sy0">=</span> <span class="kw1">OFF</span>, <span class="sy0">ALL</span>OW_ROW_LOCKS &nbsp;<span class="sy0">=</span> <span class="kw1">ON</span>, <span class="sy0">ALL</span>OW_PAGE_LOCKS &nbsp;<span class="sy0">=</span> <span class="kw1">ON</span><span class="br0">&#41;</span> <span class="kw1">ON</span> <span class="br0">&#91;</span><span class="kw1">PRIMARY</span><span class="br0">&#93;</span>
<span class="br0">&#41;</span> <span class="kw1">ON</span> <span class="br0">&#91;</span><span class="kw1">PRIMARY</span><span class="br0">&#93;</span>
<span class="kw1">END</span>
GO
&nbsp;
<span class="co1">--ALTER TABLE [dbo].[RealTest] DISABLE CHANGE_TRACKING </span>
GO
&nbsp;
<span class="kw1">SET</span> ANSI_PADD<span class="sy0">IN</span>G <span class="kw1">OFF</span>
GO
&nbsp;
<span class="kw1">USE</span> <span class="br0">&#91;</span>AllTests<span class="br0">&#93;</span>
GO
&nbsp;
<span class="kw1">USE</span> <span class="br0">&#91;</span>AllTests<span class="br0">&#93;</span>
GO
&nbsp;
<span class="coMULTI">/****** Object: &nbsp;Index [PK_RealTest] &nbsp; &nbsp;Script Date: 08/19/2009 19:53:06 ******/</span>
<span class="kw1">IF</span> <span class="sy0">NOT</span> <span class="sy0">EXISTS</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> sys.<span class="me1">indexes</span> <span class="kw1">WHERE</span> <span class="kw2">object_id</span> <span class="sy0">=</span> <span class="kw2">OBJECT_ID</span><span class="br0">&#40;</span>N<span class="st0">'[dbo].[RealTest]'</span><span class="br0">&#41;</span> <span class="sy0">AND</span> name <span class="sy0">=</span> N<span class="st0">'PK_RealTest'</span><span class="br0">&#41;</span>
<span class="kw1">ALTER</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>RealTest<span class="br0">&#93;</span> <span class="kw1">ADD</span> &nbsp;<span class="kw1">CONSTRAINT</span> <span class="br0">&#91;</span>PK_RealTest<span class="br0">&#93;</span> <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span> <span class="kw1">CLUSTERED</span> 
<span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span>Id<span class="br0">&#93;</span> <span class="kw1">ASC</span>
<span class="br0">&#41;</span><span class="kw1">WITH</span> <span class="br0">&#40;</span>PAD_<span class="sy0">IN</span>DEX &nbsp;<span class="sy0">=</span> <span class="kw1">OFF</span>, STATISTICS_N<span class="sy0">OR</span>ECOMPUTE &nbsp;<span class="sy0">=</span> <span class="kw1">OFF</span>, S<span class="sy0">OR</span>T_<span class="sy0">IN</span>_TEMPDB <span class="sy0">=</span> <span class="kw1">OFF</span>, IGN<span class="sy0">OR</span>E_DUP_KEY <span class="sy0">=</span> <span class="kw1">OFF</span>, ONL<span class="sy0">IN</span>E <span class="sy0">=</span> <span class="kw1">OFF</span>, <span class="sy0">ALL</span>OW_ROW_LOCKS &nbsp;<span class="sy0">=</span> <span class="kw1">ON</span>, <span class="sy0">ALL</span>OW_PAGE_LOCKS &nbsp;<span class="sy0">=</span> <span class="kw1">ON</span><span class="br0">&#41;</span> <span class="kw1">ON</span> <span class="br0">&#91;</span><span class="kw1">PRIMARY</span><span class="br0">&#93;</span>
GO
&nbsp;
&nbsp;
<span class="coMULTI">/****** Object: &nbsp;Index [IX_RealTest] &nbsp; &nbsp;Script Date: 08/19/2009 19:52:29 ******/</span>
<span class="kw1">IF</span> <span class="sy0">NOT</span> <span class="sy0">EXISTS</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> sys.<span class="me1">indexes</span> <span class="kw1">WHERE</span> <span class="kw2">object_id</span> <span class="sy0">=</span> <span class="kw2">OBJECT_ID</span><span class="br0">&#40;</span>N<span class="st0">'[dbo].[RealTest]'</span><span class="br0">&#41;</span> <span class="sy0">AND</span> name <span class="sy0">=</span> N<span class="st0">'IX_RealTest'</span><span class="br0">&#41;</span>
<span class="kw1">CREATE</span> <span class="kw1">NONCLUSTERED</span> <span class="kw1">INDEX</span> <span class="br0">&#91;</span>IX_RealTest<span class="br0">&#93;</span> <span class="kw1">ON</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>RealTest<span class="br0">&#93;</span> 
<span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span>Searched<span class="br0">&#93;</span> <span class="kw1">ASC</span>
<span class="br0">&#41;</span><span class="kw1">WITH</span> <span class="br0">&#40;</span>PAD_<span class="sy0">IN</span>DEX &nbsp;<span class="sy0">=</span> <span class="kw1">OFF</span>, STATISTICS_N<span class="sy0">OR</span>ECOMPUTE &nbsp;<span class="sy0">=</span> <span class="kw1">OFF</span>, S<span class="sy0">OR</span>T_<span class="sy0">IN</span>_TEMPDB <span class="sy0">=</span> <span class="kw1">OFF</span>, IGN<span class="sy0">OR</span>E_DUP_KEY <span class="sy0">=</span> <span class="kw1">OFF</span>, DROP_EXIST<span class="sy0">IN</span>G <span class="sy0">=</span> <span class="kw1">OFF</span>, ONL<span class="sy0">IN</span>E <span class="sy0">=</span> <span class="kw1">OFF</span>, <span class="sy0">ALL</span>OW_ROW_LOCKS &nbsp;<span class="sy0">=</span> <span class="kw1">ON</span>, <span class="sy0">ALL</span>OW_PAGE_LOCKS &nbsp;<span class="sy0">=</span> <span class="kw1">ON</span><span class="br0">&#41;</span> <span class="kw1">ON</span> <span class="br0">&#91;</span><span class="kw1">PRIMARY</span><span class="br0">&#93;</span>
GO
&nbsp;
&nbsp;
&nbsp;
&nbsp;
<span class="kw1">DECLARE</span> @Keys &nbsp; &nbsp;<span class="kw1">TABLE</span> <span class="br0">&#40;</span>Word <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span>, WordId <span class="kw1">INT</span> <span class="kw1">IDENTITY</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @WordsToExclude <span class="kw1">TABLE</span> <span class="br0">&#40;</span>Word <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">200</span><span class="br0">&#41;</span>, WordID <span class="kw1">INT</span> <span class="kw1">IDENTITY</span><span class="br0">&#40;</span><span class="nu0">1</span>,<span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">DECLARE</span> @I <span class="kw1">INT</span> <span class="sy0">=</span> <span class="nu0">1</span>
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">ON</span>
<span class="kw1">select</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">from</span> RealTest &nbsp;
<span class="kw1">WHILE</span> @I<span class="sy0">&lt;</span><span class="nu0">10000</span> 
<span class="kw1">BEGIN</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest &nbsp;<span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Father Daughter Son iteration'</span> <span class="sy0">+</span> <span class="kw1">CAST</span><span class="br0">&#40;</span>@i <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Daughter Son iteration'</span> <span class="sy0">+</span> <span class="kw1">CAST</span><span class="br0">&#40;</span>@i <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Son iteration'</span> <span class="sy0">+</span> <span class="kw1">CAST</span><span class="br0">&#40;</span>@i <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Daughter Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Father Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Son Daughter Father'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Other Word'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Father Daughter Brother Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Exclude Mother Father Daughter Brother Son Orphan'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Exclude Mother Father Daughter Brother Son Orphan'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'MotherFatherDaughterBrotherSon'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Exclude Mother Father Daughter Son Stepdaughter'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Brother Mother Father Daughter Son Stepdaughter'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Son And Stepson and Daughter and Father and Grandfather'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Daughter Son Family'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother Brother Father Daughter Son Orphan'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Son or Daughter or Father'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother And Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> RealTest <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Other Word One More'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">SET</span> @i <span class="sy0">=</span> @i <span class="sy0">+</span><span class="nu0">1</span>
<span class="kw1">END</span>
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @Keys <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Mother'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @Keys <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Father'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @Keys <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Son'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @Keys <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Daughter'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @WordsToExclude <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Exclude'</span><span class="br0">&#41;</span> 
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> @WordsToExclude <span class="kw1">VALUES</span> <span class="br0">&#40;</span><span class="st0">'Stepdaughter'</span><span class="br0">&#41;</span> 
&nbsp;
<span class="kw1">SELECT</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> RealTest 
&nbsp;
<span class="kw1">SET</span> <span class="kw1">STATISTICS</span> <span class="kw1">TIME</span> <span class="kw1">ON</span> 
<span class="kw1">DECLARE</span> @nAllWords <span class="kw1">INT</span>
<span class="kw1">SELECT</span> @nAllWords <span class="sy0">=</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> @Keys
&nbsp;
<span class="kw1">SELECT</span> MyTable.<span class="sy0">*</span>
<span class="kw1">FROM</span> RealTest MyTable
<span class="kw1">INNER</span> <span class="sy0">JOIN</span> <span class="br0">&#40;</span><span class="kw1">SELECT</span> MyTable.<span class="me1">Id</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> RealTest MyTable
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">INNER</span> <span class="sy0">JOIN</span> @Keys KeyWords <span class="kw1">ON</span> <span class="st0">' '</span> <span class="sy0">+</span> MyTable.<span class="me1">Searched</span> <span class="sy0">+</span> <span class="st0">' '</span> <span class="sy0">LIKE</span> <span class="st0">'% '</span> <span class="sy0">+</span> KeyWords.<span class="me1">Word</span> &nbsp;<span class="sy0">+</span> <span class="st0">' %'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> not exists <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="nu0">1</span> <span class="kw1">FROM</span> RealTest M <span class="kw1">INNER</span> <span class="sy0">JOIN</span> @WordsToExclude W <span class="kw1">ON</span> <span class="st0">' '</span> <span class="sy0">+</span> M.<span class="me1">Searched</span> <span class="sy0">+</span> <span class="st0">' '</span> <span class="sy0">LIKE</span> <span class="st0">'%'</span> <span class="sy0">+</span> W.<span class="me1">Word</span> <span class="sy0">+</span> <span class="st0">' %'</span> and M.<span class="me1">Id</span> <span class="sy0">=</span> MyTable.<span class="me1">Id</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">GROUP</span> <span class="kw1">BY</span> MyTable.<span class="me1">Id</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">HAVING</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="kw1">DISTINCT</span><span class="br0">&#40;</span>KeyWords.<span class="me1">Word</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="sy0">=</span> @nAllWords<span class="br0">&#41;</span> Tbl1 <span class="kw1">ON</span> MyTable.<span class="me1">Id</span> <span class="sy0">=</span> Tbl1.<span class="me1">Id</span> <span class="co1">--order by MyTable.Id </span>
&nbsp;
<span class="kw1">PRINT</span> <span class="st0">'Regular INNER JOIN '</span> <span class="sy0">+</span> &nbsp;<span class="kw1">CAST</span><span class="br0">&#40;</span><span class="kw2">@@ROWCOUNT</span> <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<span class="kw1">SELECT</span> x.<span class="me1">Id</span>,
&nbsp; &nbsp; &nbsp; &nbsp;x.<span class="me1">Searched</span>
&nbsp; <span class="kw1">FROM</span> <span class="br0">&#40;</span> <span class="kw1">SELECT</span> m.<span class="me1">Id</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m.<span class="me1">Searched</span>, 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> @Keys k 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> <span class="st0">' '</span><span class="sy0">+</span> m.<span class="me1">Searched</span><span class="sy0">+</span><span class="st0">' '</span> like <span class="st0">'% '</span> <span class="sy0">+</span> k.<span class="me1">Word</span> <span class="sy0">+</span> <span class="st0">' %'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#41;</span> <span class="kw1">AS</span> n, <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span> <span class="kw1">FROM</span> @WordsToExclude W <span class="kw1">WHERE</span> <span class="st0">' '</span> <span class="sy0">+</span> m.<span class="me1">Searched</span> <span class="sy0">+</span> <span class="st0">' '</span> like <span class="st0">'% '</span> <span class="sy0">+</span> W.<span class="me1">Word</span> <span class="sy0">+</span> <span class="st0">' %'</span><span class="br0">&#41;</span> <span class="kw1">AS</span> WE
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> RealTest m
&nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#41;</span> <span class="kw1">AS</span> x
&nbsp;<span class="kw1">WHERE</span> n<span class="sy0">=</span>@nAllWords and isnull<span class="br0">&#40;</span>WE,<span class="nu0">0</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="co1">--order by x.Id </span>
&nbsp;
<span class="kw1">PRINT</span> <span class="st0">'Subquery solution '</span> <span class="sy0">+</span> &nbsp;<span class="kw1">CAST</span><span class="br0">&#40;</span><span class="kw2">@@ROWCOUNT</span> <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;
<span class="kw1">SELECT</span> x.<span class="me1">Id</span>,
&nbsp; &nbsp; &nbsp; &nbsp;x.<span class="me1">Searched</span>
&nbsp; <span class="kw1">FROM</span> <span class="br0">&#40;</span> <span class="kw1">SELECT</span> m.<span class="me1">Id</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m.<span class="me1">Searched</span>,
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#40;</span> <span class="kw1">SELECT</span> <span class="kw2">COUNT</span><span class="br0">&#40;</span><span class="sy0">*</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">FROM</span> @Keys k
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">WHERE</span> <span class="st0">' '</span><span class="sy0">+</span> m.<span class="me1">Searched</span><span class="sy0">+</span><span class="st0">' '</span> like <span class="st0">'% '</span> <span class="sy0">+</span> k.<span class="me1">Word</span> <span class="sy0">+</span> <span class="st0">' %'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">&#41;</span> <span class="kw1">AS</span> n
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> RealTest m
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> not exists <span class="br0">&#40;</span> <span class="kw1">SELECT</span> <span class="sy0">*</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">FROM</span> @WordsToExclude W
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">WHERE</span> <span class="st0">' '</span> <span class="sy0">+</span> m.<span class="me1">Searched</span> <span class="sy0">+</span> <span class="st0">' '</span> like <span class="st0">'% '</span> <span class="sy0">+</span> W.<span class="me1">Word</span> <span class="sy0">+</span> <span class="st0">' %'</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp;<span class="br0">&#41;</span> <span class="kw1">AS</span> x
&nbsp;<span class="kw1">WHERE</span> n<span class="sy0">=</span>@nAllWords
&nbsp;
<span class="kw1">PRINT</span> <span class="st0">'Optimized Nikola'</span><span class="st0">'s &nbsp;solution #1 '</span> <span class="sy0">+</span> &nbsp;<span class="kw1">CAST</span><span class="br0">&#40;</span><span class="kw2">@@ROWCOUNT</span> <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;
<span class="kw1">SELECT</span> m.<span class="me1">Id</span>, m.<span class="me1">Searched</span>
<span class="kw1">FROM</span> RealTest m
<span class="kw1">WHERE</span> not exists <span class="br0">&#40;</span><span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> @WordsToExclude W <span class="kw1">WHERE</span> <span class="st0">' '</span> <span class="sy0">+</span> m.<span class="me1">Searched</span> <span class="sy0">+</span> <span class="st0">' '</span> like <span class="st0">'% '</span> <span class="sy0">+</span> W.<span class="me1">Word</span> <span class="sy0">+</span> <span class="st0">' %'</span><span class="br0">&#41;</span>
and <span class="nu0">1</span> <span class="sy0">=</span> <span class="sy0">ALL</span> <span class="br0">&#40;</span> <span class="kw1">SELECT</span> <span class="kw1">Case</span> <span class="kw1">When</span> <span class="st0">' '</span> <span class="sy0">+</span> m.<span class="me1">Searched</span> <span class="sy0">+</span> <span class="st0">' '</span> like <span class="st0">'% '</span> <span class="sy0">+</span> k.<span class="me1">Word</span> <span class="sy0">+</span> <span class="st0">' %'</span> <span class="kw1">Then</span> <span class="nu0">1</span> <span class="kw1">Else</span> <span class="nu0">0</span> <span class="kw1">End</span> <span class="kw1">FROM</span> @Keys k<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">PRINT</span> <span class="st0">'Optimized Nikola'</span><span class="st0">'s &nbsp;solution #2 '</span> <span class="sy0">+</span> &nbsp;<span class="kw1">CAST</span><span class="br0">&#40;</span><span class="kw2">@@ROWCOUNT</span> <span class="kw1">AS</span> <span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">10</span><span class="br0">&#41;</span><span class="br0">&#41;</span> &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;
&nbsp; &nbsp; 
<span class="kw1">SET</span> <span class="kw1">STATISTICS</span> <span class="kw1">TIME</span> <span class="kw1">OFF</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">USE [AllTests]
GO

/****** Object:  Table [dbo].[RealTest]    Script Date: 08/19/2009 19:39:24 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[RealTest]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[RealTest](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Searched] [varchar](200) NULL,
 CONSTRAINT [PK_RealTest] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
END
GO

--ALTER TABLE [dbo].[RealTest] DISABLE CHANGE_TRACKING 
GO

SET ANSI_PADDING OFF
GO

USE [AllTests]
GO

USE [AllTests]
GO

/****** Object:  Index [PK_RealTest]    Script Date: 08/19/2009 19:53:06 ******/
IF NOT EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[RealTest]') AND name = N'PK_RealTest')
ALTER TABLE [dbo].[RealTest] ADD  CONSTRAINT [PK_RealTest] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO


/****** Object:  Index [IX_RealTest]    Script Date: 08/19/2009 19:52:29 ******/
IF NOT EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[RealTest]') AND name = N'IX_RealTest')
CREATE NONCLUSTERED INDEX [IX_RealTest] ON [dbo].[RealTest] 
(
	[Searched] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO




DECLARE @Keys    TABLE (Word VARCHAR(200), WordId INT IDENTITY(1,1))
DECLARE @WordsToExclude TABLE (Word VARCHAR(200), WordID INT IDENTITY(1,1))
DECLARE @I INT = 1
SET NOCOUNT ON
select COUNT(*) from RealTest  
WHILE @I&lt;10000 
BEGIN
INSERT INTO RealTest  VALUES ('Mother Father Daughter Son iteration' + CAST(@i AS VARCHAR(10)))
INSERT INTO RealTest VALUES ('Mother Daughter Son iteration' + CAST(@i AS VARCHAR(10)))
INSERT INTO RealTest VALUES ('Mother Son iteration' + CAST(@i AS VARCHAR(10)))
INSERT INTO RealTest VALUES ('Daughter Son')
INSERT INTO RealTest VALUES ('Mother Father Son')
INSERT INTO RealTest VALUES ('Son Daughter Father')
INSERT INTO RealTest VALUES ('Mother Son')
INSERT INTO RealTest VALUES ('Other Word')
INSERT INTO RealTest VALUES ('Mother Father Daughter Brother Son')
INSERT INTO RealTest VALUES ('Exclude Mother Father Daughter Brother Son Orphan')
INSERT INTO RealTest VALUES ('Exclude Mother Father Daughter Brother Son Orphan')
INSERT INTO RealTest VALUES ('MotherFatherDaughterBrotherSon')
INSERT INTO RealTest VALUES ('Exclude Mother Father Daughter Son Stepdaughter')
INSERT INTO RealTest VALUES ('Brother Mother Father Daughter Son Stepdaughter')
INSERT INTO RealTest VALUES ('Mother Son And Stepson and Daughter and Father and Grandfather')
INSERT INTO RealTest VALUES ('Daughter Son Family')
INSERT INTO RealTest VALUES ('Mother Brother Father Daughter Son Orphan')
INSERT INTO RealTest VALUES ('Son or Daughter or Father')
INSERT INTO RealTest VALUES ('Mother And Son')
INSERT INTO RealTest VALUES ('Other Word One More')
 
SET @i = @i +1
END
 
INSERT INTO @Keys VALUES ('Mother')
INSERT INTO @Keys VALUES ('Father')
INSERT INTO @Keys VALUES ('Son')
INSERT INTO @Keys VALUES ('Daughter')
 
INSERT INTO @WordsToExclude VALUES ('Exclude') 
INSERT INTO @WordsToExclude VALUES ('Stepdaughter') 
 
SELECT COUNT(*) FROM RealTest 
 
SET STATISTICS TIME ON 
DECLARE @nAllWords INT
SELECT @nAllWords = COUNT(*) FROM @Keys
 
SELECT MyTable.*
FROM RealTest MyTable
INNER JOIN (SELECT MyTable.Id
                   FROM RealTest MyTable
            INNER JOIN @Keys KeyWords ON ' ' + MyTable.Searched + ' ' LIKE '% ' + KeyWords.Word  + ' %'
            WHERE not exists (SELECT 1 FROM RealTest M INNER JOIN @WordsToExclude W ON ' ' + M.Searched + ' ' LIKE '%' + W.Word + ' %' and M.Id = MyTable.Id)
            GROUP BY MyTable.Id
            HAVING COUNT(DISTINCT(KeyWords.Word)) = @nAllWords) Tbl1 ON MyTable.Id = Tbl1.Id --order by MyTable.Id 
 
PRINT 'Regular INNER JOIN ' +  CAST(@@ROWCOUNT AS VARCHAR(10))
            
SELECT x.Id,
       x.Searched
  FROM ( SELECT m.Id,
                m.Searched, 
                (SELECT COUNT(*) 
                   FROM @Keys k 
                  WHERE ' '+ m.Searched+' ' like '% ' + k.Word + ' %'
                ) AS n, (SELECT COUNT(*) FROM @WordsToExclude W WHERE ' ' + m.Searched + ' ' like '% ' + W.Word + ' %') AS WE
           FROM RealTest m
       ) AS x
 WHERE n=@nAllWords and isnull(WE,0) = 0 --order by x.Id 
 
PRINT 'Subquery solution ' +  CAST(@@ROWCOUNT AS VARCHAR(10))        

SELECT x.Id,
       x.Searched
  FROM ( SELECT m.Id,
                m.Searched,
                ( SELECT COUNT(*)
                    FROM @Keys k
                   WHERE ' '+ m.Searched+' ' like '% ' + k.Word + ' %'
                ) AS n
           FROM RealTest m
          WHERE not exists ( SELECT *
                               FROM @WordsToExclude W
                              WHERE ' ' + m.Searched + ' ' like '% ' + W.Word + ' %'
                           )
       ) AS x
 WHERE n=@nAllWords

PRINT 'Optimized Nikola''s  solution #1 ' +  CAST(@@ROWCOUNT AS VARCHAR(10))        

SELECT m.Id, m.Searched
FROM RealTest m
WHERE not exists (SELECT * FROM @WordsToExclude W WHERE ' ' + m.Searched + ' ' like '% ' + W.Word + ' %')
and 1 = ALL ( SELECT Case When ' ' + m.Searched + ' ' like '% ' + k.Word + ' %' Then 1 Else 0 End FROM @Keys k)

PRINT 'Optimized Nikola''s  solution #2 ' +  CAST(@@ROWCOUNT AS VARCHAR(10))        

    
SET STATISTICS TIME OFF</pre></div></div>

<p>with the result on my PC<br />
<code class="codespan">SQL Server Execution Times:</p>
<p> SQL Server Execution Times:<br />
   CPU time = 6599 ms,  elapsed time = 9802 ms.<br />
Regular INNER JOIN 79992</p>
<p> SQL Server Execution Times:<br />
   CPU time = 4961 ms,  elapsed time = 6697 ms.<br />
Subquery solution 79992</p>
<p> SQL Server Execution Times:<br />
   CPU time = 5366 ms,  elapsed time = 6716 ms.<br />
Optimized Nikola's  solution #1 79992</p>
<p> SQL Server Execution Times:<br />
   CPU time = 2901 ms,  elapsed time = 3670 ms.<br />
Optimized Nikola's  solution #2 79992</p>
<p></code></p>
<p>*** <strong>Remember, if you have a SQL related question, try our <a href="http://forum.lessthandot.com/viewforum.php?f=17">Microsoft SQL Server Programming</a> forum or our <a href="http://forum.lessthandot.com/viewforum.php?f=22">Microsoft SQL Server Admin</a> forum</strong><ins></ins></p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-server-extracting-data-again/'>SQL Server Extracting Data (again)</a><p>In a recent article, I explained how to extract numbers from a string. This blog&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/do-not-use-reserved-keywords/'>Do not use reserved keywords for your column names</a><p>Column names and table names should not use reserved keywords in your database. You can&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Naomi Nosonovsky, Senior Software Developer, has more than 15 years of enterprise experience in analysis, design, development and implementation of high-performance client/server data management solutions.

She is a Personality of the Year for 2008, 2009, 2010 and 2011 at www.universalthread.com in .NET, SQL Server & VFP categories.

She is also an All Star contributor/MCC Community Contributor at forums.asp.net and MSDN T-SQL forum.


 
	



    

    


<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/?sk=messages&tid=1240691655679#!/profile.php?id=10395470" title="Naomi at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/profile?viewProfile=&key=55538716&trk=tab_pro" title="Naomi at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://delicious.com/http://delicious.com/naomi_nos" title="Naomi at delicious" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_delicious.png" alt="delicious" /></a><a href="/index.php/author/naomi/feed/" title="Blog RSS feed for Naomi" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 33,729 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/naomi/">Read More Posts by Naomi Nosonovsky</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&text=RT @LessThanDot Blog - How to search for all words inclusive without using Full Text search by naomi" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&title=How to search for all words inclusive without using Full Text search&source=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&title=How to search for all words inclusive without using Full Text search" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&quote=How to search for all words inclusive without using Full Text search" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/&title=How to search for all words inclusive without using Full Text search" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		25 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-gmmastros even thread-even depth-1" id="comment-1524">
				<div id="div-comment-1524" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1524">
			July 8, 2009 at 8:27 pm</a>		</div>

		<p>Excellent post!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1524#respond' onclick='return addComment.moveForm( "div-comment-1524", "1524", "respond", "499" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis odd alt thread-odd thread-alt depth-1" id="comment-1525">
				<div id="div-comment-1525" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1525">
			July 8, 2009 at 9:03 pm</a>		</div>

		<p>Very nice Naomi and congratz on the first post  </p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1525#respond' onclick='return addComment.moveForm( "div-comment-1525", "1525", "respond", "499" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-chrissie1 even thread-even depth-1" id="comment-1526">
				<div id="div-comment-1526" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/70e155e88e0ead5e2bdcb3e1c57506b4?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/70e155e88e0ead5e2bdcb3e1c57506b4?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Christiaan Baes (chrissie1)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1526">
			July 8, 2009 at 11:47 pm</a>		</div>

		<p>Welcome to the club.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1526#respond' onclick='return addComment.moveForm( "div-comment-1526", "1526", "respond", "499" )' aria-label='Reply to Christiaan Baes (chrissie1)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola odd alt thread-odd thread-alt depth-1" id="comment-1527">
				<div id="div-comment-1527" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1527">
			July 9, 2009 at 2:08 am</a>		</div>

		<p>What about next one, should be faster:</p>
<p>Select x.Id,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.Searched<br />
&nbsp;&nbsp;from ( Select m.Id,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.Searched, <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Select Count(*) <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;From @Keys k <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Where &#8216; &#8216;+ m.Searched+&#8217; &#8216; like &#8216;% &#8216; + k.Word  + &#8216; %&#8217;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) as n<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from @myTable m<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) as x<br />
&nbsp;Where n=(Select COUNT(*) From @Keys)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1527#respond' onclick='return addComment.moveForm( "div-comment-1527", "1527", "respond", "499" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt even thread-even depth-1" id="comment-1528">
				<div id="div-comment-1528" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1528">
			July 9, 2009 at 8:46 am</a>		</div>

		<p>Nice!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1528#respond' onclick='return addComment.moveForm( "div-comment-1528", "1528", "respond", "499" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1529">
				<div id="div-comment-1529" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1529">
			July 9, 2009 at 9:10 am</a>		</div>

		<p>Hi Niikola,</p>
<p>I would need to test your solution &#8211; need to create a good test scenario and find time for this as well. To me this one is slightly harder to understand than the solution I posted.</p>
<p>Also today there was a little twist in the original problem &#8211; find all records including all the words, but excluding some other words (list of words). I have an idea, but don&#8217;t have time to think / test in more details.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1529#respond' onclick='return addComment.moveForm( "div-comment-1529", "1529", "respond", "499" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor even thread-even depth-1" id="comment-1539">
				<div id="div-comment-1539" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1539">
			July 11, 2009 at 10:35 pm</a>		</div>

		<p>Hi Niikola,</p>
<p>Your solution proved to be much faster. Also I added an ability to exclude certain words &#8211; see, if you can suggest a different idea.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1539#respond' onclick='return addComment.moveForm( "div-comment-1539", "1539", "respond", "499" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1540">
				<div id="div-comment-1540" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/cd3057ea53cccfcab8b7ef18baa9faa9?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/cd3057ea53cccfcab8b7ef18baa9faa9?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.kodyaz.com/' rel='external nofollow' class='url'>Eralper</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1540">
			July 12, 2009 at 11:38 pm</a>		</div>

		<p>Hi Naomi,</p>
<p>I liked much the trick you separate the sentence into words for the inner join using the below code fragment.<br />
Excellent!</p>
<p>ON &#8216; &#8216; + MyTable.Searched + &#8216; &#8216; LIKE &#8216;% &#8216; + KeyWords.Word  + &#8216; %&#8217;</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1540#respond' onclick='return addComment.moveForm( "div-comment-1540", "1540", "respond", "499" )' aria-label='Reply to Eralper'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1542">
				<div id="div-comment-1542" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9d5a92267a38b956e797e9af0c605062?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9d5a92267a38b956e797e9af0c605062?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://sridharbabuk.blogspot.com/' rel='external nofollow' class='url'>Sridhar</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1542">
			July 20, 2009 at 10:43 pm</a>		</div>

		<p>Excellent idea&#8230; we easily extend the solution in the same way how we can use Contains/FreeText <br />
and ContainsTable/FreeTextTable in Full Text Search.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1542#respond' onclick='return addComment.moveForm( "div-comment-1542", "1542", "respond", "499" )' aria-label='Reply to Sridhar'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1545">
				<div id="div-comment-1545" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/703b8a21f9276de1c61468d493bc3cb4?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/703b8a21f9276de1c61468d493bc3cb4?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">someguy198650</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1545">
			July 24, 2009 at 3:18 am</a>		</div>

		<p>Nice,<br />
gotta try that one.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1545#respond' onclick='return addComment.moveForm( "div-comment-1545", "1545", "respond", "499" )' aria-label='Reply to someguy198650'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola even thread-even depth-1" id="comment-1530">
				<div id="div-comment-1530" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1530">
			August 18, 2009 at 6:45 am</a>		</div>

		<p>Slightly faster version with &#8220;Words to Exclude&#8221;</p>
<p>SELECT x.Id,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x.Searched<br />
&nbsp;&nbsp;FROM ( SELECT m.Id,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m.Searched,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( SELECT COUNT(*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM @Keys k<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE &#8216; &#8216;+ m.Searched+&#8217; &#8216; like &#8216;% &#8216; + k.Word + &#8216; %&#8217;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) AS n<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM @myTable m<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE not exists ( SELECT *<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM @WordsToExclude W<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE &#8216; &#8216; + m.Searched + &#8216; &#8216; like &#8216;% &#8216; + W.Word + &#8216; %&#8217;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) AS x<br />
&nbsp;WHERE n=@nAllWords</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1530#respond' onclick='return addComment.moveForm( "div-comment-1530", "1530", "respond", "499" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola odd alt thread-odd thread-alt depth-1" id="comment-1531">
				<div id="div-comment-1531" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1531">
			August 18, 2009 at 7:03 am</a>		</div>

		<p>It would be nice if we can use next syntax:</p>
<p>SELECT m.Id,<br />
       m.Searched<br />
  FROM @myTable <br />
 WHERE m.Searched LIKE ALL ( SELECT &#8216;% &#8216; + k.Word + &#8216; %&#8217; FROM @Keys k)<br />
   and not exists (SELECT * FROM @WordsToExclude W WHERE &#8216; &#8216; + m.Searched + &#8216; &#8216; like &#8216;% &#8216; + W.Word + &#8216; %&#8217;)</p>
<p>but unfortunately ALL does not work with LIKE operator </p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1531#respond' onclick='return addComment.moveForm( "div-comment-1531", "1531", "respond", "499" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola even thread-even depth-1" id="comment-1532">
				<div id="div-comment-1532" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1532">
			August 18, 2009 at 9:06 am</a>		</div>

		<p>I forgot to add some comment why this query is faster, although I believe all of you know that already.</p>
<p></p>
<p>As WHERE clause is executed before SELECT part, it means sub query in select clause will not be executed for rows that contains at least one unwanted word, which further means less CPU and faster execution.</p>
<p></p>
<p>Changing sub query for unwanted words from (SELECT COUNT(*)&#8230;) to NOT EXISTS (&#8230;) reduces number of rows affected and number of LIKE comparisons because it will stop execution on the first match.</p>
<p></p>
<p>Effectively, instead of having nWantedWords+nUnwantedWords comparisons for each row, we will have &#8211; in case of rows that have at least one unwanted word &#8211; no one comparison with wanted words and between 1 and nUnwantedWords comparisons against unwanted ones</p>
<p></p>
<p>Rows without unwanted words will still have same number of comparisons, but without aggregates for unwanted words.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1532#respond' onclick='return addComment.moveForm( "div-comment-1532", "1532", "respond", "499" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola odd alt thread-odd thread-alt depth-1" id="comment-1533">
				<div id="div-comment-1533" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1533">
			August 18, 2009 at 9:13 am</a>		</div>

		<p>Maybe we could us ALL with a bit different sub query, although I&#8217;m not sure we would get any improvement:</p>
<p>SELECT m.Id, m.Searched<br />
FROM @myTable<br />
WHERE not exists (SELECT * FROM @WordsToExclude W WHERE &#8216; &#8216; + m.Searched + &#8216; &#8216; like &#8216;% &#8216; + W.Word + &#8216; %&#8217;)<br />
and 1 = ALL ( SELECT Case When &#8216; &#8216; + m.Searched + &#8216; &#8216; like &#8216;% &#8216; + k.Word + &#8216; %&#8217; Then 1 Else 0 End FROM @Keys k)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1533#respond' onclick='return addComment.moveForm( "div-comment-1533", "1533", "respond", "499" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola even thread-even depth-1" id="comment-1534">
				<div id="div-comment-1534" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1534">
			August 18, 2009 at 9:18 am</a>		</div>

		<p>Me again </p>
<p>1 = ALL (Select&#8230;)</p>
<p>should improve performance as ALL will stop execution of sub query for the first row in @Keys that doesn&#8217;t mach LIKE criteria &#8211; which means less comparisons in total</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1534#respond' onclick='return addComment.moveForm( "div-comment-1534", "1534", "respond", "499" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1536">
				<div id="div-comment-1536" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1536">
			August 18, 2009 at 3:37 pm</a>		</div>

		<p>Niikola &#8211; thanks a lot for your comments, I&#8217;ll try different variations at the first opportunity.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1536#respond' onclick='return addComment.moveForm( "div-comment-1536", "1536", "respond", "499" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-niikola even thread-even depth-1" id="comment-1537">
				<div id="div-comment-1537" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2db354ef491b4c42e450446dcbdc23cc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">niikola</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1537">
			August 19, 2009 at 8:57 am</a>		</div>

		<p>This is the last one, I promise </p>
<p>Results with real tables (not the table variables) on both, SQL Server 2005 and 2008 makes difference between original and modified queries much smaller. It seems that joins with table variables are very costly (especially in 2008). Adding PKs and indexes makes differences even smaller, but still visible. </p>
<p>The best one is the last one (with 1=ALL()), followed by UnwantedWords in Where clause as second, 2 subqueries in select 3rd and JOIN 4th.</p>
<p>Another interesting fact is that comparing Execution Plans and estimated cost for each of the queries shows completely opposite order of efficiency. </p>
<p>Further improvement (not a big one, but affects all solutions) would be </p>
<p>Update @Keys Set Word = &#8216;% &#8216;+word+&#8217; %&#8217;<br />
Update @WordsToExclude Set Word = &#8216;% &#8216;+word+&#8217; %&#8217;</p>
<p>In that case LIKE comparisons would be<br />
&#8216; &#8216; + M.Searched + &#8216; &#8216; LIKE Word<br />
without unnecessary concatenation in every step</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1537#respond' onclick='return addComment.moveForm( "div-comment-1537", "1537", "respond", "499" )' aria-label='Reply to niikola'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1538">
				<div id="div-comment-1538" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1538">
			August 19, 2009 at 10:31 am</a>		</div>

		<p>Hi Niikola,</p>
<p>Thanks again and keep them coming &#8211; I&#8217;m sorry I didn&#8217;t have a chance to play with it yesterday and not sure would have time this week, but I plan to test and update the blog &#8211; thanks again.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1538#respond' onclick='return addComment.moveForm( "div-comment-1538", "1538", "respond", "499" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor even thread-even depth-1" id="comment-1541">
				<div id="div-comment-1541" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1541">
			August 19, 2009 at 7:10 pm</a>		</div>

		<p>I&#8217;ve updated the blog with your comments &#8211; thanks again.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1541#respond' onclick='return addComment.moveForm( "div-comment-1541", "1541", "respond", "499" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1544">
				<div id="div-comment-1544" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3b9287a7fc838496e40c60907a94c0e7?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3b9287a7fc838496e40c60907a94c0e7?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.geekzrule.com/' rel='external nofollow' class='url'>Ben</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1544">
			September 12, 2009 at 8:51 pm</a>		</div>

		<p>Thanks for this!  This absolutely saved my bacon, and provided an awesome solution where I could not use Full Text Indexing.  Thanks again!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1544#respond' onclick='return addComment.moveForm( "div-comment-1544", "1544", "respond", "499" )' aria-label='Reply to Ben'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1546">
				<div id="div-comment-1546" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/ec964e2b93ecc53f6028e1e2d7f9efee?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/ec964e2b93ecc53f6028e1e2d7f9efee?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.7logix.net/' rel='external nofollow' class='url'>Jason Rosensweig</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1546">
			March 19, 2010 at 12:42 pm</a>		</div>

		<p>Love the article. I was wondering if you could guide me in implementing something similar, but without the requirement to match all keywords. I need a query that will take a list of keywords and return results that contain one or more of those keywords. Thanks.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1546#respond' onclick='return addComment.moveForm( "div-comment-1546", "1546", "respond", "499" )' aria-label='Reply to Jason Rosensweig'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1547">
				<div id="div-comment-1547" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1547">
			March 19, 2010 at 1:42 pm</a>		</div>

		<p>If your requirement is just to get the records containing the keywords and you have the keywords as a table, then you can use this query</p>
<p>select T.* from myTable T INNER JOIN KeyWords W on &#8216; &#8216; + T.Phrase + &#8216; &#8216; like &#8216;% &#8216; + KeyWord + &#8216; %&#8217;</p>
<p>The only problem is that this is not optimized solution. If your phrases are not very long and you know the maximum number of words they can contain, then you can also try to use CROSS APPLY idea to split the phrases into words as shown here</p>
<p><a href="http://bradsruminations.blogspot.com/2009/07/cool-cross-apply-tricks-part-2.html" rel="nofollow">http://bradsruminations.blogspot.com/2009/07/cool-cross-apply-tricks-part-2.html</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1547#respond' onclick='return addComment.moveForm( "div-comment-1547", "1547", "respond", "499" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1535">
				<div id="div-comment-1535" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo avatar-default' height='64' width='64' />			<cite class="fn">Sheree</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1535">
			May 26, 2010 at 7:51 am</a>		</div>

		<p>Thank for the info, i visit daily actually mainly for articles like this.  Thank again</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1535#respond' onclick='return addComment.moveForm( "div-comment-1535", "1535", "respond", "499" )' aria-label='Reply to Sheree'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1543">
				<div id="div-comment-1543" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f078bcb0b9d34042677201bef96a9922?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f078bcb0b9d34042677201bef96a9922?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Venkatesh</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1543">
			December 19, 2011 at 4:08 am</a>		</div>

		<p>You provide very good solution&#8230;.I am a great fan of your solutions&#8230;thank you for all the contributions you make.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1543#respond' onclick='return addComment.moveForm( "div-comment-1543", "1543", "respond", "499" )' aria-label='Reply to Venkatesh'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1523">
				<div id="div-comment-1523" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f51c3b12c6bb7fd0413f3c92e8c20caa?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f51c3b12c6bb7fd0413f3c92e8c20caa?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ansary</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#comment-1523">
			February 21, 2013 at 10:20 pm</a>		</div>

		<p>Very  good solution pals..happy coding.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/?replytocom=1523#respond' onclick='return addComment.moveForm( "div-comment-1523", "1523", "respond", "499" )' aria-label='Reply to Ansary'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/how-to-search-for-all-words-inclusive-wi/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='499' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="cc1aa436277138f61cda703991069eaf"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552766018"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
