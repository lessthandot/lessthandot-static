<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Multi-Value Parameters in SSRS</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Multi-Value Parameters in SSRS" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Here's a quick rundown of how to modify an SSRS report and a stored procedure to accept and use a multi-valued parameter." />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Multi-Value Parameters in SSRS Comments Feed" href="/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Here Is Yet Another Reason For Upgrading To SQL Server 2008 From SQL Server 2000' href='/index.php/datamgmt/dbprogramming/here-is-yet-another-reason-for-upgrading-2000/' />
<link rel='next' title='SQL Server does support regular expressions in check constraints, triggers are not always needed' href='/index.php/datamgmt/dbprogramming/sql-server-does-support-regular-expressi/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/" />
<link rel='shortlink' href='/?p=443' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fssrs_multi_value_parameters%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fssrs_multi_value_parameters%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbprogramming/sql-server-does-support-regular-expressi/" rel="next">SQL Server does support regular expressions in check constraints, triggers are not always needed</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/datamgmt/dbprogramming/here-is-yet-another-reason-for-upgrading-2000/" rel="prev">Here Is Yet Another Reason For Upgrading To SQL Server 2008 From SQL Server 2000</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/" class="post-title">Multi-Value Parameters in SSRS</a></h1>
					<div class="post-byline">by <a href="/index.php/author/emtucifor/" title="Posts by Erik" rel="author">Erik</a> on May 22, 2009 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 58,609 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&text=RT @LessThanDot Blog - Multi-Value Parameters in SSRS by emtucifor" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&title=Multi-Value Parameters in SSRS&source=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&title=Multi-Value Parameters in SSRS" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&quote=Multi-Value Parameters in SSRS" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&title=Multi-Value Parameters in SSRS" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><h1>Background</h1>
<p>I have a report that returns specific documentation from the database with one parameter, a CustomerID. The report is bound to a stored procedure which has hard-coded in it the names of the specific documents that should be included. This solution is problematic because when the list of documents needs to change, the SP has to be updated, which means mistakes can be (and have been) made.</p>
<p>The good step of converting the SP to use a table doesn&#8217;t satisfy me fully, because these reports are executed from a special reporting system that also has its own list of document names, so that it knows when to kick off a particular report—for example, if none of the documents exist, no report will be generated. I didn&#8217;t like the idea of depending on having the same data updates made in two places: I should be able to just update the reporting system with the new document names and then trust that the reports will contain the correct data. In the past, we had a mistake where the reporting system received a new document name that didn&#8217;t get included in the SP properly, so after finally fixing the SP, I had to do a recovery and resend some reports.</p>
<p>I realized that what could solve the problem once and for all was to provide the exact list of document names to the SSRS report as a parameter, and have the report pass the document names into the SP, so that even if the SP is not updated (or its source table is not updated), the correct content will still be pulled. The way to do this is with a &#8220;multi-value&#8221; parameter.</p>
<h1>Starting Points</h1>
<p>• A quick test will show that the way SSRS passes multi-valued parameters to a stored procedure is simply by taking all the values selected and packing them into a comma-delimited string. If any of the items in the list contain a comma, no escaping or special handling is done—so manual escaping is required.</p>
<p>• In case you&#8217;re really new to all this, all the report development is being done in Visual Studio 2005, with a project of type Business Intelligence Projects &#8211; Report Server Project. I&#8217;m sure you can find tutorials elsewhere for how to set up a basic report. Once you have a working report, you&#8217;re ready to add a multi-value parameter.</p>
<p>• In this article, the multi-value parameter I am working with is a list of document names. So wherever I say document names, you can insert the thing that you are concerned with. If you can guarantee that there will never be a comma in the list, you can skip or edit the parts of my explanation that have special handling for commas.</p>
<h1>Adding the Multi-Value Parameter</h1>
<p>What I learned while doing this is probably useful to someone, so here&#8217;s a quick rundown of how to modify an SSRS report and a stored procedure to accept and use a multi-valued parameter.</p>
<h2>Modify the Stored Procedure</h2>
<ol>
<li>Add the new parameter. I copied the old SP to a new name so that I couldn&#8217;t possibly mess up the original, and so going forward no one else who works with these things will get confused about which does what.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">PROCEDURE</span> dbo.<span class="me1">MyReport_DocParam</span>
&nbsp; &nbsp;@CustomerID <span class="kw1">int</span>,
&nbsp; &nbsp;@DocumentNameParam <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="kw2">Max</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">''</span>
&nbsp; &nbsp;<span class="co1">-- Please note that any document names with commas must be put inside single quotes.</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE PROCEDURE dbo.MyReport_DocParam
   @CustomerID int,
   @DocumentNameParam varchar(Max) = ''
   -- Please note that any document names with commas must be put inside single quotes.</pre></div></div>

<p>The default value of an empty string allows the SP to be run with just a CustomerID and it will still work. It may not have all the document names, but for testing and development of the SP that may not matter most of the time. I put the comment shown right into the SP to help prevent problems with other people trying to use the SP when I am not around.</p>
<p>I chose to make the new parameter varchar(Max) because it won&#8217;t hurt anything, and on the theory that I don&#8217;t like my code breaking, and despite knowing that the list will almost surely never exceed 8000 characters, I&#8217;d rather be safe. In SQL 2000 you can probably get by with varchar(8000) or even the text data type.</li>
<li>Write a value-splitting function.
<p><em>Note</em>: I have not experimented with other data types such as Integer. If you have done this and know how it works in SSRS differently from using strings, please post a comment. I suspect that whatever the actual data type of your items, they will have to be passed as a comma-separated string anyway. If your items are fixed-length or easily convert to relatively short fixed-length strings, padding them so the comma delimiters added by SSRS appear at exactly known positions will make your task of splitting much easier. You can just join to a special Numbers table and split at each position. For example, if you can make your inputs always 10 characters long then you can just break the string at every 11th character—the comma.</p>
<p>Here&#8217;s how I decided to escape commas:<br />
• If the value contains a comma, enclose it in single quotes and double up any single quotes in that value.<br />
• If the value does not contain a comma, don&#8217;t escape it in any way even if it has a single quote.</p>
<p>I chose this because it is similar to how SQL Server accepts string literals already and should be more familiar to anyone working with my code than other methods (such as backslash-escaping for example). I also considered replacing commas with a character that I know won&#8217;t be in the document names such as character 0 or 255 and then restoring it after splitting values apart, but rejected that because it makes it much more difficult to understand and makes it much harder to provide the list of items if the SP is being run from a query window such as Query Analyzer or Management Studio.</p>
<div style="border:1px solid black;background-color:#444;color:white;margin:0 20px;padding:0 5px 0 5px;"><span class="MT_larger"><em><strong>But I Don&#8217;t Wanna Escape The Comma</strong></em></span><span class="MT_smaller"></p>
<p></span>If you don&#8217;t think you need to escape commas, please ensure that commas <strong>can&#8217;t</strong> be in your data ever, not that they don&#8217;t exist now or &#8220;we&#8217;ll tell people not to put commas in.&#8221; An utterly basic and beginner&#8217;s rule of programming is to never trust user input. Bad Things happen when you do. How do you know that in 5 years when you may be gone or on vacation that some new person who never heard about the comma rule won&#8217;t enter a comma?</div>
<p>Here&#8217;s my function to do the unescaping and splitting work:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">FUNCTION</span> SplitQuotedString <span class="br0">&#40;</span>@String <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="kw2">max</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">RETURNS</span> @<span class="kw1">Array</span> <span class="kw1">TABLE</span> <span class="br0">&#40;</span>Item <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">AS</span>
<span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">DECLARE</span>
&nbsp; &nbsp; &nbsp; @Pos <span class="kw1">int</span>,
&nbsp; &nbsp; &nbsp; @<span class="kw1">End</span> <span class="kw1">int</span>,
&nbsp; &nbsp; &nbsp; @TextLength <span class="kw1">int</span>,
&nbsp; &nbsp; &nbsp; @Item <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; &nbsp; @Fragment <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">8000</span><span class="br0">&#41;</span>,
&nbsp; &nbsp; &nbsp; @InQuotes <span class="kw1">bit</span>
&nbsp; &nbsp;<span class="kw1">SET</span> @TextLength <span class="sy0">=</span> DataLength<span class="br0">&#40;</span>@String<span class="br0">&#41;</span>
&nbsp;
&nbsp; &nbsp;<span class="kw1">IF</span> @TextLength <span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">RETURN</span>
&nbsp;
&nbsp; &nbsp;<span class="kw1">SET</span> @Pos <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp; &nbsp;<span class="kw1">SET</span> @InQuotes <span class="sy0">=</span> <span class="nu0">0</span>
&nbsp; &nbsp;<span class="kw1">SET</span> @String <span class="sy0">=</span> @String <span class="sy0">+</span> <span class="st0">','</span>
&nbsp; &nbsp;<span class="kw1">SET</span> @Item <span class="sy0">=</span> <span class="st0">''</span>
&nbsp; &nbsp;<span class="kw1">WHILE</span> <span class="nu0">1</span> <span class="sy0">=</span> <span class="nu0">1</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @<span class="kw1">End</span> <span class="sy0">=</span> <span class="kw2">CharIndex</span><span class="br0">&#40;</span><span class="st0">','</span>, @String, @Pos<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">IF</span> @<span class="kw1">End</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">BREAK</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @Fragment <span class="sy0">=</span> <span class="kw2">Substring</span><span class="br0">&#40;</span>@String, @Pos, @<span class="kw1">End</span> <span class="sy0">-</span> @Pos<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">IF</span> @InQuotes <span class="sy0">=</span> <span class="nu0">1</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="co1">--InQuotes becomes false if there are an odd number of single quotes at the end of this fragment</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">SET</span> @InQuotes <span class="sy0">=</span> <span class="kw2">PatIndex</span><span class="br0">&#40;</span><span class="st0">'%[^'</span><span class="st0">']%'</span>, <span class="kw2">Reverse</span><span class="br0">&#40;</span>@Fragment<span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'x'</span><span class="br0">&#41;</span> <span class="sy0">%</span> <span class="nu0">2</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">SET</span> @Item <span class="sy0">=</span> @Item <span class="sy0">+</span> <span class="st0">','</span> <span class="sy0">+</span> <span class="kw2">Replace</span><span class="br0">&#40;</span><span class="kw1">Left</span><span class="br0">&#40;</span>@Fragment, DataLength<span class="br0">&#40;</span>@Fragment<span class="br0">&#41;</span> <span class="sy0">-</span> <span class="nu0">1</span> <span class="sy0">+</span> @InQuotes<span class="br0">&#41;</span>, <span class="st0">''</span><span class="st0">''</span><span class="st0">''</span>, <span class="st0">''</span><span class="st0">''</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">END</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">IF</span> @Fragment <span class="sy0">LIKE</span> <span class="st0">''</span><span class="st0">'%'</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @InQuotes <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @Item <span class="sy0">=</span> <span class="kw2">Replace</span><span class="br0">&#40;</span><span class="kw2">Substring</span><span class="br0">&#40;</span>@Fragment, <span class="nu0">1</span> <span class="sy0">+</span> @InQuotes, <span class="nu0">8000</span><span class="br0">&#41;</span>, <span class="st0">''</span><span class="st0">''</span><span class="st0">''</span>, <span class="st0">''</span><span class="st0">''</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">END</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">ELSE</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @Item <span class="sy0">=</span> @Fragment
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">END</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">END</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">IF</span> @InQuotes <span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">INSERT</span> @<span class="kw1">Array</span> <span class="br0">&#40;</span>Item<span class="br0">&#41;</span> <span class="kw1">VALUES</span> <span class="br0">&#40;</span>@Item<span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">SET</span> @Item <span class="sy0">=</span> <span class="st0">''</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">END</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">SET</span> @Pos <span class="sy0">=</span> @<span class="kw1">End</span> <span class="sy0">+</span> <span class="nu0">1</span>
&nbsp; &nbsp;<span class="kw1">END</span>
&nbsp;
&nbsp; &nbsp;<span class="kw1">RETURN</span>
<span class="kw1">END</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE FUNCTION SplitQuotedString (@String varchar(max))
RETURNS @Array TABLE (Item varchar(8000))
AS
BEGIN
   DECLARE
      @Pos int,
      @End int,
      @TextLength int,
      @Item varchar(8000),
      @Fragment varchar(8000),
      @InQuotes bit
   SET @TextLength = DataLength(@String)

   IF @TextLength = 0 RETURN

   SET @Pos = 1
   SET @InQuotes = 0
   SET @String = @String + ','
   SET @Item = ''
   WHILE 1 = 1 BEGIN
      SET @End = CharIndex(',', @String, @Pos)
      IF @End = 0 BREAK
      SET @Fragment = Substring(@String, @Pos, @End - @Pos)
      IF @InQuotes = 1 BEGIN
         --InQuotes becomes false if there are an odd number of single quotes at the end of this fragment
         SET @InQuotes = PatIndex('%[^'']%', Reverse(@Fragment) + 'x') % 2
         SET @Item = @Item + ',' + Replace(Left(@Fragment, DataLength(@Fragment) - 1 + @InQuotes), '''''', '''')
      END
      ELSE BEGIN
         IF @Fragment LIKE '''%' BEGIN
            SET @InQuotes = 1
            SET @Item = Replace(Substring(@Fragment, 1 + @InQuotes, 8000), '''''', '''')
         END
         ELSE BEGIN
            SET @Item = @Fragment
         END
      END
      IF @InQuotes = 0 BEGIN
         INSERT @Array (Item) VALUES (@Item)
         SET @Item = ''
      END
      SET @Pos = @End + 1
   END

   RETURN
END</pre></div></div>

<p>You&#8217;re welcome to use it, or write your own. You may not agree with how I chose to do it, and if you have any seriously big improvements do let me know. But I was not overly concerned with extracting that last tiny bit of performance, as my strings will never be very long and will never have more than a dozen or so items. I could not use a Numbers table solution since I am doubling up single quotes and in the case of encountering input such as &#8220;&#8221;&#8221;&#8221; it would incorrectly match an extra time at the second quote mark. Preventing a false match requires knowing if the current quote mark is an even or an odd one, which would need to look backward in the string, which complicated it so much that I just went for a chunk-by-chunk method that looks at each string separated by commas and determines if it begins a quoted string. If so, then each fragment is added to the item until the closing quote mark is encountered, and finally the complete item is added to the output table. If the item is not quoted, it is simply added to the output table.</p>
<p><em>Note</em>: In this function I assumed that no individual value would exceed 8000 characters. I also assumed that an item will not be quoted without containing a comma character. If items are quoted that don&#8217;t contain commas, this code will break. See the escaping logic I used in the query for the value list producing Dataset on the SSRS report.</p>
<p>If your data will never have commas in it or you can use the the fixed-length method, then should use your own plain-vanilla split function rather than my unescaping version.</li>
<li>Split and use the multi-value string.
<p>Here&#8217;s the code I used, which should be enough of an example to let you develop your own version that suits your needs:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="de1"><pre class="de1"><span class="kw1">DECLARE</span> @DocumentNames <span class="kw1">TABLE</span> <span class="br0">&#40;</span>
&nbsp; &nbsp; DocumentName <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">60</span><span class="br0">&#41;</span>
<span class="br0">&#41;</span>
<span class="kw1">IF</span> <span class="kw1">Coalesce</span><span class="br0">&#40;</span>@DocumentNameParam, <span class="st0">''</span><span class="br0">&#41;</span> <span class="sy0">=</span> <span class="st0">''</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">INSERT</span> @DocumentNames <span class="kw1">SELECT</span> Item <span class="kw1">FROM</span> dbo.<span class="me1">SplitQuotedString</span><span class="br0">&#40;</span>@DocumentNameParam<span class="br0">&#41;</span>
<span class="kw1">END</span>
<span class="kw1">ELSE</span> <span class="kw1">BEGIN</span>
&nbsp; &nbsp;<span class="kw1">INSERT</span> @DocumentNames
&nbsp; &nbsp;<span class="kw1">SELECT</span> <span class="st0">'Document Name 1'</span>
&nbsp; &nbsp;<span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> <span class="st0">'Document Name 2'</span>
&nbsp; &nbsp;<span class="kw1">UNION</span> <span class="sy0">ALL</span> <span class="kw1">SELECT</span> <span class="st0">'Document Name 3, Special'</span>
<span class="kw1">END</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">DECLARE @DocumentNames TABLE (
	DocumentName varchar(60)
)
IF Coalesce(@DocumentNameParam, '') = '' BEGIN
   INSERT @DocumentNames SELECT Item FROM dbo.SplitQuotedString(@DocumentNameParam)
END
ELSE BEGIN
   INSERT @DocumentNames
   SELECT 'Document Name 1'
   UNION ALL SELECT 'Document Name 2'
   UNION ALL SELECT 'Document Name 3, Special'
END</pre></div></div>

<p>To my dismay, I was not allowed to make this SP read from a table. But I am still quite happy because now I don&#8217;t care if the SP gets updated with new document names: when the reporting system creates a report, it will pass in document names and always be correct. I have insulated the reporting system against exactly the thing I was trying to avoid: mistakes when updating the SP. I&#8217;ll even throw in that I was the one who made the mistake updating the SP last time—I didn&#8217;t know the hard-coded document list was in <strong>three</strong> places. Now, at least, the list is in one place.</p>
<p>And finally, using the document names:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
</pre></td><td class="de1"><pre class="de1"><span class="kw1">INNER</span> <span class="sy0">JOIN</span> @DocumentNames N <span class="kw1">on</span> D.<span class="me1">DocumentName</span> <span class="sy0">=</span> N.<span class="me1">DocumentName</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">INNER JOIN @DocumentNames N on D.DocumentName = N.DocumentName</pre></div></div>

</li>
</ol>
<h2>Modify The SSRS Report</h2>
<ol>
<li>Update the Dataset. On the Data tab, either create a new Dataset or update an existing Dataset so that it has the correct SP name and finds the new parameter you added. To edit a Dataset, click the &#8220;&#8230;&#8221; button to the right of the Dataset name dropdown.</li>
<li>Decide whether the report&#8217;s default list of available document names will be hard-coded in the report or supplied by a query. I chose to make it data-driven so that if a new document is added, it will show up in the report without any changes to it, or with only a change to a shared data source, rather than having to change the SSRS report itself. I always prefer to make changes to data or shared objects than to code or types of things that have to be tested and deployed.
<p><strong>From query:</strong> Create a new DataSet that pulls the document names, one per row. Here is the query I used:</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span>
&nbsp; &nbsp;DocNameString <span class="sy0">=</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">CASE</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">WHEN</span> DocName <span class="sy0">LIKE</span> <span class="st0">'%,%'</span> <span class="kw1">THEN</span> <span class="st0">''</span><span class="st0">''</span> <span class="sy0">+</span> <span class="kw2">Replace</span><span class="br0">&#40;</span>DocName, <span class="st0">''</span><span class="st0">''</span>, <span class="st0">''</span><span class="st0">''</span><span class="st0">''</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">''</span><span class="st0">''</span>
&nbsp; &nbsp; &nbsp; <span class="kw1">ELSE</span> DocName
&nbsp; &nbsp; &nbsp; <span class="kw1">END</span>,
&nbsp; &nbsp;DocName
<span class="kw1">FROM</span> ReportDocName
<span class="kw1">WHERE</span> ReportID <span class="sy0">=</span> <span class="nu0">62</span> <span class="co1">-- my particular report that has multiple document names</span>
<span class="kw1">ORDER</span> <span class="kw1">BY</span> DocName</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT
   DocNameString =
      CASE
      WHEN DocName LIKE '%,%' THEN '''' + Replace(DocName, '''', '''''') + ''''
      ELSE DocName
      END,
   DocName
FROM ReportDocName
WHERE ReportID = 62 -- my particular report that has multiple document names
ORDER BY DocName</pre></div></div>

<p>This is the logic that I wrote the SplitQuotedString to match. If you change how you escape commas, you&#8217;ll need to write your own splitting/unescaping function. Run the query to make sure it&#8217;s working correctly. It should have two columns, one with commas escaped, and one with them unescaped. If you don&#8217;t have to escape commas in your data, then one column is okay. </p>
<p><strong>Non-queried:</strong> Run a query manually to extract the list you want or locate the values wherever they are. Keep this handy to paste in later.</li>
<li>Select Report->Report Parameters. If there isn&#8217;t already a new parameter automatically added by the fact that your SP now has a new parameter, then Add a new parameter.<br />
• Name: Give it the same name that you called the parameter in your SP. For me: DocumentNameParam.<br />
• Data type: String<br />
• Prompt: Document Names<br />
• Check the &#8220;Multi-value&#8221; checkbox. I also checked &#8220;Allow blank value&#8221; because if no names are specified, I want the SP&#8217;s list of document names to take over. You cannot choose &#8220;Allow null value&#8221; with a Multi-value parameter (at least, I couldn&#8217;t select it and I think that is the reason).<br />
• Available values:<br />
&#8211; For &#8220;Non-queried&#8221; paste in each option, one at a time, from the list of options you built earlier.<br />
&#8211; For &#8220;From query&#8221; choose the Dataset you created that displays the possible list. For &#8220;Value field&#8221; select the column that has commas escaped, and for &#8220;Label field&#8221; select the one that is plain. If your Dataset only has one column, use it in both places.<br />
• Default values:<br />
&#8211; For &#8220;Non-queried&#8221; paste in each option that you want to be selected by default.<br />
&#8211; For &#8220;From query&#8221; choose your list Dataset, or perhaps select a special default Dataset you created that is different from the list of all possible options. I used the same Dataset since I want all values to be selected by default.</p>
<p class="text-align:center;"><img src="/wp-content/uploads/blogs/DataMgmt/ssrs_multi_value_parameters/MultiValueReportParameters.PNG" alt="SSRS Report Parameters" title="Creating a Multi-value Parameter" /></p>
</li>
<li>If you had to add the multi-value report parameter manually, edit the source Dataset and make sure it is mapped properly. Click on the Data tab, select the correct Dataset, click the &#8220;&#8230;&#8221; edit button, select Parameters, and make sure that the Name is mapped to the Value.
<p><img src="/wp-content/uploads/blogs/DataMgmt/ssrs_multi_value_parameters/MultiValueDataSet.PNG" alt="SSRS Dataset Parameters" title="Mapping A Dataset Parameter to a Report Parameter" /></li>
</ol>
<h1>Happily Use Your Shiny New Report</h1>
<p>I hope that this article has been useful to you, and helps you get a Multi-value parameter added to your SSRS report in no time!</p>
<p>Erik<br />
<br />
<span class="MT_smaller"><strong>Afterthoughts</strong></p>
<p>• You <em>could</em> use a query instead of a stored procedure.<br />
• Think carefully before using a multi-valued parameter to solve problems that should be solved by database normalization. A multi-value column in a database is a BAD idea if you ever have to work with the individual items. Don&#8217;t try to adapt this solution to such a column. Fix the database design instead.</span></p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/ssrs-05-passing-multi-value-parameters-b/'>SSRS 05 Passing Multi-Value Parameters Between Reports.</a><p>So today I had some fun with a report. I had to set up a&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/getting-the-list-of-parameters/'>Getting the list of parameters from a stored procedure by using sqlCmd.Parameters or INFORMATION_SCHEMA.parameters</a><p>If you want to see what parameters a stored procedure is using then you can&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Erik has been working in IT since 1993 and starting in 2004 has specialized in MS SQL Server query writing, database design, and reporting services. He also professionally does web site design/developing and writes C# applications (mostly for projects involving his databases and web sites).

His career in the industry truly started when he first began using computers in the late 70s. In 1984 he began programming on the IBM PCJr, and performed game testing on King's Quest I. These early experiences gave him the taste and drive to continue an incremental and self-taught path all the way to his current position.

Erik is also interested in taekwondo, go (ranks 4k on KGS), sci-fi books, mathematics, philosophy, religion, and rollerblading. He and his family live on the West Coast of the US.<br style="clear: left" /></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 58,609 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/emtucifor/">Read More Posts by Erik</a>
						</div>
					</div>
					<div>
						<label>Tags:</label> <a href="/index.php/tag/escape-commas/" rel="tag">escape commas</a>, <a href="/index.php/tag/multi-value/" rel="tag">multi-value</a>, <a href="/index.php/tag/parameter/" rel="tag">parameter</a>, <a href="/index.php/tag/split/" rel="tag">split</a>, <a href="/index.php/tag/sql-server/" rel="tag">sql server</a>, <a href="/index.php/tag/ssrs-2/" rel="tag">ssrs</a> 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&text=RT @LessThanDot Blog - Multi-Value Parameters in SSRS by emtucifor" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&title=Multi-Value Parameters in SSRS&source=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&title=Multi-Value Parameters in SSRS" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&quote=Multi-Value Parameters in SSRS" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/&title=Multi-Value Parameters in SSRS" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		3 Comments	</h4>
			<ol class="comments-list">
					<li class="comment byuser comment-author-thirster42 even thread-even depth-1" id="comment-1366">
				<div id="div-comment-1366" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/026f3abfbd6ac89b6dbabbd4cef2e83d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/026f3abfbd6ac89b6dbabbd4cef2e83d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">David Forck (thirster42)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/#comment-1366">
			March 23, 2012 at 2:09 pm</a>		</div>

		<p>The easiest way to never have to worry about excaping your values is if you only use numeric values.  Say, an identity.</p>
<p>My multi-valued parameters always return a delimited list of pk keys that i then filter the select on.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/?replytocom=1366#respond' onclick='return addComment.moveForm( "div-comment-1366", "1366", "respond", "443" )' aria-label='Reply to David Forck (thirster42)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1367">
				<div id="div-comment-1367" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/cf2f94f0797d478f8b95b25e0fa3206e?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/cf2f94f0797d478f8b95b25e0fa3206e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Keith DeJarnet</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/#comment-1367">
			January 30, 2013 at 8:45 am</a>		</div>

		<p>This is great information. Unfortunately I keep getting an error that too many arguments were specified when I try using it in SSRS since the multi-value string being passed isn&#8217;t enclosed in single quotes so the coma delimited string is seen as different arguments being submitted to the SP when it only accepts one. </p>
<p>Any suggestions?</p>
<p>Thanks,</p>
<p>Keith</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/?replytocom=1367#respond' onclick='return addComment.moveForm( "div-comment-1367", "1367", "respond", "443" )' aria-label='Reply to Keith DeJarnet'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-emtucifor bypostauthor even thread-even depth-1" id="comment-1368">
				<div id="div-comment-1368" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/#comment-1368">
			January 30, 2013 at 12:07 pm</a>		</div>

		<p>Keith,</p>
<p>When I wrote this blog article I was actually unaware of one of the features of SSRS: it tries to do multi-value parameters in queries for you! The way that works is to create a multi-value parameter, then in your query text do something like this:</p>
<pre>SELECT *
FROM dbo.YourView
WHERE ColumnA IN (@YourMultiValueParameter);</pre>
<p>This gets auto-magically turned into a comma-separated list of distinct items. Of course, it requires that you use this format, and it can be fragile&#8211;it doesn&#8217;t always figure out correctly what you want to do. And it sounds like that&#8217;s what you&#8217;re running up against&#8211;SSRS is trying to solve the multi-value parameter problem itself, and fouling up your different method of attacking the problem.</p>
<p>To work around this, you have a couple of choices.</p>
<p>1. Concatenate the string yourself. Write a small piece of VB code in the Code section of the report, that, when passed in a parameter, returns a comma-delimited (and comma-escaped!) list. Then use this function&#8217;s return value as your SP&#8217;s parameter.</p>
<p>2. Bow to the way SSRS wants you to do multi-value parameters and put into your script an IN() clause somehow. This could work well if your possible parameters are coming from a short table that defines them. Let&#8217;s say it&#8217;s a list of document names (as in my example for this blog post). You could use a Table-valued parameter in SQL Server 2008 and up:</p>
<pre>/* create the table type, do this only once */
CREATE TYPE Varchar200Type AS TABLE (
   Value varchar(200)
);

/* Modify your SP to use a table-valued parameter (TVP) instead*/
CREATE PROCEDURE dbo.MySP
   @DocumentNames Varchar200Type READONLY
AS
... join to @DocumentNames in your SP

/* Call the SP */
DECLARE @DocumentNameList AS Varchar200Type;

INSERT @DocumentNameList
SELECT Name
FROM dbo.DocumentNames
WHERE Name IN (@DocumentNames);

EXEC dbo.MySP @DocumentNameList;</pre>
<p>The @DocumentNames SQL parameter would be the one you bind your SSRS parameter to.</p>
<p>I hope this helps!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/?replytocom=1368#respond' onclick='return addComment.moveForm( "div-comment-1368", "1368", "respond", "443" )' aria-label='Reply to Erik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/ssrs_multi_value_parameters/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='443' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="37bc2f75bf1bcfe8450a1a41c200364c"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552766467"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
