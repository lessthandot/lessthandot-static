<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Calculating Mean, Median and Mode with SQL Server</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Calculating Mean, Median and Mode with SQL Server" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Calculating Median and Mode with SQL Server can be frustrating for some developers, but it doesn't have to be.  Often times, inexperienced developers will attempt to write this with procedural programming practices, but set based methods do exist.Be&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Calculating Mean, Median and Mode with SQL Server Comments Feed" href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Fun With NDepend' href='/index.php/desktopdev/mstech/fun-with-ndepend/' />
<link rel='next' title='sp_replwritetovarbin Heap Overflow Code Exploit Code In The Wild, Works By Using Our Good Friend SQL Injection' href='/index.php/datamgmt/datadesign/sp_replwritetovarbin-heap-overflow-code/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/" />
<link rel='shortlink' href='/?p=258' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fcalculating-mean-median-and-mode-with-sq%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fcalculating-mean-median-and-mode-with-sq%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/datadesign/sp_replwritetovarbin-heap-overflow-code/" rel="next">sp_replwritetovarbin Heap Overflow Code Exploit Code In The Wild, Works By Using Our Good Friend SQL Injection</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/desktopdev/mstech/fun-with-ndepend/" rel="prev">Fun With NDepend</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/" class="post-title">Calculating Mean, Median and Mode with SQL Server</a></h1>
					<div class="post-byline">by <a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)" rel="author">George Mastros (gmmastros)</a> on December 22, 2008 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a> <a href="/index.php/category/datamgmt/dbprogramming/mssqlserver/" rel="category tag">Microsoft SQL Server</a>. Article views: 223,425 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&text=RT @LessThanDot Blog - Calculating Mean, Median and Mode with SQL Server by @gmmastros" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&title=Calculating Mean, Median and Mode with SQL Server&source=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&title=Calculating Mean, Median and Mode with SQL Server" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&quote=Calculating Mean, Median and Mode with SQL Server" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&title=Calculating Mean, Median and Mode with SQL Server" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>Calculating Median and Mode with SQL Server can be frustrating for some developers, but it doesn&#8217;t have to be.  Often times, inexperienced developers will attempt to write this with procedural programming practices, but set based methods do exist.</p>
<p>Before showing you methods to calculate these values, it’s probably best to explain what they are.<br />
Mean is another name for average.  SQL Server has a built-in function to calculate this value.</p>
<pre>Data
----
1
2
5
5
5
6
6
6
7
9
10</pre>
<p>To calculate the average, sum the data and divide by the number of rows.  In this case, 1 + 2 + 5 + 5 + 5 + 6 + 6 + 6 + 7 + 9 + 10 = 62.  62/11 = 5.636363</p>
<p>Median represents the &#8216;middle&#8217; value.  To calculate the median by hand, you sort the values and return the value that appears in the middle of the list.  If there is an odd number of items, there will be exactly one value in the middle of the list.  If there is an even number of items, you average the 2 values that are closest to the middle.</p>
<pre>Data
1
2
5
5
5
&lt;span style="color:red;"&gt;6&lt;/span&gt;
6
6
7
9
10</pre>
<p>Since there is an odd number of rows, the row appearing in the middle of the list contains your median value.</p>
<pre>Data
1
2
5
5
&lt;span style="color:red;"&gt;5
6&lt;/span&gt;
6
6
7
9</pre>
<p>Now, there is an even number of rows.  The median for this data set is (5 + 6)/2 = 5.5.  Simply take the average of the 2 values appearing in the middle of the data set.</p>
<p><strong>MODE</strong><br />
The mode for a data set is the item(s) that appear most frequently.  To calculate this by hand, you write a distinct list of values and count the number of times a value appears.  The value the appears the most is your mode.</p>
<pre>Data	Frequency
----    ---------
1	1
2	1
&lt;span style="color:red;"&gt;5	3
6	3&lt;/span&gt;
7	1
9	1
10	1</pre>
<p>This data set is considered to be Bi-Modal because there are 2 values with the same frequency.  With this data set, the modes are 5 and 6.</p>
<p>For demonstration purposes, I will create a table variable and populate it with data.  All code will be based on this table variable.  The data type for the data column will be Decimal(10,5).  If we used an integer column, then we would need to concern ourselves with integer math issues, which is not the focus of this blog.</p>
<p><strong>AVERAGE</strong><br />
As I stated earlier, SQL Server has a built-in function for calculating the average.  The Avg function will ignore rows with NULL.  So the average of 1, 2, NULL is 1.5 because the sum of the data is 3 and there are 2 rows that are not NULL.  3/2 = 1.5.</p>
<pre>Declare @Temp Table(Id Int Identity(1,1), Data Decimal(10,5))

Insert into @Temp Values(1)
Insert into @Temp Values(2)
Insert into @Temp Values(5)
Insert into @Temp Values(5)
Insert into @Temp Values(5)
Insert into @Temp Values(6)
Insert into @Temp Values(6)
Insert into @Temp Values(6)
Insert into @Temp Values(7)
Insert into @Temp Values(9)
Insert into @Temp Values(10)
Insert into @Temp Values(NULL)

Select Avg(Data)
From   @Temp

-- 5.636363</pre>
<p><strong>MEDIAN</strong><br />
To calculate the median, we will select the last value in the top 50 percent of rows, and the first value in the bottom 50 percent (all while ignoring NULL values).<br />
To get the last value in the top 50 percent of rows….</p>
<pre>		Select Top 1 Data
		From   (
				Select Top 50 Percent Data
				From	@Temp
				Where	Data Is NOT NULL
				Order By Data
				) As A
		Order By Data DESC</pre>
<p>To get the first value in the last 50 percent of rows…</p>
<pre>		Select Top 1 Data
		From   (
				Select Top 50 Percent Data
				From	@Temp
				Where	Data Is NOT NULL
				Order By Data DESC
				) As A
		Order By Data Asc</pre>
<p>Putting it all together:</p>
<pre>Declare @Temp Table(Id Int Identity(1,1), Data Decimal(10,5))

Insert into @Temp Values(1)
Insert into @Temp Values(2)
Insert into @Temp Values(5)
Insert into @Temp Values(5)
Insert into @Temp Values(5)
Insert into @Temp Values(6)
Insert into @Temp Values(6)
Insert into @Temp Values(6)
Insert into @Temp Values(7)
Insert into @Temp Values(9)
Insert into @Temp Values(10)
Insert into @Temp Values(NULL)

Select ((
		Select Top 1 Data
		From   (
				Select	Top 50 Percent Data
				From	@Temp
				Where	Data Is NOT NULL
				Order By Data
				) As A
		Order By Data DESC) + 
		(
		Select Top 1 Data
		From   (
				Select	Top 50 Percent Data
				From	@Temp
				Where	Data Is NOT NULL
				Order By Data DESC
				) As A
		Order By Data Asc)) / 2
-- 6</pre>
<p><strong>MODE</strong><br />
To Calculate the mode with sql server, we first need to get the counts for each value in the set.  Then, we need to filter the data so that values equal to the count are returned.</p>
<pre>Declare @Temp Table(Id Int Identity(1,1), Data Decimal(10,5))

Insert into @Temp Values(1)
Insert into @Temp Values(2)
Insert into @Temp Values(5)
Insert into @Temp Values(5)
Insert into @Temp Values(5)
Insert into @Temp Values(6)
Insert into @Temp Values(6)
Insert into @Temp Values(6)
Insert into @Temp Values(7)
Insert into @Temp Values(9)
Insert into @Temp Values(10)
Insert into @Temp Values(NULL)

SELECT TOP 1 with ties DATA
FROM   @Temp
WHERE  DATA IS Not NULL
GROUP  BY DATA
ORDER  BY COUNT(*) DESC</pre>
<p>As you can see, there are set based methods for calculating all of these values, which can be many times faster than calculating these values in a cursor.</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/it-s-hard-to-be/'>It's Hard To Be "Average": Mean, Median, and Mode in SQL Server</a><p>Average Joe. An average day. An average salary. An average run. An average house. You&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/do-not-use-reserved-keywords/'>Do not use reserved keywords for your column names</a><p>Column names and table names should not use reserved keywords in your database. You can&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>George has been developing software professionally for 19 years, first for the department of defense, and then for various other companies.  In 1998, George started his software company, Orbit Software, specializing in School Bus Transportation software.  His specialty is refining SQL Server queries to deliver optimal performance.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/gmmastros" title="gmmastros at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="/index.php/author/gmmastros/feed/" title="Blog RSS feed for gmmastros" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 223,425 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/gmmastros/">Read More Posts by George Mastros (gmmastros)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&text=RT @LessThanDot Blog - Calculating Mean, Median and Mode with SQL Server by @gmmastros" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&title=Calculating Mean, Median and Mode with SQL Server&source=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&title=Calculating Mean, Median and Mode with SQL Server" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&quote=Calculating Mean, Median and Mode with SQL Server" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/&title=Calculating Mean, Median and Mode with SQL Server" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		27 Comments	</h4>
			<ol class="comments-list">
					<li class="comment even thread-even depth-1" id="comment-611">
				<div id="div-comment-611" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7f24d340b1588f49c1ce43442bcc401a?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7f24d340b1588f49c1ce43442bcc401a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">dewitte</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-611">
			January 7, 2009 at 9:08 am</a>		</div>

		<p>Thank you!  I run into this all the time and I never remember to take advantage of the top X percent phrase.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=611#respond' onclick='return addComment.moveForm( "div-comment-611", "611", "respond", "258" )' aria-label='Reply to dewitte'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-612">
				<div id="div-comment-612" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2059711ebe3c23d7636005267df75d6b?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2059711ebe3c23d7636005267df75d6b?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.synergiesinsync.org/' rel='external nofollow' class='url'>Lani Fraizer</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-612">
			March 17, 2009 at 12:24 pm</a>		</div>

		<p>Very helpful, thanks for posting this!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=612#respond' onclick='return addComment.moveForm( "div-comment-612", "612", "respond", "258" )' aria-label='Reply to Lani Fraizer'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-624">
				<div id="div-comment-624" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/19fa13e45fc2316edbb72bd5b7dda401?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/19fa13e45fc2316edbb72bd5b7dda401?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">manish</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-624">
			September 11, 2009 at 8:41 am</a>		</div>

		<p>this is helpful but I made changes to Mode calculation as following..is it any better?</p>
<p>SELECT  TOP 1 DATA<br />
FROM     @Temp<br />
WHERE DATA IS Not NULL<br />
GROUP BY DATA<br />
ORDER BY COUNT(*) DESC</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=624#respond' onclick='return addComment.moveForm( "div-comment-624", "624", "respond", "258" )' aria-label='Reply to manish'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-625">
				<div id="div-comment-625" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-625">
			September 11, 2009 at 9:07 am</a>		</div>

		<p>@manish,</p>
<p>Strictly speaking, your query is not correct because data sets can be multi-modal, which your query does not accommodate.</p>
<p>For example, if you have the following values: 1,2,5,5,5,6,6,6,7,9,10<br />
5 appears 3 times and 6 appears 3 times.  This data set is considered multi-modal because there are multiple values that appear in the data set the same number of times.</p>
<p>That being said, a slight modification to your query will return the correct results and execute faster than the query I show.</p>
<p>SELECT TOP 1 WITH TIES DATA<br />
FROM @Temp<br />
WHERE DATA IS Not NULL<br />
GROUP BY DATA<br />
ORDER BY COUNT(*) DESC </p>
<p>Notice the &#8220;WITH TIES&#8221; addition to your query.  This allows multiple rows to be returned where the top 1 value appears in multiple rows.</p>
<p>Thank you for your comment.  I will change the query in the blog so that others may benefit from this (without needing to read these comments).</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=625#respond' onclick='return addComment.moveForm( "div-comment-625", "625", "respond", "258" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-608">
				<div id="div-comment-608" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/84b333c4a56e462ed4285aae16f550bb?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/84b333c4a56e462ed4285aae16f550bb?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">jt</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-608">
			November 20, 2009 at 4:15 am</a>		</div>

		<p>very useful, thx 🙂</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=608#respond' onclick='return addComment.moveForm( "div-comment-608", "608", "respond", "258" )' aria-label='Reply to jt'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-614">
				<div id="div-comment-614" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/aed4300e2dc8bfa5fc31ef78d7503df1?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/aed4300e2dc8bfa5fc31ef78d7503df1?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ben</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-614">
			December 4, 2009 at 9:30 am</a>		</div>

		<p>Very helpful.  One suggestion on the mode, however.  You probably want a HAVING COUNT(*)>1 in there to account for the fact that some datasets may not have a mode.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=614#respond' onclick='return addComment.moveForm( "div-comment-614", "614", "respond", "258" )' aria-label='Reply to Ben'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-emtucifor even thread-even depth-1" id="comment-620">
				<div id="div-comment-620" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/27d6e9660735af7bad858dbf2f1eecbc?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Erik</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-620">
			December 11, 2009 at 5:23 pm</a>		</div>

		<p>Ben,</p>
<p>Could you give an example of a data set that doesn&#8217;t have a mode? Consider the data set:</p>
<p>1<br />
2</p>
<p>Isn&#8217;t the mode [1, 2]?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=620#respond' onclick='return addComment.moveForm( "div-comment-620", "620", "respond", "258" )' aria-label='Reply to Erik'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-621">
				<div id="div-comment-621" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2cce9caa75900ab8987c85f69d6abd89?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2cce9caa75900ab8987c85f69d6abd89?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Lucian</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-621">
			August 23, 2010 at 8:12 am</a>		</div>

		<p>Thank you for the great tip, helped a lot!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=621#respond' onclick='return addComment.moveForm( "div-comment-621", "621", "respond", "258" )' aria-label='Reply to Lucian'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-618">
				<div id="div-comment-618" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/ca693e117847a6ddf67d4ebc321a48d5?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/ca693e117847a6ddf67d4ebc321a48d5?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Deb W</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-618">
			January 12, 2011 at 7:31 am</a>		</div>

		<p>How would you get the mean, mode, median By a Group of some sort?</p>
<p>DECLARE @Temp TABLE(Id INT IDENTITY(1,1),Application_id int, DATA DECIMAL(10,5))</p>
<p>INSERT INTO @Temp VALUES(1,1)<br />
INSERT INTO @Temp VALUES(1,2)<br />
INSERT INTO @Temp VALUES(1,5)<br />
INSERT INTO @Temp VALUES(1,5)<br />
INSERT INTO @Temp VALUES(2,5)<br />
INSERT INTO @Temp VALUES(1,6)<br />
INSERT INTO @Temp VALUES(2,6)<br />
INSERT INTO @Temp VALUES(2,6)<br />
INSERT INTO @Temp VALUES(1,7)<br />
INSERT INTO @Temp VALUES(2,9)<br />
INSERT INTO @Temp VALUES(2,10)<br />
INSERT INTO @Temp VALUES(null,NULL)</p>
<p>Want to get the mean, mode, median by the Application_Id  in the above table.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=618#respond' onclick='return addComment.moveForm( "div-comment-618", "618", "respond", "258" )' aria-label='Reply to Deb W'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-622">
				<div id="div-comment-622" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/76ebd6fecabc982c205dd056e8f0415a?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/76ebd6fecabc982c205dd056e8f0415a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">greatbear302</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-622">
			January 20, 2011 at 11:53 am</a>		</div>

		<p>are you sure mean equals average in statistics?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=622#respond' onclick='return addComment.moveForm( "div-comment-622", "622", "respond", "258" )' aria-label='Reply to greatbear302'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor even thread-even depth-1" id="comment-623">
				<div id="div-comment-623" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-623">
			January 20, 2011 at 12:13 pm</a>		</div>

		<p>@greatbear302,</p>
<p>Yes.  I am sure that &#8220;Arithmetic Mean&#8221; is the same thing as Avg.  There are other types of means that statisticians  use, like Geometric Mean, Harmonic Mean, etc&#8230;</p>
<p>The calculations that SQL Server perform with the AVG aggregate function is what statisticians refer to as Arithmetic Mean.</p>
<p>For more information regarding other types of Means:<br />
<a href="http://en.wikipedia.org/wiki/Mean" rel="nofollow">http://en.wikipedia.org/wiki/Mean</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=623#respond' onclick='return addComment.moveForm( "div-comment-623", "623", "respond", "258" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-613">
				<div id="div-comment-613" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9979581099ac4049817c39a959f594a3?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9979581099ac4049817c39a959f594a3?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Shuaib</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-613">
			May 6, 2011 at 12:56 pm</a>		</div>

		<p>Great Article and Helped me a lot to clearly understand the logic.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=613#respond' onclick='return addComment.moveForm( "div-comment-613", "613", "respond", "258" )' aria-label='Reply to Shuaib'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-617">
				<div id="div-comment-617" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/46a1c95070b58f9d8ba429c3c28783f8?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/46a1c95070b58f9d8ba429c3c28783f8?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">ivonna</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-617">
			August 29, 2011 at 9:53 pm</a>		</div>

		<p>Hi,i cant have the results i want, here below my sample.  could you help please?   I have </p>
<p>select 75012345 bc, cast(2.5 as decimal(12,2)) vl into _tbl<br />
insert into _tbl select 75012345, 5.0<br />
insert into _tbl select 75012345, 4.0<br />
insert into _tbl select 75054321, 3.5<br />
insert into _tbl select 75054321, 2.0<br />
insert into _tbl select 75054321, 3.0</p>
<p>select top 1 with ties vl<br />
from _tbl<br />
where vl is not null<br />
group by vl<br />
order by count(*) desc</p>
<p>select bc, avg(vl) from _tbl group by bc</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=617#respond' onclick='return addComment.moveForm( "div-comment-617", "617", "respond", "258" )' aria-label='Reply to ivonna'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-619">
				<div id="div-comment-619" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-619">
			August 30, 2011 at 6:24 am</a>		</div>

		<p>ivonna,</p>
<p>The code you are using is for MODE.  Your sample data set is considered multi-modal because each value appears exactly once.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=619#respond' onclick='return addComment.moveForm( "div-comment-619", "619", "respond", "258" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-627">
				<div id="div-comment-627" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/ac6f9dd23961ec446345904178e9e12f?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/ac6f9dd23961ec446345904178e9e12f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Paul Stevens</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-627">
			September 16, 2011 at 7:56 am</a>		</div>

		<p>i have the following sample data and script cobbled together through forums and head scratching (fairly new to SQL) </p>
<p>I can get the median for the total of the figures but need to group it by month. </p>
<p>Any idea anyone??</p>
<p>
CREATE TABLE #data (number INT, Month_Name nvarchar (10))<br />
INSERT INTO #data <br />
SELECT 15 as number, &#8216;jan&#8217; as Month_Name union all<br />
SELECT 26 as number, &#8216;jan&#8217; as Month_Name union all<br />
SELECT 47 as number, &#8216;jan&#8217; as Month_Name union all<br />
SELECT 25 as number, &#8216;jan&#8217; as Month_Name union all<br />
SELECT 15 as number, &#8216;jan&#8217; as Month_Name union all<br />
SELECT 20 as number, &#8216;jan&#8217; as Month_Name union all<br />
SELECT 22 as number, &#8216;jan&#8217; as Month_Name union all<br />
SELECT 40 as number, &#8216;jan&#8217; as Month_Name union all<br />
SELECT 98 as number, &#8216;mar&#8217; as Month_Name union all<br />
SELECT 15 as number, &#8216;mar&#8217; as Month_Name union all<br />
SELECT 48 as number, &#8216;mar&#8217; as Month_Name union all<br />
SELECT 75 as number, &#8216;mar&#8217; as Month_Name union all<br />
SELECT 25 as number, &#8216;mar&#8217; as Month_Name union all<br />
SELECT 40 as number, &#8216;mar&#8217; as Month_Name union all<br />
SELECT 44 as number, &#8216;mar&#8217; as Month_Name union all<br />
SELECT 40 as number, &#8216;mar&#8217; as Month_Name union all<br />
SELECT 5 as number, &#8216;feb&#8217; as Month_Name union all<br />
SELECT 2 as number, &#8216;feb&#8217; as Month_Name union all<br />
SELECT 3 as number, &#8216;feb&#8217; as Month_Name union all<br />
SELECT 4 as number, &#8216;feb&#8217; as Month_Name union all<br />
SELECT 5 as number, &#8216;feb&#8217; as Month_Name union all<br />
SELECT 2 as number, &#8216;feb&#8217; as Month_Name union all<br />
SELECT 3 as number, &#8216;feb&#8217; as Month_Name union all<br />
SELECT 4 as number, &#8216;feb&#8217; as Month_Name union all<br />
SELECT 7 as number, &#8216;feb&#8217; as Month_Name</p>
<p>
select * from #data</p>
<p>&#8211;8888888888888888888888888888888888</p>
<p>SELECT  AVG(1.0E * number) ,Month_Name as mine<br />
FROM    (<br />
            SELECT  number,Month_Name,<br />
                    2 * ROW_NUMBER() OVER (ORDER BY number) &#8211; COUNT(*) OVER () AS y<br />
            FROM    #data<br />
         )AS d<br />
WHERE   y BETWEEN 0 AND 2<br />
group by Month_Name</p>
<p>&#8211;8888888888888888888888888888888888</p>
<p>
drop table #data</p>
<p></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=627#respond' onclick='return addComment.moveForm( "div-comment-627", "627", "respond", "258" )' aria-label='Reply to Paul Stevens'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-628">
				<div id="div-comment-628" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-628">
			September 16, 2011 at 9:11 am</a>		</div>

		<p>Paul, try this:</p>
<p>
Select MonthCount.Month_Name, Avg(Number)<br />
From   (<br />
       Select Month_Name, Count(*) As MonthCount From #Data Group By Month_Name<br />
       ) As MonthCount<br />
       Inner Join (<br />
          select Number, Month_Name, Row_Number() Over (Partition By Month_Name Order By NUmber) As RowNumber<br />
          from   #data<br />
         ) As RowCounts<br />
         On MonthCount.Month_Name = RowCounts.Month_Name<br />
Where  2 * RowNumber &#8211; MonthCount Between -1 and 1<br />
Group By MonthCount.Month_Name</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=628#respond' onclick='return addComment.moveForm( "div-comment-628", "628", "respond", "258" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-626">
				<div id="div-comment-626" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/3d03d5c01d9090e0801a82610879c5a5?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/3d03d5c01d9090e0801a82610879c5a5?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Russ</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-626">
			November 3, 2011 at 9:31 am</a>		</div>

		<p>Thanks! One of the business managers thinks I&#8217;m a god now!</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=626#respond' onclick='return addComment.moveForm( "div-comment-626", "626", "respond", "258" )' aria-label='Reply to Russ'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-615">
				<div id="div-comment-615" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/ad2c198edfee196a0e44212740e4d689?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/ad2c198edfee196a0e44212740e4d689?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Marge</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-615">
			December 7, 2011 at 8:23 am</a>		</div>

		<p>You never gave the sql for the MEAN.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=615#respond' onclick='return addComment.moveForm( "div-comment-615", "615", "respond", "258" )' aria-label='Reply to Marge'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-gmmastros bypostauthor even thread-even depth-1" id="comment-616">
				<div id="div-comment-616" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/f3b9936c43f72d26a385f7e9ea90769d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">George Mastros (gmmastros)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-616">
			December 7, 2011 at 8:28 am</a>		</div>

		<p>Marge,</p>
<p>MEAN is exactly the same as Average, which I did show the code for.  I labelled is AVERAGE instead of MEAN.  Sorry for the confusion.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=616#respond' onclick='return addComment.moveForm( "div-comment-616", "616", "respond", "258" )' aria-label='Reply to George Mastros (gmmastros)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-610">
				<div id="div-comment-610" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-610">
			January 10, 2012 at 9:14 am</a>		</div>

		<p>Interesting discussion with good links in this <a href="http://social.msdn.microsoft.com/Forums/en/transactsql/thread/dc3cb084-f0ad-4758-8140-6edf89a681d3">thread</a> in MSDN forum</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=610#respond' onclick='return addComment.moveForm( "div-comment-610", "610", "respond", "258" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-630">
				<div id="div-comment-630" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/d3507e41afb92c2c5ba21a3b7ade6785?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/d3507e41afb92c2c5ba21a3b7ade6785?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">JamesB</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-630">
			February 24, 2012 at 4:40 am</a>		</div>

		<p>Hey guys, thanks for creating this blog. My question is that I&#8217;m a bit confused on the median coding. Can you please explain in detail, perhaps with an example?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=630#respond' onclick='return addComment.moveForm( "div-comment-630", "630", "respond", "258" )' aria-label='Reply to JamesB'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-631">
				<div id="div-comment-631" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/0608585c1a9dfcfbb2324cc673766679?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/0608585c1a9dfcfbb2324cc673766679?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Garvey</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-631">
			February 27, 2012 at 2:15 pm</a>		</div>

		<p>Is there a way to do this if your version of SQL does not provide the TOP 50 Percent phrase?</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=631#respond' onclick='return addComment.moveForm( "div-comment-631", "631", "respond", "258" )' aria-label='Reply to Garvey'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-607">
				<div id="div-comment-607" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/d7794d293fba8e2ed7eab1ec7735cd91?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/d7794d293fba8e2ed7eab1ec7735cd91?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">John O</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-607">
			July 3, 2012 at 8:57 am</a>		</div>

		<p>Regarding the query for the median, it might be better to make the denominator 2.0 instead of just 2 so that it will work even for integer data types.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=607#respond' onclick='return addComment.moveForm( "div-comment-607", "607", "respond", "258" )' aria-label='Reply to John O'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-609">
				<div id="div-comment-609" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/d7794d293fba8e2ed7eab1ec7735cd91?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/d7794d293fba8e2ed7eab1ec7735cd91?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">John O</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-609">
			July 3, 2012 at 1:41 pm</a>		</div>

		<p>&#8212; Here&#8217;s an alternative solution for MEDIAN using<br />
&#8212; ROWNUMBER and AVG</p>
<p>DECLARE @TotalRecords int<br />
DECLARE @Temp Table(Id int IDENTITY(1,1), Data int) &#8211;Decimal(10,5))</p>
<p>INSERT INTO @Temp VALUES(1)<br />
INSERT INTO @Temp VALUES(2)<br />
INSERT INTO @Temp VALUES(3)<br />
INSERT INTO @Temp VALUES(4)<br />
&#8211;INSERT INTO @Temp VALUES(5)</p>
<p>SELECT @TotalRecords = COUNT(*)<br />
FROM @Temp</p>
<p>;<br />
WITH TEMP_WITH_ROW_NUMBER<br />
AS<br />
(<br />
&nbsp;&nbsp;&nbsp;SELECT ROW_NUMBER() OVER(ORDER BY Data ASC) as [_RowIndex]<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;,Data<br />
&nbsp;&nbsp;&nbsp;FROM @Temp<br />
&nbsp;&nbsp;&nbsp;WHERE Data IS NOT NULL<br />
)<br />
SELECT AVG(Data * 1.0) as &#8216;Median&#8217;<br />
FROM TEMP_WITH_ROW_NUMBER<br />
WHERE _RowIndex IN (<br />
&nbsp;&nbsp;&nbsp;&nbsp;FLOOR((@TotalRecords + 1) / 2.0) &#8212; MidLow<br />
&nbsp;&nbsp;&nbsp;,CEILING((@TotalRecords + 1) / 2.0) &#8212; MidHigh<br />
)</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=609#respond' onclick='return addComment.moveForm( "div-comment-609", "609", "respond", "258" )' aria-label='Reply to John O'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1 parent" id="comment-629">
				<div id="div-comment-629" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/20d5fe29abe145eddd2abc6037b4adce?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/20d5fe29abe145eddd2abc6037b4adce?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Noman</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-629">
			November 24, 2013 at 6:18 pm</a>		</div>

		<p>Hi Guys,</p>
<p>I need to get Modes for two columns at a time, see this:</p>
<p>Product    Catalogue    Page<br />
1           1            3<br />
1           1            2<br />
1           2            3</p>
<p>Considering this table structure, my expected result is :<br />
Product     Catalogue     Page<br />
1            1             3</p>
<p>Where Catalogue=1 and Page=3 are Modes.<br />
Pelase help</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=629#respond' onclick='return addComment.moveForm( "div-comment-629", "629", "respond", "258" )' aria-label='Reply to Noman'>Reply</a></div>
				</div>
		<ol class="children">
		<li class="comment odd alt depth-2" id="comment-5062270">
				<div id="div-comment-5062270" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/902903b5297ae16ea012692cdf68a61c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/902903b5297ae16ea012692cdf68a61c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jamie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-5062270">
			May 26, 2016 at 1:09 pm</a>		</div>

		<p>Ever find a solution? I have the same issue.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=5062270#respond' onclick='return addComment.moveForm( "div-comment-5062270", "5062270", "respond", "258" )' aria-label='Reply to Jamie'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
		<li class="comment even thread-odd thread-alt depth-1" id="comment-5060801">
				<div id="div-comment-5060801" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/902903b5297ae16ea012692cdf68a61c?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/902903b5297ae16ea012692cdf68a61c?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Jamie</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#comment-5060801">
			May 25, 2016 at 3:52 pm</a>		</div>

		<p>While the method of calculating mode is fantastic, and thank you for posting it, how would you go about calculating the mode of the values of several columns&#8230;like 64 more? Is it possible? Thanks again.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/?replytocom=5060801#respond' onclick='return addComment.moveForm( "div-comment-5060801", "5060801", "respond", "258" )' aria-label='Reply to Jamie'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/calculating-mean-median-and-mode-with-sq/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='258' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="ad972f10e0800b49d76fed33a21f6698"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765991"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
