<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   SQL Advent 2011 Day 6: Windowing functions</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   SQL Advent 2011 Day 6: Windowing functions" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/sql-advent-2011-day-6/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="In my Are you ready for SQL Server 2012 or are you still partying like it is 1999? post, I wrote about how you should start using SQL Server 2005 and SQL Server 2008 functionality now in order to prepare for SQL Server 2012. I still see tons of code tha&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; SQL Advent 2011 Day 6: Windowing functions Comments Feed" href="/index.php/datamgmt/datadesign/sql-advent-2011-day-6/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Meme Monday for December' href='/index.php/itprofessionals/professionaldevelopment/meme-monday-for-december/' />
<link rel='next' title='Shared Connections – New level of efficiency in SSIS 2012' href='/index.php/datamgmt/datadesign/shared-connections-new-level-of/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/sql-advent-2011-day-6/" />
<link rel='shortlink' href='/?p=1418' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fsql-advent-2011-day-6%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fsql-advent-2011-day-6%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/datadesign/shared-connections-new-level-of/" rel="next">Shared Connections – New level of efficiency in SSIS 2012</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/itprofessionals/professionaldevelopment/meme-monday-for-december/" rel="prev">Meme Monday for December</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/sql-advent-2011-day-6/" class="post-title">SQL Advent 2011 Day 6: Windowing functions</a></h1>
					<div class="post-byline">by <a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis" rel="author">SQLDenis</a> on December 6, 2011 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a>. Article views: 6,521 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&text=RT @LessThanDot Blog - SQL Advent 2011 Day 6: Windowing functions by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&title=SQL Advent 2011 Day 6: Windowing functions&source=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&title=SQL Advent 2011 Day 6: Windowing functions" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&quote=SQL Advent 2011 Day 6: Windowing functions" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&title=SQL Advent 2011 Day 6: Windowing functions" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>In my <a href="/index.php/DataMgmt/DataDesign/are-you-ready-for-sql">Are you ready for SQL Server 2012 or are you still partying like it is 1999?</a> post, I wrote about how you should start using SQL Server 2005 and SQL Server 2008 functionality now in order to prepare for SQL Server 2012. I still see tons of code that is written in the pre 2005 style and people still keep using those functions, procs and statements even though SQL Server 2005 and 2008 have much better functionality.</p>
<p>In today&#8217;s post I will cover Windowing functions. SQL Server 2005 introduced 4 windowing functions, these functions are ROW_NUMBER(), RANK(), DENSE_RANK() and NTILE().</p>
<p>The functions make it very easy to add a number to a resultset or do paging without having to use TOP and SET ROWCOUNT<br />
In the 2000 days you would have to use either a running count or you would insert into a temporary table with an identity column and select from that table ordered by the identity column.</p>
<p>In order to run all the examples we need to create a simple table first.</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="kw1">IF</span> <span class="kw2">OBJECT_ID</span><span class="br0">&#40;</span><span class="st0">'tempdb..#Rankings'</span><span class="br0">&#41;</span> <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
<span class="kw1">DROP</span> <span class="kw1">TABLE</span> #Rankings
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp;<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Rankings <span class="br0">&#40;</span><span class="kw1">Value</span> <span class="kw1">CHAR</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> #Rankings
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'A'</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'B'</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'C'</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'D'</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'E'</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'F'</span>
&nbsp; &nbsp; </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">IF OBJECT_ID('tempdb..#Rankings') IS NOT NULL
DROP TABLE #Rankings
		   
		   
   CREATE TABLE #Rankings (Value CHAR(1))
    INSERT INTO #Rankings
    SELECT 'A' UNION ALL
    SELECT 'B' UNION ALL
    SELECT 'C' UNION ALL
    SELECT 'D' UNION ALL
    SELECT 'E' UNION ALL
    SELECT 'F'
    </pre></div></div>

<p>
<h2>ROW_NUMBER</h2>
<p>The ROW_NUMBER function  returns the sequential number of a row within a partition of a result set, starting at 1 for the first row in each partition. The syntax might look complicated the first time you use it but it is really not</p>
<p>The query below will simply add a number to the resultset</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> ROW_NUMBER<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Value</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Row</span>,<span class="sy0">*</span>
<span class="kw1">FROM</span> #Rankings
<span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Row</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT ROW_NUMBER() OVER ( ORDER BY Value) AS Row,*
FROM #Rankings
ORDER BY Row</pre></div></div>

<p>
<pre>Row                  Value
-------------------- -----
1                    A
2                    B
3                    C
4                    D
5                    E
6                    F</pre>
<p></p>
<p>Let&#8217;s add some more rows so that the table is not unique anymore</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1">&nbsp;<span class="kw1">INSERT</span> <span class="kw1">INTO</span> #Rankings
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'A'</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'B'</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'C'</span> </pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse"> INSERT INTO #Rankings
    SELECT 'A' UNION ALL
    SELECT 'B' UNION ALL
    SELECT 'C' </pre></div></div>

<p>    </p>
<p>When we run the same query again, you can see that it is ordered by Value and the Row column matches that ordering. You can also see that bot rows with the value A have a different row number</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> ROW_NUMBER<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Value</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Row</span>,<span class="sy0">*</span>
<span class="kw1">FROM</span> #Rankings
<span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Row</span> &nbsp; &nbsp;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT ROW_NUMBER() OVER ( ORDER BY Value) AS Row,*
FROM #Rankings
ORDER BY Row    </pre></div></div>

<pre>Row                  Value
-------------------- -----
1                    A
2                    A
3                    B
4                    B
5                    C
6                    C
7                    D
8                    E
9                    F</pre>
<p></p>
<p>You can add more than one ranking function in the same query, in the query below we will add two row numbers, one will be sorted ascending and one will be sorted descending</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> ROW_NUMBER<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Value</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Row</span>,
&nbsp; &nbsp; &nbsp; &nbsp;ROW_NUMBER<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Value</span> <span class="kw1">DESC</span><span class="br0">&#41;</span> <span class="kw1">AS</span> RowDesc,<span class="sy0">*</span>
<span class="kw1">FROM</span> #Rankings
<span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Row</span> &nbsp; &nbsp;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT ROW_NUMBER() OVER ( ORDER BY Value) AS Row,
	   ROW_NUMBER() OVER ( ORDER BY Value DESC) AS RowDesc,*
FROM #Rankings
ORDER BY Row    </pre></div></div>

<p>
<pre>Row                  RowDesc              Value
-------------------- -------------------- -----
1                    8                    A
2                    9                    A
3                    6                    B
4                    7                    B
5                    4                    C
6                    5                    C
7                    3                    D
8                    2                    E
9                    1                    F</pre>
<p></p>
<p>As you can see Row is ordered ascending and RowDesc is ordered descending</p>
<p>
<h2>RANK</h2>
<p>The RANK function is similar to ROW_NUMBER but it will keep the same number for the same value, it also skips numbers when the value changes</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> RANK<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Value</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Row</span>,<span class="sy0">*</span>
<span class="kw1">FROM</span> #Rankings
<span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Row</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT RANK() OVER ( ORDER BY Value) AS Row,*
FROM #Rankings
ORDER BY Row</pre></div></div>

<p>
<pre>Row                  Value
-------------------- -----
1                    A
1                    A
3                    B
3                    B
5                    C
5                    C
7                    D
8                    E
9                    F</pre>
<p></p>
<p>Now the rows with the value A have the same exact number, but did you notice that it skips numbers? What if you don&#8217;t want to skip numbers? You can use DENSE_RANK for that</p>
<p>
<h2>DENSE_RANK</h2>
<p>The DENSE_RANK function is similar to the RANK function, the difference is that numbers are not skipped when the value changes</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> DENSE_RANK<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Value</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Row</span>,<span class="sy0">*</span>
<span class="kw1">FROM</span> #Rankings
<span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Row</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT DENSE_RANK() OVER ( ORDER BY Value) AS Row,*
FROM #Rankings
ORDER BY Row</pre></div></div>

<p>
<pre>Row                  Value
-------------------- -----
1                    A
1                    A
2                    B
2                    B
3                    C
3                    C
4                    D
5                    E
6                    F</pre>
<p></p>
<h2>More examples</h2>
<p>Now let&#8217;s take a look at some more examples. First drop the table we created earlier and create this table instead</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="de1"><pre class="de1">&nbsp;<span class="kw1">IF</span> <span class="kw2">OBJECT_ID</span><span class="br0">&#40;</span><span class="st0">'tempdb..#Rankings'</span><span class="br0">&#41;</span> <span class="kw1">IS</span> <span class="sy0">NOT</span> <span class="sy0">NULL</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="kw1">DROP</span> <span class="kw1">TABLE</span> #Rankings
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GO
<span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Rankings <span class="br0">&#40;</span><span class="kw1">Value</span> <span class="kw1">CHAR</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>, SomeValue <span class="kw1">int</span><span class="br0">&#41;</span>
&nbsp;
&nbsp; &nbsp; <span class="kw1">INSERT</span> <span class="kw1">INTO</span> #Rankings
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'A'</span>,<span class="nu0">1</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'A'</span>,<span class="nu0">2</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'A'</span>,<span class="nu0">3</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'B'</span>,<span class="nu0">2</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'C'</span>,<span class="nu0">3</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'C'</span>,<span class="nu0">3</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'C'</span>,<span class="nu0">9</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'D'</span>,<span class="nu0">4</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'E'</span>,<span class="nu0">5</span> <span class="kw1">UNION</span> <span class="sy0">ALL</span>
&nbsp; &nbsp; <span class="kw1">SELECT</span> <span class="st0">'F'</span>,<span class="nu0">6</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse"> IF OBJECT_ID('tempdb..#Rankings') IS NOT NULL
		   DROP TABLE #Rankings
		   GO
CREATE TABLE #Rankings (Value CHAR(1), SomeValue int)

    INSERT INTO #Rankings
    SELECT 'A',1 UNION ALL
    SELECT 'A',2 UNION ALL
    SELECT 'A',3 UNION ALL
    SELECT 'B',2 UNION ALL
    SELECT 'C',3 UNION ALL
    SELECT 'C',3 UNION ALL
    SELECT 'C',9 UNION ALL
    SELECT 'D',4 UNION ALL
    SELECT 'E',5 UNION ALL
    SELECT 'F',6</pre></div></div>

<p>   </p>
<p>Now let&#8217;s run our simple ROW_NUMBER query again</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1"><span class="kw1">SELECT</span> ROW_NUMBER<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Value</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Row</span>,<span class="sy0">*</span>
<span class="kw1">FROM</span> #Rankings
<span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Row</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">SELECT ROW_NUMBER() OVER ( ORDER BY Value) AS Row,*
FROM #Rankings
ORDER BY Row</pre></div></div>

<p>
<pre>Row                  Value SomeValue
-------------------- ----- -----------
1                    A     1
2                    A     2
3                    A     3
4                    B     2
5                    C     3
6                    C     3
7                    C     9
8                    D     4
9                    E     5
10                   F     6</pre>
<p></p>
<p>So, nothing special, what if you want the number start over when the value column changes. This would be a sample output</p>
<p>A 1<br />
A 2<br />
A 3<br />
B 1<br />
C 1<br />
C 2</p>
<p>In order to do that, you can use partition, if you partition by Value, when the Value changes the number will start from 1 again. Here is what the query looks like</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
</pre></td><td class="de1"><pre class="de1">&nbsp;<span class="kw1">SELECT</span> ROW_NUMBER<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> PARTITION <span class="kw1">BY</span> <span class="kw1">Value</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> SomeValue <span class="kw1">DESC</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Row</span>,<span class="sy0">*</span>
<span class="kw1">FROM</span> #Rankings
<span class="kw1">ORDER</span> <span class="kw1">BY</span> <span class="kw1">Row</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse"> SELECT ROW_NUMBER() OVER ( PARTITION BY Value ORDER BY SomeValue DESC) AS Row,*
FROM #Rankings
ORDER BY Row</pre></div></div>

<p>
<pre>Row                  Value SomeValue
-------------------- ----- -----------
1                    A     3
2                    A     2
3                    A     1
1                    B     2
1                    C     9
2                    C     3
3                    C     3
1                    D     4
1                    E     5
1                    F     6</pre>
<p></p>
<p>How about only returning the distinct value in the Value column together with the max value of the SomeValue column? In order to do that, you can use a Common Table Expression (see <a href="/index.php/DataMgmt/DBProgramming/MSSQLServer/sql-advent-2011-day-5">SQL Advent 2011 Day 5: Common Table Expressions</a> for some information about  Common Table Expressions), you partition by Value and then you select all the rows that are 1</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
</pre></td><td class="de1"><pre class="de1">;<span class="kw1">WITH</span> cte <span class="kw1">AS</span><span class="br0">&#40;</span> <span class="kw1">SELECT</span> ROW_NUMBER<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span> PARTITION <span class="kw1">BY</span> <span class="kw1">Value</span> <span class="kw1">ORDER</span> <span class="kw1">BY</span> SomeValue <span class="kw1">DESC</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Row</span>,<span class="sy0">*</span>
<span class="kw1">FROM</span> #Rankings<span class="br0">&#41;</span>
&nbsp;
<span class="kw1">SELECT</span> <span class="sy0">*</span> <span class="kw1">FROM</span> cte <span class="kw1">WHERE</span> <span class="kw1">row</span> <span class="sy0">=</span> <span class="nu0">1</span>
<span class="kw1">ORDER</span> <span class="kw1">By</span> <span class="kw1">Value</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">;WITH cte AS( SELECT ROW_NUMBER() OVER ( PARTITION BY Value ORDER BY SomeValue DESC) AS Row,*
FROM #Rankings)

SELECT * FROM cte WHERE row = 1
ORDER By Value</pre></div></div>

<p>
<pre>Row                  Value SomeValue
-------------------- ----- -----------
1                    A     3
1                    B     2
1                    C     9
1                    D     4
1                    E     5
1                    F     6</pre>
<p></p>
<p>That was pretty simple, now for a more complex example</p>
<p>This example is from Itzik Ben-Gan, I am not sure if I saw it in a forum or news group, it is really cool if you think about how the code works</p>
<p>First create this table </p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> #Test <span class="br0">&#40;</span>ID <span class="kw1">INT</span> <span class="kw1">IDENTITY</span> not null, SomeDate <span class="kw1">DATETIME</span>, CrewID <span class="kw1">CHAR</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/1/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/2/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/2/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/3/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/4/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/6/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/7/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/10/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/10/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/29/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'6/30/2008'</span>, <span class="st0">'1'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/1/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/2/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/3/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/3/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/4/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/6/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/7/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/10/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/10/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/20/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/21/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span>
<span class="kw1">INSERT</span> #Test <span class="kw1">VALUES</span><span class="br0">&#40;</span><span class="st0">'7/29/2008'</span>, <span class="st0">'2'</span><span class="br0">&#41;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE #Test (ID INT IDENTITY not null, SomeDate DATETIME, CrewID CHAR(2))
 
INSERT #Test VALUES('6/1/2008', '1')
INSERT #Test VALUES('6/2/2008', '1')
INSERT #Test VALUES('6/2/2008', '1')
INSERT #Test VALUES('6/3/2008', '1')
INSERT #Test VALUES('6/4/2008', '1')
INSERT #Test VALUES('6/6/2008', '1')
INSERT #Test VALUES('6/7/2008', '1')
INSERT #Test VALUES('6/10/2008', '1')
INSERT #Test VALUES('6/10/2008', '1')
INSERT #Test VALUES('6/29/2008', '1')
INSERT #Test VALUES('6/30/2008', '1')
 
INSERT #Test VALUES('7/1/2008', '2')
INSERT #Test VALUES('7/2/2008', '2')
INSERT #Test VALUES('7/3/2008', '2')
INSERT #Test VALUES('7/3/2008', '2')
INSERT #Test VALUES('7/4/2008', '2')
INSERT #Test VALUES('7/6/2008', '2')
INSERT #Test VALUES('7/7/2008', '2')
INSERT #Test VALUES('7/10/2008', '2')
INSERT #Test VALUES('7/10/2008', '2')
INSERT #Test VALUES('7/20/2008', '2')
INSERT #Test VALUES('7/21/2008', '2')
INSERT #Test VALUES('7/29/2008', '2')</pre></div></div>

<p>Here is the desired output</p>
<p>
<pre>CrewID startdate  enddate
------ ---------- ----------
1      2008-06-01 2008-06-04
1      2008-06-06 2008-06-07
1      2008-06-10 2008-06-10
1      2008-06-29 2008-06-30
2      2008-07-01 2008-07-04
2      2008-07-06 2008-07-07
2      2008-07-10 2008-07-10
2      2008-07-20 2008-07-21
2      2008-07-29 2008-07-29</pre>
<p>
As you can see if the cleaning crew cleaned for more than one continuous day then use the min and max dates from the range. If the same day shows up more than once then use it only ones. when a break occurs, start with another day</p>
<p>And here is the solution</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="de1"><pre class="de1">;<span class="kw1">WITH</span> c <span class="kw1">AS</span>
<span class="br0">&#40;</span>
&nbsp; <span class="kw1">SELECT</span> CrewID, SomeDate,
&nbsp; &nbsp; <span class="kw2">DATEADD</span><span class="br0">&#40;</span><span class="kw1">DAY</span>, <span class="sy0">-</span><span class="nu0">1</span><span class="sy0">*</span>DENSE_RANK<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw1">OVER</span> <span class="br0">&#40;</span>PARTITION <span class="kw1">BY</span> CrewID <span class="kw1">ORDER</span> <span class="kw1">BY</span> SomeDate<span class="br0">&#41;</span>,
SomeDate<span class="br0">&#41;</span> <span class="kw1">AS</span> Grouped
&nbsp; <span class="kw1">FROM</span> #Test
<span class="br0">&#41;</span>
<span class="kw1">SELECT</span> CrewID, <span class="kw2">MIN</span><span class="br0">&#40;</span>SomeDate<span class="br0">&#41;</span> <span class="kw1">AS</span> startdate, <span class="kw2">MAX</span><span class="br0">&#40;</span>SomeDate<span class="br0">&#41;</span> <span class="kw1">AS</span> enddate
<span class="kw1">FROM</span> c
<span class="kw1">GROUP</span> <span class="kw1">BY</span> CrewID, Grouped
<span class="kw1">ORDER</span> <span class="kw1">BY</span> CrewID,startdate;</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">;WITH c AS
(
  SELECT CrewID, SomeDate,
    DATEADD(DAY, -1*DENSE_RANK() OVER (PARTITION BY CrewID ORDER BY SomeDate),
SomeDate) AS Grouped
  FROM #Test
)
SELECT CrewID, MIN(SomeDate) AS startdate, MAX(SomeDate) AS enddate
FROM c
GROUP BY CrewID, Grouped
ORDER BY CrewID,startdate;</pre></div></div>

<p>That is all for today, come back tomorrow for some more goodies</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/are-you-ready-for-sql/'>Are you ready for SQL Server 2012 or are you still partying like it is 1999?</a><p>SQL Server 2012 is around the corner, perhaps you are ready to upgrade and perhaps&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-advent-2011-day-11/'>SQL Advent 2011 Day 11: DML statements with the OUTPUT clause</a><p>In my Are you ready for SQL Server 2012 or are you still partying like&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2><img class="bioPic" src="http://www.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d.png" alt="User bio image"/>Denis has been working with SQL Server since version 6.5. Although he worked as an ASP/JSP/ColdFusion developer before the dot com bust, he has been working exclusively as a database developer/architect since 2002. In addition to English, Denis is also fluent in Croatian and Dutch, but he can curse in many other languages and dialects (just ask the SQL optimizer) He lives in Princeton, NJ with his wife and three kids.<br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/denisgobo" title="SQLDenis at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=http://www.facebook.com/denis.gobo" title="SQLDenis at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/in/denisgobo" title="SQLDenis at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://denisgobo.blogspot.com/" title="SQLDenis at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="http://www.flickr.com/photos/denisgobo//" title="SQLDenis at Flickr" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_flickr.png" alt="Flickr" /></a><a href="/index.php/author/SQLDenis/feed/" title="Blog RSS feed for SQLDenis" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 6,521 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/SQLDenis/">Read More Posts by SQLDenis</a>
						</div>
					</div>
					<div>
						<label>Tags:</label> <a href="/index.php/tag/dense_rank/" rel="tag">dense_rank</a>, <a href="/index.php/tag/rank/" rel="tag">rank</a>, <a href="/index.php/tag/ranking/" rel="tag">ranking</a>, <a href="/index.php/tag/row_number/" rel="tag">row_number</a>, <a href="/index.php/tag/sql-server-2005/" rel="tag">sql server 2005</a>, <a href="/index.php/tag/sql-server-2008/" rel="tag">sql server 2008</a>, <a href="/index.php/tag/windowing/" rel="tag">windowing</a> 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&text=RT @LessThanDot Blog - SQL Advent 2011 Day 6: Windowing functions by @denisgobo" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&title=SQL Advent 2011 Day 6: Windowing functions&source=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&title=SQL Advent 2011 Day 6: Windowing functions" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&quote=SQL Advent 2011 Day 6: Windowing functions" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/sql-advent-2011-day-6/&title=SQL Advent 2011 Day 6: Windowing functions" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		3 Comments	</h4>
			<ol class="comments-list">
					<li class="comment even thread-even depth-1" id="comment-4949">
				<div id="div-comment-4949" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/ac454edd2906dad461bee7669174f84a?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/ac454edd2906dad461bee7669174f84a?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Steve</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-advent-2011-day-6/#comment-4949">
			December 6, 2011 at 6:54 am</a>		</div>

		<p>Speaking of 1999 style code, two which really bother me are being used above:</p>
<p>1) Using UNION ALL to insert multiple rows in a single insert statement. It is unintuitive and too much typing. The above could be replaced with the following:<br />
   INSERT INTO #Rankings (Value) VALUES (&#8216;A&#8217;), (&#8216;B&#8217;), (&#8216;C&#8217;), (&#8216;D&#8217;), (&#8216;E&#8217;), (&#8216;F&#8217;);<br />
Luckily the execution plans seem to be identical.</p>
<p>2) Temperary tables. They DO have their uses, but often a table variable will do just as well if not better. This is certainly one of those cases. You could get rid of the existance check. Also, it will free you of needing to drop the table when you&#8217;re all done, something that is missing from this article.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-advent-2011-day-6/?replytocom=4949#respond' onclick='return addComment.moveForm( "div-comment-4949", "4949", "respond", "1418" )' aria-label='Reply to Steve'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-tarwn odd alt thread-odd thread-alt depth-1" id="comment-4950">
				<div id="div-comment-4950" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/67511f6308748c8524ff82fa4ec1eb58?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/67511f6308748c8524ff82fa4ec1eb58?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Eli Weinstock-Herman (tarwn)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-advent-2011-day-6/#comment-4950">
			December 6, 2011 at 7:27 am</a>		</div>

		<p>Steve, while I would agree with the first point (I love the more terse method for defining multiple values), the Table Variable one is far less cut and dry. Temporary tables have a far more consistent track record while Temporary Variables have a number of drawbacks (most notably the way they are handled during plan cost estimation) that, in my mind at least, makes Table Variables more of a second choice to be used when they offer some sort of clear and useful advantage over Temporary Tables. So, in fact, the exact reverse of your statement.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-advent-2011-day-6/?replytocom=4950#respond' onclick='return addComment.moveForm( "div-comment-4950", "4950", "respond", "1418" )' aria-label='Reply to Eli Weinstock-Herman (tarwn)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-SQLDenis bypostauthor even thread-even depth-1" id="comment-4951">
				<div id="div-comment-4951" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/7a49149d4d4b9242348b95a2c561c20d?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">SQLDenis</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/sql-advent-2011-day-6/#comment-4951">
			December 6, 2011 at 7:43 am</a>		</div>

		<p>Steve, the reason I used UNION is because I wanted people to be able to run it on SQL Server 2005</p>
<p>The reason I use temp tables instead of real tables is because someone left me a comment that I should use temp tables so that he didn&#8217;t have to clean up the tables afterwards</p>
<p>I could have used a table variable but then you have to run the piece that creates the table for every piece of code on the page first</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/sql-advent-2011-day-6/?replytocom=4951#respond' onclick='return addComment.moveForm( "div-comment-4951", "4951", "respond", "1418" )' aria-label='Reply to SQLDenis'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/sql-advent-2011-day-6/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1418' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="8df707a948fac1b4a0f97aa554886ec8"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765591"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
