<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Securing your password for SQL Server 2005 and 2008 and more</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Securing your password for SQL Server 2005 and 2008 and more" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Do you know your sa password? Or let me put that a different way and say, does anyone besides you know the sa password? To build on that question, does anyone know the AD SQL Server service account password? Or any service account passwords. How about some of the sql authenticated users you&#8217;ve setup for [&hellip;]" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Securing your password for SQL Server 2005 and 2008 and more Comments Feed" href="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='ReportViewer and the RSPrintClient Control Problems' href='/index.php/datamgmt/datadesign/reportviewer-and-the-rsprintclient-contr/' />
<link rel='next' title='SQL Server Fibonacci Sequence' href='/index.php/datamgmt/dbprogramming/mssqlserver/sql-server-fibonacci-sequence/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/" />
<link rel='shortlink' href='/?p=229' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fsecuring-you-password-for-sql-server-200%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdatadesign%2Fsecuring-you-password-for-sql-server-200%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbprogramming/mssqlserver/sql-server-fibonacci-sequence/" rel="next">SQL Server Fibonacci Sequence</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/datamgmt/datadesign/reportviewer-and-the-rsprintclient-contr/" rel="prev">ReportViewer and the RSPrintClient Control Problems</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/" class="post-title">Securing your password for SQL Server 2005 and 2008 and more</a></h1>
					<div class="post-byline">by <a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)" rel="author">Ted Krueger (onpnt)</a> on December 2, 2008 in category <a href="/index.php/category/datamgmt/datadesign/" rel="category tag">Data Modelling and Design</a> <a href="/index.php/category/datamgmt/dbadmin/mssqlserveradmin/" rel="category tag">Microsoft SQL Server Admin</a>. Article views: 27,052 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&text=RT @LessThanDot Blog - Securing your password for SQL Server 2005 and 2008 and more by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&title=Securing your password for SQL Server 2005 and 2008 and more&source=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&title=Securing your password for SQL Server 2005 and 2008 and more" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&quote=Securing your password for SQL Server 2005 and 2008 and more" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&title=Securing your password for SQL Server 2005 and 2008 and more" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>Do you know your sa password?  Or let me put that a different way and say, does anyone besides you know the sa password?  To build on that question, does anyone know the AD SQL Server service account password? Or any service account passwords.  How about some of the sql authenticated users you&#8217;ve setup for reporting, system integration etc&#8230; ????</p>
<p>If you just said yes and they are in an excel file sitting either in a network drive or on your machine then you should be flipping burgers at McDonalds.  Yes I really do feel that way.  What is the sense of us as systems security and support employees that are entrusted with these key strings that can gain access to just about anything the company has to hold personal.  BOM&#8217;s, Sales, Customers and on.  All of this will mean nothing if you don&#8217;t also secure the passwords to gain access to your instances.</p>
<p>Luckily there is an easy fix to this and although it being not 100% secure (which nothing is) and having one loop hole that I can think of off the top of my head, at least your excel file can&#8217;t be somehow opened by Bob Johnson the weekend hacker you hired last week as a customer service associate to answer hate calls.  Just think how Bob is going to feel about his job after months of listening to people complain about his company.  Yes when the customer calls usually it will be his company at that point to the customer.</p>
<p>Ok back to the easy fix.  SQL Server 2005 and 2008 make it easy to setup certificates and keys allowing you to insert data into a table while encrypting it using SQL Server.  </p>
<p>Ok so you want to see some cool graphs? Click here http://msdn.microsoft.com/en-us/library/ms189586.aspx</p>
<p>Ok pictures aside in order to get yourself in the position to encrypt data you first need a cert.  The certificate will give you the ability to then create a key in order to encrypt the data when inserting into the tables you have.  Encryption can be intimidating which is why I thought of writing this.  I want to write by example and not give you a bunch of techy garbage that will only confuse you.  I think the power of learning is by means of the ability to perform.  So back on track we&#8217;re going to create a simplistic ASP.NET front-end for you to view and add network and SQL Server authenticated passwords using a self-signed certificate and symmetric key.</p>
<p>Let’s do it&#8230;</p>
<p>First let&#8217;s get your database setup.  Notes: encryption is slow.  Don’t forget that!  Also don&#8217;t fall under the belief the master key can encrypt data.  You still need to create a key.</p>
<p>Again I use a DBA database on all instances so you will see that through my blogs.  This code is littered all over the internet.  In fact a friend and probably the best DBA I know has a much better blog on just this @ http://searchsqlserver.techtarget.com/tip/0,289483,sid87_gci1285699,00.html#  I suggest you read it.  Denny goes into far better encryption and algorithm details than I.</p>
<p>Here are the steps in order</p>
<p>1. Create a table to hold your passwords and relevant data</p>
<p>2. Create your certificate to gain access to our key.  Don’t forget to put a description on it so you know what it&#8217;s for or the next poor DBA does.  My example does not use a string password but I highly recommend more complexity to it.  </p>
<p>3. Create you symmetric key passed of your new certificate and we&#8217;ll use the AES_256 algorithm.  (note: windows 2000 and or Xp does not support this.  You’ll have to choose another encryption.  Read here http://msdn.microsoft.com/en-us/library/ms345262.aspx)</p>
<p>4. This is the step that is what you will utilize on insert every time.  Open the key.  </p>
<p>5. Create a variable to hold guid of the key.</p>
<p>6. Using the EncryptByKey function to do the work insert your data</p>
<p>7. You can select on it to see by using the DecryptByKey function and then ALWAYS close your key</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> SSPasswordList <span class="br0">&#40;</span>EncrypPwdPhrase <span class="kw1">VARBINARY</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>,UserN <span class="kw1">Varchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>, SystemN <span class="kw1">Varchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span>, SystemType <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">3</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
Go
<span class="kw1">CREATE</span> CERTIFICATE PasswordCert 
ENCRYPTION <span class="kw1">BY</span> PASSW<span class="sy0">OR</span>D <span class="sy0">=</span> <span class="st0">'mycert.1'</span>
<span class="kw1">WITH</span> SUBJECT <span class="sy0">=</span> <span class="st0">'Password Cert'</span>, 
EXPIRY_DATE <span class="sy0">=</span> <span class="st0">'01/01/2099'</span>;
GO
&nbsp;
<span class="kw1">CREATE</span> SYMMETRIC <span class="kw1">KEY</span> PasswordKey <span class="kw1">WITH</span> ALG<span class="sy0">OR</span>ITHM <span class="sy0">=</span> AES_256
ENCRYPTION <span class="kw1">BY</span> CERTIFICATE PasswordCert;
GO
&nbsp;
<span class="kw1">OPEN</span> SYMMETRIC <span class="kw1">KEY</span> PasswordKey DECRYPTION <span class="kw1">BY</span> CERTIFICATE PasswordCert <span class="kw1">WITH</span> PASSW<span class="sy0">OR</span>D <span class="sy0">=</span><span class="st0">'mycert.1'</span>;
&nbsp;
<span class="kw1">DECLARE</span> @GUID <span class="kw1">UNIQUEIDENTIFIER</span>
&nbsp;
<span class="kw1">SELECT</span> @GUID <span class="sy0">=</span> KEY_GUID <span class="kw1">FROM</span> sys.<span class="me1">symmetric_keys</span> <span class="kw1">WHERE</span> Name <span class="sy0">=</span> <span class="st0">'PasswordKey'</span>
<span class="kw1">INSERT</span> <span class="kw1">INTO</span> SSPasswordList <span class="br0">&#40;</span>EncrypPwdPhrase,UserN,SystemN,SystemType<span class="br0">&#41;</span> <span class="kw1">VALUES</span> <span class="br0">&#40;</span>EncryptByKey<span class="br0">&#40;</span>@Guid, <span class="st0">'123456'</span>, <span class="nu0">1</span><span class="br0">&#41;</span>,<span class="st0">'sa'</span>,<span class="st0">'My instance sa password'</span>,<span class="st0">'SQL'</span><span class="br0">&#41;</span>
&nbsp;
<span class="kw1">SELECT</span> <span class="kw1">CONVERT</span><span class="br0">&#40;</span><span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span>, DecryptByKey<span class="br0">&#40;</span>SSPasswordList.<span class="me1">EncrypPwdPhrase</span>, <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">AS</span> <span class="kw1">Data</span>,<span class="sy0">*</span> <span class="kw1">FROM</span> SSPasswordList
&nbsp;
<span class="kw1">CLOSE</span> SYMMETRIC <span class="kw1">KEY</span> PasswordKey
Go</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE SSPasswordList (EncrypPwdPhrase VARBINARY(255),UserN Varchar(255), SystemN Varchar(255), SystemType varchar(3))
Go
CREATE CERTIFICATE PasswordCert 
ENCRYPTION BY PASSWORD = 'mycert.1'
WITH SUBJECT = 'Password Cert', 
EXPIRY_DATE = '01/01/2099';
GO

CREATE SYMMETRIC KEY PasswordKey WITH ALGORITHM = AES_256
ENCRYPTION BY CERTIFICATE PasswordCert;
GO

OPEN SYMMETRIC KEY PasswordKey DECRYPTION BY CERTIFICATE PasswordCert WITH PASSWORD ='mycert.1';

DECLARE @GUID UNIQUEIDENTIFIER

SELECT @GUID = KEY_GUID FROM sys.symmetric_keys WHERE Name = 'PasswordKey'
INSERT INTO SSPasswordList (EncrypPwdPhrase,UserN,SystemN,SystemType) VALUES (EncryptByKey(@Guid, '123456', 1),'sa','My instance sa password','SQL')

SELECT CONVERT(VARCHAR(20), DecryptByKey(SSPasswordList.EncrypPwdPhrase, 1)) AS Data,* FROM SSPasswordList

CLOSE SYMMETRIC KEY PasswordKey
Go</pre></div></div>

<p>Let&#8217;s make this easy for us to use now.  create these two proc&#8217;s in your DBA database</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="de1"><pre class="de1"><span class="kw1">Create</span> <span class="kw1">Proc</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>GrabPassword<span class="br0">&#93;</span> <span class="br0">&#40;</span>@userN <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">610</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">As</span>
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">ON</span>
<span class="kw1">OPEN</span> SYMMETRIC <span class="kw1">KEY</span> PasswordKey DECRYPTION <span class="kw1">BY</span> CERTIFICATE PasswordCert <span class="kw1">WITH</span> PASSW<span class="sy0">OR</span>D <span class="sy0">=</span><span class="st0">'mycert.1'</span>;
&nbsp;
<span class="kw1">SELECT</span> <span class="kw1">CONVERT</span><span class="br0">&#40;</span><span class="kw1">VARCHAR</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span>, DecryptByKey<span class="br0">&#40;</span>SSPasswordList.<span class="me1">EncrypPwdPhrase</span>, <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">as</span> pwd <span class="kw1">FROM</span> SSPasswordList <span class="kw1">Where</span> <span class="st0">'User: '</span> <span class="sy0">+</span> UserN <span class="sy0">+</span> <span class="st0">' On: '</span> <span class="sy0">+</span> SystemN <span class="sy0">=</span> @userN
&nbsp;
<span class="kw1">CLOSE</span> SYMMETRIC <span class="kw1">KEY</span> PasswordKey
<span class="kw1">SET</span> <span class="kw1">NOCOUNT</span> <span class="kw1">OFF</span>
Go
&nbsp;
&nbsp;
<span class="kw1">Create</span> <span class="kw1">proc</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>GrabNameList<span class="br0">&#93;</span><span class="br0">&#40;</span>@type <span class="kw1">varchar</span><span class="br0">&#40;</span><span class="nu0">255</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="kw1">as</span> 
<span class="kw1">select</span> <span class="st0">'User: '</span> <span class="sy0">+</span> UserN <span class="sy0">+</span> <span class="st0">' On: '</span> <span class="sy0">+</span> SystemN <span class="kw1">from</span> SSPasswordList <span class="kw1">where</span> SystemType <span class="sy0">=</span> @type</pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Create Proc [dbo].[GrabPassword] (@userN varchar(610))
As
SET NOCOUNT ON
OPEN SYMMETRIC KEY PasswordKey DECRYPTION BY CERTIFICATE PasswordCert WITH PASSWORD ='mycert.1';

SELECT CONVERT(VARCHAR(20), DecryptByKey(SSPasswordList.EncrypPwdPhrase, 1)) as pwd FROM SSPasswordList Where 'User: ' + UserN + ' On: ' + SystemN = @userN

CLOSE SYMMETRIC KEY PasswordKey
SET NOCOUNT OFF
Go


Create proc [dbo].[GrabNameList](@type varchar(255))
as 
select 'User: ' + UserN + ' On: ' + SystemN from SSPasswordList where SystemType = @type</pre></div></div>

<p>So how can we use this then.  Let&#8217;s do this.  I&#8217;m not going to talk about how to write ASP.NET or C# or anything on IIS etc&#8230;  There are plenty of other things out there to help you with that.  I&#8217;m just giving you the code so you can try it out.  Create a new web site in VS.NET (I&#8217;m on 2.0 and 2005).  In your Default.aspx replace the code with the below</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="html4strict"><thead><tr><td colspan="2"  class="head">HTML</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
</pre></td><td class="de1"><pre class="de1"><span class="sc2">&lt;%@ Page <span class="kw3">Language</span><span class="sy0">=</span><span class="st0">&quot;C#&quot;</span> AutoEventWireup<span class="sy0">=</span><span class="st0">&quot;true&quot;</span> CodeFile<span class="sy0">=</span><span class="st0">&quot;Default.aspx.cs&quot;</span> Inherits<span class="sy0">=</span><span class="st0">&quot;_Default&quot;</span> %&gt;</span>
<span class="sc2">&lt;% @ Import Namespace<span class="sy0">=</span><span class="st0">&quot;System.Data.SqlClient&quot;</span> %&gt;</span>
<span class="sc2">&lt;% @ Import Namespace<span class="sy0">=</span><span class="st0">&quot;System.Data&quot;</span> %&gt;</span>
<span class="sc0">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
&nbsp;
<span class="sc2">&lt;<span class="kw2">html</span> xmlns<span class="sy0">=</span><span class="st0">&quot;http://www.w3.org/1999/xhtml&quot;</span> &gt;</span>
<span class="sc2">&lt;<span class="kw2">head</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;Head1&quot;</span> runat<span class="sy0">=</span><span class="st0">&quot;server&quot;</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">title</span>&gt;</span>Password Manager<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">title</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">style</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text/css&quot;</span>&gt;</span>
Body {
background-color: #666666;
}
&nbsp;
.button {
&nbsp;background: #CCCCCC;
&nbsp;border: 1px solid #97AAC7;
&nbsp;font-family: Verdana, Helvetica, Sans-Serif;
&nbsp;font-size: 11px;
&nbsp;margin-top: 2px;
&nbsp;width:150px;
}
&nbsp;
table {
&nbsp;background-color: #E4EAF2;
&nbsp;text-align:center;
&nbsp;width:70%;
&nbsp;height:50%;
&nbsp;border: 1px solid #000000;
}
TD {
&nbsp;
}
.wrap {
&nbsp;width:100%;
&nbsp;height:100%;
&nbsp;text-align:center;
&nbsp;margin-top:100px;
}
.mid {
&nbsp;width:90%;
&nbsp;height:400px;
}
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">style</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">script</span> <span class="kw3">language</span><span class="sy0">=</span><span class="st0">&quot;javascript&quot;</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text/javascript&quot;</span>&gt;</span>
&nbsp;
function onSelType()
{
&nbsp;var obj = document.getElementById('types');
&nbsp;if(obj.options[obj.selectedIndex].value &gt; 0)
&nbsp;{
&nbsp; if(window.location.href.indexOf(&quot;?&quot;) == -1)
&nbsp; {
&nbsp; window.location.href=window.location.href + &quot;?types=&quot; + obj.options[obj.selectedIndex].value;
&nbsp; }
&nbsp; else
&nbsp; {
&nbsp; window.location.href=window.location.href.substring(0,window.location.href.indexOf(&quot;?&quot;)) + &quot;?types=&quot; + obj.options[obj.selectedIndex].value; &nbsp; 
&nbsp; }
&nbsp;}
}
function onSelUser()
{
&nbsp;var obj = document.getElementById('accounts');
var objTypes = document.getElementById('types');
if(window.location.href.indexOf(&quot;?&quot;) != -1)
{
window.location.href=window.location.href.substring(0,window.location.href.indexOf(&quot;?&quot;)) + &quot;?userStr=&quot; + obj.options[obj.selectedIndex].value + &quot;<span class="sc1">&amp;types=&quot; + objTypes.options[objTypes.selectedIndex].value;</span> &nbsp; 
}
}
function selList()
{
var sel = <span class="sc2">&lt;%</span>
<span class="sc2">if<span class="br0">&#40;</span>Convert.ToString<span class="br0">&#40;</span>Request.QueryString<span class="br0">&#91;</span><span class="st0">&quot;types&quot;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">==</span> null<span class="br0">&#41;</span></span>
<span class="sc2"><span class="br0">&#123;</span></span>
<span class="sc2">Response.Write<span class="br0">&#40;</span><span class="st0">&quot;0&quot;</span><span class="br0">&#41;</span>;</span>
<span class="sc2"><span class="br0">&#125;</span> else <span class="br0">&#123;</span> </span>
<span class="sc2">Response.Write<span class="br0">&#40;</span>Convert.ToString<span class="br0">&#40;</span>Request.QueryString<span class="br0">&#91;</span><span class="st0">&quot;types&quot;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;</span>
<span class="sc2"><span class="br0">&#125;</span> %&gt;</span>;
&nbsp;
if(sel &gt; 0)
{
var selObj = document.getElementById(&quot;types&quot;);
selObj.options[sel].selected = true;
}
}
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">script</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">head</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">body</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">div</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;wrap&quot;</span>&gt;</span>
<span class="sc2">&lt;<span class="kw2">div</span> <span class="kw3">class</span><span class="sy0">=</span><span class="st0">&quot;mid&quot;</span>&gt;</span>
&nbsp;<span class="sc2">&lt;<span class="kw2">form</span> <span class="kw3">method</span><span class="sy0">=</span><span class="st0">&quot;post&quot;</span> <span class="kw3">action</span><span class="sy0">=</span><span class="st0">&quot;Default.aspx&quot;</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;frm&quot;</span> runat<span class="sy0">=</span><span class="st0">&quot;server&quot;</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">input</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;hidden&quot;</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;status&quot;</span> <span class="sy0">/</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">table</span> <span class="kw3">cellpadding</span><span class="sy0">=</span><span class="st0">&quot;10&quot;</span> <span class="kw3">cellspacing</span><span class="sy0">=</span><span class="st0">&quot;0&quot;</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">td</span> <span class="kw3">colspan</span><span class="sy0">=</span><span class="st0">&quot;2&quot;</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;font-weight:bolder;font-size:xx-large;&quot;</span>&gt;</span>
<span class="sc2">&lt;asp:<span class="kw3">Label</span> <span class="kw3">ID</span><span class="sy0">=</span><span class="st0">&quot;password&quot;</span> runat<span class="sy0">=</span><span class="st0">&quot;server&quot;</span> <span class="kw3">Text</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span>&gt;&lt;<span class="sy0">/</span>asp:Label&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">td</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;text-align:left;&quot;</span>&gt;</span>
&nbsp; Select Account Type:<span class="sc2">&lt;<span class="kw2">br</span> <span class="sy0">/</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">td</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;text-align:left;&quot;</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">select</span> <span class="kw3">id</span><span class="sy0">=</span><span class="st0">&quot;types&quot;</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;types&quot;</span> <span class="kw3">onchange</span><span class="sy0">=</span><span class="st0">&quot;onSelType();&quot;</span>&gt;</span>
&nbsp; &nbsp;<span class="sc2">&lt;<span class="kw2">option</span>&gt;</span>-- select password type --<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
&nbsp; &nbsp;<span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;1&quot;</span>&gt;</span>SQL Server Passwords<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
&nbsp; &nbsp;<span class="sc2">&lt;<span class="kw2">option</span> <span class="kw3">value</span><span class="sy0">=</span><span class="st0">&quot;2&quot;</span>&gt;</span>Network Passwords<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">select</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">tr</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">td</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;text-align:left;&quot;</span>&gt;</span> 
&nbsp; Select Account:<span class="sc2">&lt;<span class="kw2">br</span> <span class="sy0">/</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">td</span> <span class="kw3">style</span><span class="sy0">=</span><span class="st0">&quot;text-align:left;&quot;</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="kw2">select</span> <span class="kw3">name</span><span class="sy0">=</span><span class="st0">&quot;accounts&quot;</span> <span class="kw3">onchange</span><span class="sy0">=</span><span class="st0">&quot;onSelUser();&quot;</span>&gt;</span>
&nbsp; &nbsp;
&nbsp; <span class="sc2">&lt;%</span>
<span class="sc2">SqlConnection conn <span class="sy0">=</span> new SqlConnection<span class="br0">&#40;</span><span class="st0">&quot;Data Source={instance};Initial Catalog=DBA;User Id=userid;Password=userpwd;&quot;</span><span class="br0">&#41;</span>;</span>
<span class="sc2">SqlCommand cmd <span class="sy0">=</span> new SqlCommand<span class="br0">&#40;</span><span class="br0">&#41;</span>;</span>
<span class="sc2">SqlDataAdapter adt <span class="sy0">=</span> new SqlDataAdapter<span class="br0">&#40;</span>cmd<span class="br0">&#41;</span>;</span>
<span class="sc2">DataTable dt <span class="sy0">=</span> new DataTable<span class="br0">&#40;</span><span class="br0">&#41;</span>;</span>
<span class="sc2"> &nbsp;int i <span class="sy0">=</span> <span class="nu0">0</span>;</span>
<span class="sc2"> &nbsp;if<span class="br0">&#40;</span>Convert.ToString<span class="br0">&#40;</span>Request.QueryString<span class="br0">&#91;</span><span class="st0">&quot;userStr&quot;</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="sy0">==</span> null<span class="br0">&#41;</span></span>
<span class="sc2"> &nbsp;<span class="br0">&#123;</span></span>
<span class="sc2"> &nbsp;Response.Write<span class="br0">&#40;</span><span class="st0">&quot;&lt;option&gt;</span></span>-- accounts available --<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>&quot;);
&nbsp; }
&nbsp; else
&nbsp; {
&nbsp; Response.Write(&quot;<span class="sc2">&lt;<span class="kw2">option</span>&gt;</span>&quot; + Convert.ToString(Request.QueryString[&quot;userStr&quot;]) + &quot;<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>&quot;);
&nbsp; }
string types = Convert.ToString(Request.QueryString[&quot;types&quot;]);
string userStr = Convert.ToString(Request.QueryString[&quot;userStr&quot;]);
if (types != null <span class="sc1">&amp;&amp; types != &quot;&quot; &amp;&amp; userStr == null)</span>
<span class="sc1">{</span>
<span class="sc1">if (Convert.ToInt32(types) &gt; 0)</span>
<span class="sc1">{</span>
<span class="sc1">switch (types)</span>
<span class="sc1">{</span>
<span class="sc1">case &quot;0&quot;:</span>
<span class="sc1">break;</span>
case &quot;1&quot;:
if (User.IsInRole(@&quot;ActiveDirectoryDBA Group&quot;))
{
//grab accounts
cmd.Connection = conn;
cmd.CommandText = &quot;Exec GrabNameList 'SQL'&quot;;
adt.Fill(dt);
&nbsp;
while (i <span class="sc2">&lt; dt.<span class="kw3">Rows</span>.Count<span class="br0">&#41;</span></span>
<span class="sc2"><span class="br0">&#123;</span></span>
<span class="sc2">Response.Write<span class="br0">&#40;</span><span class="st0">&quot;&lt;option value='&quot;</span> + dt.<span class="kw3">Rows</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span>.ItemArray<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.ToString<span class="br0">&#40;</span><span class="br0">&#41;</span>.Trim<span class="br0">&#40;</span><span class="br0">&#41;</span>+<span class="st0">&quot;'&gt;</span></span>&quot; + dt.Rows[i].ItemArray[0].ToString().Trim() + &quot;<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>&quot;);
i++;
}
}
break;
case &quot;2&quot;:
if (User.IsInRole(@&quot;ActiveDirectoryDomain Admins Group&quot;))
{
//grab accounts
cmd.Connection = conn;
cmd.CommandText = &quot;Exec GrabNameList 'ADM'&quot;;
adt.Fill(dt);
&nbsp;
while (i <span class="sc2">&lt; dt.<span class="kw3">Rows</span>.Count<span class="br0">&#41;</span></span>
<span class="sc2"><span class="br0">&#123;</span></span>
<span class="sc2">Response.Write<span class="br0">&#40;</span><span class="st0">&quot;&lt;option value='&quot;</span>+ dt.<span class="kw3">Rows</span><span class="br0">&#91;</span>i<span class="br0">&#93;</span>.ItemArray<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.ToString<span class="br0">&#40;</span><span class="br0">&#41;</span>.Trim<span class="br0">&#40;</span><span class="br0">&#41;</span>+<span class="st0">&quot;'&gt;</span></span>&quot; + dt.Rows[i].ItemArray[0].ToString().Trim() + &quot;<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">option</span>&gt;</span>&quot;);
i++;
}
}
break;
}
}
} 
&nbsp; %&gt;
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">select</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">td</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">tr</span>&gt;</span>
&nbsp; <span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">table</span>&gt;</span>
<span class="sc2">&lt;asp:HiddenField <span class="kw3">ID</span><span class="sy0">=</span><span class="st0">&quot;loader&quot;</span> runat<span class="sy0">=</span><span class="st0">&quot;server&quot;</span> <span class="sy0">/</span>&gt;</span>
&nbsp;<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">form</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">div</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">div</span>&gt;</span>
<span class="sc2">&lt;%</span>
<span class="sc2"><span class="sy0">//</span>Response.Write<span class="br0">&#40;</span>loader.<span class="kw3">Value</span><span class="br0">&#41;</span>; </span>
<span class="sc2">%&gt;</span>
<span class="sc2">&lt;<span class="kw2">script</span> <span class="kw3">type</span><span class="sy0">=</span><span class="st0">&quot;text/javascript&quot;</span>&gt;</span>selList();<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">script</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">body</span>&gt;</span>
<span class="sc2">&lt;<span class="sy0">/</span><span class="kw2">html</span>&gt;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">&lt;%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %&gt;
&lt;% @ Import Namespace="System.Data.SqlClient" %&gt;
&lt;% @ Import Namespace="System.Data" %&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;

&lt;html xmlns="http://www.w3.org/1999/xhtml" &gt;
&lt;head id="Head1" runat="server"&gt;
&lt;title&gt;Password Manager&lt;/title&gt;
&lt;style type="text/css"&gt;
Body {
background-color: #666666;
}

.button {
 background: #CCCCCC;
 border: 1px solid #97AAC7;
 font-family: Verdana, Helvetica, Sans-Serif;
 font-size: 11px;
 margin-top: 2px;
 width:150px;
}

table {
 background-color: #E4EAF2;
 text-align:center;
 width:70%;
 height:50%;
 border: 1px solid #000000;
}
TD {

}
.wrap {
 width:100%;
 height:100%;
 text-align:center;
 margin-top:100px;
}
.mid {
 width:90%;
 height:400px;
}
&lt;/style&gt;
&lt;script language="javascript" type="text/javascript"&gt;

function onSelType()
{
 var obj = document.getElementById('types');
 if(obj.options[obj.selectedIndex].value &gt; 0)
 {
  if(window.location.href.indexOf("?") == -1)
  {
  window.location.href=window.location.href + "?types=" + obj.options[obj.selectedIndex].value;
  }
  else
  {
  window.location.href=window.location.href.substring(0,window.location.href.indexOf("?")) + "?types=" + obj.options[obj.selectedIndex].value;   
  }
 }
}
function onSelUser()
{
 var obj = document.getElementById('accounts');
var objTypes = document.getElementById('types');
if(window.location.href.indexOf("?") != -1)
{
window.location.href=window.location.href.substring(0,window.location.href.indexOf("?")) + "?userStr=" + obj.options[obj.selectedIndex].value + "&amp;types=" + objTypes.options[objTypes.selectedIndex].value;   
}
}
function selList()
{
var sel = &lt;%
if(Convert.ToString(Request.QueryString["types"]) == null)
{
Response.Write("0");
} else { 
Response.Write(Convert.ToString(Request.QueryString["types"]));
} %&gt;;

if(sel &gt; 0)
{
var selObj = document.getElementById("types");
selObj.options[sel].selected = true;
}
}
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class="wrap"&gt;
&lt;div class="mid"&gt;
 &lt;form method="post" action="Default.aspx" id="frm" runat="server"&gt;
  &lt;input type="hidden" value="" name="status" /&gt;
  &lt;table cellpadding="10" cellspacing="0"&gt;
  &lt;tr&gt;
  &lt;td colspan="2" style="font-weight:bolder;font-size:xx-large;"&gt;
&lt;asp:Label ID="password" runat="server" Text=""&gt;&lt;/asp:Label&gt;
&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
  &lt;td style="text-align:left;"&gt;
  Select Account Type:&lt;br /&gt;
  &lt;/td&gt;
  &lt;td style="text-align:left;"&gt;
  &lt;select id="types" name="types" onchange="onSelType();"&gt;
   &lt;option&gt;-- select password type --&lt;/option&gt;
   &lt;option value="1"&gt;SQL Server Passwords&lt;/option&gt;
   &lt;option value="2"&gt;Network Passwords&lt;/option&gt;
  &lt;/select&gt;
  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
  &lt;td style="text-align:left;"&gt; 
  Select Account:&lt;br /&gt;
  &lt;/td&gt;
  &lt;td style="text-align:left;"&gt;
  &lt;select name="accounts" onchange="onSelUser();"&gt;
   
  &lt;%
SqlConnection conn = new SqlConnection("Data Source={instance};Initial Catalog=DBA;User Id=userid;Password=userpwd;");
SqlCommand cmd = new SqlCommand();
SqlDataAdapter adt = new SqlDataAdapter(cmd);
DataTable dt = new DataTable();
  int i = 0;
  if(Convert.ToString(Request.QueryString["userStr"]) == null)
  {
  Response.Write("&lt;option&gt;-- accounts available --&lt;/option&gt;");
  }
  else
  {
  Response.Write("&lt;option&gt;" + Convert.ToString(Request.QueryString["userStr"]) + "&lt;/option&gt;");
  }
string types = Convert.ToString(Request.QueryString["types"]);
string userStr = Convert.ToString(Request.QueryString["userStr"]);
if (types != null &amp;&amp; types != "" &amp;&amp; userStr == null)
{
if (Convert.ToInt32(types) &gt; 0)
{
switch (types)
{
case "0":
break;
case "1":
if (User.IsInRole(@"ActiveDirectoryDBA Group"))
{
//grab accounts
cmd.Connection = conn;
cmd.CommandText = "Exec GrabNameList 'SQL'";
adt.Fill(dt);

while (i &lt; dt.Rows.Count)
{
Response.Write("&lt;option value='" + dt.Rows[i].ItemArray[0].ToString().Trim()+"'&gt;" + dt.Rows[i].ItemArray[0].ToString().Trim() + "&lt;/option&gt;");
i++;
}
}
break;
case "2":
if (User.IsInRole(@"ActiveDirectoryDomain Admins Group"))
{
//grab accounts
cmd.Connection = conn;
cmd.CommandText = "Exec GrabNameList 'ADM'";
adt.Fill(dt);

while (i &lt; dt.Rows.Count)
{
Response.Write("&lt;option value='"+ dt.Rows[i].ItemArray[0].ToString().Trim()+"'&gt;" + dt.Rows[i].ItemArray[0].ToString().Trim() + "&lt;/option&gt;");
i++;
}
}
break;
}
}
} 
  %&gt;
  &lt;/select&gt;
  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;/table&gt;
&lt;asp:HiddenField ID="loader" runat="server" /&gt;
 &lt;/form&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;%
//Response.Write(loader.Value); 
%&gt;
&lt;script type="text/javascript"&gt;selList();&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div></div>

<p>Code behind</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="csharp"><thead><tr><td colspan="2"  class="head">C#</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre></td><td class="de1"><pre class="de1"><span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Data</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Configuration</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Web</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Web.Security</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Web.UI</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Web.UI.WebControls</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Web.UI.WebControls.WebParts</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Web.UI.HtmlControls</span><span class="sy0">;</span>
<span class="kw1">using</span> <span class="co3">System.Data.SqlClient</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">public</span> <span class="kw1">partial</span> <span class="kw4">class</span> _Default <span class="sy0">:</span> <span class="kw5">System.<span class="me1">Web</span><span class="sy0">.</span><span class="me1">UI</span></span><span class="sy0">.</span><span class="me1">Page</span>
<span class="br0">&#123;</span>
<span class="kw1">protected</span> <span class="kw4">void</span> Page_Load<span class="br0">&#40;</span><span class="kw4">object</span> sender, EventArgs e<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
Label password <span class="sy0">=</span> <span class="br0">&#40;</span>Label<span class="br0">&#41;</span><span class="br0">&#40;</span>frm<span class="sy0">.</span><span class="me1">FindControl</span><span class="br0">&#40;</span><span class="st0">&quot;password&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
SqlConnection conn <span class="sy0">=</span> <span class="kw3">new</span> SqlConnection<span class="br0">&#40;</span><span class="st0">&quot;Data Source={instance};Initial Catalog=DBA;User Id=userid;Password=userpwd;&quot;</span><span class="br0">&#41;</span><span class="sy0">;</span>
SqlCommand cmd <span class="sy0">=</span> <span class="kw3">new</span> SqlCommand<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
SqlDataAdapter adt <span class="sy0">=</span> <span class="kw3">new</span> SqlDataAdapter<span class="br0">&#40;</span>cmd<span class="br0">&#41;</span><span class="sy0">;</span>
DataTable dt <span class="sy0">=</span> <span class="kw3">new</span> DataTable<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="kw4">string</span> loader <span class="sy0">=</span> Convert<span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span>Request<span class="sy0">.</span><span class="me1">QueryString</span><span class="br0">&#91;</span><span class="st0">&quot;userStr&quot;</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">if</span> <span class="br0">&#40;</span>loader <span class="sy0">!=</span> <span class="kw1">null</span> <span class="sy0">&amp;&amp;</span> loader <span class="sy0">!=</span> <span class="st0">&quot;&quot;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
cmd<span class="sy0">.</span><span class="me1">Connection</span> <span class="sy0">=</span> conn<span class="sy0">;</span>
cmd<span class="sy0">.</span><span class="me1">CommandText</span> <span class="sy0">=</span> <span class="st0">&quot;Exec GrabPassword '&quot;</span> <span class="sy0">+</span> loader<span class="sy0">.</span><span class="me1">Replace</span><span class="br0">&#40;</span><span class="st0">&quot;'&quot;</span>, <span class="st0">&quot;''&quot;</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot;'&quot;</span><span class="sy0">;</span>
adt<span class="sy0">.</span><span class="me1">Fill</span><span class="br0">&#40;</span>dt<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
<span class="kw1">if</span> <span class="br0">&#40;</span>dt<span class="sy0">.</span><span class="me1">Rows</span><span class="sy0">.</span><span class="me1">Count</span> <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
password<span class="sy0">.</span><span class="me1">Text</span> <span class="sy0">=</span> <span class="st0">&quot;Password: &quot;</span> <span class="sy0">+</span> dt<span class="sy0">.</span><span class="me1">Rows</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">ItemArray</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">.</span><span class="me1">ToString</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
conn<span class="sy0">.</span><span class="me1">Dispose</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
cmd<span class="sy0">.</span><span class="me1">Dispose</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
adt<span class="sy0">.</span><span class="me1">Dispose</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">using System;
using System.Data;
using System.Configuration;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;
using System.Data.SqlClient;

public partial class _Default : System.Web.UI.Page
{
protected void Page_Load(object sender, EventArgs e)
{
Label password = (Label)(frm.FindControl("password"));

SqlConnection conn = new SqlConnection("Data Source={instance};Initial Catalog=DBA;User Id=userid;Password=userpwd;");
SqlCommand cmd = new SqlCommand();
SqlDataAdapter adt = new SqlDataAdapter(cmd);
DataTable dt = new DataTable();
string loader = Convert.ToString(Request.QueryString["userStr"]);

if (loader != null &amp;&amp; loader != "")
{
cmd.Connection = conn;
cmd.CommandText = "Exec GrabPassword '" + loader.Replace("'", "''") + "'";
adt.Fill(dt);

if (dt.Rows.Count == 1)
{
password.Text = "Password: " + dt.Rows[0].ItemArray[0].ToString();
}
}
conn.Dispose();
cmd.Dispose();
adt.Dispose();
}
}</pre></div></div>

<p>OK explanations.  First I control mostly everything by means of active directory.  You probably should as well.  This code above will utilize two groups, your typical domain admins group and then a DBA group.  All my DBA&#8217;s are in this group (me 😉 right now).  If the person executing this is not in the DBA group then they cannot see SQL Server authenticated passwords (type SQL).  If they are not in the domain admin group then they can&#8217;t see domain accounts (type ADM).  In order to get this code to work you will need to either comment those out or create the groups.  I would create the groups and use this correctly as it will be more secure that way to normal users finding the site and checking the passwords out.</p>
<p>Now go delete that excel file and secure your passwords!!!</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/sql-server-2008-logo/'>SQL Server 2008 Logo</a><p>Here is the new logo for SQL Server 2008. Looks pretty clean, what do you&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/how-to-change-the-sa/'>How to change the SA password in SQL Server</a><p>There was a question today How to change my local sql server sa password? i&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Ted Krueger is a SQL Server MVP and Author that has been working in development and database administration and the owner of a successful consulting business, DataMetrics Consulting.  Specialties range from High Availability and Disaster / Recovery setup and testing methods down to custom assembly development for SQL Server Reporting Services.  Ted blogs and is also one of the founders of LessThanDot.com technology community.  Some of the articles focused on are Backup / Recovery, Security, SSIS and working on SQL Server and using all of the SQL Server features available to create stable and scalable database services.  <br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/onpnt" title="onpnt at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=https://www.facebook.com/onpntfirearms" title="onpnt at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/pub/ted-krueger/2/183/b66" title="onpnt at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://www.datametricsconsulting.com/" title="onpnt at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="/index.php/author/onpnt/feed/" title="Blog RSS feed for onpnt" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 27,052 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/onpnt/">Read More Posts by Ted Krueger (onpnt)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&text=RT @LessThanDot Blog - Securing your password for SQL Server 2005 and 2008 and more by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&title=Securing your password for SQL Server 2005 and 2008 and more&source=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&title=Securing your password for SQL Server 2005 and 2008 and more" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&quote=Securing your password for SQL Server 2005 and 2008 and more" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/&title=Securing your password for SQL Server 2005 and 2008 and more" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		4 Comments	</h4>
			<ol class="comments-list">
					<li class="comment even thread-even depth-1" id="comment-447">
				<div id="div-comment-447" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2b340063d58054f130a1d4ff3aa5826e?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2b340063d58054f130a1d4ff3aa5826e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Vahid</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/#comment-447">
			December 4, 2008 at 12:00 am</a>		</div>

		<p>your code has some problems<br />
1- is it guarantied that conn.Dispose will be executed each time? use &#8220;try/finally&#8221; or use &#8220;using&#8221;<br />
2- your code is ready for sql injection! try ado.net parameters instead of that string concatenation</p>
<p>have fun</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/?replytocom=447#respond' onclick='return addComment.moveForm( "div-comment-447", "447", "respond", "229" )' aria-label='Reply to Vahid'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-448">
				<div id="div-comment-448" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/#comment-448">
			December 4, 2008 at 4:01 am</a>		</div>

		<p>Thanks Vahid.  My code has more problems then that but it was an example I wrote very quickly for this posting.  Those things are up to you IMO once I hope you get the basics of encryption on SQL Server from what I wrote.  This wasn&#8217;t really a C# post but you&#8217;re correct and I should have posted better written code for that portion.<br />
sql injection?  here? loader.Replace(&#8220;’&#8221;, &#8220;&#8216;’&#8221;).  </p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/?replytocom=448#respond' onclick='return addComment.moveForm( "div-comment-448", "448", "respond", "229" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-449">
				<div id="div-comment-449" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/ba78b90dc3b81faed1b9ae6220cc494f?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/ba78b90dc3b81faed1b9ae6220cc494f?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Dedicated Server Hosting</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/#comment-449">
			December 8, 2008 at 5:13 am</a>		</div>

		<p>Thanks for this informative article.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/?replytocom=449#respond' onclick='return addComment.moveForm( "div-comment-449", "449", "respond", "229" )' aria-label='Reply to Dedicated Server Hosting'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-446">
				<div id="div-comment-446" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/46daea8ca6405a47fc9b225c1cac429e?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/46daea8ca6405a47fc9b225c1cac429e?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Mottehosting</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/#comment-446">
			May 15, 2010 at 6:47 pm</a>		</div>

		<p>Thanks for this info, but Don’t forget that! Also don&#8217;t fall under the belief the master key can encrypt data. You still need to create a key.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/?replytocom=446#respond' onclick='return addComment.moveForm( "div-comment-446", "446", "respond", "229" )' aria-label='Reply to Mottehosting'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/datadesign/securing-you-password-for-sql-server-200/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='229' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="e00da03b685a0dd18fb6a08af0923de0"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765826"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
