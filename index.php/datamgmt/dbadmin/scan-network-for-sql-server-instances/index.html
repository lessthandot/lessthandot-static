<!DOCTYPE html>
<html lang="en-US">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
		<link rel="shortcut icon" href="http://lessthandot.com/favicon.ico" type="image/vnd.microsoft.icon" />
	<title>Less Than Dot - Blog -   Scan network for SQL Server instances</title>
	<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Less Than Dot - Blog -   Scan network for SQL Server instances" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:url" content="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/" />
		<meta prefix="og: http://ogp.me/ns#" property="og:image" content="http://lessthandot.com/images/logo_prod.png" />
	<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article" />
	<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="LessThanDot" />
	<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Securing data services is part of a DBA's critical tasks that should be performed.  This goes beyond users, roles and schemas though.  A DBA must take into account the concept of software installations in a growing and dynamic environment that often pos&hellip;" />
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="/index.php/feed/" />
	<link rel="alternate" type="application/atom+xml" title="Atom" href="/index.php/feed/atom/" />

	<!-- this page is the canonical URL -->	
	<link rel="stylesheet" href="/wp-content/themes/lessthandot2009/style.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsite.css" type="text/css" />
	<link rel="stylesheet" href="http://lessthandot.com/includes/allsiteprint.css" media="print" type="text/css" />

	<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LessthanDot &raquo; Scan network for SQL Server instances Comments Feed" href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bwp-syntax-css'  href='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/css/bwp-syntax-global.css?ver=4.6.1' type='text/css' media='all' />
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js?ver=1.12.4'></script>
<script type='text/javascript' src='/wp-content/plugins/better-wordpress-syntax-based-on-geshi/js/bwp-syntax.js?ver=4.6.1'></script>
<link rel='https://api.w.org/' href='/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='What To Do When Your Identity Column Maxes Out' href='/index.php/datamgmt/dbadmin/mssqlserveradmin/what-to-do-when-your-identity-column-max/' />
<link rel='next' title='Backups are for sissies!!!' href='/index.php/datamgmt/dbadmin/mssqlserveradmin/backups-are-for-sissies/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel="canonical" href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/" />
<link rel='shortlink' href='/?p=344' />
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbadmin%2Fscan-network-for-sql-server-instances%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=http%3A%2F%2F%2Findex.php%2Fdatamgmt%2Fdbadmin%2Fscan-network-for-sql-server-instances%2F&#038;format=xml" />
<style type='text/css'>.rp4wp-related-posts ul{width:100%;padding:0;margin:0;float:left;}
.rp4wp-related-posts ul>li{list-style:none;padding:0;margin:0;padding-bottom:20px;clear:both;}
.rp4wp-related-posts ul>li>p{margin:0;padding:0;}
.rp4wp-related-post-image{width:35%;padding-right:25px;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;float:left;}</style>
	<script src="http://lessthandot.com/includes/allsite.js" type="text/javascript" ></script>
</head>
<body>
<div id="contain"><div id="subcontain"><div id="ttl"><div id="hdr"><div id="snav"><a href="http://lessthandot.com/login.php?backtrack=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?">Member Login</a>
</div><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="logoc"><img src="http://lessthandot.com/images/logo_prod.png" alt="LessThanDot Site Logo" border="0" /></a><h1>LessThanDot</h1><div class="pgsttl">A decade of helpful technical content</div></div><div id="nav">
<ul>
<li><a href="http://lessthandot.com/" title="LessThanDot Launchpad" id="h" ><span>Launchpad</span></a></li>
<li class="cur"><a href="/" title="LessThanDot Blogs" id="b" ><span>Blogs</span></a></li>
<li><a href="http://forum.lessthandot.com/" title="LessThanDot Community Forums" id="f" ><span>Forum</span></a></li>
<li><a href="http://wiki.lessthandot.com/" title="LessThanDot Wiki Articles" id="w" ><span>Wiki</span></a></li>
<li><a href="http://sqlcop.lessthandot.com/" title="LessThanDot SQLCop" id="a" ><span>SQLCop</span></a></li>
<li><a href="http://lessthandot.com/account.php" title="Your Account Settings" id="r"  class="l_ie"><span>My Account</span></a></li></ul></div>
</div><div id="content">
<div id="fac"><div id="fa">
		<p>Less Than Dot is a community of passionate IT professionals and enthusiasts dedicated to sharing technical knowledge, experience, and assistance. Inside you will find reference materials, interesting technical discussions, and expert tips and commentary.</p></div></div><div class="content-sidebar">
	<div id="social" class="sdsec">
		<h2>LTD Social Sitings</h2>
		<div>
		<a id="social_twitter" href="http://twitter.com/LessThanDot/" title="Follow us on Twitter" ><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Lessthandot twitter"/></a> 
		<a href="http://www.linkedin.com/groups?home=&amp;gid=113440" title="Join us on LinkedIn" ><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="Lessthandot Linkedin" /></a> 
		<a href="http://www.facebook.com/group.php?gid=19330511063" title="Join us on Facebook" ><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Lessthandot facebook"/></a> 
		<a href="http://lessthandot.com/rss.php" title="LessThanDot News Feed" ><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="Lessthandot rss"/></a> 
		</div>
		<p><em>Note: Watch for social icons on posts by your favorite authors to follow their postings on these and other social sites.</em></p>
	</div><div class="content-sidebar-section">
<h2>Tag cloud</h2>
	<p class="tag-cloud">
		<a href='/index.php/tag/net/' class='tag-link-245 tag-link-position-1' title='21 topics' style='font-size: 8.9565217391304pt;'>.net</a> <a href='/index.php/tag/asp-net/' class='tag-link-168 tag-link-position-2' title='21 topics' style='font-size: 8.9565217391304pt;'>asp.net</a> <a href='/index.php/tag/azure-2/' class='tag-link-321 tag-link-position-3' title='29 topics' style='font-size: 10.173913043478pt;'>azure</a> <a href='/index.php/tag/book/' class='tag-link-130 tag-link-position-4' title='26 topics' style='font-size: 9.7391304347826pt;'>book</a> <a href='/index.php/tag/business-intelligence-2/' class='tag-link-256 tag-link-position-5' title='30 topics' style='font-size: 10.260869565217pt;'>business intelligence</a> <a href='/index.php/tag/c/' class='tag-link-138 tag-link-position-6' title='40 topics' style='font-size: 11.304347826087pt;'>c#</a> <a href='/index.php/tag/database/' class='tag-link-134 tag-link-position-7' title='31 topics' style='font-size: 10.434782608696pt;'>database</a> <a href='/index.php/tag/excel/' class='tag-link-155 tag-link-position-8' title='16 topics' style='font-size: 8pt;'>excel</a> <a href='/index.php/tag/gotcha/' class='tag-link-240 tag-link-position-9' title='19 topics' style='font-size: 8.6086956521739pt;'>gotcha</a> <a href='/index.php/tag/how-to/' class='tag-link-272 tag-link-position-10' title='44 topics' style='font-size: 11.652173913043pt;'>how to</a> <a href='/index.php/tag/mongodb/' class='tag-link-765 tag-link-position-11' title='17 topics' style='font-size: 8.2608695652174pt;'>mongodb</a> <a href='/index.php/tag/nosql/' class='tag-link-775 tag-link-position-12' title='18 topics' style='font-size: 8.4347826086957pt;'>nosql</a> <a href='/index.php/tag/performance/' class='tag-link-179 tag-link-position-13' title='26 topics' style='font-size: 9.7391304347826pt;'>performance</a> <a href='/index.php/tag/security-2/' class='tag-link-398 tag-link-position-14' title='25 topics' style='font-size: 9.5652173913043pt;'>security</a> <a href='/index.php/tag/sql/' class='tag-link-132 tag-link-position-15' title='42 topics' style='font-size: 11.478260869565pt;'>sql</a> <a href='/index.php/tag/sql-advent-2012/' class='tag-link-1416 tag-link-position-16' title='18 topics' style='font-size: 8.4347826086957pt;'>sql advent 2012</a> <a href='/index.php/tag/sql-friday/' class='tag-link-377 tag-link-position-17' title='18 topics' style='font-size: 8.4347826086957pt;'>sql friday</a> <a href='/index.php/tag/sql-server/' class='tag-link-154 tag-link-position-18' title='145 topics' style='font-size: 16.086956521739pt;'>sql server</a> <a href='/index.php/tag/sql-server-2000/' class='tag-link-366 tag-link-position-19' title='45 topics' style='font-size: 11.739130434783pt;'>sql server 2000</a> <a href='/index.php/tag/sql-server-2005/' class='tag-link-327 tag-link-position-20' title='118 topics' style='font-size: 15.391304347826pt;'>sql server 2005</a> <a href='/index.php/tag/sql-server-2008/' class='tag-link-152 tag-link-position-21' title='237 topics' style='font-size: 18pt;'>sql server 2008</a> <a href='/index.php/tag/sql-server-2008-r2/' class='tag-link-548 tag-link-position-22' title='38 topics' style='font-size: 11.130434782609pt;'>sql server 2008 r2</a> <a href='/index.php/tag/sql-server-2012/' class='tag-link-1161 tag-link-position-23' title='76 topics' style='font-size: 13.739130434783pt;'>sql server 2012</a> <a href='/index.php/tag/ssis-2/' class='tag-link-501 tag-link-position-24' title='52 topics' style='font-size: 12.260869565217pt;'>ssis</a> <a href='/index.php/tag/ssms/' class='tag-link-640 tag-link-position-25' title='18 topics' style='font-size: 8.4347826086957pt;'>ssms</a> <a href='/index.php/tag/ssrs-2/' class='tag-link-557 tag-link-position-26' title='27 topics' style='font-size: 9.9130434782609pt;'>ssrs</a> <a href='/index.php/tag/syndicated/' class='tag-link-1407 tag-link-position-27' title='67 topics' style='font-size: 13.217391304348pt;'>syndicated</a> <a href='/index.php/tag/t-sql/' class='tag-link-185 tag-link-position-28' title='26 topics' style='font-size: 9.7391304347826pt;'>t-sql</a> <a href='/index.php/tag/tip/' class='tag-link-194 tag-link-position-29' title='46 topics' style='font-size: 11.826086956522pt;'>tip</a> <a href='/index.php/tag/unit-testing/' class='tag-link-162 tag-link-position-30' title='17 topics' style='font-size: 8.2608695652174pt;'>unit testing</a>	</p>
</div>		<div class="content-sidebar-section">
		<h2>Authors</h2>
			<ul class="author-list dimmed">
				<li><a href="/index.php/author/SQLDenis/" title="Posts by SQLDenis">SQLDenis</a> <a href="/index.php/author/SQLDenis/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (597)</li><li><a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)">Ted Krueger (onpnt)</a> <a href="/index.php/author/onpnt/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (355)</li><li><a href="/index.php/author/grrlgeek/" title="Posts by Jes Borland">Jes Borland</a> <a href="/index.php/author/grrlgeek/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (202)</li><li><a href="/index.php/author/tarwn/" title="Posts by Eli Weinstock-Herman (tarwn)">Eli Weinstock-Herman (tarwn)</a> <a href="/index.php/author/tarwn/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (190)</li><li><a href="/index.php/author/koenverbeeck/" title="Posts by Koen Verbeeck">Koen Verbeeck</a> <a href="/index.php/author/koenverbeeck/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (100)</li><li><a href="/index.php/author/alexcuse/" title="Posts by Alex Ullrich">Alex Ullrich</a> <a href="/index.php/author/alexcuse/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (55)</li><li><a href="/index.php/author/gmmastros/" title="Posts by George Mastros (gmmastros)">George Mastros (gmmastros)</a> <a href="/index.php/author/gmmastros/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (45)</li><li><a href="/index.php/author/axel8s/" title="Posts by Axel Achten (axel8s)">Axel Achten (axel8s)</a> <a href="/index.php/author/axel8s/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (28)</li><li><a href="/index.php/author/naomi/" title="Posts by Naomi Nosonovsky">Naomi Nosonovsky</a> <a href="/index.php/author/naomi/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (27)</li><li><a href="/index.php/author/thirster42/" title="Posts by David Forck (thirster42)">David Forck (thirster42)</a> <a href="/index.php/author/thirster42/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (24)</li><li><a href="/index.php/author/chopstik/" title="Posts by chopstik">chopstik</a> <a href="/index.php/author/chopstik/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (20)</li><li><a href="/index.php/author/kconan/" title="Posts by Kevin Conan">Kevin Conan</a> <a href="/index.php/author/kconan/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (18)</li><li><a href="/index.php/author/robearl/" title="Posts by Rob Earl">Rob Earl</a> <a href="/index.php/author/robearl/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (14)</li><li><a href="/index.php/author/thatrickguy/" title="Posts by ThatRickGuy">ThatRickGuy</a> <a href="/index.php/author/thatrickguy/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (12)</li><li><a href="/index.php/author/sqlarcher/" title="Posts by SQLArcher">SQLArcher</a> <a href="/index.php/author/sqlarcher/feed/"><img src="http://lessthandot.com/images/bdg_rss_icon_sm.png" style="border: none;" /></a> (11)</li>                <li><a href="http://lessthandot.com/Stats/BlogAuthors.php">More...</a></li>
			</ul>
		</div>
				<div class="content-sidebar-section">
		<h2>Categories</h2>
			<ul class="categories-list">
					<li class="cat-item cat-item-10"><a href="/index.php/category/all/" >All Blogs</a>
</li>
	<li class="cat-item cat-item-5"><a href="/index.php/category/architect/" >Architecture, Design and Strategy</a>
</li>
	<li class="cat-item cat-item-1759"><a href="/index.php/category/artificial-intelligence/" >Artificial Intelligence</a>
</li>
	<li class="cat-item cat-item-6"><a href="/index.php/category/datamgmt/" >Data Management</a>
</li>
	<li class="cat-item cat-item-7"><a href="/index.php/category/desktopdev/" >Desktop Developer</a>
</li>
	<li class="cat-item cat-item-8"><a href="/index.php/category/enterprisedev/" >Enterprise Developer</a>
</li>
	<li class="cat-item cat-item-11"><a href="/index.php/category/itprofessionals/" >IT Professionals</a>
</li>
	<li class="cat-item cat-item-12"><a href="/index.php/category/itstudents/" >IT Students and Researchers</a>
</li>
	<li class="cat-item cat-item-1743"><a href="/index.php/category/management/" >Management</a>
</li>
	<li class="cat-item cat-item-9"><a href="/index.php/category/sysadmins/" >System Admins</a>
</li>
	<li class="cat-item cat-item-1"><a href="/index.php/category/uncategorized/" >Uncategorized</a>
</li>
	<li class="cat-item cat-item-4"><a href="/index.php/category/webdev/" >Web Developer</a>
</li>
			</ul>
		</div>
		</div><div class="content-main">
				<div class="post-navigation">
				<div class="post-navigation-forward"><a href="/index.php/datamgmt/dbadmin/mssqlserveradmin/backups-are-for-sissies/" rel="next">Backups are for sissies!!!</a> &raquo; </div>
				<div class="post-navigation-back">&laquo; <a href="/index.php/datamgmt/dbadmin/mssqlserveradmin/what-to-do-when-your-identity-column-max/" rel="prev">What To Do When Your Identity Column Maxes Out</a></div>
			</div>
			<div class="post-area instapaper_body">
				<div class="post-title-line">
										<h1 class="instapaper_ignore"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/" class="post-title">Scan network for SQL Server instances</a></h1>
					<div class="post-byline">by <a href="/index.php/author/onpnt/" title="Posts by Ted Krueger (onpnt)" rel="author">Ted Krueger (onpnt)</a> on March 9, 2009 in category <a href="/index.php/category/datamgmt/dbadmin/" rel="category tag">Database Administration</a> <a href="/index.php/category/datamgmt/dbadmin/mssqlserveradmin/" rel="category tag">Microsoft SQL Server Admin</a>. Article views: 50,092 </div>
				</div>
				<div class="post-tagline"><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&text=RT @LessThanDot Blog - Scan network for SQL Server instances by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&title=Scan network for SQL Server instances&source=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&title=Scan network for SQL Server instances" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&quote=Scan network for SQL Server instances" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&title=Scan network for SQL Server instances" class="instapaper_button">Instapaper</a></div>

				<div class="post-content"><p>Securing data services is part of a DBA&#8217;s critical tasks that should be performed.  This goes beyond users, roles and schemas though.  A DBA must take into account the concept of software installations in a growing and dynamic environment that often pose serious security threats.  It&#8217;s very common for software to ship with the desktop version of SQL Server (MSDE2000 or SQL Express).  This can be prepackaged and installed, configured and user created on the fly during installation.  Most of us with developer experience know exactly how to do this and how easy it has made our jobs as developers at times.  You can package up your very own free database server with your application and with a simple command and a small script, configure and have it rolling in no time.  </p>
<p>Given my change in careers and moving to the DBA side of things I quickly started realizing how bad this can be for the environment all together and honestly how bad some of the developers of these prepackaged solutions can really get.  The age old example is the sa account usage and weak passwords.  Today I did my monthly audit of the instances on my network and not all that surprising I found an unknown instance that was installed by another network administrator.  The SQL Server instance was the desktop version and was prepackaged.  When I asked the admin about it, he didn&#8217;t even know he installed it.  So why was it such an issue?  The developer that packaged the MSDE used sa and left the password blank.  There are several reasons why this is bad.  A few of you could name right away is.   Gaining access to that database servers databases and having unrestricted permissions to them.  The one I worry most about is linked servers and other data source connections you can make while in there.  With a prepackaged MSDE installed under the radar, you can gain access to anything and everything.</p>
<p>After saying all that I wanted to post how I audit the network for instances and maintain the knowledge of what I have out there and what may be potentially a problem.</p>
<p>First I use SQL Ping which can be found http://www.sqlsecurity.com/Tools/FreeTools/tabid/65/Default.aspx</p>
<p>SQL Ping isn&#8217;t a secret and most of you probably know or have used it.  It seems to be the easiest and free instance discovery tool out there.   There is a good article over on SQL Server Central that goes over the usage @ http://www.sqlservercentral.com/articles/64016/</p>
<p>In most cases your will know you facilities IP schema so it makes searches fairly simple.  Example would be if you have your corporate location on 192.168.61.xx and your primary manufacturing location on 192.168.71.xx.  For SQL Ping all we need to do is the following then to search those networks for existing SQL Server instances.</p>
<p>Sqlping3cl.exe ‚Äìscantype range ‚ÄìstartIP 192.168.61.0 ‚ÄìendIP 192.168.61.254 ‚Äìoutput instance_searchcorporate_location.csv</p>
<p>This outputs a file listing all found instances.  The primary data I&#8217;m worried about for the task of security audits are the columns ServerIP, ServerName, InstanceName, TrueVersion and Details.</p>
<p>This data gives me plenty to compare older audits with this one and let me know what may be a potential problem or a new instance that comes up without the DBA being notified.  </p>
<p>None of this is useful if you ask me though unless you can automate it.  Seeing as SQL Ping is a command line utility your options are wide.  You could use windows task scheduler to run the utility, or you can keep the entire process on the instance by scheduling it through a job.</p>
<p>The SSIS package is quite large on my job server due to error handling and script steps to validate files, SQL Ping functionality and a few other things that makes it lengthy.  In a real situation you&#8217;re also going to want to make it dynamic.  Pass variables in the SSIS around to call up SQL Ping to search difference schemas, instances and file locations.  You can also use the argument IPList to specify the IPs to search.  Make sure firewalls aren&#8217;t getting in your way by running SQL Ping first from the command prompt initially.<br />
For an example, I&#8217;m going to create a new package to run off a small subset of IP&#8217;s and static paths.<br />
First task bring over two send email tasks which will act as our success and failure notifications.  Add the SMTP connection to the connection manager and go ahead and configure the tasks to point to your local or remote SMTP server.<br />
Second task, bring over two script tasks.  First will be named ‚ÄúCall up SQLPing‚Äù, and the second, ‚ÄúValidate SQLPing Run and file output‚Äù.<br />
Go into the designer of the first script task and add IO and Diagnostics in so we can access the files and also call a new process.  I created a folder on my root c drive as C:instance_search where the files for this example will be written.  </p>
<p>The code will look like such</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="vbnet"><thead><tr><td colspan="2"  class="head">vb.net</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="de1"><pre class="de1">&nbsp; &nbsp; <span class="kw1">Public</span> <span class="kw1">Sub</span> Main<span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> File<span class="sy0">.</span><span class="me1">Exists</span><span class="br0">&#40;</span><span class="st0">&quot;C:instance_searchcorporate_location.csv&quot;</span><span class="br0">&#41;</span> <span class="kw1">Then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; File<span class="sy0">.</span><span class="me1">Delete</span><span class="br0">&#40;</span><span class="st0">&quot;C:instance_searchcorporate_location.csv&quot;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span> <span class="kw1">If</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> proc <span class="kw1">As</span> <span class="kw1">New</span> Process
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> args <span class="kw1">As</span> <span class="kw1">New</span> ProcessStartInfo<span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; args<span class="sy0">.</span><span class="me1">FileName</span> <span class="sy0">=</span> <span class="st0">&quot;c:sqlping3cl.exe&quot;</span>
&nbsp; &nbsp; &nbsp; &nbsp; args<span class="sy0">.</span><span class="me1">Arguments</span> <span class="sy0">=</span> <span class="st0">&quot;-scantype range -startIP 192.168.xx.xx -EndIP 192.168.xx.xx -Output instance_searchcorporate_location.csv&quot;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; proc<span class="sy0">.</span><span class="me1">StartInfo</span> <span class="sy0">=</span> args
&nbsp; &nbsp; &nbsp; &nbsp; proc<span class="sy0">.</span><span class="me1">Start</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; proc<span class="sy0">.</span><span class="me1">WaitForExit</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; Dts<span class="sy0">.</span><span class="me1">TaskResult</span> <span class="sy0">=</span> Dts<span class="sy0">.</span><span class="me1">Results</span><span class="sy0">.</span><span class="me1">Success</span>
&nbsp; &nbsp; <span class="kw1">End</span> <span class="kw1">Sub</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">    Public Sub Main()
        If File.Exists("C:instance_searchcorporate_location.csv") Then
            File.Delete("C:instance_searchcorporate_location.csv")
        End If

        Dim proc As New Process
        Dim args As New ProcessStartInfo()

        args.FileName = "c:sqlping3cl.exe"
        args.Arguments = "-scantype range -startIP 192.168.xx.xx -EndIP 192.168.xx.xx -Output instance_searchcorporate_location.csv"

        proc.StartInfo = args
        proc.Start()
        proc.WaitForExit()

        Dts.TaskResult = Dts.Results.Success
    End Sub</pre></div></div>

<p>Replace the xx with your own structure.    There are some things I need to point out with SQLPing 3.0 command line.  I have problems putting paths in such as C:folderfile.csv.  I have a posting up on sqlsecurity.com and Chip has made some replies.   Seeing as the following command works fine I haven&#8217;t pulled SQL Ping 3.0 from this process.  The new version is still a very good tool that based all my tests for stability. I thank Chip again for the hard work and offering of SQL Ping to the community.  If you have problems you can always comment here as well for help or go to the sqlsecurity.com community.</p>
<p>This is the working command for directory paths other than the root:</p>
<p>c: sqlping3cl.exe &#8220;-scantype range -startIP 192.168.xx.xx -EndIP 192.168.xx.xx -Output instance_searchcorporate_location.csv</p>
<p>Next step in the SSIS package is to edit the second script task.  This step will validate the file creation by SQL Ping and base the flow for the next step on the existence of the file.  </p>
<p>The code will be as follows</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="vbnet"><thead><tr><td colspan="2"  class="head">vb.net</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="de1"><pre class="de1"><span class="kw1">Public</span> <span class="kw1">Class</span> ScriptMain
&nbsp;
&nbsp; &nbsp; <span class="kw1">Public</span> <span class="kw1">Sub</span> Main<span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> File<span class="sy0">.</span><span class="me1">Exists</span><span class="br0">&#40;</span><span class="st0">&quot;C:instance_searchcorporate_location.csv&quot;</span><span class="br0">&#41;</span> <span class="kw1">Then</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dts<span class="sy0">.</span><span class="me1">TaskResult</span> <span class="sy0">=</span> Dts<span class="sy0">.</span><span class="me1">Results</span><span class="sy0">.</span><span class="me1">Success</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Else</span>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dts<span class="sy0">.</span><span class="me1">TaskResult</span> <span class="sy0">=</span> Dts<span class="sy0">.</span><span class="me1">Results</span><span class="sy0">.</span><span class="me1">Failure</span>
&nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span> <span class="kw1">If</span>
&nbsp; &nbsp; <span class="kw1">End</span> <span class="kw1">Sub</span>
&nbsp;
<span class="kw1">End</span> <span class="kw1">Class</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">Public Class ScriptMain

	Public Sub Main()
        If File.Exists("C:instance_searchcorporate_location.csv") Then
            Dts.TaskResult = Dts.Results.Success
        Else
            Dts.TaskResult = Dts.Results.Failure
        End If
	End Sub

End Class</pre></div></div>

<p>All we need to accomplish here is to validate the files existence.  If the file does not exist then our steps will go to the send failure email task and notify you.<br />
Next step, drag over a Data Flow task.  Add to the connection managers a flat file connection to the csv file in the instance_search folder as a flat file connection.  Second, add an ADO.NET or OLEDB connection to your instance.  In my case I have a DBA database on the instance that this package is created.  In this database I created a table instance_audit.  This table is where we pump the results from SQL Ping in order to report on later.  The create table would be‚Ä¶</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="de1"><pre class="de1"><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> <span class="br0">&#91;</span>dbo<span class="br0">&#93;</span>.<span class="br0">&#91;</span>instance_audit<span class="br0">&#93;</span><span class="br0">&#40;</span>
&nbsp; &nbsp; <span class="br0">&#91;</span>ServerIP<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>TCPPort<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">5</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>ServerName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">55</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>InstanceName<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">55</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>BaseVersion<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">char</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">20</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>SSNetlibVersion<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>TrueVersion<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">50</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>ServiceAccount<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">55</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>IsClustered<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">25</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>Details<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="kw2">max</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>,
&nbsp; &nbsp; <span class="br0">&#91;</span>DetectionMethod<span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="kw1">varchar</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="nu0">55</span><span class="br0">&#41;</span> <span class="sy0">NULL</span>
<span class="br0">&#41;</span> <span class="kw1">ON</span> <span class="br0">&#91;</span><span class="kw1">PRIMARY</span><span class="br0">&#93;</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">CREATE TABLE [dbo].[instance_audit](
	[ServerIP] [varchar](50) NULL,
	[TCPPort] [varchar](5) NULL,
	[ServerName] [varchar](55) NULL,
	[InstanceName] [varchar](55) NULL,
	[BaseVersion] [char](20) NULL,
	[SSNetlibVersion] [varchar](50) NULL,
	[TrueVersion] [varchar](50) NULL,
	[ServiceAccount] [varchar](55) NULL,
	[IsClustered] [varchar](25) NULL,
	[Details] [varchar](max) NULL,
	[DetectionMethod] [varchar](55) NULL
) ON [PRIMARY]</pre></div></div>

<p>In the data flow tab drag over a flat file source, data conversion and OLEDB destination.<br />
Configure the flat file source with the flat file connection.  Verify the mappings all look good after configuring the source.  Connect to the flat file source to the data conversion and open up the configuration window of the conversion.  I edit my types in the conversion so they appear as</p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/mapp_view.gif" alt="" title="" /></div>
<p>This ensures they will pump to SQL accurately and without issues.  Connect the conversion to the OLEDB destination and open the destination editor.  Select the SQL connection you created earlier and then in the table listing find your table.  Verify in mappings then that your converted values are mapped.  By default you will probably get the original columns.  I typically check &#8220;Keep nulls&#8221; for these types of tasks also.  Sense we rely on external processes that are out of our control the opportunity for null values is more probable.  </p>
<p>Go back the control flow tab and connect all your steps to the email tasks so notifications go out on success and failures.  You should end up with something similar to </p>
<div class="image_block"><img src="/wp-content/uploads/blogs/DataMgmt/pack_view.gif" alt="" title="" /></div>
<p>Running this package fills the discovered instances into the instance_audit table for later reporting in SSRS or you can send out a notification with a query attachment for review.<br />
Such as‚Ä¶</p>

<div class="bwp-syntax-block clearfix">
<div class="bwp-syntax-toolbar"><div class="bwp-syntax-control"><a href="javascript:;" class="bwp-syntax-source-switch" title="View Source Code"></a></div></div>
<div class="bwp-syntax-wrapper clearfix bwp-syntax-simple"><table class="tsql"><thead><tr><td colspan="2"  class="head">T-SQL</td></tr></thead><tbody><tr class="li1"><td class="ln"><pre class="de1">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="de1"><pre class="de1"><span class="kw1">EXEC</span> msdb.<span class="me1">dbo</span>.<span class="me1">sp_send_dbmail</span> @recipients<span class="sy0">=</span><span class="st0">'dba@your_company.com'</span>,
&nbsp; &nbsp; @subject <span class="sy0">=</span> <span class="st0">'Instance discovery completed.'</span>,
&nbsp; &nbsp; @body <span class="sy0">=</span> <span class="st0">'Review attachment for results of SQL Server scan of the network'</span>,
&nbsp; &nbsp; @body_format <span class="sy0">=</span> <span class="st0">'HTML'</span>,
&nbsp; &nbsp; @profile_name <span class="sy0">=</span> <span class="st0">'DBA'</span>,
&nbsp; &nbsp; @query <span class="sy0">=</span> <span class="st0">'Select * From db.dbo.instance_audit'</span>,
&nbsp; &nbsp; &nbsp;@query_attachment_filename <span class="sy0">=</span> <span class="st0">'Instance_Discovery.csv'</span>,
&nbsp; &nbsp; &nbsp;@query_result_header <span class="sy0">=</span> <span class="kw1">false</span>,
&nbsp; &nbsp; &nbsp;@query_result_width <span class="sy0">=</span> <span class="nu0">10000</span>,
&nbsp; &nbsp; &nbsp;@attach_query_result_as_file <span class="sy0">=</span> <span class="nu0">1</span>,
&nbsp; &nbsp; &nbsp;@query_result_separator <span class="sy0">=</span> <span class="st0">','</span></pre></td></tr></tbody></table></div>
<div class="bwp-syntax-source"><pre class="no-parse">EXEC msdb.dbo.sp_send_dbmail @recipients='dba@your_company.com',
	@subject = 'Instance discovery completed.',
	@body = 'Review attachment for results of SQL Server scan of the network',
	@body_format = 'HTML',
	@profile_name = 'DBA',
	@query = 'Select * From db.dbo.instance_audit',
	 @query_attachment_filename = 'Instance_Discovery.csv',
	 @query_result_header = false,
	 @query_result_width = 10000,
	 @attach_query_result_as_file = 1,
	 @query_result_separator = ','</pre></div></div>

<p>It takes around 1 minute 30 seconds to scan 50 IPs, finding 15 instances.  The longest time that I have found is the SQL Ping and writing the output contents.  That is a local test on my personal machine.  The server scans a complete 0 ‚Äì 254 (24 instances) and completes the insert into the table in around a minute.</p>
<div class='rp4wp-related-posts'>
<h3>Related Posts</h3>
<ul>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/dbprogramming/sql-server-sprawl-heard-it-twice-in-one/'>SQL Server sprawl, heard it twice in one day</a><p>Last week on Wednesday I attended a Quest seminar which was hosted by a couple&hellip;</p></div>
</li>
<li><div class='rp4wp-related-post-content'>
<a href='/index.php/datamgmt/datadesign/location-of-files-for-new/'>Location of files for new database in SQL Server</a><p>The following question was asked I've got a sql server that's set up to have&hellip;</p></div>
</li>
</ul>
</div>
</div>
				<div class="post-author">
					<div class="userInfo"><h2>About the Author</h2>Ted Krueger is a SQL Server MVP and Author that has been working in development and database administration and the owner of a successful consulting business, DataMetrics Consulting.  Specialties range from High Availability and Disaster / Recovery setup and testing methods down to custom assembly development for SQL Server Reporting Services.  Ted blogs and is also one of the founders of LessThanDot.com technology community.  Some of the articles focused on are Backup / Recovery, Security, SSIS and working on SQL Server and using all of the SQL Server features available to create stable and scalable database services.  <br style="clear: left" /><div class="bioSoc"><span class="bioSocTitle">Social Sitings</span><a href="http://twitter.com/onpnt" title="onpnt at Twitter" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_twitter.png" alt="Twitter" /></a><a href="http://www.facebook.com/profile.php?id=https://www.facebook.com/onpntfirearms" title="onpnt at Facebook" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_facebook.png" alt="Facebook" /></a><a href="http://www.linkedin.com/pub/ted-krueger/2/183/b66" title="onpnt at LinkedIn" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_linkedin.png" alt="LinkedIn" /></a><a href="http://www.datametricsconsulting.com/" title="onpnt at HomePage" class="bioSocLink" rel="author"><img src="http://lessthandot.com/images/bdg_homepage.png" alt="HomePage" /></a><a href="/index.php/author/onpnt/feed/" title="Blog RSS feed for onpnt" class="bioSocLink"><img src="http://lessthandot.com/images/bdg_rss_icon.png" alt="LTD RSS Feed" /></a></div></div>				</div>
				<div class="post-foot instapaper_ignore">
					<div class="post-tagline">
						<div class="post-foot-views"><label>Article views:</label> 50,092 </div>
						<div class="post-foot-more-posts">
                            <a href="/index.php/author/onpnt/">Read More Posts by Ted Krueger (onpnt)</a>
						</div>
					</div>
					<div>
						 
					</div>
					<div class="post-tagline" style="height: auto">
						<span class="social-button-label">Share:</span><a href="https://twitter.com/intent/tweet?url=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&text=RT @LessThanDot Blog - Scan network for SQL Server instances by @onpnt" class="twitter-share-button-static" target="_blank"><i></i><span class="label">Tweet</span></a><a href="http://www.linkedin.com/shareArticle?mini=true&url=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&title=Scan network for SQL Server instances&source=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/" target="_blank" title="Share on LinkedIn" class="svg-button"><img alt="Share on LinkedIn"  src="http://lessthandot.com/images/LinkedIn.svg" /></a><a href="http://www.reddit.com/submit?url=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&title=Scan network for SQL Server instances" target="_blank" title="Submit to Reddit" class="svg-button"><img alt="Submit to Reddit" src="http://lessthandot.com/images/Reddit.svg" /></a><a href="https://www.facebook.com/sharer/sharer.php?u=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&quote=Scan network for SQL Server instances" title="Share on Facebook" target="_blank" class="svg-button"><img alt="Share on Facebook" src="http://lessthandot.com/images/Facebook.svg" /></a> <a href="http://www.instapaper.com/hello2?url=/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/&title=Scan network for SQL Server instances" class="instapaper_button">Instapaper</a>					</div>			
				</div>
				<div class="comments-area instapaper_ignore">
	<h4 class="comments-title">
		13 Comments	</h4>
			<ol class="comments-list">
					<li class="comment even thread-even depth-1" id="comment-1056">
				<div id="div-comment-1056" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/96f4e1a6b175ac636e34463ca5645a2b?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/96f4e1a6b175ac636e34463ca5645a2b?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn"><a href='http://www.SQLServerNewbie.com/' rel='external nofollow' class='url'>Jerry Hung</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1056">
			March 10, 2009 at 11:55 am</a>		</div>

		<p>funny how I just read Brent Ozar&#8217;s posts on Quest&#8217;s free Discovery Wizard, to find SQL Servers on the network, no coding required</p>
<p><a href="http://www.brentozar.com/archive/2009/03/discovery-wizard-plugin-query-packs/" rel="nofollow">http://www.brentozar.com/archive/2009/03/discovery-wizard-plugin-query-packs/</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1056#respond' onclick='return addComment.moveForm( "div-comment-1056", "1056", "respond", "344" )' aria-label='Reply to Jerry Hung'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1057">
				<div id="div-comment-1057" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1057">
			March 10, 2009 at 12:14 pm</a>		</div>

		<p>Yes, most of the big third parties will have this basic task for a &#8220;free&#8221; tool.  Idera and a few others provide similar products for free download.  If you like installing things on your servers outside a thin exe and native tools then they are great options. üôÇ</p>
<p>One thing to be warned is most install objects on the instance in order to function.  That will always push me to pass on them</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1057#respond' onclick='return addComment.moveForm( "div-comment-1057", "1057", "respond", "344" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1058">
				<div id="div-comment-1058" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/acce22159f2e08903a77fca17d850377?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/acce22159f2e08903a77fca17d850377?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Dan Jones</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1058">
			March 22, 2009 at 12:49 pm</a>		</div>

		<p>Microsoft has a free tool as well called MAP &#8211; Microsoft Assessment and Planning Toolkit. You can read more and download it here: <a href="http://www.microsoft.com/downloads/details.aspx?displaylang=en&#038;FamilyID=67240b76-3148-4e49-943d-4d9ea7f77730" rel="nofollow">http://www.microsoft.com/downloads/details.aspx?displaylang=en&#038;FamilyID=67240b76-3148-4e49-943d-4d9ea7f77730</a></p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1058#respond' onclick='return addComment.moveForm( "div-comment-1058", "1058", "respond", "344" )' aria-label='Reply to Dan Jones'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1059">
				<div id="div-comment-1059" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/70351e44f031f245f8e822897ea2fadd?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/70351e44f031f245f8e822897ea2fadd?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">kbriankelley</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1059">
			April 7, 2009 at 12:56 pm</a>		</div>

		<p>It&#8217;s important to note that the article here focuses on sqlping3 for the command line. There is a SQL Ping 3 GUI tool that doesn&#8217;t require scripting. The point is, though, that with this tool you can automate your scans, etc.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1059#respond' onclick='return addComment.moveForm( "div-comment-1059", "1059", "respond", "344" )' aria-label='Reply to kbriankelley'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1060">
				<div id="div-comment-1060" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/738fddd111232000b1027466e40930db?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/738fddd111232000b1027466e40930db?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Joannah</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1060">
			April 9, 2009 at 2:35 am</a>		</div>

		<p>I recently came across your blog and have been reading along. I thought I would leave my first comment. I don&#8217;t know what to say except that I have enjoyed reading. Nice blog. I will keep visiting this blog very often.</p>
<p>Joannah</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1060#respond' onclick='return addComment.moveForm( "div-comment-1060", "1060", "respond", "344" )' aria-label='Reply to Joannah'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-naomi odd alt thread-odd thread-alt depth-1" id="comment-1055">
				<div id="div-comment-1055" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/61e248e3f536e25c08658d205808b113?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Naomi Nosonovsky</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1055">
			August 6, 2009 at 9:09 pm</a>		</div>

		<p>Great post, thanks</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1055#respond' onclick='return addComment.moveForm( "div-comment-1055", "1055", "respond", "344" )' aria-label='Reply to Naomi Nosonovsky'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1062">
				<div id="div-comment-1062" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/4990f32a327f5ec510a878e35ed61053?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/4990f32a327f5ec510a878e35ed61053?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">megan</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1062">
			August 11, 2010 at 3:49 pm</a>		</div>

		<p>where did sqlsecurity.com go, I get failure on any attempted links</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1062#respond' onclick='return addComment.moveForm( "div-comment-1062", "1062", "respond", "344" )' aria-label='Reply to megan'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment byuser comment-author-onpnt bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-1063">
				<div id="div-comment-1063" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=64&#038;d=mm&#038;r=g' srcset='http://0.gravatar.com/avatar/9666550a97e912e0dff5023dddb78e64?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Ted Krueger (onpnt)</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1063">
			August 11, 2010 at 5:01 pm</a>		</div>

		<p>Not sure but I will see if I can find out</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1063#respond' onclick='return addComment.moveForm( "div-comment-1063", "1063", "respond", "344" )' aria-label='Reply to Ted Krueger (onpnt)'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-1061">
				<div id="div-comment-1061" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://1.gravatar.com/avatar/19d3d0f053c17b1d9f499b4589b73238?s=64&#038;d=mm&#038;r=g' srcset='http://1.gravatar.com/avatar/19d3d0f053c17b1d9f499b4589b73238?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">BettyLou</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1061">
			October 20, 2010 at 8:47 am</a>		</div>

		<p>I tried to go to <a href="http://www.sqlsecurity.com/Tools/FreeTools/tabid/65/Default.aspx" rel="nofollow">http://www.sqlsecurity.com/Tools/FreeTools/tabid/65/Default.aspx</a><br />
TrendMicro has it marked as malicious.  Is there another site where I can down load sqlping3??<br />
I enjoyed this article and hope to be able to use the scripting to meet my current needs.</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1061#respond' onclick='return addComment.moveForm( "div-comment-1061", "1061", "respond", "344" )' aria-label='Reply to BettyLou'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-1054">
				<div id="div-comment-1054" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/e1cd34f5de045c4e42b1539e0bd274af?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/e1cd34f5de045c4e42b1539e0bd274af?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Bob Sawyer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-1054">
			July 29, 2013 at 2:29 pm</a>		</div>

		<p>I know this is an old post, but&#8230;</p>
<p>Is the command line above for SQLPING3CL valid? Its not working for me. All it does is return the Syntax help listing. I copied and pasted directly from this page, and modified the IP addresses and file names and also a direct copy and paste of the exact command line listed above just to see if I was doing something wrong. </p>
<p>Running as admin on Windows 2008 R2 if that matters.</p>
<p>Thanks</p>
<p>Bob</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=1054#respond' onclick='return addComment.moveForm( "div-comment-1054", "1054", "respond", "344" )' aria-label='Reply to Bob Sawyer'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="comment even thread-even depth-1" id="comment-593818">
				<div id="div-comment-593818" class="comment-body">
				<div class="comment-author vcard">
			<img alt='' src='http://2.gravatar.com/avatar/2b790e5e0f7458dc2c0a9083e604e7dd?s=64&#038;d=mm&#038;r=g' srcset='http://2.gravatar.com/avatar/2b790e5e0f7458dc2c0a9083e604e7dd?s=128&amp;d=mm&amp;r=g 2x' class='avatar avatar-64 photo' height='64' width='64' />			<cite class="fn">Fred</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-593818">
			April 16, 2014 at 2:54 pm</a>		</div>

		<p>Old question need answer in case people try this solution.<br />
I&#8217;m new to SQL but at least I made it work.</p>
<p>In the Call up sqlping add args.WorkingDirectory = &#8220;c:\&#8221;</p>
<p>In the Validate &#8230; this work for me in SQL 2008 R2.<br />
       If File.Exists(&#8220;C:\instance_searchcorporate_location.csv&#8221;) Then<br />
            Dts.TaskResult = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success<br />
        Else<br />
            Dts.TaskResult = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure<br />
        End If</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=593818#respond' onclick='return addComment.moveForm( "div-comment-593818", "593818", "respond", "344" )' aria-label='Reply to Fred'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback odd alt thread-odd thread-alt depth-1" id="comment-4394360">
				<div id="div-comment-4394360" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='http://www.sqlskills.com/blogs/paul/how-to-scan-a-network-looking-for-sql-instances/' rel='external nofollow' class='url'>How to scan a network looking for SQL instances - Paul S. Randal</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-4394360">
			June 22, 2015 at 7:50 pm</a>		</div>

		<p>[&#8230;] Checkout the post at <a href="/index.php/DataMgmt/DBAdmin/scan-network-for-sql-server-instances" rel="nofollow">/index.php/DataMgmt/DBAdmin/scan-network-for-sql-server-instances</a>. [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=4394360#respond' onclick='return addComment.moveForm( "div-comment-4394360", "4394360", "respond", "344" )' aria-label='Reply to How to scan a network looking for SQL instances - Paul S. Randal'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		<li class="pingback even thread-even depth-1" id="comment-5897775">
				<div id="div-comment-5897775" class="comment-body">
				<div class="comment-author vcard">
						<cite class="fn"><a href='https://www.sqlskills.com/blogs/paul/how-to-scan-a-network-looking-for-sql-instances/' rel='external nofollow' class='url'>How to scan a network looking for SQL instances - Paul S. Randal</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#comment-5897775">
			November 18, 2017 at 7:34 pm</a>		</div>

		<p>[&#8230;] Checkout the post here. [&#8230;]</p>

		<div class="reply"><a rel='nofollow' class='comment-reply-link' href='/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/?replytocom=5897775#respond' onclick='return addComment.moveForm( "div-comment-5897775", "5897775", "respond", "344" )' aria-label='Reply to How to scan a network looking for SQL instances - Paul S. Randal'>Reply</a></div>
				</div>
		</li><!-- #comment-## -->
		</ol>
						<div id="respond" class="comment-respond">
			<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/index.php/datamgmt/dbadmin/scan-network-for-sql-server-instances/#respond" style="display:none;">Cancel reply</a></small></h3>				<form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form">
					<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='344' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><input type="hidden" id="killer_value" name="killer_value" value="01386bd6d8e091c2ab4c7c7de644d37b"/><noscript>Sorry, but you are required to use a javascript enabled brower to comment here.</noscript>				</form>
					</div><!-- #respond -->
		</div>			</div>
				<br style="clear: both;" />
</div>
		</div>
		<div id="page-footer">
			<div id="botnav"><a href="http://lessthandot.com/" title="LessThanDot Launchpad">Launchpad</a> | <a href="http://lessthandot.com/account.php" title="Your Account Settings">My Account</a> | <a href="http://lessthandot.com/statistics.php" title="Statistics">Statistics</a> | <a href="http://lessthandot.com/donate.php" title="Donate">Donate</a> | <a href="http://lessthandot.com/contactus.php" title="Contact Us">Contact Us</a> | <a href="http://lessthandot.com/aboutus.php" title="About the LessThanDot Team">&copy;2008 - 2019 LessThanDot, LLC</a></div>

		<script type='text/javascript'>
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-4471405-1']);
		_gaq.push(['_trackPageview']);
		_gaq.push(['_setCustomVar', 1, 'Environment', 'lessthandot.com', 3]);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	  </script>			<div class="validator"><a href="http://validator.w3.org/check?uri=referer">Valid XHTML</a> | <a href="http://jigsaw.w3.org/css-validator/check/referer" title="Validate the CSS for this page at the W3C website">Valid CSS</a> | 2018-11-11 15:52</div>
		</div>
	</div>
</div>
<!-- <script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script> -->
<script type='text/javascript' src='/wp-includes/js/wp-embed.min.js?ver=4.6.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var spam_destroyer = {"key":"159ff9dcc225580310c2de238cdd1f1a","lifetime":"3600","limit":"1552765823"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/spam-destroyer/kill.js?ver=1.2'></script>
</body>
</html>
